<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>HUD</title>
    <link rel="apple-touch-icon" sizes="180x180" href="./apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="./favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="./favicon-16x16.png" />
    <link rel="manifest" href="./site.webmanifest" />
    <script type="module" crossorigin>(function(){const se=document.createElement("link").relList;if(se&&se.supports&&se.supports("modulepreload"))return;for(const Oe of document.querySelectorAll('link[rel="modulepreload"]'))ee(Oe);new MutationObserver(Oe=>{for(const rt of Oe)if(rt.type==="childList")for(const O of rt.addedNodes)O.tagName==="LINK"&&O.rel==="modulepreload"&&ee(O)}).observe(document,{childList:!0,subtree:!0});function Ee(Oe){const rt={};return Oe.integrity&&(rt.integrity=Oe.integrity),Oe.referrerPolicy&&(rt.referrerPolicy=Oe.referrerPolicy),Oe.crossOrigin==="use-credentials"?rt.credentials="include":Oe.crossOrigin==="anonymous"?rt.credentials="omit":rt.credentials="same-origin",rt}function ee(Oe){if(Oe.ep)return;Oe.ep=!0;const rt=Ee(Oe);fetch(Oe.href,rt)}})();function nm(Z){return Z&&Z.__esModule&&Object.prototype.hasOwnProperty.call(Z,"default")?Z.default:Z}var wp={exports:{}},bf={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kp;function rm(){if(kp)return bf;kp=1;var Z=Symbol.for("react.transitional.element"),se=Symbol.for("react.fragment");function Ee(ee,Oe,rt){var O=null;if(rt!==void 0&&(O=""+rt),Oe.key!==void 0&&(O=""+Oe.key),"key"in Oe){rt={};for(var d in Oe)d!=="key"&&(rt[d]=Oe[d])}else rt=Oe;return Oe=rt.ref,{$$typeof:Z,type:ee,key:O,ref:Oe!==void 0?Oe:null,props:rt}}return bf.Fragment=se,bf.jsx=Ee,bf.jsxs=Ee,bf}var Lp;function am(){return Lp||(Lp=1,wp.exports=rm()),wp.exports}var Fe=am(),Tp={exports:{}},Wt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bp;function sm(){if(Bp)return Wt;Bp=1;var Z=Symbol.for("react.transitional.element"),se=Symbol.for("react.portal"),Ee=Symbol.for("react.fragment"),ee=Symbol.for("react.strict_mode"),Oe=Symbol.for("react.profiler"),rt=Symbol.for("react.consumer"),O=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),it=Symbol.for("react.suspense"),Ne=Symbol.for("react.memo"),Mt=Symbol.for("react.lazy"),Bt=Symbol.iterator;function at(fe){return fe===null||typeof fe!="object"?null:(fe=Bt&&fe[Bt]||fe["@@iterator"],typeof fe=="function"?fe:null)}var _e={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},st=Object.assign,yi={};function Ai(fe,Je,St){this.props=fe,this.context=Je,this.refs=yi,this.updater=St||_e}Ai.prototype.isReactComponent={},Ai.prototype.setState=function(fe,Je){if(typeof fe!="object"&&typeof fe!="function"&&fe!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,fe,Je,"setState")},Ai.prototype.forceUpdate=function(fe){this.updater.enqueueForceUpdate(this,fe,"forceUpdate")};function Pn(){}Pn.prototype=Ai.prototype;function cn(fe,Je,St){this.props=fe,this.context=Je,this.refs=yi,this.updater=St||_e}var pr=cn.prototype=new Pn;pr.constructor=cn,st(pr,Ai.prototype),pr.isPureReactComponent=!0;var tn=Array.isArray,$t={H:null,A:null,T:null,S:null},Jt=Object.prototype.hasOwnProperty;function li(fe,Je,St,xt,ot,Rt){return St=Rt.ref,{$$typeof:Z,type:fe,key:Je,ref:St!==void 0?St:null,props:Rt}}function gi(fe,Je){return li(fe.type,Je,void 0,void 0,void 0,fe.props)}function Dt(fe){return typeof fe=="object"&&fe!==null&&fe.$$typeof===Z}function ai(fe){var Je={"=":"=0",":":"=2"};return"$"+fe.replace(/[=:]/g,function(St){return Je[St]})}var Dn=/\/+/g;function Kn(fe,Je){return typeof fe=="object"&&fe!==null&&fe.key!=null?ai(""+fe.key):Je.toString(36)}function un(){}function ji(fe){switch(fe.status){case"fulfilled":return fe.value;case"rejected":throw fe.reason;default:switch(typeof fe.status=="string"?fe.then(un,un):(fe.status="pending",fe.then(function(Je){fe.status==="pending"&&(fe.status="fulfilled",fe.value=Je)},function(Je){fe.status==="pending"&&(fe.status="rejected",fe.reason=Je)})),fe.status){case"fulfilled":return fe.value;case"rejected":throw fe.reason}}throw fe}function Fn(fe,Je,St,xt,ot){var Rt=typeof fe;(Rt==="undefined"||Rt==="boolean")&&(fe=null);var Ut=!1;if(fe===null)Ut=!0;else switch(Rt){case"bigint":case"string":case"number":Ut=!0;break;case"object":switch(fe.$$typeof){case Z:case se:Ut=!0;break;case Mt:return Ut=fe._init,Fn(Ut(fe._payload),Je,St,xt,ot)}}if(Ut)return ot=ot(fe),Ut=xt===""?"."+Kn(fe,0):xt,tn(ot)?(St="",Ut!=null&&(St=Ut.replace(Dn,"$&/")+"/"),Fn(ot,Je,St,"",function(ui){return ui})):ot!=null&&(Dt(ot)&&(ot=gi(ot,St+(ot.key==null||fe&&fe.key===ot.key?"":(""+ot.key).replace(Dn,"$&/")+"/")+Ut)),Je.push(ot)),1;Ut=0;var hn=xt===""?".":xt+":";if(tn(fe))for(var ei=0;ei<fe.length;ei++)xt=fe[ei],Rt=hn+Kn(xt,ei),Ut+=Fn(xt,Je,St,Rt,ot);else if(ei=at(fe),typeof ei=="function")for(fe=ei.call(fe),ei=0;!(xt=fe.next()).done;)xt=xt.value,Rt=hn+Kn(xt,ei++),Ut+=Fn(xt,Je,St,Rt,ot);else if(Rt==="object"){if(typeof fe.then=="function")return Fn(ji(fe),Je,St,xt,ot);throw Je=String(fe),Error("Objects are not valid as a React child (found: "+(Je==="[object Object]"?"object with keys {"+Object.keys(fe).join(", ")+"}":Je)+"). If you meant to render a collection of children, use an array instead.")}return Ut}function Ke(fe,Je,St){if(fe==null)return fe;var xt=[],ot=0;return Fn(fe,xt,"","",function(Rt){return Je.call(St,Rt,ot++)}),xt}function Ot(fe){if(fe._status===-1){var Je=fe._result;Je=Je(),Je.then(function(St){(fe._status===0||fe._status===-1)&&(fe._status=1,fe._result=St)},function(St){(fe._status===0||fe._status===-1)&&(fe._status=2,fe._result=St)}),fe._status===-1&&(fe._status=0,fe._result=Je)}if(fe._status===1)return fe._result.default;throw fe._result}var zt=typeof reportError=="function"?reportError:function(fe){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Je=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof fe=="object"&&fe!==null&&typeof fe.message=="string"?String(fe.message):String(fe),error:fe});if(!window.dispatchEvent(Je))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",fe);return}console.error(fe)};function ci(){}return Wt.Children={map:Ke,forEach:function(fe,Je,St){Ke(fe,function(){Je.apply(this,arguments)},St)},count:function(fe){var Je=0;return Ke(fe,function(){Je++}),Je},toArray:function(fe){return Ke(fe,function(Je){return Je})||[]},only:function(fe){if(!Dt(fe))throw Error("React.Children.only expected to receive a single React element child.");return fe}},Wt.Component=Ai,Wt.Fragment=Ee,Wt.Profiler=Oe,Wt.PureComponent=cn,Wt.StrictMode=ee,Wt.Suspense=it,Wt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=$t,Wt.act=function(){throw Error("act(...) is not supported in production builds of React.")},Wt.cache=function(fe){return function(){return fe.apply(null,arguments)}},Wt.cloneElement=function(fe,Je,St){if(fe==null)throw Error("The argument must be a React element, but you passed "+fe+".");var xt=st({},fe.props),ot=fe.key,Rt=void 0;if(Je!=null)for(Ut in Je.ref!==void 0&&(Rt=void 0),Je.key!==void 0&&(ot=""+Je.key),Je)!Jt.call(Je,Ut)||Ut==="key"||Ut==="__self"||Ut==="__source"||Ut==="ref"&&Je.ref===void 0||(xt[Ut]=Je[Ut]);var Ut=arguments.length-2;if(Ut===1)xt.children=St;else if(1<Ut){for(var hn=Array(Ut),ei=0;ei<Ut;ei++)hn[ei]=arguments[ei+2];xt.children=hn}return li(fe.type,ot,void 0,void 0,Rt,xt)},Wt.createContext=function(fe){return fe={$$typeof:O,_currentValue:fe,_currentValue2:fe,_threadCount:0,Provider:null,Consumer:null},fe.Provider=fe,fe.Consumer={$$typeof:rt,_context:fe},fe},Wt.createElement=function(fe,Je,St){var xt,ot={},Rt=null;if(Je!=null)for(xt in Je.key!==void 0&&(Rt=""+Je.key),Je)Jt.call(Je,xt)&&xt!=="key"&&xt!=="__self"&&xt!=="__source"&&(ot[xt]=Je[xt]);var Ut=arguments.length-2;if(Ut===1)ot.children=St;else if(1<Ut){for(var hn=Array(Ut),ei=0;ei<Ut;ei++)hn[ei]=arguments[ei+2];ot.children=hn}if(fe&&fe.defaultProps)for(xt in Ut=fe.defaultProps,Ut)ot[xt]===void 0&&(ot[xt]=Ut[xt]);return li(fe,Rt,void 0,void 0,null,ot)},Wt.createRef=function(){return{current:null}},Wt.forwardRef=function(fe){return{$$typeof:d,render:fe}},Wt.isValidElement=Dt,Wt.lazy=function(fe){return{$$typeof:Mt,_payload:{_status:-1,_result:fe},_init:Ot}},Wt.memo=function(fe,Je){return{$$typeof:Ne,type:fe,compare:Je===void 0?null:Je}},Wt.startTransition=function(fe){var Je=$t.T,St={};$t.T=St;try{var xt=fe(),ot=$t.S;ot!==null&&ot(St,xt),typeof xt=="object"&&xt!==null&&typeof xt.then=="function"&&xt.then(ci,zt)}catch(Rt){zt(Rt)}finally{$t.T=Je}},Wt.unstable_useCacheRefresh=function(){return $t.H.useCacheRefresh()},Wt.use=function(fe){return $t.H.use(fe)},Wt.useActionState=function(fe,Je,St){return $t.H.useActionState(fe,Je,St)},Wt.useCallback=function(fe,Je){return $t.H.useCallback(fe,Je)},Wt.useContext=function(fe){return $t.H.useContext(fe)},Wt.useDebugValue=function(){},Wt.useDeferredValue=function(fe,Je){return $t.H.useDeferredValue(fe,Je)},Wt.useEffect=function(fe,Je){return $t.H.useEffect(fe,Je)},Wt.useId=function(){return $t.H.useId()},Wt.useImperativeHandle=function(fe,Je,St){return $t.H.useImperativeHandle(fe,Je,St)},Wt.useInsertionEffect=function(fe,Je){return $t.H.useInsertionEffect(fe,Je)},Wt.useLayoutEffect=function(fe,Je){return $t.H.useLayoutEffect(fe,Je)},Wt.useMemo=function(fe,Je){return $t.H.useMemo(fe,Je)},Wt.useOptimistic=function(fe,Je){return $t.H.useOptimistic(fe,Je)},Wt.useReducer=function(fe,Je,St){return $t.H.useReducer(fe,Je,St)},Wt.useRef=function(fe){return $t.H.useRef(fe)},Wt.useState=function(fe){return $t.H.useState(fe)},Wt.useSyncExternalStore=function(fe,Je,St){return $t.H.useSyncExternalStore(fe,Je,St)},Wt.useTransition=function(){return $t.H.useTransition()},Wt.version="19.0.0",Wt}var Op;function Ip(){return Op||(Op=1,Tp.exports=sm()),Tp.exports}var bd=Ip();function om({name:Z,label:se,unit:Ee,value:ee,defaultValue:Oe,onChange:rt,min:O,max:d,step:it=1,validate:Ne,type:Mt,options:Bt,className:at,shortcut:_e}){const st=Ai=>{let Pn=Ai.target.value;Ne&&(Pn=Ne(Pn)),rt(Pn)},yi=function(Ai){if(Ai==="number")return"number";if(Ai==="select")return"select";if(Ai==="toggle")return"button"};return ee===void 0&&(ee=Oe),Fe.jsxs("div",{className:`flex flex-col items-center justify-center aspect-square text-white space-y-2 font-mono overflow-hidden last:border-b last:border-gray-400 lg:last:border-r relative ${at}`,children:[Fe.jsx("label",{htmlFor:Z,className:"uppercase",children:se}),_e&&Fe.jsxs("div",{className:"absolute bottom-1 left-1/2 -translate-x-1/2 font-mono text-xs text-gray-400",children:["(",_e,")"]}),Fe.jsx("input",{type:yi(Mt),id:Z,className:"border-green-500 text-center border text-xl w-25 text-white font-semibold selection:bg-green-300 selection:text-black bg-black focus:outline-none focus:ring focus:ring-green-500 focus:ring-offset-2 focus:ring-offset-gray-800",value:ee,min:O,max:d,step:it,onChange:st}),Fe.jsx("p",{className:"text-sm text-gray-400 uppercase",children:Ee})]})}function lm({position:Z,onToggle:se,shortcut:Ee,className:ee=""}){return Fe.jsxs("div",{className:`flex flex-col items-center justify-center aspect-square text-white space-y-2 font-mono last:border-b last:border-gray-400 lg:last:border-r relative ${ee}`,children:[Fe.jsx("label",{htmlFor:"gear",className:"uppercase",children:"Gear"}),Ee&&Fe.jsxs("div",{className:"absolute bottom-1 left-1/2 -translate-x-1/2 font-mono text-xs text-gray-400",children:["(",Ee,")"]}),Fe.jsx("button",{type:"button",className:"border-green-500 border text-xl text-center w-25 text-white font-semibold hover:bg-green-900 focus:bg-green-900 transition-colors bg-black focus:outline-none focus:ring focus:ring-green-500 focus:ring-offset-2 focus:ring-offset-gray-800",onClick:se,children:Z.toUpperCase()}),Fe.jsx("p",{className:"text-sm text-gray-400 uppercase",children:"Status"})]})}function cm({mode:Z,onToggle:se,shortcut:Ee,className:ee=""}){return Fe.jsxs("div",{className:`flex flex-col items-center justify-center aspect-square text-white space-y-2 font-mono last:border-b last:border-gray-400 lg:last:border-r relative ${ee}`,children:[Fe.jsx("label",{htmlFor:"mode",className:"uppercase",children:"Throttle"}),Ee&&Fe.jsxs("div",{className:"absolute bottom-1 left-1/2 -translate-x-1/2 font-mono text-xs text-gray-400",children:["(",Ee,")"]}),Fe.jsx("button",{type:"button",className:"border-green-500 border text-xl text-center w-25 text-white font-semibold hover:bg-green-900 focus:bg-green-900 transition-colors bg-black focus:outline-none focus:ring focus:ring-green-500 focus:ring-offset-2 focus:ring-offset-gray-800",onClick:se,children:Z.toUpperCase()}),Fe.jsx("p",{className:"text-sm text-gray-400 uppercase",children:"Mode"})]})}function um({shortcut:Z,className:se=""}){const Ee=()=>{window.print()};return Fe.jsxs("div",{className:`flex flex-col items-center justify-center aspect-square text-white space-y-2 font-mono last:border-b last:border-gray-400 lg:last:border-r relative ${se}`,children:[Fe.jsx("label",{htmlFor:"gear",className:"uppercase",children:"Download"}),Z&&Fe.jsxs("div",{className:"absolute bottom-1 left-1/2 -translate-x-1/2 font-mono text-xs text-gray-400",children:["(",Z,")"]}),Fe.jsx("button",{onClick:Ee,type:"button",className:"border-green-500 border uppercase text-xl text-center w-25 text-white font-semibold hover:bg-green-900 focus:bg-green-900 transition-colors bg-black focus:outline-none focus:ring focus:ring-green-500 focus:ring-offset-2 focus:ring-offset-gray-800",children:"Save"}),Fe.jsx("p",{className:"text-sm text-gray-400 uppercase",children:"HUD"})]})}function hm({position:Z,onToggle:se,shortcut:Ee,className:ee=""}){function Oe(){Z===fr.IN?se(fr.HALF):Z===fr.HALF?se(fr.FULL):Z===fr.FULL?se(fr.LOCKED):se(fr.IN)}return Fe.jsxs("div",{className:`flex flex-col items-center justify-center aspect-square text-white space-y-2 font-mono last:border-b last:border-gray-400 lg:last:border-r relative ${ee}`,children:[Fe.jsx("label",{htmlFor:"boards",className:"uppercase",children:"Boards"}),Ee&&Fe.jsxs("div",{className:"absolute bottom-1 left-1/2 -translate-x-1/2 font-mono text-xs text-gray-400",children:["(",Ee,")"]}),Fe.jsx("button",{onClick:Oe,type:"button",className:"border-green-500 border text-xl text-center w-25 text-white font-semibold hover:bg-green-900 focus:bg-green-900 transition-colors bg-black focus:outline-none focus:ring focus:ring-green-500 focus:ring-offset-2 focus:ring-offset-gray-800",children:Z.toUpperCase()}),Fe.jsx("p",{className:"text-sm text-gray-400 uppercase",children:"Status"})]})}const dm=[{name:"altitude",label:"Alt",unit:"MSL",defaultValue:16e3,min:0,max:1e5,step:100,validate:function(Z){const se=Number(Z);return Math.min(Math.max(se,0),1e5)},type:"number",shortcut:"z+up/down"},{name:"airspeed",label:"Airspeed",unit:"KEAS",defaultValue:150,min:0,max:500,step:1,validate:function(Z){const se=Number(Z);return Math.min(Math.max(se,0),500)},type:"number",shortcut:"a+up/down"},{name:"heading",label:"Heading",unit:"deg",defaultValue:360,min:0,max:360,step:1,validate:function(Z){const se=Number(Z);return Math.min(Math.max(se,1),360)},type:"number",shortcut:"h+left/right"},{name:"pitch",label:"Gamma",unit:"deg",defaultValue:0,min:-45,max:45,step:.1,validate:function(Z){const se=Number(Z);return Math.min(Math.max(se,-45),45)},type:"number",shortcut:"up/down"},{name:"bank",label:"Bank",unit:"deg",defaultValue:0,min:-45,max:45,step:1,validate:function(Z){const se=Number(Z);return Math.min(Math.max(se,-45),45)},type:"number",shortcut:"left/right"},{name:"pla",label:"Power",unit:"PLA",defaultValue:30,min:0,max:100,step:1,type:"number",validate:function(Z){const se=Number(Z);return Math.min(Math.max(se,0),100)},shortcut:"ctrl+up/down"}];function fm({uavState:Z,displayPreferences:se,onStateChange:Ee}){return Fe.jsxs("section",{className:"flex w-full flex-col bg-black h-full overflow-y-auto print:hidden",children:[Fe.jsx("header",{className:"h-10 flex items-center justify-between border-x border-t border-gray-400",children:Fe.jsx("h1",{className:"font-mono uppercase tracking-tight font-black pl-4",children:"Control Panel"})}),Fe.jsx("main",{className:"flex-1 border border-gray-400",children:Fe.jsxs("div",{className:`\r
        grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 w-full h-auto divide-x divide-y divide-gray-400\r
        `,children:[dm.map(ee=>Fe.jsx(om,{...ee,value:Z[ee.name],onChange:Oe=>Ee({...Z,[ee.name]:Oe})},ee.name)),Fe.jsx(cm,{mode:Z.powerMode,shortcut:"t",onToggle:()=>Ee({...Z,powerMode:Z.powerMode==="speed"?"pla":"speed"})}),Fe.jsx(lm,{position:Z.gearPosition,shortcut:"g",onToggle:()=>Ee({...Z,gearPosition:Z.gearPosition==="up"?"down":"up"})}),Fe.jsx(hm,{position:Z.boardsPosition,shortcut:"b",onToggle:ee=>Ee({...Z,boardsPosition:ee})}),Fe.jsx(um,{shortcut:"ctrl+p"})]})}),Fe.jsx("footer",{className:"w-full border-x border-b border-gray-400 h-10 flex items-center px-4 text-gray-400 font-mono text-sm",children:Fe.jsx("p",{children:"Version 0.0.1"})})]})}function xd(Z){return Z=(Z-1)%360+1,Z<1&&(Z+=360),Z}function Sf(Z,se,Ee,ee){const Oe=pm(ee);return{x:Z+Ee*Math.cos(Oe),y:se+Ee*Math.sin(Oe)}}function pm(Z){return Z*Math.PI/180}const Dp=300,jp=50,mm=Dp/60,gm=-4,_m=-8;function ym(Z){const se=[];let Ee=xd(Z);for(let ee=-30;ee<=30;ee++){let Oe=Ee+ee;Oe=xd(Oe);const rt=ee*mm,O=Oe%10===0?_m:gm,d=[];(Oe%5===0||Oe%10===0)&&d.push(Fe.jsx("line",{x1:rt,y1:0,x2:rt,y2:O,stroke:"currentColor",strokeWidth:"1",id:`heading-indicator-tick-${ee}`})),Oe%10===0&&ee!==0&&Math.abs(ee)>2&&d.push(Fe.jsx("text",{x:rt,y:-10,textAnchor:"middle",fill:"currentColor",fontSize:"10",className:"font-mono",children:Oe.toString().slice(0,2)})),d.length>0&&se.push(Fe.jsx("g",{children:d},`heading-indicator-tick-${ee}`))}return se}function vm({heading:Z}){return Fe.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 text-green-500 print:text-black top-[3%] z-10",children:Fe.jsxs("svg",{width:Dp,height:jp,viewBox:"-120 -30 240 50",children:[Fe.jsx("rect",{x:-120,y:-30,width:Dp,height:jp+30,fillOpacity:100,id:"heading-indicator-background",className:"print:fill-white fill-black"}),ym(Z),Fe.jsx("rect",{x:-25,y:-23,width:50,height:16,stroke:"currentColor",className:"fill-black print:fill-white",strokeWidth:1}),Fe.jsx("text",{x:0,y:-11,textAnchor:"middle",fill:"currentColor",fontSize:"14",className:"font-mono",children:xd(Z).toString().padStart(3,"0")})]})})}function xm({pitch:Z,bank:se,width:Ee}){let ee=Z.toFixed(1);return Z>=0?ee="+"+ee:ee="âˆ’"+Math.abs(Z).toFixed(1),Fe.jsxs("div",{id:"commanded-pitch-indicator",className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",style:{width:`${Ee*1.2}px`},children:[Fe.jsxs("div",{className:"absolute right-0 flex items-center h-5 -translate-y-1/2",style:{transform:`translateY(${-Z*20}px)`,willChange:"transform"},children:[Fe.jsx("div",{className:"w-0 h-0 border-t-[8px] border-t-transparent border-b-[8px] border-b-transparent border-r-[12px] border-r-green-500 print:border-r-black"}),Fe.jsx("span",{className:"text-green-500 print:text-black ml-2 text-sm font-mono",children:ee})]}),Fe.jsxs("div",{className:"absolute left-0 flex items-center h-5 -translate-y-1/2",style:{transform:`translateY(${-Z*20}px)`,willChange:"transform"},children:[Fe.jsx("span",{className:"text-green-500 print:text-black mr-2 text-sm font-mono",children:ee}),Fe.jsx("div",{className:"w-0 h-0 border-t-[8px] border-t-transparent border-b-[8px] border-b-transparent border-l-[12px] border-l-green-500 print:border-l-black"})]})]})}const Yp=250,bm=150,wm=325,Kp=75,Tm=[-45,-35,-30,-25,-20,-15,-10,-5,0,5,10,15,20,25,30,35,45],Sm=[-45,-35,-30,-25,-20,-15,-10,-5,-2.5,0,2.5,5,10,15,20,25,30,35,45];function Mm(Z){let se;return Z===0?se=wm:Math.abs(Z)===2.5?se=bm:se=Yp,`${se/2-Kp/2}px`}function Fp(Z,se){const Ee={width:Mm(Z),height:"0.5px",transform:`
      translateX(${se?-37.5:Kp/2}px)
      rotate(${se?Z:-Z}deg)
    `,transformOrigin:se?"right center":"left center"};return Z<0?{...Ee,backgroundImage:"linear-gradient(to right, rgb(34 197 94) 50%, transparent 50%)",backgroundSize:"10px 1px",backgroundRepeat:"repeat-x"}:{...Ee,backgroundColor:"rgb(34 197 94)"}}function Em({bank:Z,gearPosition:se,pitch:Ee}){const ee=se==="down"?Sm:Tm;return Fe.jsx("div",{className:"relative w-full h-full",children:Fe.jsxs("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full h-full",style:{transform:`rotate(${Z}deg)`},children:[ee.map(Oe=>Fe.jsxs("div",{id:`pitch-line-${Oe}`,className:"absolute left-1/2 top-1/2 -translate-x-1/2 flex items-center justify-center",style:{transform:`translateY(${-Oe*20}px)`},children:[Fe.jsx("div",{className:`relative ${Oe>0?"print-bg-black":"print-bg-black-dotted"}`,style:Fp(Oe,!0)}),Fe.jsx("div",{className:`relative ${Oe>0?"print-bg-black":"print-bg-black-dotted"}`,style:Fp(Oe,!1)})]},Oe)),Fe.jsx(xm,{pitch:Ee,bank:Z,width:Yp})]})})}function Cm({bank:Z,pitch:se,boardsPosition:Ee}){const ee={transform:`
            translate(-50%, -50%) 
            rotate(${Z}deg)
            translate(0, ${-se*20}px)
        `};return Fe.jsx("div",{className:"absolute left-1/2 top-1/2 text-green-500 print:text-black",style:ee,children:Fe.jsxs("svg",{width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",className:"text-green-500 print:text-black",children:[Fe.jsx("circle",{cx:"15",cy:"15",r:"6",stroke:"currentColor",strokeWidth:"1",fill:"none"}),Fe.jsx("line",{x1:"0",y1:"15",x2:"9",y2:"15",stroke:"currentColor",strokeWidth:"1"}),Fe.jsx("line",{x1:"21",y1:"15",x2:"30",y2:"15",stroke:"currentColor",strokeWidth:"1"}),Fe.jsx("line",{x1:"15",y1:"0",x2:"15",y2:"9",stroke:"currentColor",strokeWidth:"1"}),Ee!=fr.IN&&Ee!=fr.LOCKED&&Fe.jsx("line",{x1:"5",y1:"15",x2:"5",y2:Ee===fr.HALF?"25":"45",stroke:"currentColor",strokeWidth:"1.5"})]})})}const Mf=150,Ef=200,Cf=0;function Am(Z){const se=[];return[-45,-30,-20,-10,0,10,20,30,45].forEach(ee=>{let Oe=ee%45===0?15:ee%10===0?10:7;(ee===45||ee===-45)&&Z<30&&Z>-30&&(Oe=0);let rt=Sf(Ef,Cf,Mf,ee+90),O=Sf(Ef,Cf,Mf-Oe,ee+90),d=Fe.jsx("g",{children:Fe.jsx("line",{x1:rt.x,y1:rt.y,x2:O.x,y2:O.y,stroke:"currentColor",strokeWidth:"1"})},ee);se.push(d)}),se}function zm(Z){const se=90+Z,Ee=Sf(Ef,Cf,Mf,se),ee=Sf(Ef,Cf,Mf+10,se-3),Oe=Sf(Ef,Cf,Mf+10,se+3);return Fe.jsx("path",{d:`M ${Ee.x} ${Ee.y} L ${ee.x} ${ee.y} L ${Oe.x} ${Oe.y} Z`,fill:"currentColor"})}function Pm({bank:Z}){return Fe.jsx("div",{id:"bank-indicator",className:"absolute left-1/2 bottom-[4%] print:bottom-[6%] -translate-x-1/2 text-green-500 print:text-black",children:Fe.jsxs("svg",{width:"400",height:"150",viewBox:"0 0 400 200",className:"scale-100",children:[Am(Z),zm(Z)]})})}function Dm({airspeed:Z}){return Fe.jsx("div",{style:{top:"55%",left:"20%",transform:"translate(-50%, -50%)"},className:"absolute border border-green-500 text-green-500 print:text-black print:border-black font-mono text-xl text-center w-20",children:Fe.jsx("p",{className:"text-xl",children:Z})})}function Im({altitude:Z}){return Fe.jsx("div",{style:{top:"55%",right:"13%",transform:"translate(-50%, -50%)"},className:"absolute border border-green-500 text-green-500 font-mono text-xl text-center w-20 print:text-black print:border-black",children:Fe.jsx("p",{className:"text-xl",children:Z})})}function Rm({pla:Z,powerMode:se}){const Ee=Z*2.7;return Fe.jsx("div",{style:{top:"35%",left:"16%",transform:"translate(-50%, -50%)"},className:"absolute font-mono text-green-500 print:text-black w-20",children:Fe.jsxs("svg",{viewBox:"0 0 100 150",className:"w-full",children:[Fe.jsx("path",{d:"M 50 10 A 40 40 0 1 1 10 50",fill:"none",stroke:"currentColor",strokeWidth:"1"}),Fe.jsx("line",{x1:"50",y1:"10",x2:"50",y2:"5",stroke:"currentColor",strokeWidth:"1"}),Fe.jsx("line",{x1:"10",y1:"50",x2:"5",y2:"50",stroke:"currentColor",strokeWidth:"1"}),Fe.jsxs("g",{transform:`rotate(${Ee}, 50, 50)`,children:[Fe.jsx("line",{x1:"50",y1:"50",x2:"50",y2:"15",stroke:"currentColor",strokeWidth:"1"}),Fe.jsx("path",{d:"M 45,20 L 50,15 L 55,20",fill:"currentColor",stroke:"currentColor",strokeWidth:"1"})]}),Fe.jsx("circle",{cx:"50",cy:"50",r:"15",fill:"black",className:"print:fill-white"}),Fe.jsx("text",{x:"50",y:"60",fontSize:"24",fill:"currentColor",fillOpacity:"1",textAnchor:"middle",stroke:"currentColor",strokeWidth:"1",children:Z}),se==="pla"&&Fe.jsx("text",{x:"50",y:"125",textAnchor:"middle",fontSize:"24",className:"uppercase",fill:"currentColor",fillOpacity:"1",stroke:"currentColor",strokeWidth:"1",children:se})]})})}function km(Z,se){let Ee=[];for(let ee=0;ee<se;ee++){const Oe=ee*2*Math.PI/se,rt={x:Z*Math.cos(Oe)+Z,y:Z*Math.sin(Oe)+Z};Ee.push(rt)}return Ee}function Lm(Z,se,Ee){return Fe.jsxs("svg",{width:se*2,height:se*2,viewBox:`0 0 ${se*2} ${se*2}`,fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Fe.jsx("text",{x:se,y:se+2,textAnchor:"middle",dominantBaseline:"middle",stroke:"currentColor",strokeWidth:"0",fill:"currentColor",fontSize:"20",className:"text-green-500 print:text-black",children:Ee}),Z.map(ee=>Fe.jsx("circle",{cx:ee.x,cy:ee.y,r:2,fill:"currentColor"},`${ee.x}-${ee.y}`))]})}function Bm({airspeed:Z}){let se=30;const Ee=11,ee=bd.useMemo(()=>km(se,Ee),[se,Ee]);return Fe.jsx("div",{style:{top:"55%",left:"20%",transform:"translate(-50%, -50%)"},className:"absolute flex items-center justify-center text-green-500 print:text-black print:border-black font-mono text-xl text-center w-20",children:Lm(ee,se,Z)})}function Om({uavState:Z,displayPreferences:se}){return Fe.jsx("div",{className:"border-gray-400 border w-full flex-1 bg-neutral-900 relative overflow-hidden flex items-center justify-center",children:Fe.jsxs("section",{id:"hud",className:"absolute h-full aspect-5/3 border-x border-gray-400 bg-black print:bg-white",children:[Fe.jsx(vm,{heading:Z.heading}),Fe.jsx(Em,{bank:Z.bank,gearPosition:Z.gearPosition,pitch:Z.pitch}),Fe.jsx(Cm,{bank:Z.bank,pitch:Z.pitch,boardsPosition:Z.boardsPosition}),Fe.jsx(Pm,{bank:Z.bank}),Z.gearPosition==="down"?Fe.jsx(Bm,{airspeed:Z.airspeed}):Fe.jsx(Dm,{airspeed:Z.airspeed}),Fe.jsx(Im,{altitude:Z.altitude}),Fe.jsx(Rm,{pla:Z.pla,powerMode:Z.powerMode})]})})}function jm(){return Fe.jsx("div",{className:"planform-container",children:Fe.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"-20.109 -7.737 20.86 8.896",children:Fe.jsx("path",{d:"M0 0-1.007.409-6.444-1.617-9.689-.727-12.819-1.6-18.42.393-19.359.03-19.029-.991-9.672-6.987-.315-.974 0-0",fill:"currentColor",strokeWidth:"0.1",className:"stroke-gray-500"})})})}function Fm({heading:Z}){const se=[{label:"N",angle:0},{label:"E",angle:90},{label:"S",angle:180},{label:"W",angle:270}],Ee=Array.from({length:72},(ee,Oe)=>Oe*5);return Fe.jsxs("svg",{viewBox:"-250 -250 500 500",className:"compass-rose",children:[Fe.jsx("circle",{r:"200",fill:"none",stroke:"currentColor",strokeWidth:"2"}),Ee.map(ee=>{const Oe=ee%30===0,rt=Oe?20:10,O=Oe?2:1,d=ee*Math.PI/180,it=Math.sin(d)*200,Ne=-Math.cos(d)*200,Mt=Math.sin(d)*(200-rt),Bt=-Math.cos(d)*(200-rt);return Fe.jsx("line",{x1:it,y1:Ne,x2:Mt,y2:Bt,stroke:"currentColor",strokeWidth:O},ee)}),se.map(({label:ee,angle:Oe})=>{const rt=Oe*Math.PI/180,O=Math.sin(rt)*170,d=-Math.cos(rt)*170;return Fe.jsx("text",{x:O,y:d,textAnchor:"middle",dominantBaseline:"middle",fill:"currentColor",fontSize:"24",children:ee},ee)})]})}function Nm({uavState:Z,displayPreferences:se}){return Fe.jsx("div",{className:"h-full print:hidden flex items-center justify-center relative flex-1 w-full",children:Fe.jsxs("div",{className:"relative h-full bg-black border-gray-400 border w-full aspect-square",children:[Fe.jsx("div",{className:"absolute inset-0 text-green-500 print:text-black",style:{transform:se.northUp?"rotate(0deg)":`rotate(-${Z.heading}deg)`,willChange:"transform"},children:Fe.jsx(Fm,{heading:Z.heading})}),Fe.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{transform:se.northUp?`rotate(${Z.heading}deg)`:"rotate(0deg)",willChange:"transform"},children:Fe.jsx("div",{className:"text-gray-700",style:{width:"100px"},children:Fe.jsx(jm,{})})})]})})}function Um(){return Fe.jsx("svg",{className:"transform scale-x-[-1]",xmlns:"http://www.w3.org/2000/svg",viewBox:"-0.05 -1.054 7.359 1.433",children:Fe.jsx("path",{d:"M0 0 .582-.259 1.213-.454 1.492-.885 2.303-.994 2.977-1.004 3.769-.961 4.556-.857 5.172-.738 5.76-.605 6.088-.596 6.804-.582 7.259-.53 7.022-.463 6.125-.307 5.756-.245 5.699-.093 5.229.039 4.148.329 3.332.329 1.302.299.63.188 0 0M5.757-.253 4.266.017 3.302.082 2.454.12 1.713.103 1.713.103 1.458.018 1.397-.122 1.555-.219 2.115-.365 3.021-.469 4.086-.511 5.005-.53 5.772-.578 6.739-.584 7.238-.542 7.098-.481 5.772-.25M1.214-.457 1.494-.895 2.31-.992 1.981-.596 1.202-.438l.292-.444M1.993-.603 2.316-.992 2.559-.968 2.735-.931 3.253-.761 3.642-.639 3.849-.603 3.995-.536 3.825-.536 3.283-.517 2.699-.481 2.249-.463 2.005-.45 1.932-.505 1.981-.615",strokeWidth:".05",fill:"currentColor",className:"stroke-gray-500"})})}function Vm({uavState:Z,displayPreferences:se}){const Ee=-Z.pitch||0;return Fe.jsx("div",{className:"border-gray-400 border w-full h-1/2 print:hidden bg-neutral-900",children:Fe.jsx("div",{className:"relative flex w-full h-full bg-black",children:Fe.jsx("div",{className:"w-1/4 flex items-center justify-center h-auto",children:Fe.jsx("div",{className:"text-gray-700",style:{transform:`rotate(${Ee}deg)`,transition:"transform 0.3s ease-out",width:"150px"},children:Fe.jsx(Um,{})})})})})}var lp={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.2.0/LICENSE.txt
 */var Zm=lp.exports,Np;function Gm(){return Np||(Np=1,function(Z,se){(function(Ee,ee){Z.exports=ee()})(Zm,function(){var Ee={},ee={};function Oe(O,d,it){if(ee[O]=it,O==="index"){var Ne="var sharedModule = {}; ("+ee.shared+")(sharedModule); ("+ee.worker+")(sharedModule);",Mt={};return ee.shared(Mt),ee.index(Ee,Mt),typeof window<"u"&&Ee.setWorkerUrl(window.URL.createObjectURL(new Blob([Ne],{type:"text/javascript"}))),Ee}}Oe("shared",["exports"],function(O){function d(a,t,r,o){return new(r||(r=Promise))(function(h,g){function _(M){try{w(o.next(M))}catch(C){g(C)}}function v(M){try{w(o.throw(M))}catch(C){g(C)}}function w(M){var C;M.done?h(M.value):(C=M.value,C instanceof r?C:new r(function(A){A(C)})).then(_,v)}w((o=o.apply(a,t||[])).next())})}function it(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Ne,Mt;function Bt(){if(Mt)return Ne;function a(t,r){this.x=t,this.y=r}return Mt=1,Ne=a,a.prototype={clone:function(){return new a(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,r){return this.clone()._rotateAround(t,r)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var r=t.x-this.x,o=t.y-this.y;return r*r+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,r){return Math.atan2(this.x*r-this.y*t,this.x*t+this.y*r)},_matMult:function(t){var r=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var r=Math.cos(t),o=Math.sin(t),h=o*this.x+r*this.y;return this.x=r*this.x-o*this.y,this.y=h,this},_rotateAround:function(t,r){var o=Math.cos(t),h=Math.sin(t),g=r.y+h*(this.x-r.x)+o*(this.y-r.y);return this.x=r.x+o*(this.x-r.x)-h*(this.y-r.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},a.convert=function(t){return t instanceof a?t:Array.isArray(t)?new a(t[0],t[1]):t},Ne}typeof SuppressedError=="function"&&SuppressedError;var at,_e,st=it(Bt()),yi=function(){if(_e)return at;function a(t,r,o,h){this.cx=3*t,this.bx=3*(o-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(h-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=o,this.p2y=h}return _e=1,at=a,a.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,r){if(r===void 0&&(r=1e-6),t<0)return 0;if(t>1)return 1;for(var o=t,h=0;h<8;h++){var g=this.sampleCurveX(o)-t;if(Math.abs(g)<r)return o;var _=this.sampleCurveDerivativeX(o);if(Math.abs(_)<1e-6)break;o-=g/_}var v=0,w=1;for(o=t,h=0;h<20&&(g=this.sampleCurveX(o),!(Math.abs(g-t)<r));h++)t>g?v=o:w=o,o=.5*(w-v)+v;return o},solve:function(t,r){return this.sampleCurveY(this.solveCurveX(t,r))}},at}(),Ai=it(yi);let Pn,cn;function pr(){return Pn==null&&(Pn=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Pn}function tn(){if(cn==null&&(cn=!1,pr())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let o=0;o<5*5;o++){const h=4*o;t.fillStyle=`rgb(${h},${h+1},${h+2})`,t.fillRect(o%5,Math.floor(o/5),1,1)}const r=t.getImageData(0,0,5,5).data;for(let o=0;o<5*5*4;o++)if(o%4!=3&&r[o]!==o){cn=!0;break}}}return cn||!1}var $t,Jt=1e-6,li=typeof Float32Array<"u"?Float32Array:Array;function gi(){var a=new li(9);return li!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function Dt(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function ai(){var a=new li(3);return li!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function Dn(a,t,r){var o=new li(3);return o[0]=a,o[1]=t,o[2]=r,o}function Kn(a,t,r){var o=t[0],h=t[1],g=t[2],_=t[3];return a[0]=r[0]*o+r[4]*h+r[8]*g+r[12]*_,a[1]=r[1]*o+r[5]*h+r[9]*g+r[13]*_,a[2]=r[2]*o+r[6]*h+r[10]*g+r[14]*_,a[3]=r[3]*o+r[7]*h+r[11]*g+r[15]*_,a}function un(){var a=new li(4);return li!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function ji(){var a=new li(2);return li!=Float32Array&&(a[0]=0,a[1]=0),a}function Fn(a,t){var r=new li(2);return r[0]=a,r[1]=t,r}Math.hypot||(Math.hypot=function(){for(var a=0,t=arguments.length;t--;)a+=arguments[t]*arguments[t];return Math.sqrt(a)}),ai(),$t=new li(4),li!=Float32Array&&($t[0]=0,$t[1]=0,$t[2]=0,$t[3]=0),ai(),Dn(1,0,0),Dn(0,1,0),un(),un(),gi(),ji();const Ke=8192;function Ot(a,t,r){return t*(Ke/(a.tileSize*Math.pow(2,r-a.tileID.overscaledZ)))}function zt(a,t){return(a%t+t)%t}function ci(a,t,r){return a*(1-r)+t*r}function fe(a){if(a<=0)return 0;if(a>=1)return 1;const t=a*a,r=t*a;return 4*(a<.5?r:3*(a-t)+r-.75)}function Je(a,t,r,o){const h=new Ai(a,t,r,o);return g=>h.solve(g)}const St=Je(.25,.1,.25,1);function xt(a,t,r){return Math.min(r,Math.max(t,a))}function ot(a,t,r){const o=r-t,h=((a-t)%o+o)%o+t;return h===t?r:h}function Rt(a,...t){for(const r of t)for(const o in r)a[o]=r[o];return a}let Ut=1;function hn(a,t,r){const o={};for(const h in a)o[h]=t.call(this,a[h],h,a);return o}function ei(a,t,r){const o={};for(const h in a)t.call(this,a[h],h,a)&&(o[h]=a[h]);return o}function ui(a){return Array.isArray(a)?a.map(ui):typeof a=="object"&&a?hn(a,ui):a}const vi={};function Di(a){vi[a]||(typeof console<"u"&&console.warn(a),vi[a]=!0)}function Hi(a,t,r){return(r.y-a.y)*(t.x-a.x)>(t.y-a.y)*(r.x-a.x)}function sr(a){return typeof WorkerGlobalScope<"u"&&a!==void 0&&a instanceof WorkerGlobalScope}let Fi=null;function Oa(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const ea="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Br(a,t,r,o,h){return d(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const g=new VideoFrame(a,{timestamp:0});try{const _=g==null?void 0:g.format;if(!_||!_.startsWith("BGR")&&!_.startsWith("RGB"))throw new Error(`Unrecognized format ${_}`);const v=_.startsWith("BGR"),w=new Uint8ClampedArray(o*h*4);if(yield g.copyTo(w,function(M,C,A,R,k){const j=4*Math.max(1,0),U=(Math.max(0,A)-A)*R*4+j,H=4*R,Q=Math.max(0,C),ue=Math.max(0,A);return{rect:{x:Q,y:ue,width:Math.min(M.width,C+R)-Q,height:Math.min(M.height,A+k)-ue},layout:[{offset:U,stride:H}]}}(a,t,r,o,h)),v)for(let M=0;M<w.length;M+=4){const C=w[M];w[M]=w[M+2],w[M+2]=C}return w}finally{g.close()}})}let va,ja;function ta(a,t,r,o){return a.addEventListener(t,r,o),{unsubscribe:()=>{a.removeEventListener(t,r,o)}}}function Or(a){return a/Math.PI*180}const Bo="AbortError";function to(){return new Error(Bo)}const or={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Oo(a){return or.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))]}const ws="global-dispatcher";class Fa extends Error{constructor(t,r,o,h){super(`AJAXError: ${r} (${t}): ${o}`),this.status=t,this.statusText=r,this.url=o,this.body=h}}const ia=()=>sr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ts=function(a,t){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){const o=Oo(a.url);if(o)return o(a,t);if(sr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,targetMapId:ws},t)}if(!(/^file:/.test(r=a.url)||/^file:/.test(ia())&&!/^\w+:/.test(r))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(o,h){return d(this,void 0,void 0,function*(){const g=new Request(o.url,{method:o.method||"GET",body:o.body,credentials:o.credentials,headers:o.headers,cache:o.cache,referrer:ia(),signal:h.signal});let _,v;o.type!=="json"||g.headers.has("Accept")||g.headers.set("Accept","application/json");try{_=yield fetch(g)}catch(M){throw new Fa(0,M.message,o.url,new Blob)}if(!_.ok){const M=yield _.blob();throw new Fa(_.status,_.statusText,o.url,M)}v=o.type==="arrayBuffer"||o.type==="image"?_.arrayBuffer():o.type==="json"?_.json():_.text();const w=yield v;if(h.signal.aborted)throw to();return{data:w,cacheControl:_.headers.get("Cache-Control"),expires:_.headers.get("Expires")}})}(a,t);if(sr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,mustQueue:!0,targetMapId:ws},t)}var r;return function(o,h){return new Promise((g,_)=>{var v;const w=new XMLHttpRequest;w.open(o.method||"GET",o.url,!0),o.type!=="arrayBuffer"&&o.type!=="image"||(w.responseType="arraybuffer");for(const M in o.headers)w.setRequestHeader(M,o.headers[M]);o.type==="json"&&(w.responseType="text",!((v=o.headers)===null||v===void 0)&&v.Accept||w.setRequestHeader("Accept","application/json")),w.withCredentials=o.credentials==="include",w.onerror=()=>{_(new Error(w.statusText))},w.onload=()=>{if(!h.signal.aborted)if((w.status>=200&&w.status<300||w.status===0)&&w.response!==null){let M=w.response;if(o.type==="json")try{M=JSON.parse(w.response)}catch(C){return void _(C)}g({data:M,cacheControl:w.getResponseHeader("Cache-Control"),expires:w.getResponseHeader("Expires")})}else{const M=new Blob([w.response],{type:w.getResponseHeader("Content-Type")});_(new Fa(w.status,w.statusText,o.url,M))}},h.signal.addEventListener("abort",()=>{w.abort(),_(to())}),w.send(o.body)})}(a,t)};function is(a){if(!a||a.indexOf("://")<=0||a.indexOf("data:image/")===0||a.indexOf("blob:")===0)return!0;const t=new URL(a),r=window.location;return t.protocol===r.protocol&&t.host===r.host}function Il(a,t,r){r[a]&&r[a].indexOf(t)!==-1||(r[a]=r[a]||[],r[a].push(t))}function jo(a,t,r){if(r&&r[a]){const o=r[a].indexOf(t);o!==-1&&r[a].splice(o,1)}}class ns{constructor(t,r={}){Rt(this,r),this.type=t}}class dn extends ns{constructor(t,r={}){super("error",Rt({error:t},r))}}class ye{on(t,r){return this._listeners=this._listeners||{},Il(t,r,this._listeners),{unsubscribe:()=>{this.off(t,r)}}}off(t,r){return jo(t,r,this._listeners),jo(t,r,this._oneTimeListeners),this}once(t,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},Il(t,r,this._oneTimeListeners),this):new Promise(o=>this.once(t,o))}fire(t,r){typeof t=="string"&&(t=new ns(t,r||{}));const o=t.type;if(this.listens(o)){t.target=this;const h=this._listeners&&this._listeners[o]?this._listeners[o].slice():[];for(const v of h)v.call(this,t);const g=this._oneTimeListeners&&this._oneTimeListeners[o]?this._oneTimeListeners[o].slice():[];for(const v of g)jo(o,v,this._oneTimeListeners),v.call(this,t);const _=this._eventedParent;_&&(Rt(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),_.fire(t))}else t instanceof dn&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,r){return this._eventedParent=t,this._eventedParentData=r,this}}var P={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const V=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function $(a,t){const r={};for(const o in a)o!=="ref"&&(r[o]=a[o]);return V.forEach(o=>{o in t&&(r[o]=t[o])}),r}function W(a,t){if(Array.isArray(a)){if(!Array.isArray(t)||a.length!==t.length)return!1;for(let r=0;r<a.length;r++)if(!W(a[r],t[r]))return!1;return!0}if(typeof a=="object"&&a!==null&&t!==null){if(typeof t!="object"||Object.keys(a).length!==Object.keys(t).length)return!1;for(const r in a)if(!W(a[r],t[r]))return!1;return!0}return a===t}function le(a,t){a.push(t)}function pe(a,t,r){le(r,{command:"addSource",args:[a,t[a]]})}function Se(a,t,r){le(t,{command:"removeSource",args:[a]}),r[a]=!0}function de(a,t,r,o){Se(a,r,o),pe(a,t,r)}function Re(a,t,r){let o;for(o in a[r])if(Object.prototype.hasOwnProperty.call(a[r],o)&&o!=="data"&&!W(a[r][o],t[r][o]))return!1;for(o in t[r])if(Object.prototype.hasOwnProperty.call(t[r],o)&&o!=="data"&&!W(a[r][o],t[r][o]))return!1;return!0}function ze(a,t,r,o,h,g){a=a||{},t=t||{};for(const _ in a)Object.prototype.hasOwnProperty.call(a,_)&&(W(a[_],t[_])||r.push({command:g,args:[o,_,t[_],h]}));for(const _ in t)Object.prototype.hasOwnProperty.call(t,_)&&!Object.prototype.hasOwnProperty.call(a,_)&&(W(a[_],t[_])||r.push({command:g,args:[o,_,t[_],h]}))}function ve(a){return a.id}function Ve(a,t){return a[t.id]=t,a}class xe{constructor(t,r,o,h){this.message=(t?`${t}: `:"")+o,h&&(this.identifier=h),r!=null&&r.__line__&&(this.line=r.__line__)}}function tt(a,...t){for(const r of t)for(const o in r)a[o]=r[o];return a}class pt extends Error{constructor(t,r){super(r),this.message=r,this.key=t}}class kt{constructor(t,r=[]){this.parent=t,this.bindings={};for(const[o,h]of r)this.bindings[o]=h}concat(t){return new kt(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const At={kind:"null"},je={kind:"number"},ht={kind:"string"},lt={kind:"boolean"},Zt={kind:"color"},bt={kind:"projectionDefinition"},Et={kind:"object"},ct={kind:"value"},na={kind:"collator"},nn={kind:"formatted"},In={kind:"padding"},zi={kind:"resolvedImage"},Rl={kind:"variableAnchorOffsetCollection"};function Nn(a,t){return{kind:"array",itemType:a,N:t}}function hi(a){if(a.kind==="array"){const t=hi(a.itemType);return typeof a.N=="number"?`array<${t}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${t}>`}return a.kind}const Ss=[At,je,ht,lt,Zt,bt,nn,Et,Nn(ct),In,zi,Rl];function Na(a,t){if(t.kind==="error")return null;if(a.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Na(a.itemType,t.itemType))&&(typeof a.N!="number"||a.N===t.N))return null}else{if(a.kind===t.kind)return null;if(a.kind==="value"){for(const r of Ss)if(!Na(r,t))return null}}return`Expected ${hi(a)} but found ${hi(t)} instead.`}function io(a,t){return t.some(r=>r.kind===a.kind)}function jr(a,t){return t.some(r=>r==="null"?a===null:r==="array"?Array.isArray(a):r==="object"?a&&!Array.isArray(a)&&typeof a=="object":r===typeof a)}function $i(a,t){return a.kind==="array"&&t.kind==="array"?a.itemType.kind===t.itemType.kind&&typeof a.N=="number":a.kind===t.kind}const Mc=.96422,Pu=.82521,Ms=4/29,xa=6/29,Ua=3*xa*xa,wd=xa*xa*xa,Eh=Math.PI/180,Ch=180/Math.PI;function Du(a){return(a%=360)<0&&(a+=360),a}function rs([a,t,r,o]){let h,g;const _=ba((.2225045*(a=Fo(a))+.7168786*(t=Fo(t))+.0606169*(r=Fo(r)))/1);a===t&&t===r?h=g=_:(h=ba((.4360747*a+.3850649*t+.1430804*r)/Mc),g=ba((.0139322*a+.0971045*t+.7141733*r)/Pu));const v=116*_-16;return[v<0?0:v,500*(h-_),200*(_-g),o]}function Fo(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function ba(a){return a>wd?Math.pow(a,1/3):a/Ua+Ms}function Qn([a,t,r,o]){let h=(a+16)/116,g=isNaN(t)?h:h+t/500,_=isNaN(r)?h:h-r/200;return h=1*Iu(h),g=Mc*Iu(g),_=Pu*Iu(_),[Ec(3.1338561*g-1.6168667*h-.4906146*_),Ec(-.9787684*g+1.9161415*h+.033454*_),Ec(.0719453*g-.2289914*h+1.4052427*_),o]}function Ec(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function Iu(a){return a>xa?a*a*a:Ua*(a-Ms)}function no(a){return parseInt(a.padEnd(2,a),16)/255}function Cc(a,t){return Va(t?a/100:a,0,1)}function Va(a,t,r){return Math.min(Math.max(t,a),r)}function wa(a){return!a.some(Number.isNaN)}const Ft={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function mr(a,t,r){return a+r*(t-a)}function Fr(a,t,r){return a.map((o,h)=>mr(o,t[h],r))}class Xt{constructor(t,r,o,h=1,g=!0){this.r=t,this.g=r,this.b=o,this.a=h,g||(this.r*=h,this.g*=h,this.b*=h,h||this.overwriteGetter("rgb",[t,r,o,h]))}static parse(t){if(t instanceof Xt)return t;if(typeof t!="string")return;const r=function(o){if((o=o.toLowerCase().trim())==="transparent")return[0,0,0,0];const h=Ft[o];if(h){const[_,v,w]=h;return[_/255,v/255,w/255,1]}if(o.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(o)){const _=o.length<6?1:2;let v=1;return[no(o.slice(v,v+=_)),no(o.slice(v,v+=_)),no(o.slice(v,v+=_)),no(o.slice(v,v+_)||"ff")]}if(o.startsWith("rgb")){const _=o.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[v,w,M,C,A,R,k,j,U,H,Q,ue]=_,te=[C||" ",k||" ",H].join("");if(te==="  "||te==="  /"||te===",,"||te===",,,"){const L=[M,R,U].join(""),G=L==="%%%"?100:L===""?255:0;if(G){const ie=[Va(+w/G,0,1),Va(+A/G,0,1),Va(+j/G,0,1),Q?Cc(+Q,ue):1];if(wa(ie))return ie}}return}}const g=o.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(g){const[_,v,w,M,C,A,R,k,j]=g,U=[w||" ",C||" ",R].join("");if(U==="  "||U==="  /"||U===",,"||U===",,,"){const H=[+v,Va(+M,0,100),Va(+A,0,100),k?Cc(+k,j):1];if(wa(H))return function([Q,ue,te,L]){function G(ie){const Te=(ie+Q/30)%12,qe=ue*Math.min(te,1-te);return te-qe*Math.max(-1,Math.min(Te-3,9-Te,1))}return Q=Du(Q),ue/=100,te/=100,[G(0),G(8),G(4),L]}(H)}}}(t);return r?new Xt(...r,!1):void 0}get rgb(){const{r:t,g:r,b:o,a:h}=this,g=h||1/0;return this.overwriteGetter("rgb",[t/g,r/g,o/g,h])}get hcl(){return this.overwriteGetter("hcl",function(t){const[r,o,h,g]=rs(t),_=Math.sqrt(o*o+h*h);return[Math.round(1e4*_)?Du(Math.atan2(h,o)*Ch):NaN,_,r,g]}(this.rgb))}get lab(){return this.overwriteGetter("lab",rs(this.rgb))}overwriteGetter(t,r){return Object.defineProperty(this,t,{value:r}),r}toString(){const[t,r,o,h]=this.rgb;return`rgba(${[t,r,o].map(g=>Math.round(255*g)).join(",")},${h})`}static interpolate(t,r,o,h="rgb"){switch(h){case"rgb":{const[g,_,v,w]=Fr(t.rgb,r.rgb,o);return new Xt(g,_,v,w,!1)}case"hcl":{const[g,_,v,w]=t.hcl,[M,C,A,R]=r.hcl;let k,j;if(isNaN(g)||isNaN(M))isNaN(g)?isNaN(M)?k=NaN:(k=M,v!==1&&v!==0||(j=C)):(k=g,A!==1&&A!==0||(j=_));else{let te=M-g;M>g&&te>180?te-=360:M<g&&g-M>180&&(te+=360),k=g+o*te}const[U,H,Q,ue]=function([te,L,G,ie]){return te=isNaN(te)?0:te*Eh,Qn([G,Math.cos(te)*L,Math.sin(te)*L,ie])}([k,j??mr(_,C,o),mr(v,A,o),mr(w,R,o)]);return new Xt(U,H,Q,ue,!1)}case"lab":{const[g,_,v,w]=Qn(Fr(t.lab,r.lab,o));return new Xt(g,_,v,w,!1)}}}}Xt.black=new Xt(0,0,0,1),Xt.white=new Xt(1,1,1,1),Xt.transparent=new Xt(0,0,0,0),Xt.red=new Xt(1,0,0,1);class as{constructor(t,r,o){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=o,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,r){return this.collator.compare(t,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Ac=["bottom","center","top"];class Nr{constructor(t,r,o,h,g,_){this.text=t,this.image=r,this.scale=o,this.fontStack=h,this.textColor=g,this.verticalAlign=_}}class rn{constructor(t){this.sections=t}static fromString(t){return new rn([new Nr(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof rn?t:rn.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class Un{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Un)return t;if(typeof t=="number")return new Un([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const r of t)if(typeof r!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new Un(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,o){return new Un(Fr(t.values,r.values,o))}}class Ni{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const zc=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class bn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof bn)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let r=0;r<t.length;r+=2){const o=t[r],h=t[r+1];if(typeof o!="string"||!zc.has(o)||!Array.isArray(h)||h.length!==2||typeof h[0]!="number"||typeof h[1]!="number")return}return new bn(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,o){const h=t.values,g=r.values;if(h.length!==g.length)throw new Ni(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${r.toString()}`);const _=[];for(let v=0;v<h.length;v+=2){if(h[v]!==g[v])throw new Ni(`Cannot interpolate values containing mismatched anchors. from[${v}]: ${h[v]}, to[${v}]: ${g[v]}`);_.push(h[v]);const[w,M]=h[v+1],[C,A]=g[v+1];_.push([mr(w,C,o),mr(M,A,o)])}return new bn(_)}}class gr{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new gr({name:t,available:!1}):null}}class Mr{constructor(t,r,o){this.from=t,this.to=r,this.transition=o}static interpolate(t,r,o){return new Mr(t,r,o)}static parse(t){return t instanceof Mr?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new Mr(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new Mr(t.from,t.to,t.transition):typeof t=="string"?new Mr(t,t,1):void 0}}function ro(a,t,r,o){return typeof a=="number"&&a>=0&&a<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?o===void 0||typeof o=="number"&&o>=0&&o<=1?null:`Invalid rgba value [${[a,t,r,o].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof o=="number"?[a,t,r,o]:[a,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ur(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof Mr||a instanceof Xt||a instanceof as||a instanceof rn||a instanceof Un||a instanceof bn||a instanceof gr)return!0;if(Array.isArray(a)){for(const t of a)if(!Ur(t))return!1;return!0}if(typeof a=="object"){for(const t in a)if(!Ur(a[t]))return!1;return!0}return!1}function an(a){if(a===null)return At;if(typeof a=="string")return ht;if(typeof a=="boolean")return lt;if(typeof a=="number")return je;if(a instanceof Xt)return Zt;if(a instanceof Mr)return bt;if(a instanceof as)return na;if(a instanceof rn)return nn;if(a instanceof Un)return In;if(a instanceof bn)return Rl;if(a instanceof gr)return zi;if(Array.isArray(a)){const t=a.length;let r;for(const o of a){const h=an(o);if(r){if(r===h)continue;r=ct;break}r=h}return Nn(r||ct,t)}return Et}function Vr(a){const t=typeof a;return a===null?"":t==="string"||t==="number"||t==="boolean"?String(a):a instanceof Xt||a instanceof Mr||a instanceof rn||a instanceof Un||a instanceof bn||a instanceof gr?a.toString():JSON.stringify(a)}class Wn{constructor(t,r){this.type=t,this.value=r}static parse(t,r){if(t.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Ur(t[1]))return r.error("invalid value");const o=t[1];let h=an(o);const g=r.expectedType;return h.kind!=="array"||h.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(h=g),new Wn(h,o)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const No={string:ht,number:je,boolean:lt,object:Et};class Er{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let o,h=1;const g=t[0];if(g==="array"){let v,w;if(t.length>2){const M=t[1];if(typeof M!="string"||!(M in No)||M==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);v=No[M],h++}else v=ct;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return r.error('The length argument to "array" must be a positive integer literal',2);w=t[2],h++}o=Nn(v,w)}else{if(!No[g])throw new Error(`Types doesn't contain name = ${g}`);o=No[g]}const _=[];for(;h<t.length;h++){const v=r.parse(t[h],h,ct);if(!v)return null;_.push(v)}return new Er(o,_)}evaluate(t){for(let r=0;r<this.args.length;r++){const o=this.args[r].evaluate(t);if(!Na(this.type,an(o)))return o;if(r===this.args.length-1)throw new Ni(`Expected value to be of type ${hi(this.type)}, but found ${hi(an(o))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Pc={"to-boolean":lt,"to-color":Zt,"to-number":je,"to-string":ht};class _r{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const o=t[0];if(!Pc[o])throw new Error(`Can't parse ${o} as it is not part of the known types`);if((o==="to-boolean"||o==="to-string")&&t.length!==2)return r.error("Expected one argument.");const h=Pc[o],g=[];for(let _=1;_<t.length;_++){const v=r.parse(t[_],_,ct);if(!v)return null;g.push(v)}return new _r(h,g)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let r,o;for(const h of this.args){if(r=h.evaluate(t),o=null,r instanceof Xt)return r;if(typeof r=="string"){const g=t.parseColor(r);if(g)return g}else if(Array.isArray(r)&&(o=r.length<3||r.length>4?`Invalid rgba value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:ro(r[0],r[1],r[2],r[3]),!o))return new Xt(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new Ni(o||`Could not parse color from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"padding":{let r;for(const o of this.args){r=o.evaluate(t);const h=Un.parse(r);if(h)return h}throw new Ni(`Could not parse padding from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"variableAnchorOffsetCollection":{let r;for(const o of this.args){r=o.evaluate(t);const h=bn.parse(r);if(h)return h}throw new Ni(`Could not parse variableAnchorOffsetCollection from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"number":{let r=null;for(const o of this.args){if(r=o.evaluate(t),r===null)return 0;const h=Number(r);if(!isNaN(h))return h}throw new Ni(`Could not convert ${JSON.stringify(r)} to number.`)}case"formatted":return rn.fromString(Vr(this.args[0].evaluate(t)));case"resolvedImage":return gr.fromString(Vr(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return Vr(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Ti=["Unknown","Point","LineString","Polygon"];class Es{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ti[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let r=this._parseColorCache[t];return r||(r=this._parseColorCache[t]=Xt.parse(t)),r}}class Vt{constructor(t,r,o=[],h,g=new kt,_=[]){this.registry=t,this.path=o,this.key=o.map(v=>`[${v}]`).join(""),this.scope=g,this.errors=_,this.expectedType=h,this._isConstant=r}parse(t,r,o,h,g={}){return r?this.concat(r,o,h)._parse(t,g):this._parse(t,g)}_parse(t,r){function o(h,g,_){return _==="assert"?new Er(g,[h]):_==="coerce"?new _r(g,[h]):h}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=t[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const g=this.registry[h];if(g){let _=g.parse(t,this);if(!_)return null;if(this.expectedType){const v=this.expectedType,w=_.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||w.kind!=="value")if(v.kind!=="projectionDefinition"||w.kind!=="string"&&w.kind!=="array")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||w.kind!=="value"&&w.kind!=="string")if(v.kind!=="padding"||w.kind!=="value"&&w.kind!=="number"&&w.kind!=="array")if(v.kind!=="variableAnchorOffsetCollection"||w.kind!=="value"&&w.kind!=="array"){if(this.checkSubtype(v,w))return null}else _=o(_,v,r.typeAnnotation||"coerce");else _=o(_,v,r.typeAnnotation||"coerce");else _=o(_,v,r.typeAnnotation||"coerce");else _=o(_,v,r.typeAnnotation||"coerce");else _=o(_,v,r.typeAnnotation||"assert")}if(!(_ instanceof Wn)&&_.type.kind!=="resolvedImage"&&this._isConstant(_)){const v=new Es;try{_=new Wn(_.type,_.evaluate(v))}catch(w){return this.error(w.message),null}}return _}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,r,o){const h=typeof t=="number"?this.path.concat(t):this.path,g=o?this.scope.concat(o):this.scope;return new Vt(this.registry,this._isConstant,h,r||null,g,this.errors)}error(t,...r){const o=`${this.key}${r.map(h=>`[${h}]`).join("")}`;this.errors.push(new pt(o,t))}checkSubtype(t,r){const o=Na(t,r);return o&&this.error(o),o}}class jt{constructor(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const r of this.bindings)t(r[1]);t(this.result)}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const o=[];for(let g=1;g<t.length-1;g+=2){const _=t[g];if(typeof _!="string")return r.error(`Expected string, but found ${typeof _} instead.`,g);if(/[^a-zA-Z0-9_]/.test(_))return r.error("Variable names must contain only alphanumeric characters or '_'.",g);const v=r.parse(t[g+1],g+1);if(!v)return null;o.push([_,v])}const h=r.parse(t[t.length-1],t.length-1,r.expectedType,o);return h?new jt(o,h):null}outputDefined(){return this.result.outputDefined()}}class ss{constructor(t,r){this.type=r.type,this.name=t,this.boundExpression=r}static parse(t,r){if(t.length!==2||typeof t[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const o=t[1];return r.scope.has(o)?new ss(o,r.scope.get(o)):r.error(`Unknown variable "${o}". Make sure "${o}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Yt{constructor(t,r,o){this.type=t,this.index=r,this.input=o}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const o=r.parse(t[1],1,je),h=r.parse(t[2],2,Nn(r.expectedType||ct));return o&&h?new Yt(h.type.itemType,o,h):null}evaluate(t){const r=this.index.evaluate(t),o=this.input.evaluate(t);if(r<0)throw new Ni(`Array index out of bounds: ${r} < 0.`);if(r>=o.length)throw new Ni(`Array index out of bounds: ${r} > ${o.length-1}.`);if(r!==Math.floor(r))throw new Ni(`Array index must be an integer, but found ${r} instead.`);return o[r]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Cs{constructor(t,r){this.type=lt,this.needle=t,this.haystack=r}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const o=r.parse(t[1],1,ct),h=r.parse(t[2],2,ct);return o&&h?io(o.type,[lt,ht,je,At,ct])?new Cs(o,h):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${hi(o.type)} instead`):null}evaluate(t){const r=this.needle.evaluate(t),o=this.haystack.evaluate(t);if(!o)return!1;if(!jr(r,["boolean","string","number","null"]))throw new Ni(`Expected first argument to be of type boolean, string, number or null, but found ${hi(an(r))} instead.`);if(!jr(o,["string","array"]))throw new Ni(`Expected second argument to be of type array or string, but found ${hi(an(o))} instead.`);return o.indexOf(r)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class yr{constructor(t,r,o){this.type=je,this.needle=t,this.haystack=r,this.fromIndex=o}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const o=r.parse(t[1],1,ct),h=r.parse(t[2],2,ct);if(!o||!h)return null;if(!io(o.type,[lt,ht,je,At,ct]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${hi(o.type)} instead`);if(t.length===4){const g=r.parse(t[3],3,je);return g?new yr(o,h,g):null}return new yr(o,h)}evaluate(t){const r=this.needle.evaluate(t),o=this.haystack.evaluate(t);if(!jr(r,["boolean","string","number","null"]))throw new Ni(`Expected first argument to be of type boolean, string, number or null, but found ${hi(an(r))} instead.`);let h;if(this.fromIndex&&(h=this.fromIndex.evaluate(t)),jr(o,["string"])){const g=o.indexOf(r,h);return g===-1?-1:[...o.slice(0,g)].length}if(jr(o,["array"]))return o.indexOf(r,h);throw new Ni(`Expected second argument to be of type array or string, but found ${hi(an(o))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Uo{constructor(t,r,o,h,g,_){this.inputType=t,this.type=r,this.input=o,this.cases=h,this.outputs=g,this.otherwise=_}static parse(t,r){if(t.length<5)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return r.error("Expected an even number of arguments.");let o,h;r.expectedType&&r.expectedType.kind!=="value"&&(h=r.expectedType);const g={},_=[];for(let M=2;M<t.length-1;M+=2){let C=t[M];const A=t[M+1];Array.isArray(C)||(C=[C]);const R=r.concat(M);if(C.length===0)return R.error("Expected at least one branch label.");for(const j of C){if(typeof j!="number"&&typeof j!="string")return R.error("Branch labels must be numbers or strings.");if(typeof j=="number"&&Math.abs(j)>Number.MAX_SAFE_INTEGER)return R.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof j=="number"&&Math.floor(j)!==j)return R.error("Numeric branch labels must be integer values.");if(o){if(R.checkSubtype(o,an(j)))return null}else o=an(j);if(g[String(j)]!==void 0)return R.error("Branch labels must be unique.");g[String(j)]=_.length}const k=r.parse(A,M,h);if(!k)return null;h=h||k.type,_.push(k)}const v=r.parse(t[1],1,ct);if(!v)return null;const w=r.parse(t[t.length-1],t.length-1,h);return w?v.type.kind!=="value"&&r.concat(1).checkSubtype(o,v.type)?null:new Uo(o,h,v,g,_,w):null}evaluate(t){const r=this.input.evaluate(t);return(an(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class Jn{constructor(t,r,o){this.type=t,this.branches=r,this.otherwise=o}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return r.error("Expected an odd number of arguments.");let o;r.expectedType&&r.expectedType.kind!=="value"&&(o=r.expectedType);const h=[];for(let _=1;_<t.length-1;_+=2){const v=r.parse(t[_],_,lt);if(!v)return null;const w=r.parse(t[_+1],_+1,o);if(!w)return null;h.push([v,w]),o=o||w.type}const g=r.parse(t[t.length-1],t.length-1,o);if(!g)return null;if(!o)throw new Error("Can't infer output type");return new Jn(o,h,g)}evaluate(t){for(const[r,o]of this.branches)if(r.evaluate(t))return o.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[r,o]of this.branches)t(r),t(o);t(this.otherwise)}outputDefined(){return this.branches.every(([t,r])=>r.outputDefined())&&this.otherwise.outputDefined()}}class Ta{constructor(t,r,o,h){this.type=t,this.input=r,this.beginIndex=o,this.endIndex=h}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const o=r.parse(t[1],1,ct),h=r.parse(t[2],2,je);if(!o||!h)return null;if(!io(o.type,[Nn(ct),ht,ct]))return r.error(`Expected first argument to be of type array or string, but found ${hi(o.type)} instead`);if(t.length===4){const g=r.parse(t[3],3,je);return g?new Ta(o.type,o,h,g):null}return new Ta(o.type,o,h)}evaluate(t){const r=this.input.evaluate(t),o=this.beginIndex.evaluate(t);let h;if(this.endIndex&&(h=this.endIndex.evaluate(t)),jr(r,["string"]))return[...r].slice(o,h).join("");if(jr(r,["array"]))return r.slice(o,h);throw new Ni(`Expected first argument to be of type array or string, but found ${hi(an(r))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function os(a,t){const r=a.length-1;let o,h,g=0,_=r,v=0;for(;g<=_;)if(v=Math.floor((g+_)/2),o=a[v],h=a[v+1],o<=t){if(v===r||t<h)return v;g=v+1}else{if(!(o>t))throw new Ni("Input is not a number.");_=v-1}return 0}class Za{constructor(t,r,o){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(const[h,g]of o)this.labels.push(h),this.outputs.push(g)}static parse(t,r){if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");const o=r.parse(t[1],1,je);if(!o)return null;const h=[];let g=null;r.expectedType&&r.expectedType.kind!=="value"&&(g=r.expectedType);for(let _=1;_<t.length;_+=2){const v=_===1?-1/0:t[_],w=t[_+1],M=_,C=_+1;if(typeof v!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(h.length&&h[h.length-1][0]>=v)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const A=r.parse(w,C,g);if(!A)return null;g=g||A.type,h.push([v,A])}return new Za(g,o,h)}evaluate(t){const r=this.labels,o=this.outputs;if(r.length===1)return o[0].evaluate(t);const h=this.input.evaluate(t);if(h<=r[0])return o[0].evaluate(t);const g=r.length;return h>=r[g-1]?o[g-1].evaluate(t):o[os(r,h)].evaluate(t)}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Td(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Vo,kl,ls=function(){if(kl)return Vo;function a(t,r,o,h){this.cx=3*t,this.bx=3*(o-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(h-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=o,this.p2y=h}return kl=1,Vo=a,a.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,r){if(r===void 0&&(r=1e-6),t<0)return 0;if(t>1)return 1;for(var o=t,h=0;h<8;h++){var g=this.sampleCurveX(o)-t;if(Math.abs(g)<r)return o;var _=this.sampleCurveDerivativeX(o);if(Math.abs(_)<1e-6)break;o-=g/_}var v=0,w=1;for(o=t,h=0;h<20&&(g=this.sampleCurveX(o),!(Math.abs(g-t)<r));h++)t>g?v=o:w=o,o=.5*(w-v)+v;return o},solve:function(t,r){return this.sampleCurveY(this.solveCurveX(t,r))}},Vo}(),Rn=Td(ls);class er{constructor(t,r,o,h,g){this.type=t,this.operator=r,this.interpolation=o,this.input=h,this.labels=[],this.outputs=[];for(const[_,v]of g)this.labels.push(_),this.outputs.push(v)}static interpolationFactor(t,r,o,h){let g=0;if(t.name==="exponential")g=Dc(r,t.base,o,h);else if(t.name==="linear")g=Dc(r,1,o,h);else if(t.name==="cubic-bezier"){const _=t.controlPoints;g=new Rn(_[0],_[1],_[2],_[3]).solve(Dc(r,1,o,h))}return g}static parse(t,r){let[o,h,g,..._]=t;if(!Array.isArray(h)||h.length===0)return r.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const M=h[1];if(typeof M!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:M}}else{if(h[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const M=h.slice(1);if(M.length!==4||M.some(C=>typeof C!="number"||C<0||C>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:M}}}if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(g=r.parse(g,2,je),!g)return null;const v=[];let w=null;o==="interpolate-hcl"||o==="interpolate-lab"?w=Zt:r.expectedType&&r.expectedType.kind!=="value"&&(w=r.expectedType);for(let M=0;M<_.length;M+=2){const C=_[M],A=_[M+1],R=M+3,k=M+4;if(typeof C!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(v.length&&v[v.length-1][0]>=C)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',R);const j=r.parse(A,k,w);if(!j)return null;w=w||j.type,v.push([C,j])}return $i(w,je)||$i(w,bt)||$i(w,Zt)||$i(w,In)||$i(w,Rl)||$i(w,Nn(je))?new er(w,o,h,g,v):r.error(`Type ${hi(w)} is not interpolatable.`)}evaluate(t){const r=this.labels,o=this.outputs;if(r.length===1)return o[0].evaluate(t);const h=this.input.evaluate(t);if(h<=r[0])return o[0].evaluate(t);const g=r.length;if(h>=r[g-1])return o[g-1].evaluate(t);const _=os(r,h),v=er.interpolationFactor(this.interpolation,h,r[_],r[_+1]),w=o[_].evaluate(t),M=o[_+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return mr(w,M,v);case"color":return Xt.interpolate(w,M,v);case"padding":return Un.interpolate(w,M,v);case"variableAnchorOffsetCollection":return bn.interpolate(w,M,v);case"array":return Fr(w,M,v);case"projectionDefinition":return Mr.interpolate(w,M,v)}case"interpolate-hcl":return Xt.interpolate(w,M,v,"hcl");case"interpolate-lab":return Xt.interpolate(w,M,v,"lab")}}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Dc(a,t,r,o){const h=o-r,g=a-r;return h===0?0:t===1?g/h:(Math.pow(t,g)-1)/(Math.pow(t,h)-1)}const Zr={color:Xt.interpolate,number:mr,padding:Un.interpolate,variableAnchorOffsetCollection:bn.interpolate,array:Fr};class fn{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let o=null;const h=r.expectedType;h&&h.kind!=="value"&&(o=h);const g=[];for(const v of t.slice(1)){const w=r.parse(v,1+g.length,o,void 0,{typeAnnotation:"omit"});if(!w)return null;o=o||w.type,g.push(w)}if(!o)throw new Error("No output type");const _=h&&g.some(v=>Na(h,v.type));return new fn(_?ct:o,g)}evaluate(t){let r,o=null,h=0;for(const g of this.args)if(h++,o=g.evaluate(t),o&&o instanceof gr&&!o.available&&(r||(r=o.name),o=null,h===this.args.length&&(o=r)),o!==null)break;return o}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function Ll(a,t){return a==="=="||a==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Ic(a,t,r,o){return o.compare(t,r)===0}function ao(a,t,r){const o=a!=="=="&&a!=="!=";return class Qp{constructor(g,_,v){this.type=lt,this.lhs=g,this.rhs=_,this.collator=v,this.hasUntypedArgument=g.type.kind==="value"||_.type.kind==="value"}static parse(g,_){if(g.length!==3&&g.length!==4)return _.error("Expected two or three arguments.");const v=g[0];let w=_.parse(g[1],1,ct);if(!w)return null;if(!Ll(v,w.type))return _.concat(1).error(`"${v}" comparisons are not supported for type '${hi(w.type)}'.`);let M=_.parse(g[2],2,ct);if(!M)return null;if(!Ll(v,M.type))return _.concat(2).error(`"${v}" comparisons are not supported for type '${hi(M.type)}'.`);if(w.type.kind!==M.type.kind&&w.type.kind!=="value"&&M.type.kind!=="value")return _.error(`Cannot compare types '${hi(w.type)}' and '${hi(M.type)}'.`);o&&(w.type.kind==="value"&&M.type.kind!=="value"?w=new Er(M.type,[w]):w.type.kind!=="value"&&M.type.kind==="value"&&(M=new Er(w.type,[M])));let C=null;if(g.length===4){if(w.type.kind!=="string"&&M.type.kind!=="string"&&w.type.kind!=="value"&&M.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(C=_.parse(g[3],3,na),!C)return null}return new Qp(w,M,C)}evaluate(g){const _=this.lhs.evaluate(g),v=this.rhs.evaluate(g);if(o&&this.hasUntypedArgument){const w=an(_),M=an(v);if(w.kind!==M.kind||w.kind!=="string"&&w.kind!=="number")throw new Ni(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${w.kind}, ${M.kind}) instead.`)}if(this.collator&&!o&&this.hasUntypedArgument){const w=an(_),M=an(v);if(w.kind!=="string"||M.kind!=="string")return t(g,_,v)}return this.collator?r(g,_,v,this.collator.evaluate(g)):t(g,_,v)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}}}const Sd=ao("==",function(a,t,r){return t===r},Ic),Rc=ao("!=",function(a,t,r){return t!==r},function(a,t,r,o){return!Ic(0,t,r,o)}),Ru=ao("<",function(a,t,r){return t<r},function(a,t,r,o){return o.compare(t,r)<0}),Ah=ao(">",function(a,t,r){return t>r},function(a,t,r,o){return o.compare(t,r)>0}),kc=ao("<=",function(a,t,r){return t<=r},function(a,t,r,o){return o.compare(t,r)<=0}),Lc=ao(">=",function(a,t,r){return t>=r},function(a,t,r,o){return o.compare(t,r)>=0});class Cr{constructor(t,r,o){this.type=na,this.locale=o,this.caseSensitive=t,this.diacriticSensitive=r}static parse(t,r){if(t.length!==2)return r.error("Expected one argument.");const o=t[1];if(typeof o!="object"||Array.isArray(o))return r.error("Collator options argument must be an object.");const h=r.parse(o["case-sensitive"]!==void 0&&o["case-sensitive"],1,lt);if(!h)return null;const g=r.parse(o["diacritic-sensitive"]!==void 0&&o["diacritic-sensitive"],1,lt);if(!g)return null;let _=null;return o.locale&&(_=r.parse(o.locale,1,ht),!_)?null:new Cr(h,g,_)}evaluate(t){return new as(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Bc{constructor(t,r,o,h,g){this.type=ht,this.number=t,this.locale=r,this.currency=o,this.minFractionDigits=h,this.maxFractionDigits=g}static parse(t,r){if(t.length!==3)return r.error("Expected two arguments.");const o=r.parse(t[1],1,je);if(!o)return null;const h=t[2];if(typeof h!="object"||Array.isArray(h))return r.error("NumberFormat options argument must be an object.");let g=null;if(h.locale&&(g=r.parse(h.locale,1,ht),!g))return null;let _=null;if(h.currency&&(_=r.parse(h.currency,1,ht),!_))return null;let v=null;if(h["min-fraction-digits"]&&(v=r.parse(h["min-fraction-digits"],1,je),!v))return null;let w=null;return h["max-fraction-digits"]&&(w=r.parse(h["max-fraction-digits"],1,je),!w)?null:new Bc(o,g,_,v,w)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class cs{constructor(t){this.type=nn,this.sections=t}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const o=t[1];if(!Array.isArray(o)&&typeof o=="object")return r.error("First argument must be an image or text section.");const h=[];let g=!1;for(let _=1;_<=t.length-1;++_){const v=t[_];if(g&&typeof v=="object"&&!Array.isArray(v)){g=!1;let w=null;if(v["font-scale"]&&(w=r.parse(v["font-scale"],1,je),!w))return null;let M=null;if(v["text-font"]&&(M=r.parse(v["text-font"],1,Nn(ht)),!M))return null;let C=null;if(v["text-color"]&&(C=r.parse(v["text-color"],1,Zt),!C))return null;let A=null;if(v["vertical-align"]){if(typeof v["vertical-align"]=="string"&&!Ac.includes(v["vertical-align"]))return r.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${v["vertical-align"]}' instead.`);if(A=r.parse(v["vertical-align"],1,ht),!A)return null}const R=h[h.length-1];R.scale=w,R.font=M,R.textColor=C,R.verticalAlign=A}else{const w=r.parse(t[_],1,ct);if(!w)return null;const M=w.type.kind;if(M!=="string"&&M!=="value"&&M!=="null"&&M!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,h.push({content:w,scale:null,font:null,textColor:null,verticalAlign:null})}}return new cs(h)}evaluate(t){return new rn(this.sections.map(r=>{const o=r.content.evaluate(t);return an(o)===zi?new Nr("",o,null,null,null,r.verticalAlign?r.verticalAlign.evaluate(t):null):new Nr(Vr(o),null,r.scale?r.scale.evaluate(t):null,r.font?r.font.evaluate(t).join(","):null,r.textColor?r.textColor.evaluate(t):null,r.verticalAlign?r.verticalAlign.evaluate(t):null)}))}eachChild(t){for(const r of this.sections)t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor),r.verticalAlign&&t(r.verticalAlign)}outputDefined(){return!1}}class ku{constructor(t){this.type=zi,this.input=t}static parse(t,r){if(t.length!==2)return r.error("Expected two arguments.");const o=r.parse(t[1],1,ht);return o?new ku(o):r.error("No image name provided.")}evaluate(t){const r=this.input.evaluate(t),o=gr.fromString(r);return o&&t.availableImages&&(o.available=t.availableImages.indexOf(r)>-1),o}eachChild(t){t(this.input)}outputDefined(){return!1}}class Bl{constructor(t){this.type=je,this.input=t}static parse(t,r){if(t.length!==2)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);const o=r.parse(t[1],1);return o?o.type.kind!=="array"&&o.type.kind!=="string"&&o.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${hi(o.type)} instead.`):new Bl(o):null}evaluate(t){const r=this.input.evaluate(t);if(typeof r=="string")return[...r].length;if(Array.isArray(r))return r.length;throw new Ni(`Expected value to be of type string or array, but found ${hi(an(r))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Ga=8192;function zh(a,t){const r=(180+a[0])/360,o=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,h=Math.pow(2,t.z);return[Math.round(r*h*Ga),Math.round(o*h*Ga)]}function Lu(a,t){const r=Math.pow(2,t.z);return[(h=(a[0]/Ga+t.x)/r,360*h-180),(o=(a[1]/Ga+t.y)/r,360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90)];var o,h}function Ol(a,t){a[0]=Math.min(a[0],t[0]),a[1]=Math.min(a[1],t[1]),a[2]=Math.max(a[2],t[0]),a[3]=Math.max(a[3],t[1])}function As(a,t){return!(a[0]<=t[0]||a[2]>=t[2]||a[1]<=t[1]||a[3]>=t[3])}function Md(a,t,r){const o=a[0]-t[0],h=a[1]-t[1],g=a[0]-r[0],_=a[1]-r[1];return o*_-g*h==0&&o*g<=0&&h*_<=0}function jl(a,t,r,o){return(h=[o[0]-r[0],o[1]-r[1]])[0]*(g=[t[0]-a[0],t[1]-a[1]])[1]-h[1]*g[0]!=0&&!(!Go(a,t,r,o)||!Go(r,o,a,t));var h,g}function Ph(a,t,r){for(const o of r)for(let h=0;h<o.length-1;++h)if(jl(a,t,o[h],o[h+1]))return!0;return!1}function Zo(a,t,r=!1){let o=!1;for(const v of t)for(let w=0;w<v.length-1;w++){if(Md(a,v[w],v[w+1]))return r;(g=v[w])[1]>(h=a)[1]!=(_=v[w+1])[1]>h[1]&&h[0]<(_[0]-g[0])*(h[1]-g[1])/(_[1]-g[1])+g[0]&&(o=!o)}var h,g,_;return o}function Dh(a,t){for(const r of t)if(Zo(a,r))return!0;return!1}function Ih(a,t){for(const r of a)if(!Zo(r,t))return!1;for(let r=0;r<a.length-1;++r)if(Ph(a[r],a[r+1],t))return!1;return!0}function Bu(a,t){for(const r of t)if(Ih(a,r))return!0;return!1}function Go(a,t,r,o){const h=o[0]-r[0],g=o[1]-r[1],_=(a[0]-r[0])*g-h*(a[1]-r[1]),v=(t[0]-r[0])*g-h*(t[1]-r[1]);return _>0&&v<0||_<0&&v>0}function Ou(a,t,r){const o=[];for(let h=0;h<a.length;h++){const g=[];for(let _=0;_<a[h].length;_++){const v=zh(a[h][_],r);Ol(t,v),g.push(v)}o.push(g)}return o}function ju(a,t,r){const o=[];for(let h=0;h<a.length;h++){const g=Ou(a[h],t,r);o.push(g)}return o}function Oc(a,t,r,o){if(a[0]<r[0]||a[0]>r[2]){const h=.5*o;let g=a[0]-r[0]>h?-o:r[0]-a[0]>h?o:0;g===0&&(g=a[0]-r[2]>h?-o:r[2]-a[0]>h?o:0),a[0]+=g}Ol(t,a)}function jc(a,t,r,o){const h=Math.pow(2,o.z)*Ga,g=[o.x*Ga,o.y*Ga],_=[];for(const v of a)for(const w of v){const M=[w.x+g[0],w.y+g[1]];Oc(M,t,r,h),_.push(M)}return _}function Fc(a,t,r,o){const h=Math.pow(2,o.z)*Ga,g=[o.x*Ga,o.y*Ga],_=[];for(const w of a){const M=[];for(const C of w){const A=[C.x+g[0],C.y+g[1]];Ol(t,A),M.push(A)}_.push(M)}if(t[2]-t[0]<=h/2){(v=t)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const w of _)for(const M of w)Oc(M,t,r,h)}var v;return _}class zs{constructor(t,r){this.type=lt,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ur(t[1])){const o=t[1];if(o.type==="FeatureCollection"){const h=[];for(const g of o.features){const{type:_,coordinates:v}=g.geometry;_==="Polygon"&&h.push(v),_==="MultiPolygon"&&h.push(...v)}if(h.length)return new zs(o,{type:"MultiPolygon",coordinates:h})}else if(o.type==="Feature"){const h=o.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new zs(o,o.geometry)}else if(o.type==="Polygon"||o.type==="MultiPolygon")return new zs(o,o)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(r,o){const h=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],_=r.canonicalID();if(o.type==="Polygon"){const v=Ou(o.coordinates,g,_),w=jc(r.geometry(),h,g,_);if(!As(h,g))return!1;for(const M of w)if(!Zo(M,v))return!1}if(o.type==="MultiPolygon"){const v=ju(o.coordinates,g,_),w=jc(r.geometry(),h,g,_);if(!As(h,g))return!1;for(const M of w)if(!Dh(M,v))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(r,o){const h=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],_=r.canonicalID();if(o.type==="Polygon"){const v=Ou(o.coordinates,g,_),w=Fc(r.geometry(),h,g,_);if(!As(h,g))return!1;for(const M of w)if(!Ih(M,v))return!1}if(o.type==="MultiPolygon"){const v=ju(o.coordinates,g,_),w=Fc(r.geometry(),h,g,_);if(!As(h,g))return!1;for(const M of w)if(!Bu(M,v))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let so=class{constructor(a=[],t=(r,o)=>r<o?-1:r>o?1:0){if(this.data=a,this.length=this.data.length,this.compare=t,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(this.length===0)return;const a=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:t,compare:r}=this,o=t[a];for(;a>0;){const h=a-1>>1,g=t[h];if(r(o,g)>=0)break;t[a]=g,a=h}t[a]=o}_down(a){const{data:t,compare:r}=this,o=this.length>>1,h=t[a];for(;a<o;){let g=1+(a<<1);const _=g+1;if(_<this.length&&r(t[_],t[g])<0&&(g=_),r(t[g],h)>=0)break;t[a]=t[g],a=g}t[a]=h}};function Rh(a,t,r=0,o=a.length-1,h=Ed){for(;o>r;){if(o-r>600){const w=o-r+1,M=t-r+1,C=Math.log(w),A=.5*Math.exp(2*C/3),R=.5*Math.sqrt(C*A*(w-A)/w)*(M-w/2<0?-1:1);Rh(a,t,Math.max(r,Math.floor(t-M*A/w+R)),Math.min(o,Math.floor(t+(w-M)*A/w+R)),h)}const g=a[t];let _=r,v=o;for(oo(a,r,t),h(a[o],g)>0&&oo(a,r,o);_<v;){for(oo(a,_,v),_++,v--;h(a[_],g)<0;)_++;for(;h(a[v],g)>0;)v--}h(a[r],g)===0?oo(a,r,v):(v++,oo(a,v,o)),v<=t&&(r=v+1),t<=v&&(o=v-1)}}function oo(a,t,r){const o=a[t];a[t]=a[r],a[r]=o}function Ed(a,t){return a<t?-1:a>t?1:0}function Fl(a,t){if(a.length<=1)return[a];const r=[];let o,h;for(const g of a){const _=qo(g);_!==0&&(g.area=Math.abs(_),h===void 0&&(h=_<0),h===_<0?(o&&r.push(o),o=[g]):o.push(g))}if(o&&r.push(o),t>1)for(let g=0;g<r.length;g++)r[g].length<=t||(Rh(r[g],t,1,r[g].length-1,kh),r[g]=r[g].slice(0,t));return r}function kh(a,t){return t.area-a.area}function qo(a){let t=0;for(let r,o,h=0,g=a.length,_=g-1;h<g;_=h++)r=a[h],o=a[_],t+=(o.x-r.x)*(r.y+o.y);return t}const lo=1/298.257223563,Lh=lo*(2-lo),Nl=Math.PI/180;class Ul{constructor(t){const r=6378.137*Nl*1e3,o=Math.cos(t*Nl),h=1/(1-Lh*(1-o*o)),g=Math.sqrt(h);this.kx=r*g*o,this.ky=r*g*h*(1-Lh)}distance(t,r){const o=this.wrap(t[0]-r[0])*this.kx,h=(t[1]-r[1])*this.ky;return Math.sqrt(o*o+h*h)}pointOnLine(t,r){let o,h,g,_,v=1/0;for(let w=0;w<t.length-1;w++){let M=t[w][0],C=t[w][1],A=this.wrap(t[w+1][0]-M)*this.kx,R=(t[w+1][1]-C)*this.ky,k=0;A===0&&R===0||(k=(this.wrap(r[0]-M)*this.kx*A+(r[1]-C)*this.ky*R)/(A*A+R*R),k>1?(M=t[w+1][0],C=t[w+1][1]):k>0&&(M+=A/this.kx*k,C+=R/this.ky*k)),A=this.wrap(r[0]-M)*this.kx,R=(r[1]-C)*this.ky;const j=A*A+R*R;j<v&&(v=j,o=M,h=C,g=w,_=k)}return{point:[o,h],index:g,t:Math.max(0,Math.min(1,_))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function Nc(a,t){return t[0]-a[0]}function Ho(a){return a[1]-a[0]+1}function Sa(a,t){return a[1]>=a[0]&&a[1]<t}function Uc(a,t){if(a[0]>a[1])return[null,null];const r=Ho(a);if(t){if(r===2)return[a,null];const h=Math.floor(r/2);return[[a[0],a[0]+h],[a[0]+h,a[1]]]}if(r===1)return[a,null];const o=Math.floor(r/2)-1;return[[a[0],a[0]+o],[a[0]+o+1,a[1]]]}function Vl(a,t){if(!Sa(t,a.length))return[1/0,1/0,-1/0,-1/0];const r=[1/0,1/0,-1/0,-1/0];for(let o=t[0];o<=t[1];++o)Ol(r,a[o]);return r}function Vc(a){const t=[1/0,1/0,-1/0,-1/0];for(const r of a)for(const o of r)Ol(t,o);return t}function Bh(a){return a[0]!==-1/0&&a[1]!==-1/0&&a[2]!==1/0&&a[3]!==1/0}function Fu(a,t,r){if(!Bh(a)||!Bh(t))return NaN;let o=0,h=0;return a[2]<t[0]&&(o=t[0]-a[2]),a[0]>t[2]&&(o=a[0]-t[2]),a[1]>t[3]&&(h=a[1]-t[3]),a[3]<t[1]&&(h=t[1]-a[3]),r.distance([0,0],[o,h])}function co(a,t,r){const o=r.pointOnLine(t,a);return r.distance(a,o.point)}function si(a,t,r,o,h){const g=Math.min(co(a,[r,o],h),co(t,[r,o],h)),_=Math.min(co(r,[a,t],h),co(o,[a,t],h));return Math.min(g,_)}function Cd(a,t,r,o,h){if(!Sa(t,a.length)||!Sa(o,r.length))return 1/0;let g=1/0;for(let _=t[0];_<t[1];++_){const v=a[_],w=a[_+1];for(let M=o[0];M<o[1];++M){const C=r[M],A=r[M+1];if(jl(v,w,C,A))return 0;g=Math.min(g,si(v,w,C,A,h))}}return g}function Gr(a,t,r,o,h){if(!Sa(t,a.length)||!Sa(o,r.length))return NaN;let g=1/0;for(let _=t[0];_<=t[1];++_)for(let v=o[0];v<=o[1];++v)if(g=Math.min(g,h.distance(a[_],r[v])),g===0)return g;return g}function Zl(a,t,r){if(Zo(a,t,!0))return 0;let o=1/0;for(const h of t){const g=h[0],_=h[h.length-1];if(g!==_&&(o=Math.min(o,co(a,[_,g],r)),o===0))return o;const v=r.pointOnLine(h,a);if(o=Math.min(o,r.distance(a,v.point)),o===0)return o}return o}function Oh(a,t,r,o){if(!Sa(t,a.length))return NaN;for(let g=t[0];g<=t[1];++g)if(Zo(a[g],r,!0))return 0;let h=1/0;for(let g=t[0];g<t[1];++g){const _=a[g],v=a[g+1];for(const w of r)for(let M=0,C=w.length,A=C-1;M<C;A=M++){const R=w[A],k=w[M];if(jl(_,v,R,k))return 0;h=Math.min(h,si(_,v,R,k,o))}}return h}function Nu(a,t){for(const r of a)for(const o of r)if(Zo(o,t,!0))return!0;return!1}function jh(a,t,r,o=1/0){const h=Vc(a),g=Vc(t);if(o!==1/0&&Fu(h,g,r)>=o)return o;if(As(h,g)){if(Nu(a,t))return 0}else if(Nu(t,a))return 0;let _=1/0;for(const v of a)for(let w=0,M=v.length,C=M-1;w<M;C=w++){const A=v[C],R=v[w];for(const k of t)for(let j=0,U=k.length,H=U-1;j<U;H=j++){const Q=k[H],ue=k[j];if(jl(A,R,Q,ue))return 0;_=Math.min(_,si(A,R,Q,ue,r))}}return _}function Uu(a,t,r,o,h,g){if(!g)return;const _=Fu(Vl(o,g),h,r);_<t&&a.push([_,g,[0,0]])}function $o(a,t,r,o,h,g,_){if(!g||!_)return;const v=Fu(Vl(o,g),Vl(h,_),r);v<t&&a.push([v,g,_])}function Zc(a,t,r,o,h=1/0){let g=Math.min(o.distance(a[0],r[0][0]),h);if(g===0)return g;const _=new so([[0,[0,a.length-1],[0,0]]],Nc),v=Vc(r);for(;_.length>0;){const w=_.pop();if(w[0]>=g)continue;const M=w[1],C=t?50:100;if(Ho(M)<=C){if(!Sa(M,a.length))return NaN;if(t){const A=Oh(a,M,r,o);if(isNaN(A)||A===0)return A;g=Math.min(g,A)}else for(let A=M[0];A<=M[1];++A){const R=Zl(a[A],r,o);if(g=Math.min(g,R),g===0)return 0}}else{const A=Uc(M,t);Uu(_,g,o,a,v,A[0]),Uu(_,g,o,a,v,A[1])}}return g}function Gc(a,t,r,o,h,g=1/0){let _=Math.min(g,h.distance(a[0],r[0]));if(_===0)return _;const v=new so([[0,[0,a.length-1],[0,r.length-1]]],Nc);for(;v.length>0;){const w=v.pop();if(w[0]>=_)continue;const M=w[1],C=w[2],A=t?50:100,R=o?50:100;if(Ho(M)<=A&&Ho(C)<=R){if(!Sa(M,a.length)&&Sa(C,r.length))return NaN;let k;if(t&&o)k=Cd(a,M,r,C,h),_=Math.min(_,k);else if(t&&!o){const j=a.slice(M[0],M[1]+1);for(let U=C[0];U<=C[1];++U)if(k=co(r[U],j,h),_=Math.min(_,k),_===0)return _}else if(!t&&o){const j=r.slice(C[0],C[1]+1);for(let U=M[0];U<=M[1];++U)if(k=co(a[U],j,h),_=Math.min(_,k),_===0)return _}else k=Gr(a,M,r,C,h),_=Math.min(_,k)}else{const k=Uc(M,t),j=Uc(C,o);$o(v,_,h,a,r,k[0],j[0]),$o(v,_,h,a,r,k[0],j[1]),$o(v,_,h,a,r,k[1],j[0]),$o(v,_,h,a,r,k[1],j[1])}}return _}function Ps(a){return a.type==="MultiPolygon"?a.coordinates.map(t=>({type:"Polygon",coordinates:t})):a.type==="MultiLineString"?a.coordinates.map(t=>({type:"LineString",coordinates:t})):a.type==="MultiPoint"?a.coordinates.map(t=>({type:"Point",coordinates:t})):[a]}class us{constructor(t,r){this.type=je,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ur(t[1])){const o=t[1];if(o.type==="FeatureCollection")return new us(o,o.features.map(h=>Ps(h.geometry)).flat());if(o.type==="Feature")return new us(o,Ps(o.geometry));if("type"in o&&"coordinates"in o)return new us(o,Ps(o))}return r.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(r,o){const h=r.geometry(),g=h.flat().map(w=>Lu([w.x,w.y],r.canonical));if(h.length===0)return NaN;const _=new Ul(g[0][1]);let v=1/0;for(const w of o){switch(w.type){case"Point":v=Math.min(v,Gc(g,!1,[w.coordinates],!1,_,v));break;case"LineString":v=Math.min(v,Gc(g,!1,w.coordinates,!0,_,v));break;case"Polygon":v=Math.min(v,Zc(g,!1,w.coordinates,_,v))}if(v===0)return v}return v}(t,this.geometries);if(t.geometryType()==="LineString")return function(r,o){const h=r.geometry(),g=h.flat().map(w=>Lu([w.x,w.y],r.canonical));if(h.length===0)return NaN;const _=new Ul(g[0][1]);let v=1/0;for(const w of o){switch(w.type){case"Point":v=Math.min(v,Gc(g,!0,[w.coordinates],!1,_,v));break;case"LineString":v=Math.min(v,Gc(g,!0,w.coordinates,!0,_,v));break;case"Polygon":v=Math.min(v,Zc(g,!0,w.coordinates,_,v))}if(v===0)return v}return v}(t,this.geometries);if(t.geometryType()==="Polygon")return function(r,o){const h=r.geometry();if(h.length===0||h[0].length===0)return NaN;const g=Fl(h,0).map(w=>w.map(M=>M.map(C=>Lu([C.x,C.y],r.canonical)))),_=new Ul(g[0][0][0][1]);let v=1/0;for(const w of o)for(const M of g){switch(w.type){case"Point":v=Math.min(v,Zc([w.coordinates],!1,M,_,v));break;case"LineString":v=Math.min(v,Zc(w.coordinates,!0,M,_,v));break;case"Polygon":v=Math.min(v,jh(M,w.coordinates,_,v))}if(v===0)return v}return v}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const qa={"==":Sd,"!=":Rc,">":Ah,"<":Ru,">=":Lc,"<=":kc,array:Er,at:Yt,boolean:Er,case:Jn,coalesce:fn,collator:Cr,format:cs,image:ku,in:Cs,"index-of":yr,interpolate:er,"interpolate-hcl":er,"interpolate-lab":er,length:Bl,let:jt,literal:Wn,match:Uo,number:Er,"number-format":Bc,object:Er,slice:Ta,step:Za,string:Er,"to-boolean":_r,"to-color":_r,"to-number":_r,"to-string":_r,var:ss,within:zs,distance:us};class Ar{constructor(t,r,o,h){this.name=t,this.type=r,this._evaluate=o,this.args=h}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,r){const o=t[0],h=Ar.definitions[o];if(!h)return r.error(`Unknown expression "${o}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(h)?h[0]:h.type,_=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,v=_.filter(([M])=>!Array.isArray(M)||M.length===t.length-1);let w=null;for(const[M,C]of v){w=new Vt(r.registry,Gl,r.path,null,r.scope);const A=[];let R=!1;for(let k=1;k<t.length;k++){const j=t[k],U=Array.isArray(M)?M[k-1]:M.type,H=w.parse(j,1+A.length,U);if(!H){R=!0;break}A.push(H)}if(!R)if(Array.isArray(M)&&M.length!==A.length)w.error(`Expected ${M.length} arguments, but found ${A.length} instead.`);else{for(let k=0;k<A.length;k++){const j=Array.isArray(M)?M[k]:M.type,U=A[k];w.concat(k+1).checkSubtype(j,U.type)}if(w.errors.length===0)return new Ar(o,g,C,A)}}if(v.length===1)r.errors.push(...w.errors);else{const M=(v.length?v:_).map(([A])=>{return R=A,Array.isArray(R)?`(${R.map(hi).join(", ")})`:`(${hi(R.type)}...)`;var R}).join(" | "),C=[];for(let A=1;A<t.length;A++){const R=r.parse(t[A],1+C.length);if(!R)return null;C.push(hi(R.type))}r.error(`Expected arguments of type ${M}, but found (${C.join(", ")}) instead.`)}return null}static register(t,r){Ar.definitions=r;for(const o in r)t[o]=Ar}}function Vu(a,[t,r,o,h]){t=t.evaluate(a),r=r.evaluate(a),o=o.evaluate(a);const g=h?h.evaluate(a):1,_=ro(t,r,o,g);if(_)throw new Ni(_);return new Xt(t/255,r/255,o/255,g,!1)}function Ds(a,t){return a in t}function Is(a,t){const r=t[a];return r===void 0?null:r}function hs(a){return{type:a}}function Gl(a){if(a instanceof ss)return Gl(a.boundExpression);if(a instanceof Ar&&a.name==="error"||a instanceof Cr||a instanceof zs||a instanceof us)return!1;const t=a instanceof _r||a instanceof Er;let r=!0;return a.eachChild(o=>{r=t?r&&Gl(o):r&&o instanceof Wn}),!!r&&Ha(a)&&ql(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ha(a){if(a instanceof Ar&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof zs||a instanceof us)return!1;let t=!0;return a.eachChild(r=>{t&&!Ha(r)&&(t=!1)}),t}function Xo(a){if(a instanceof Ar&&a.name==="feature-state")return!1;let t=!0;return a.eachChild(r=>{t&&!Xo(r)&&(t=!1)}),t}function ql(a,t){if(a instanceof Ar&&t.indexOf(a.name)>=0)return!1;let r=!0;return a.eachChild(o=>{r&&!ql(o,t)&&(r=!1)}),r}function Zu(a){return{result:"success",value:a}}function Yo(a){return{result:"error",value:a}}function Ko(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function Fh(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function qc(a){return!!a.expression&&a.expression.interpolated}function ti(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function Hl(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function Ma(a){return a}function qr(a,t){const r=t.type==="color",o=a.stops&&typeof a.stops[0][0]=="object",h=o||!(o||a.property!==void 0),g=a.type||(qc(t)?"exponential":"interval");if(r||t.type==="padding"){const C=r?Xt.parse:Un.parse;(a=tt({},a)).stops&&(a.stops=a.stops.map(A=>[A[0],C(A[1])])),a.default=C(a.default?a.default:t.default)}if(a.colorSpace&&(_=a.colorSpace)!=="rgb"&&_!=="hcl"&&_!=="lab")throw new Error(`Unknown color space: "${a.colorSpace}"`);var _;let v,w,M;if(g==="exponential")v=$l;else if(g==="interval")v=Hc;else if(g==="categorical"){v=Gu,w=Object.create(null);for(const C of a.stops)w[C[0]]=C[1];M=typeof a.stops[0][0]}else{if(g!=="identity")throw new Error(`Unknown function type "${g}"`);v=$c}if(o){const C={},A=[];for(let j=0;j<a.stops.length;j++){const U=a.stops[j],H=U[0].zoom;C[H]===void 0&&(C[H]={zoom:H,type:a.type,property:a.property,default:a.default,stops:[]},A.push(H)),C[H].stops.push([U[0].value,U[1]])}const R=[];for(const j of A)R.push([C[j].zoom,qr(C[j],t)]);const k={name:"linear"};return{kind:"composite",interpolationType:k,interpolationFactor:er.interpolationFactor.bind(void 0,k),zoomStops:R.map(j=>j[0]),evaluate:({zoom:j},U)=>$l({stops:R,base:a.base},t,j).evaluate(j,U)}}if(h){const C=g==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:C,interpolationFactor:er.interpolationFactor.bind(void 0,C),zoomStops:a.stops.map(A=>A[0]),evaluate:({zoom:A})=>v(a,t,A,w,M)}}return{kind:"source",evaluate(C,A){const R=A&&A.properties?A.properties[a.property]:void 0;return R===void 0?ra(a.default,t.default):v(a,t,R,w,M)}}}function ra(a,t,r){return a!==void 0?a:t!==void 0?t:r!==void 0?r:void 0}function Gu(a,t,r,o,h){return ra(typeof r===h?o[r]:void 0,a.default,t.default)}function Hc(a,t,r){if(ti(r)!=="number")return ra(a.default,t.default);const o=a.stops.length;if(o===1||r<=a.stops[0][0])return a.stops[0][1];if(r>=a.stops[o-1][0])return a.stops[o-1][1];const h=os(a.stops.map(g=>g[0]),r);return a.stops[h][1]}function $l(a,t,r){const o=a.base!==void 0?a.base:1;if(ti(r)!=="number")return ra(a.default,t.default);const h=a.stops.length;if(h===1||r<=a.stops[0][0])return a.stops[0][1];if(r>=a.stops[h-1][0])return a.stops[h-1][1];const g=os(a.stops.map(C=>C[0]),r),_=function(C,A,R,k){const j=k-R,U=C-R;return j===0?0:A===1?U/j:(Math.pow(A,U)-1)/(Math.pow(A,j)-1)}(r,o,a.stops[g][0],a.stops[g+1][0]),v=a.stops[g][1],w=a.stops[g+1][1],M=Zr[t.type]||Ma;return typeof v.evaluate=="function"?{evaluate(...C){const A=v.evaluate.apply(void 0,C),R=w.evaluate.apply(void 0,C);if(A!==void 0&&R!==void 0)return M(A,R,_,a.colorSpace)}}:M(v,w,_,a.colorSpace)}function $c(a,t,r){switch(t.type){case"color":r=Xt.parse(r);break;case"formatted":r=rn.fromString(r.toString());break;case"resolvedImage":r=gr.fromString(r.toString());break;case"padding":r=Un.parse(r);break;default:ti(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0)}return ra(r,a.default,t.default)}Ar.register(qa,{error:[{kind:"error"},[ht],(a,[t])=>{throw new Ni(t.evaluate(a))}],typeof:[ht,[ct],(a,[t])=>hi(an(t.evaluate(a)))],"to-rgba":[Nn(je,4),[Zt],(a,[t])=>{const[r,o,h,g]=t.evaluate(a).rgb;return[255*r,255*o,255*h,g]}],rgb:[Zt,[je,je,je],Vu],rgba:[Zt,[je,je,je,je],Vu],has:{type:lt,overloads:[[[ht],(a,[t])=>Ds(t.evaluate(a),a.properties())],[[ht,Et],(a,[t,r])=>Ds(t.evaluate(a),r.evaluate(a))]]},get:{type:ct,overloads:[[[ht],(a,[t])=>Is(t.evaluate(a),a.properties())],[[ht,Et],(a,[t,r])=>Is(t.evaluate(a),r.evaluate(a))]]},"feature-state":[ct,[ht],(a,[t])=>Is(t.evaluate(a),a.featureState||{})],properties:[Et,[],a=>a.properties()],"geometry-type":[ht,[],a=>a.geometryType()],id:[ct,[],a=>a.id()],zoom:[je,[],a=>a.globals.zoom],"heatmap-density":[je,[],a=>a.globals.heatmapDensity||0],"line-progress":[je,[],a=>a.globals.lineProgress||0],accumulated:[ct,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[je,hs(je),(a,t)=>{let r=0;for(const o of t)r+=o.evaluate(a);return r}],"*":[je,hs(je),(a,t)=>{let r=1;for(const o of t)r*=o.evaluate(a);return r}],"-":{type:je,overloads:[[[je,je],(a,[t,r])=>t.evaluate(a)-r.evaluate(a)],[[je],(a,[t])=>-t.evaluate(a)]]},"/":[je,[je,je],(a,[t,r])=>t.evaluate(a)/r.evaluate(a)],"%":[je,[je,je],(a,[t,r])=>t.evaluate(a)%r.evaluate(a)],ln2:[je,[],()=>Math.LN2],pi:[je,[],()=>Math.PI],e:[je,[],()=>Math.E],"^":[je,[je,je],(a,[t,r])=>Math.pow(t.evaluate(a),r.evaluate(a))],sqrt:[je,[je],(a,[t])=>Math.sqrt(t.evaluate(a))],log10:[je,[je],(a,[t])=>Math.log(t.evaluate(a))/Math.LN10],ln:[je,[je],(a,[t])=>Math.log(t.evaluate(a))],log2:[je,[je],(a,[t])=>Math.log(t.evaluate(a))/Math.LN2],sin:[je,[je],(a,[t])=>Math.sin(t.evaluate(a))],cos:[je,[je],(a,[t])=>Math.cos(t.evaluate(a))],tan:[je,[je],(a,[t])=>Math.tan(t.evaluate(a))],asin:[je,[je],(a,[t])=>Math.asin(t.evaluate(a))],acos:[je,[je],(a,[t])=>Math.acos(t.evaluate(a))],atan:[je,[je],(a,[t])=>Math.atan(t.evaluate(a))],min:[je,hs(je),(a,t)=>Math.min(...t.map(r=>r.evaluate(a)))],max:[je,hs(je),(a,t)=>Math.max(...t.map(r=>r.evaluate(a)))],abs:[je,[je],(a,[t])=>Math.abs(t.evaluate(a))],round:[je,[je],(a,[t])=>{const r=t.evaluate(a);return r<0?-Math.round(-r):Math.round(r)}],floor:[je,[je],(a,[t])=>Math.floor(t.evaluate(a))],ceil:[je,[je],(a,[t])=>Math.ceil(t.evaluate(a))],"filter-==":[lt,[ht,ct],(a,[t,r])=>a.properties()[t.value]===r.value],"filter-id-==":[lt,[ct],(a,[t])=>a.id()===t.value],"filter-type-==":[lt,[ht],(a,[t])=>a.geometryType()===t.value],"filter-<":[lt,[ht,ct],(a,[t,r])=>{const o=a.properties()[t.value],h=r.value;return typeof o==typeof h&&o<h}],"filter-id-<":[lt,[ct],(a,[t])=>{const r=a.id(),o=t.value;return typeof r==typeof o&&r<o}],"filter->":[lt,[ht,ct],(a,[t,r])=>{const o=a.properties()[t.value],h=r.value;return typeof o==typeof h&&o>h}],"filter-id->":[lt,[ct],(a,[t])=>{const r=a.id(),o=t.value;return typeof r==typeof o&&r>o}],"filter-<=":[lt,[ht,ct],(a,[t,r])=>{const o=a.properties()[t.value],h=r.value;return typeof o==typeof h&&o<=h}],"filter-id-<=":[lt,[ct],(a,[t])=>{const r=a.id(),o=t.value;return typeof r==typeof o&&r<=o}],"filter->=":[lt,[ht,ct],(a,[t,r])=>{const o=a.properties()[t.value],h=r.value;return typeof o==typeof h&&o>=h}],"filter-id->=":[lt,[ct],(a,[t])=>{const r=a.id(),o=t.value;return typeof r==typeof o&&r>=o}],"filter-has":[lt,[ct],(a,[t])=>t.value in a.properties()],"filter-has-id":[lt,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[lt,[Nn(ht)],(a,[t])=>t.value.indexOf(a.geometryType())>=0],"filter-id-in":[lt,[Nn(ct)],(a,[t])=>t.value.indexOf(a.id())>=0],"filter-in-small":[lt,[ht,Nn(ct)],(a,[t,r])=>r.value.indexOf(a.properties()[t.value])>=0],"filter-in-large":[lt,[ht,Nn(ct)],(a,[t,r])=>function(o,h,g,_){for(;g<=_;){const v=g+_>>1;if(h[v]===o)return!0;h[v]>o?_=v-1:g=v+1}return!1}(a.properties()[t.value],r.value,0,r.value.length-1)],all:{type:lt,overloads:[[[lt,lt],(a,[t,r])=>t.evaluate(a)&&r.evaluate(a)],[hs(lt),(a,t)=>{for(const r of t)if(!r.evaluate(a))return!1;return!0}]]},any:{type:lt,overloads:[[[lt,lt],(a,[t,r])=>t.evaluate(a)||r.evaluate(a)],[hs(lt),(a,t)=>{for(const r of t)if(r.evaluate(a))return!0;return!1}]]},"!":[lt,[lt],(a,[t])=>!t.evaluate(a)],"is-supported-script":[lt,[ht],(a,[t])=>{const r=a.globals&&a.globals.isSupportedScript;return!r||r(t.evaluate(a))}],upcase:[ht,[ht],(a,[t])=>t.evaluate(a).toUpperCase()],downcase:[ht,[ht],(a,[t])=>t.evaluate(a).toLowerCase()],concat:[ht,hs(ct),(a,t)=>t.map(r=>Vr(r.evaluate(a))).join("")],"resolved-locale":[ht,[na],(a,[t])=>t.evaluate(a).resolvedLocale()]});class $a{constructor(t,r){var o;this.expression=t,this._warningHistory={},this._evaluator=new Es,this._defaultValue=r?(o=r).type==="color"&&Hl(o.default)?new Xt(0,0,0,0):o.type==="color"?Xt.parse(o.default)||null:o.type==="padding"?Un.parse(o.default)||null:o.type==="variableAnchorOffsetCollection"?bn.parse(o.default)||null:o.type==="projectionDefinition"?Mr.parse(o.default)||null:o.default===void 0?null:o.default:null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(t,r,o,h,g,_){return this._evaluator.globals=t,this._evaluator.feature=r,this._evaluator.featureState=o,this._evaluator.canonical=h,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=_,this.expression.evaluate(this._evaluator)}evaluate(t,r,o,h,g,_){this._evaluator.globals=t,this._evaluator.feature=r||null,this._evaluator.featureState=o||null,this._evaluator.canonical=h,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=_||null;try{const v=this.expression.evaluate(this._evaluator);if(v==null||typeof v=="number"&&v!=v)return this._defaultValue;if(this._enumValues&&!(v in this._enumValues))throw new Ni(`Expected value to be one of ${Object.keys(this._enumValues).map(w=>JSON.stringify(w)).join(", ")}, but found ${JSON.stringify(v)} instead.`);return v}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console<"u"&&console.warn(v.message)),this._defaultValue}}}function Xl(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in qa}function Xa(a,t){const r=new Vt(qa,Gl,[],t?function(h){const g={color:Zt,string:ht,number:je,enum:ht,boolean:lt,formatted:nn,padding:In,projectionDefinition:bt,resolvedImage:zi,variableAnchorOffsetCollection:Rl};return h.type==="array"?Nn(g[h.value]||ct,h.length):g[h.type]}(t):void 0),o=r.parse(a,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return o?Zu(new $a(o,t)):Yo(r.errors)}class ds{constructor(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!Xo(r.expression)}evaluateWithoutErrorHandling(t,r,o,h,g,_){return this._styleExpression.evaluateWithoutErrorHandling(t,r,o,h,g,_)}evaluate(t,r,o,h,g,_){return this._styleExpression.evaluate(t,r,o,h,g,_)}}class Xc{constructor(t,r,o,h){this.kind=t,this.zoomStops=o,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!Xo(r.expression),this.interpolationType=h}evaluateWithoutErrorHandling(t,r,o,h,g,_){return this._styleExpression.evaluateWithoutErrorHandling(t,r,o,h,g,_)}evaluate(t,r,o,h,g,_){return this._styleExpression.evaluate(t,r,o,h,g,_)}interpolationFactor(t,r,o){return this.interpolationType?er.interpolationFactor(this.interpolationType,t,r,o):0}}function Hr(a,t){const r=Xa(a,t);if(r.result==="error")return r;const o=r.value.expression,h=Ha(o);if(!h&&!Ko(t))return Yo([new pt("","data expressions not supported")]);const g=ql(o,["zoom"]);if(!g&&!Fh(t))return Yo([new pt("","zoom expressions not supported")]);const _=ps(o);return _||g?_ instanceof pt?Yo([_]):_ instanceof er&&!qc(t)?Yo([new pt("",'"interpolate" expressions cannot be used with this property')]):Zu(_?new Xc(h?"camera":"composite",r.value,_.labels,_ instanceof er?_.interpolation:void 0):new ds(h?"constant":"source",r.value)):Yo([new pt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class fs{constructor(t,r){this._parameters=t,this._specification=r,tt(this,qr(this._parameters,this._specification))}static deserialize(t){return new fs(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function ps(a){let t=null;if(a instanceof jt)t=ps(a.result);else if(a instanceof fn){for(const r of a.args)if(t=ps(r),t)break}else(a instanceof Za||a instanceof er)&&a.input instanceof Ar&&a.input.name==="zoom"&&(t=a);return t instanceof pt||a.eachChild(r=>{const o=ps(r);o instanceof pt?t=o:!t&&o?t=new pt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&o&&t!==o&&(t=new pt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function Qo(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const t of a.slice(1))if(!Qo(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const Yl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function vr(a){if(a==null)return{filter:()=>!0,needGeometry:!1};Qo(a)||(a=$r(a));const t=Xa(a,Yl);if(t.result==="error")throw new Error(t.value.map(r=>`${r.key}: ${r.message}`).join(", "));return{filter:(r,o,h)=>t.value.evaluate(r,o,{},h),needGeometry:Rs(a)}}function aa(a,t){return a<t?-1:a>t?1:0}function Rs(a){if(!Array.isArray(a))return!1;if(a[0]==="within"||a[0]==="distance")return!0;for(let t=1;t<a.length;t++)if(Rs(a[t]))return!0;return!1}function $r(a){if(!a)return!0;const t=a[0];return a.length<=1?t!=="any":t==="=="?sa(a[1],a[2],"=="):t==="!="?ks(sa(a[1],a[2],"==")):t==="<"||t===">"||t==="<="||t===">="?sa(a[1],a[2],t):t==="any"?(r=a.slice(1),["any"].concat(r.map($r))):t==="all"?["all"].concat(a.slice(1).map($r)):t==="none"?["all"].concat(a.slice(1).map($r).map(ks)):t==="in"?ms(a[1],a.slice(2)):t==="!in"?ks(ms(a[1],a.slice(2))):t==="has"?Yc(a[1]):t!=="!has"||ks(Yc(a[1]));var r}function sa(a,t,r){switch(a){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,a,t]}}function ms(a,t){if(t.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(r=>typeof r!=typeof t[0])?["filter-in-large",a,["literal",t.sort(aa)]]:["filter-in-small",a,["literal",t]]}}function Yc(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function ks(a){return["!",a]}function uo(a){const t=typeof a;if(t==="number"||t==="boolean"||t==="string"||a==null)return JSON.stringify(a);if(Array.isArray(a)){let h="[";for(const g of a)h+=`${uo(g)},`;return`${h}]`}const r=Object.keys(a).sort();let o="{";for(let h=0;h<r.length;h++)o+=`${JSON.stringify(r[h])}:${uo(a[r[h]])},`;return`${o}}`}function tr(a){let t="";for(const r of V)t+=`/${uo(a[r])}`;return t}function pn(a){const t=a.value;return t?[new xe(a.key,t,"constants have been deprecated as of v8")]:[]}function It(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function ir(a){if(Array.isArray(a))return a.map(ir);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const t={};for(const r in a)t[r]=ir(a[r]);return t}return It(a)}function mn(a){const t=a.key,r=a.value,o=a.valueSpec||{},h=a.objectElementValidators||{},g=a.style,_=a.styleSpec,v=a.validateSpec;let w=[];const M=ti(r);if(M!=="object")return[new xe(t,r,`object expected, ${M} found`)];for(const C in r){const A=C.split(".")[0],R=o[A]||o["*"];let k;if(h[A])k=h[A];else if(o[A])k=v;else if(h["*"])k=h["*"];else{if(!o["*"]){w.push(new xe(t,r[C],`unknown property "${C}"`));continue}k=v}w=w.concat(k({key:(t&&`${t}.`)+C,value:r[C],valueSpec:R,style:g,styleSpec:_,object:r,objectKey:C,validateSpec:v},r))}for(const C in o)h[C]||o[C].required&&o[C].default===void 0&&r[C]===void 0&&w.push(new xe(t,r,`missing required property "${C}"`));return w}function Kl(a){const t=a.value,r=a.valueSpec,o=a.style,h=a.styleSpec,g=a.key,_=a.arrayElementValidator||a.validateSpec;if(ti(t)!=="array")return[new xe(g,t,`array expected, ${ti(t)} found`)];if(r.length&&t.length!==r.length)return[new xe(g,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new xe(g,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let v={type:r.value,values:r.values};h.$version<7&&(v.function=r.function),ti(r.value)==="object"&&(v=r.value);let w=[];for(let M=0;M<t.length;M++)w=w.concat(_({array:t,arrayIndex:M,value:t[M],valueSpec:v,validateSpec:a.validateSpec,style:o,styleSpec:h,key:`${g}[${M}]`}));return w}function gs(a){const t=a.key,r=a.value,o=a.valueSpec;let h=ti(r);return h==="number"&&r!=r&&(h="NaN"),h!=="number"?[new xe(t,r,`number expected, ${h} found`)]:"minimum"in o&&r<o.minimum?[new xe(t,r,`${r} is less than the minimum value ${o.minimum}`)]:"maximum"in o&&r>o.maximum?[new xe(t,r,`${r} is greater than the maximum value ${o.maximum}`)]:[]}function qu(a){const t=a.valueSpec,r=It(a.value.type);let o,h,g,_={};const v=r!=="categorical"&&a.value.property===void 0,w=!v,M=ti(a.value.stops)==="array"&&ti(a.value.stops[0])==="array"&&ti(a.value.stops[0][0])==="object",C=mn({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(k){if(r==="identity")return[new xe(k.key,k.value,'identity function may not have a "stops" property')];let j=[];const U=k.value;return j=j.concat(Kl({key:k.key,value:U,valueSpec:k.valueSpec,validateSpec:k.validateSpec,style:k.style,styleSpec:k.styleSpec,arrayElementValidator:A})),ti(U)==="array"&&U.length===0&&j.push(new xe(k.key,U,"array must have at least one stop")),j},default:function(k){return k.validateSpec({key:k.key,value:k.value,valueSpec:t,validateSpec:k.validateSpec,style:k.style,styleSpec:k.styleSpec})}}});return r==="identity"&&v&&C.push(new xe(a.key,a.value,'missing required property "property"')),r==="identity"||a.value.stops||C.push(new xe(a.key,a.value,'missing required property "stops"')),r==="exponential"&&a.valueSpec.expression&&!qc(a.valueSpec)&&C.push(new xe(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(w&&!Ko(a.valueSpec)?C.push(new xe(a.key,a.value,"property functions not supported")):v&&!Fh(a.valueSpec)&&C.push(new xe(a.key,a.value,"zoom functions not supported"))),r!=="categorical"&&!M||a.value.property!==void 0||C.push(new xe(a.key,a.value,'"property" property is required')),C;function A(k){let j=[];const U=k.value,H=k.key;if(ti(U)!=="array")return[new xe(H,U,`array expected, ${ti(U)} found`)];if(U.length!==2)return[new xe(H,U,`array length 2 expected, length ${U.length} found`)];if(M){if(ti(U[0])!=="object")return[new xe(H,U,`object expected, ${ti(U[0])} found`)];if(U[0].zoom===void 0)return[new xe(H,U,"object stop key must have zoom")];if(U[0].value===void 0)return[new xe(H,U,"object stop key must have value")];if(g&&g>It(U[0].zoom))return[new xe(H,U[0].zoom,"stop zoom values must appear in ascending order")];It(U[0].zoom)!==g&&(g=It(U[0].zoom),h=void 0,_={}),j=j.concat(mn({key:`${H}[0]`,value:U[0],valueSpec:{zoom:{}},validateSpec:k.validateSpec,style:k.style,styleSpec:k.styleSpec,objectElementValidators:{zoom:gs,value:R}}))}else j=j.concat(R({key:`${H}[0]`,value:U[0],validateSpec:k.validateSpec,style:k.style,styleSpec:k.styleSpec},U));return Xl(ir(U[1]))?j.concat([new xe(`${H}[1]`,U[1],"expressions are not allowed in function stops.")]):j.concat(k.validateSpec({key:`${H}[1]`,value:U[1],valueSpec:t,validateSpec:k.validateSpec,style:k.style,styleSpec:k.styleSpec}))}function R(k,j){const U=ti(k.value),H=It(k.value),Q=k.value!==null?k.value:j;if(o){if(U!==o)return[new xe(k.key,Q,`${U} stop domain type must match previous stop domain type ${o}`)]}else o=U;if(U!=="number"&&U!=="string"&&U!=="boolean")return[new xe(k.key,Q,"stop domain value must be a number, string, or boolean")];if(U!=="number"&&r!=="categorical"){let ue=`number expected, ${U} found`;return Ko(t)&&r===void 0&&(ue+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new xe(k.key,Q,ue)]}return r!=="categorical"||U!=="number"||isFinite(H)&&Math.floor(H)===H?r!=="categorical"&&U==="number"&&h!==void 0&&H<h?[new xe(k.key,Q,"stop domain values must appear in ascending order")]:(h=H,r==="categorical"&&H in _?[new xe(k.key,Q,"stop domain values must be unique")]:(_[H]=!0,[])):[new xe(k.key,Q,`integer expected, found ${H}`)]}}function Ls(a){const t=(a.expressionContext==="property"?Hr:Xa)(ir(a.value),a.valueSpec);if(t.result==="error")return t.value.map(o=>new xe(`${a.key}${o.key}`,a.value,o.message));const r=t.value.expression||t.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!r.outputDefined())return[new xe(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!Xo(r))return[new xe(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!Xo(r))return[new xe(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!ql(r,["zoom","feature-state"]))return[new xe(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!Ha(r))return[new xe(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ya(a){const t=a.key,r=a.value,o=a.valueSpec,h=[];return Array.isArray(o.values)?o.values.indexOf(It(r))===-1&&h.push(new xe(t,r,`expected one of [${o.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(o.values).indexOf(It(r))===-1&&h.push(new xe(t,r,`expected one of [${Object.keys(o.values).join(", ")}], ${JSON.stringify(r)} found`)),h}function Ka(a){return Qo(ir(a.value))?Ls(tt({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Wo(a)}function Wo(a){const t=a.value,r=a.key;if(ti(t)!=="array")return[new xe(r,t,`array expected, ${ti(t)} found`)];const o=a.styleSpec;let h,g=[];if(t.length<1)return[new xe(r,t,"filter array must have at least 1 element")];switch(g=g.concat(Ya({key:`${r}[0]`,value:t[0],valueSpec:o.filter_operator,style:a.style,styleSpec:a.styleSpec})),It(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&It(t[1])==="$type"&&g.push(new xe(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&g.push(new xe(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(h=ti(t[1]),h!=="string"&&g.push(new xe(`${r}[1]`,t[1],`string expected, ${h} found`)));for(let _=2;_<t.length;_++)h=ti(t[_]),It(t[1])==="$type"?g=g.concat(Ya({key:`${r}[${_}]`,value:t[_],valueSpec:o.geometry_type,style:a.style,styleSpec:a.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&g.push(new xe(`${r}[${_}]`,t[_],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let _=1;_<t.length;_++)g=g.concat(Wo({key:`${r}[${_}]`,value:t[_],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":h=ti(t[1]),t.length!==2?g.push(new xe(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):h!=="string"&&g.push(new xe(`${r}[1]`,t[1],`string expected, ${h} found`))}return g}function ho(a,t){const r=a.key,o=a.validateSpec,h=a.style,g=a.styleSpec,_=a.value,v=a.objectKey,w=g[`${t}_${a.layerType}`];if(!w)return[];const M=v.match(/^(.*)-transition$/);if(t==="paint"&&M&&w[M[1]]&&w[M[1]].transition)return o({key:r,value:_,valueSpec:g.transition,style:h,styleSpec:g});const C=a.valueSpec||w[v];if(!C)return[new xe(r,_,`unknown property "${v}"`)];let A;if(ti(_)==="string"&&Ko(C)&&!C.tokens&&(A=/^{([^}]+)}$/.exec(_)))return[new xe(r,_,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(A[1])} }\`.`)];const R=[];return a.layerType==="symbol"&&(v==="text-field"&&h&&!h.glyphs&&R.push(new xe(r,_,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&Hl(ir(_))&&It(_.type)==="identity"&&R.push(new xe(r,_,'"text-font" does not support identity functions'))),R.concat(o({key:a.key,value:_,valueSpec:C,style:h,styleSpec:g,expressionContext:"property",propertyType:t,propertyKey:v}))}function Kc(a){return ho(a,"paint")}function Qc(a){return ho(a,"layout")}function Wc(a){let t=[];const r=a.value,o=a.key,h=a.style,g=a.styleSpec;r.type||r.ref||t.push(new xe(o,r,'either "type" or "ref" is required'));let _=It(r.type);const v=It(r.ref);if(r.id){const w=It(r.id);for(let M=0;M<a.arrayIndex;M++){const C=h.layers[M];It(C.id)===w&&t.push(new xe(o,r.id,`duplicate layer id "${r.id}", previously used at line ${C.id.__line__}`))}}if("ref"in r){let w;["type","source","source-layer","filter","layout"].forEach(M=>{M in r&&t.push(new xe(o,r[M],`"${M}" is prohibited for ref layers`))}),h.layers.forEach(M=>{It(M.id)===v&&(w=M)}),w?w.ref?t.push(new xe(o,r.ref,"ref cannot reference another ref layer")):_=It(w.type):t.push(new xe(o,r.ref,`ref layer "${v}" not found`))}else if(_!=="background")if(r.source){const w=h.sources&&h.sources[r.source],M=w&&It(w.type);w?M==="vector"&&_==="raster"?t.push(new xe(o,r.source,`layer "${r.id}" requires a raster source`)):M!=="raster-dem"&&_==="hillshade"?t.push(new xe(o,r.source,`layer "${r.id}" requires a raster-dem source`)):M==="raster"&&_!=="raster"?t.push(new xe(o,r.source,`layer "${r.id}" requires a vector source`)):M!=="vector"||r["source-layer"]?M==="raster-dem"&&_!=="hillshade"?t.push(new xe(o,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):_!=="line"||!r.paint||!r.paint["line-gradient"]||M==="geojson"&&w.lineMetrics||t.push(new xe(o,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new xe(o,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new xe(o,r.source,`source "${r.source}" not found`))}else t.push(new xe(o,r,'missing required property "source"'));return t=t.concat(mn({key:o,value:r,valueSpec:g.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${o}.type`,value:r.type,valueSpec:g.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:r,objectKey:"type"}),filter:Ka,layout:w=>mn({layer:r,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,validateSpec:w.validateSpec,objectElementValidators:{"*":M=>Qc(tt({layerType:_},M))}}),paint:w=>mn({layer:r,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,validateSpec:w.validateSpec,objectElementValidators:{"*":M=>Kc(tt({layerType:_},M))}})}})),t}function Ea(a){const t=a.value,r=a.key,o=ti(t);return o!=="string"?[new xe(r,t,`string expected, ${o} found`)]:[]}const fo={promoteId:function({key:a,value:t}){if(ti(t)==="string")return Ea({key:a,value:t});{const r=[];for(const o in t)r.push(...Ea({key:`${a}.${o}`,value:t[o]}));return r}}};function Jo(a){const t=a.value,r=a.key,o=a.styleSpec,h=a.style,g=a.validateSpec;if(!t.type)return[new xe(r,t,'"type" is required')];const _=It(t.type);let v;switch(_){case"vector":case"raster":return v=mn({key:r,value:t,valueSpec:o[`source_${_.replace("-","_")}`],style:a.style,styleSpec:o,objectElementValidators:fo,validateSpec:g}),v;case"raster-dem":return v=function(w){var M;const C=(M=w.sourceName)!==null&&M!==void 0?M:"",A=w.value,R=w.styleSpec,k=R.source_raster_dem,j=w.style;let U=[];const H=ti(A);if(A===void 0)return U;if(H!=="object")return U.push(new xe("source_raster_dem",A,`object expected, ${H} found`)),U;const Q=It(A.encoding)==="custom",ue=["redFactor","greenFactor","blueFactor","baseShift"],te=w.value.encoding?`"${w.value.encoding}"`:"Default";for(const L in A)!Q&&ue.includes(L)?U.push(new xe(L,A[L],`In "${C}": "${L}" is only valid when "encoding" is set to "custom". ${te} encoding found`)):k[L]?U=U.concat(w.validateSpec({key:L,value:A[L],valueSpec:k[L],validateSpec:w.validateSpec,style:j,styleSpec:R})):U.push(new xe(L,A[L],`unknown property "${L}"`));return U}({sourceName:r,value:t,style:a.style,styleSpec:o,validateSpec:g}),v;case"geojson":if(v=mn({key:r,value:t,valueSpec:o.source_geojson,style:h,styleSpec:o,validateSpec:g,objectElementValidators:fo}),t.cluster)for(const w in t.clusterProperties){const[M,C]=t.clusterProperties[w],A=typeof M=="string"?[M,["accumulated"],["get",w]]:M;v.push(...Ls({key:`${r}.${w}.map`,value:C,expressionContext:"cluster-map"})),v.push(...Ls({key:`${r}.${w}.reduce`,value:A,expressionContext:"cluster-reduce"}))}return v;case"video":return mn({key:r,value:t,valueSpec:o.source_video,style:h,validateSpec:g,styleSpec:o});case"image":return mn({key:r,value:t,valueSpec:o.source_image,style:h,validateSpec:g,styleSpec:o});case"canvas":return[new xe(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ya({key:`${r}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Hu(a){const t=a.value,r=a.styleSpec,o=r.light,h=a.style;let g=[];const _=ti(t);if(t===void 0)return g;if(_!=="object")return g=g.concat([new xe("light",t,`object expected, ${_} found`)]),g;for(const v in t){const w=v.match(/^(.*)-transition$/);g=g.concat(w&&o[w[1]]&&o[w[1]].transition?a.validateSpec({key:v,value:t[v],valueSpec:r.transition,validateSpec:a.validateSpec,style:h,styleSpec:r}):o[v]?a.validateSpec({key:v,value:t[v],valueSpec:o[v],validateSpec:a.validateSpec,style:h,styleSpec:r}):[new xe(v,t[v],`unknown property "${v}"`)])}return g}function po(a){const t=a.value,r=a.styleSpec,o=r.sky,h=a.style,g=ti(t);if(t===void 0)return[];if(g!=="object")return[new xe("sky",t,`object expected, ${g} found`)];let _=[];for(const v in t)_=_.concat(o[v]?a.validateSpec({key:v,value:t[v],valueSpec:o[v],style:h,styleSpec:r}):[new xe(v,t[v],`unknown property "${v}"`)]);return _}function el(a){const t=a.value,r=a.styleSpec,o=r.terrain,h=a.style;let g=[];const _=ti(t);if(t===void 0)return g;if(_!=="object")return g=g.concat([new xe("terrain",t,`object expected, ${_} found`)]),g;for(const v in t)g=g.concat(o[v]?a.validateSpec({key:v,value:t[v],valueSpec:o[v],validateSpec:a.validateSpec,style:h,styleSpec:r}):[new xe(v,t[v],`unknown property "${v}"`)]);return g}function Ql(a){let t=[];const r=a.value,o=a.key;if(Array.isArray(r)){const h=[],g=[];for(const _ in r)r[_].id&&h.includes(r[_].id)&&t.push(new xe(o,r,`all the sprites' ids must be unique, but ${r[_].id} is duplicated`)),h.push(r[_].id),r[_].url&&g.includes(r[_].url)&&t.push(new xe(o,r,`all the sprites' URLs must be unique, but ${r[_].url} is duplicated`)),g.push(r[_].url),t=t.concat(mn({key:`${o}[${_}]`,value:r[_],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return t}return Ea({key:o,value:r})}const tl={"*":()=>[],array:Kl,boolean:function(a){const t=a.value,r=a.key,o=ti(t);return o!=="boolean"?[new xe(r,t,`boolean expected, ${o} found`)]:[]},number:gs,color:function(a){const t=a.key,r=a.value,o=ti(r);return o!=="string"?[new xe(t,r,`color expected, ${o} found`)]:Xt.parse(String(r))?[]:[new xe(t,r,`color expected, "${r}" found`)]},constants:pn,enum:Ya,filter:Ka,function:qu,layer:Wc,object:mn,source:Jo,light:Hu,sky:po,terrain:el,projection:function(a){const t=a.value,r=a.styleSpec,o=r.projection,h=a.style,g=ti(t);if(t===void 0)return[];if(g!=="object")return[new xe("projection",t,`object expected, ${g} found`)];let _=[];for(const v in t)_=_.concat(o[v]?a.validateSpec({key:v,value:t[v],valueSpec:o[v],style:h,styleSpec:r}):[new xe(v,t[v],`unknown property "${v}"`)]);return _},projectionDefinition:function(a){const t=a.key;let r=a.value;r=r instanceof String?r.valueOf():r;const o=ti(r);return o!=="array"||function(h){return Array.isArray(h)&&h.length===3&&typeof h[0]=="string"&&typeof h[1]=="string"&&typeof h[2]=="number"}(r)||function(h){return!!["interpolate","step","literal"].includes(h[0])}(r)?["array","string"].includes(o)?[]:[new xe(t,r,`projection expected, invalid type "${o}" found`)]:[new xe(t,r,`projection expected, invalid array ${JSON.stringify(r)} found`)]},string:Ea,formatted:function(a){return Ea(a).length===0?[]:Ls(a)},resolvedImage:function(a){return Ea(a).length===0?[]:Ls(a)},padding:function(a){const t=a.key,r=a.value;if(ti(r)==="array"){if(r.length<1||r.length>4)return[new xe(t,r,`padding requires 1 to 4 values; ${r.length} values found`)];const o={type:"number"};let h=[];for(let g=0;g<r.length;g++)h=h.concat(a.validateSpec({key:`${t}[${g}]`,value:r[g],validateSpec:a.validateSpec,valueSpec:o}));return h}return gs({key:t,value:r,valueSpec:{}})},variableAnchorOffsetCollection:function(a){const t=a.key,r=a.value,o=ti(r),h=a.styleSpec;if(o!=="array"||r.length<1||r.length%2!=0)return[new xe(t,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let g=[];for(let _=0;_<r.length;_+=2)g=g.concat(Ya({key:`${t}[${_}]`,value:r[_],valueSpec:h.layout_symbol["text-anchor"]})),g=g.concat(Kl({key:`${t}[${_+1}]`,value:r[_+1],valueSpec:{length:2,value:"number"},validateSpec:a.validateSpec,style:a.style,styleSpec:h}));return g},sprite:Ql};function Ca(a){const t=a.value,r=a.valueSpec,o=a.styleSpec;return a.validateSpec=Ca,r.expression&&Hl(It(t))?qu(a):r.expression&&Xl(ir(t))?Ls(a):r.type&&tl[r.type]?tl[r.type](a):mn(tt({},a,{valueSpec:r.type?o[r.type]:r}))}function mo(a){const t=a.value,r=a.key,o=Ea(a);return o.length||(t.indexOf("{fontstack}")===-1&&o.push(new xe(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&o.push(new xe(r,t,'"glyphs" url must include a "{range}" token'))),o}function Ui(a,t=P){let r=[];return r=r.concat(Ca({key:"",value:a,valueSpec:t.$root,styleSpec:t,style:a,validateSpec:Ca,objectElementValidators:{glyphs:mo,"*":()=>[]}})),a.constants&&(r=r.concat(pn({key:"constants",value:a.constants}))),Jc(r)}function wn(a){return function(t){return a({...t,validateSpec:Ca})}}function Jc(a){return[].concat(a).sort((t,r)=>t.line-r.line)}function xr(a){return function(...t){return Jc(a.apply(this,t))}}Ui.source=xr(wn(Jo)),Ui.sprite=xr(wn(Ql)),Ui.glyphs=xr(wn(mo)),Ui.light=xr(wn(Hu)),Ui.sky=xr(wn(po)),Ui.terrain=xr(wn(el)),Ui.layer=xr(wn(Wc)),Ui.filter=xr(wn(Ka)),Ui.paintProperty=xr(wn(Kc)),Ui.layoutProperty=xr(wn(Qc));const _s=Ui,il=_s.light,eu=_s.sky,Wl=_s.paintProperty,oa=_s.layoutProperty;function Xr(a,t){let r=!1;if(t&&t.length)for(const o of t)a.fire(new dn(new Error(o.message))),r=!0;return r}class la{constructor(t,r,o){const h=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const _=new Int32Array(this.arrayBuffer);t=_[0],this.d=(r=_[1])+2*(o=_[2]);for(let w=0;w<this.d*this.d;w++){const M=_[3+w],C=_[3+w+1];h.push(M===C?null:_.subarray(M,C))}const v=_[3+h.length+1];this.keys=_.subarray(_[3+h.length],v),this.bboxes=_.subarray(v),this.insert=this._insertReadonly}else{this.d=r+2*o;for(let _=0;_<this.d*this.d;_++)h.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=t,this.padding=o,this.scale=r/t,this.uid=0;const g=o/r*t;this.min=-g,this.max=t+g}insert(t,r,o,h,g){this._forEachCell(r,o,h,g,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(r),this.bboxes.push(o),this.bboxes.push(h),this.bboxes.push(g)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,r,o,h,g,_){this.cells[g].push(_)}query(t,r,o,h,g){const _=this.min,v=this.max;if(t<=_&&r<=_&&v<=o&&v<=h&&!g)return Array.prototype.slice.call(this.keys);{const w=[];return this._forEachCell(t,r,o,h,this._queryCell,w,{},g),w}}_queryCell(t,r,o,h,g,_,v,w){const M=this.cells[g];if(M!==null){const C=this.keys,A=this.bboxes;for(let R=0;R<M.length;R++){const k=M[R];if(v[k]===void 0){const j=4*k;(w?w(A[j+0],A[j+1],A[j+2],A[j+3]):t<=A[j+2]&&r<=A[j+3]&&o>=A[j+0]&&h>=A[j+1])?(v[k]=!0,_.push(C[k])):v[k]=!1}}}}_forEachCell(t,r,o,h,g,_,v,w){const M=this._convertToCellCoord(t),C=this._convertToCellCoord(r),A=this._convertToCellCoord(o),R=this._convertToCellCoord(h);for(let k=M;k<=A;k++)for(let j=C;j<=R;j++){const U=this.d*j+k;if((!w||w(this._convertFromCellCoord(k),this._convertFromCellCoord(j),this._convertFromCellCoord(k+1),this._convertFromCellCoord(j+1)))&&g.call(this,t,r,o,h,U,_,v,w))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,r=3+this.cells.length+1+1;let o=0;for(let _=0;_<this.cells.length;_++)o+=this.cells[_].length;const h=new Int32Array(r+o+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;let g=r;for(let _=0;_<t.length;_++){const v=t[_];h[3+_]=g,h.set(v,g),g+=v.length}return h[3+t.length]=g,h.set(this.keys,g),g+=this.keys.length,h[3+t.length+1]=g,h.set(this.bboxes,g),g+=this.bboxes.length,h.buffer}static serialize(t,r){const o=t.toArrayBuffer();return r&&r.push(o),{buffer:o}}static deserialize(t){return new la(t.buffer)}}const zr={};function nt(a,t,r={}){if(zr[a])throw new Error(`${a} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:a,writeable:!1}),zr[a]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}nt("Object",Object),nt("TransferableGridIndex",la),nt("Color",Xt),nt("Error",Error),nt("AJAXError",Fa),nt("ResolvedImage",gr),nt("StylePropertyFunction",fs),nt("StyleExpression",$a,{omit:["_evaluator"]}),nt("ZoomDependentExpression",Xc),nt("ZoomConstantExpression",ds),nt("CompoundExpression",Ar,{omit:["_evaluate"]});for(const a in qa)qa[a]._classRegistryKey||nt(`Expression_${a}`,qa[a]);function Pr(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function gn(a){return a.$name||a.constructor._classRegistryKey}function Jl(a){return!function(t){if(t===null||typeof t!="object")return!1;const r=gn(t);return!(!r||r==="Object")}(a)&&(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||a instanceof Error||Pr(a)||Oa(a)||ArrayBuffer.isView(a)||a instanceof ImageData)}function Bs(a,t){if(Jl(a))return(Pr(a)||Oa(a))&&t&&t.push(a),ArrayBuffer.isView(a)&&t&&t.push(a.buffer),a instanceof ImageData&&t&&t.push(a.data.buffer),a;if(Array.isArray(a)){const g=[];for(const _ of a)g.push(Bs(_,t));return g}if(typeof a!="object")throw new Error("can't serialize object of type "+typeof a);const r=gn(a);if(!r)throw new Error(`can't serialize object of unregistered class ${a.constructor.name}`);if(!zr[r])throw new Error(`${r} is not registered.`);const{klass:o}=zr[r],h=o.serialize?o.serialize(a,t):{};if(o.serialize){if(t&&h===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const g in a){if(!a.hasOwnProperty(g)||zr[r].omit.indexOf(g)>=0)continue;const _=a[g];h[g]=zr[r].shallow.indexOf(g)>=0?_:Bs(_,t)}a instanceof Error&&(h.message=a.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return r!=="Object"&&(h.$name=r),h}function ec(a){if(Jl(a))return a;if(Array.isArray(a))return a.map(ec);if(typeof a!="object")throw new Error("can't deserialize object of type "+typeof a);const t=gn(a)||"Object";if(!zr[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:r}=zr[t];if(!r)throw new Error(`can't deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(a);const o=Object.create(r.prototype);for(const h of Object.keys(a)){if(h==="$name")continue;const g=a[h];o[h]=zr[t].shallow.indexOf(h)>=0?g:ec(g)}return o}class tu{constructor(){this.first=!0}update(t,r){const o=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=o,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=o,!0):(this.lastFloorZoom>o?(this.lastIntegerZoom=o+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<o&&(this.lastIntegerZoom=o,this.lastIntegerZoomTime=r),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=o,!0))}}const Tt={"Latin-1 Supplement":a=>a>=128&&a<=255,"Hangul Jamo":a=>a>=4352&&a<=4607,Khmer:a=>a>=6016&&a<=6143,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Kanbun:a=>a>=12688&&a<=12703,"CJK Strokes":a=>a>=12736&&a<=12783,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Hangul Syllables":a=>a>=44032&&a<=55215,"Private Use Area":a=>a>=57344&&a<=63743,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function nl(a){for(const t of a)if($u(t.charCodeAt(0)))return!0;return!1}function rl(a){for(const t of a)if(!js(t.charCodeAt(0)))return!1;return!0}function Os(a){const t=a.map(r=>{try{return new RegExp(`\\p{sc=${r}}`,"u").source}catch{return null}}).filter(r=>r);return new RegExp(t.join("|"),"u")}const iu=Os(["Arab","Dupl","Mong","Ougr","Syrc"]);function js(a){return!iu.test(String.fromCodePoint(a))}const Fs=Os(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function $u(a){return!(a!==746&&a!==747&&(a<4352||!(Tt["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||Tt["CJK Compatibility"](a)||Tt["CJK Strokes"](a)||!(!Tt["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||Tt["Enclosed CJK Letters and Months"](a)||Tt["Ideographic Description Characters"](a)||Tt.Kanbun(a)||Tt.Katakana(a)&&a!==12540||!(!Tt["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!Tt["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||Tt["Vertical Forms"](a)||Tt["Yijing Hexagram Symbols"](a)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(a))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(a))||Fs.test(String.fromCodePoint(a)))))}function nu(a){return!($u(a)||function(t){return!!(Tt["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Tt["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Tt["Letterlike Symbols"](t)||Tt["Number Forms"](t)||Tt["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Tt["Control Pictures"](t)&&t!==9251||Tt["Optical Character Recognition"](t)||Tt["Enclosed Alphanumerics"](t)||Tt["Geometric Shapes"](t)||Tt["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Tt["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Tt["CJK Symbols and Punctuation"](t)||Tt.Katakana(t)||Tt["Private Use Area"](t)||Tt["CJK Compatibility Forms"](t)||Tt["Small Form Variants"](t)||Tt["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(a))}const Ad=Os(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function ru(a){return Ad.test(String.fromCodePoint(a))}function Ns(a,t){return!(!t&&ru(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||Tt.Khmer(a))}function au(a){for(const t of a)if(ru(t.charCodeAt(0)))return!0;return!1}const Aa=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(a){this.pluginStatus=a.pluginStatus,this.pluginURL=a.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(a){if(Aa.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=a.applyArabicShaping,this.processBidirectionalText=a.processBidirectionalText,this.processStyledBidirectionalText=a.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(a,t){return d(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(a.pluginStatus!=="loading")return this.setState(a),a;const r=a.pluginURL,o=new Promise(g=>{this.loadScriptResolve=g});t(r);const h=new Promise(g=>setTimeout(()=>g(),this.TIMEOUT));if(yield Promise.race([o,h]),this.isParsed()){const g={pluginStatus:"loaded",pluginURL:r};return this.setState(g),g}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${r}`)})}};class Pi{constructor(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new tu,this.transition={})}isSupportedScript(t){return function(r,o){for(const h of r)if(!Ns(h.charCodeAt(0),o))return!1;return!0}(t,Aa.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,r=t-Math.floor(t),o=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*o}:{fromScale:.5,toScale:1,t:1-(1-o)*r}}}class ca{constructor(t,r){this.property=t,this.value=r,this.expression=function(o,h){if(Hl(o))return new fs(o,h);if(Xl(o)){const g=Hr(o,h);if(g.result==="error")throw new Error(g.value.map(_=>`${_.key}: ${_.message}`).join(", "));return g.value}{let g=o;return h.type==="color"&&typeof o=="string"?g=Xt.parse(o):h.type!=="padding"||typeof o!="number"&&!Array.isArray(o)?h.type==="variableAnchorOffsetCollection"&&Array.isArray(o)?g=bn.parse(o):h.type==="projectionDefinition"&&typeof o=="string"&&(g=Mr.parse(o)):g=Un.parse(o),{kind:"constant",evaluate:()=>g}}}(r===void 0?t.specification.default:r,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,r,o){return this.property.possiblyEvaluate(this,t,r,o)}}class Gt{constructor(t){this.property=t,this.value=new ca(t,void 0)}transitioned(t,r){return new sn(this.property,this.value,r,Rt({},t.transition,this.transition),t.now)}untransitioned(){return new sn(this.property,this.value,null,{},0)}}class di{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return ui(this._values[t].value.value)}setValue(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Gt(this._values[t].property)),this._values[t].value=new ca(this._values[t].property,r===null?void 0:ui(r))}getTransition(t){return ui(this._values[t].transition)}setTransition(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Gt(this._values[t].property)),this._values[t].transition=ui(r)||void 0}serialize(){const t={};for(const r of Object.keys(this._values)){const o=this.getValue(r);o!==void 0&&(t[r]=o);const h=this.getTransition(r);h!==void 0&&(t[`${r}-transition`]=h)}return t}transitioned(t,r){const o=new Us(this._properties);for(const h of Object.keys(this._values))o._values[h]=this._values[h].transitioned(t,r._values[h]);return o}untransitioned(){const t=new Us(this._properties);for(const r of Object.keys(this._values))t._values[r]=this._values[r].untransitioned();return t}}class sn{constructor(t,r,o,h,g){this.property=t,this.value=r,this.begin=g+h.delay||0,this.end=this.begin+h.duration||0,t.specification.transition&&(h.delay||h.duration)&&(this.prior=o)}possiblyEvaluate(t,r,o){const h=t.now||0,g=this.value.possiblyEvaluate(t,r,o),_=this.prior;if(_){if(h>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(h<this.begin)return _.possiblyEvaluate(t,r,o);{const v=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(t,r,o),g,fe(v))}}return g}}class Us{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,r,o){const h=new go(this._properties);for(const g of Object.keys(this._values))h._values[g]=this._values[g].possiblyEvaluate(t,r,o);return h}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class al{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return ui(this._values[t].value)}setValue(t,r){this._values[t]=new ca(this._values[t].property,r===null?void 0:ui(r))}serialize(){const t={};for(const r of Object.keys(this._values)){const o=this.getValue(r);o!==void 0&&(t[r]=o)}return t}possiblyEvaluate(t,r,o){const h=new go(this._properties);for(const g of Object.keys(this._values))h._values[g]=this._values[g].possiblyEvaluate(t,r,o);return h}}class Vn{constructor(t,r,o){this.property=t,this.value=r,this.parameters=o}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,r,o,h){return this.property.evaluate(this.value,this.parameters,t,r,o,h)}}class go{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class mt{constructor(t){this.specification=t}possiblyEvaluate(t,r){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(r)}interpolate(t,r,o){const h=Zr[this.specification.type];return h?h(t,r,o):t}}class yt{constructor(t,r){this.specification=t,this.overrides=r}possiblyEvaluate(t,r,o,h){return new Vn(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(r,null,{},o,h)}:t.expression,r)}interpolate(t,r,o){if(t.value.kind!=="constant"||r.value.kind!=="constant")return t;if(t.value.value===void 0||r.value.value===void 0)return new Vn(this,{kind:"constant",value:void 0},t.parameters);const h=Zr[this.specification.type];if(h){const g=h(t.value.value,r.value.value,o);return new Vn(this,{kind:"constant",value:g},t.parameters)}return t}evaluate(t,r,o,h,g,_){return t.kind==="constant"?t.value:t.evaluate(r,o,h,g,_)}}class tc extends yt{possiblyEvaluate(t,r,o,h){if(t.value===void 0)return new Vn(this,{kind:"constant",value:void 0},r);if(t.expression.kind==="constant"){const g=t.expression.evaluate(r,null,{},o,h),_=t.property.specification.type==="resolvedImage"&&typeof g!="string"?g.name:g,v=this._calculate(_,_,_,r);return new Vn(this,{kind:"constant",value:v},r)}if(t.expression.kind==="camera"){const g=this._calculate(t.expression.evaluate({zoom:r.zoom-1}),t.expression.evaluate({zoom:r.zoom}),t.expression.evaluate({zoom:r.zoom+1}),r);return new Vn(this,{kind:"constant",value:g},r)}return new Vn(this,t.expression,r)}evaluate(t,r,o,h,g,_){if(t.kind==="source"){const v=t.evaluate(r,o,h,g,_);return this._calculate(v,v,v,r)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(r.zoom)-1},o,h),t.evaluate({zoom:Math.floor(r.zoom)},o,h),t.evaluate({zoom:Math.floor(r.zoom)+1},o,h),r):t.value}_calculate(t,r,o,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:o,to:r}}interpolate(t){return t}}class Vi{constructor(t){this.specification=t}possiblyEvaluate(t,r,o,h){if(t.value!==void 0){if(t.expression.kind==="constant"){const g=t.expression.evaluate(r,null,{},o,h);return this._calculate(g,g,g,r)}return this._calculate(t.expression.evaluate(new Pi(Math.floor(r.zoom-1),r)),t.expression.evaluate(new Pi(Math.floor(r.zoom),r)),t.expression.evaluate(new Pi(Math.floor(r.zoom+1),r)),r)}}_calculate(t,r,o,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:o,to:r}}interpolate(t){return t}}class ic{constructor(t){this.specification=t}possiblyEvaluate(t,r,o,h){return!!t.expression.evaluate(r,null,{},o,h)}interpolate(){return!1}}class lr{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const r in t){const o=t[r];o.specification.overridable&&this.overridableProperties.push(r);const h=this.defaultPropertyValues[r]=new ca(o,void 0),g=this.defaultTransitionablePropertyValues[r]=new Gt(o);this.defaultTransitioningPropertyValues[r]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=h.possiblyEvaluate({})}}}nt("DataDrivenProperty",yt),nt("DataConstantProperty",mt),nt("CrossFadedDataDrivenProperty",tc),nt("CrossFadedProperty",Vi),nt("ColorRampProperty",ic);const Xu="-transition";class za extends ye{constructor(t,r){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),r.layout&&(this._unevaluatedLayout=new al(r.layout)),r.paint)){this._transitionablePaint=new di(r.paint);for(const o in t.paint)this.setPaintProperty(o,t.paint[o],{validate:!1});for(const o in t.layout)this.setLayoutProperty(o,t.layout[o],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new go(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,r,o={}){r!=null&&this._validate(oa,`layers.${this.id}.layout.${t}`,t,r,o)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,r):this.visibility=r)}getPaintProperty(t){return t.endsWith(Xu)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,r,o={}){if(r!=null&&this._validate(Wl,`layers.${this.id}.paint.${t}`,t,r,o))return!1;if(t.endsWith(Xu))return this._transitionablePaint.setTransition(t.slice(0,-11),r||void 0),!1;{const h=this._transitionablePaint._values[t],g=h.property.specification["property-type"]==="cross-faded-data-driven",_=h.value.isDataDriven(),v=h.value;this._transitionablePaint.setValue(t,r),this._handleSpecialPaintPropertyUpdate(t);const w=this._transitionablePaint._values[t].value;return w.isDataDriven()||_||g||this._handleOverridablePaintPropertyUpdate(t,v,w)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,r,o){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,r){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,r)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),ei(t,(r,o)=>!(r===void 0||o==="layout"&&!Object.keys(r).length||o==="paint"&&!Object.keys(r).length))}_validate(t,r,o,h,g={}){return(!g||g.validate!==!1)&&Xr(this,t.call(_s,{key:r,layerType:this.type,objectKey:o,value:h,styleSpec:P,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const r=this.paint.get(t);if(r instanceof Vn&&Ko(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}}const zd={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ua{constructor(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ii{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,r){return t._trim(),r&&(t.isTransferred=!0,r.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const r=Object.create(this.prototype);return r.arrayBuffer=t.arrayBuffer,r.length=t.length,r.capacity=t.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Xi(a,t=1){let r=0,o=0;return{members:a.map(h=>{const g=zd[h.type].BYTES_PER_ELEMENT,_=r=br(r,Math.max(t,g)),v=h.components||1;return o=Math.max(o,g),r+=g*v,{name:h.name,type:h.type,components:v,offset:_}}),size:br(r,Math.max(o,t)),alignment:t}}function br(a,t){return Math.ceil(a/t)*t}class Ri extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r){const o=this.length;return this.resize(o+1),this.emplace(o,t,r)}emplace(t,r,o){const h=2*t;return this.int16[h+0]=r,this.int16[h+1]=o,t}}Ri.prototype.bytesPerElement=4,nt("StructArrayLayout2i4",Ri);class _o extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,o){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,o)}emplace(t,r,o,h){const g=3*t;return this.int16[g+0]=r,this.int16[g+1]=o,this.int16[g+2]=h,t}}_o.prototype.bytesPerElement=6,nt("StructArrayLayout3i6",_o);class yo extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,o,h){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,o,h)}emplace(t,r,o,h,g){const _=4*t;return this.int16[_+0]=r,this.int16[_+1]=o,this.int16[_+2]=h,this.int16[_+3]=g,t}}yo.prototype.bytesPerElement=8,nt("StructArrayLayout4i8",yo);class ha extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,o,h,g,_){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,o,h,g,_)}emplace(t,r,o,h,g,_,v){const w=6*t;return this.int16[w+0]=r,this.int16[w+1]=o,this.int16[w+2]=h,this.int16[w+3]=g,this.int16[w+4]=_,this.int16[w+5]=v,t}}ha.prototype.bytesPerElement=12,nt("StructArrayLayout2i4i12",ha);class sl extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,o,h,g,_){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,o,h,g,_)}emplace(t,r,o,h,g,_,v){const w=4*t,M=8*t;return this.int16[w+0]=r,this.int16[w+1]=o,this.uint8[M+4]=h,this.uint8[M+5]=g,this.uint8[M+6]=_,this.uint8[M+7]=v,t}}sl.prototype.bytesPerElement=8,nt("StructArrayLayout2i4ub8",sl);class wr extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r){const o=this.length;return this.resize(o+1),this.emplace(o,t,r)}emplace(t,r,o){const h=2*t;return this.float32[h+0]=r,this.float32[h+1]=o,t}}wr.prototype.bytesPerElement=8,nt("StructArrayLayout2f8",wr);class vo extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,o,h,g,_,v,w,M,C){const A=this.length;return this.resize(A+1),this.emplace(A,t,r,o,h,g,_,v,w,M,C)}emplace(t,r,o,h,g,_,v,w,M,C,A){const R=10*t;return this.uint16[R+0]=r,this.uint16[R+1]=o,this.uint16[R+2]=h,this.uint16[R+3]=g,this.uint16[R+4]=_,this.uint16[R+5]=v,this.uint16[R+6]=w,this.uint16[R+7]=M,this.uint16[R+8]=C,this.uint16[R+9]=A,t}}vo.prototype.bytesPerElement=20,nt("StructArrayLayout10ui20",vo);class xo extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,o,h,g,_,v,w,M,C,A,R){const k=this.length;return this.resize(k+1),this.emplace(k,t,r,o,h,g,_,v,w,M,C,A,R)}emplace(t,r,o,h,g,_,v,w,M,C,A,R,k){const j=12*t;return this.int16[j+0]=r,this.int16[j+1]=o,this.int16[j+2]=h,this.int16[j+3]=g,this.uint16[j+4]=_,this.uint16[j+5]=v,this.uint16[j+6]=w,this.uint16[j+7]=M,this.int16[j+8]=C,this.int16[j+9]=A,this.int16[j+10]=R,this.int16[j+11]=k,t}}xo.prototype.bytesPerElement=24,nt("StructArrayLayout4i4ui4i24",xo);class nc extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,o){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,o)}emplace(t,r,o,h){const g=3*t;return this.float32[g+0]=r,this.float32[g+1]=o,this.float32[g+2]=h,t}}nc.prototype.bytesPerElement=12,nt("StructArrayLayout3f12",nc);class bo extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint32[1*t+0]=r,t}}bo.prototype.bytesPerElement=4,nt("StructArrayLayout1ul4",bo);class Vs extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,o,h,g,_,v,w,M){const C=this.length;return this.resize(C+1),this.emplace(C,t,r,o,h,g,_,v,w,M)}emplace(t,r,o,h,g,_,v,w,M,C){const A=10*t,R=5*t;return this.int16[A+0]=r,this.int16[A+1]=o,this.int16[A+2]=h,this.int16[A+3]=g,this.int16[A+4]=_,this.int16[A+5]=v,this.uint32[R+3]=w,this.uint16[A+8]=M,this.uint16[A+9]=C,t}}Vs.prototype.bytesPerElement=20,nt("StructArrayLayout6i1ul2ui20",Vs);class su extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,o,h,g,_){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,o,h,g,_)}emplace(t,r,o,h,g,_,v){const w=6*t;return this.int16[w+0]=r,this.int16[w+1]=o,this.int16[w+2]=h,this.int16[w+3]=g,this.int16[w+4]=_,this.int16[w+5]=v,t}}su.prototype.bytesPerElement=12,nt("StructArrayLayout2i2i2i12",su);class rc extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,o,h,g){const _=this.length;return this.resize(_+1),this.emplace(_,t,r,o,h,g)}emplace(t,r,o,h,g,_){const v=4*t,w=8*t;return this.float32[v+0]=r,this.float32[v+1]=o,this.float32[v+2]=h,this.int16[w+6]=g,this.int16[w+7]=_,t}}rc.prototype.bytesPerElement=16,nt("StructArrayLayout2f1f2i16",rc);class Zs extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,o,h,g,_){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,o,h,g,_)}emplace(t,r,o,h,g,_,v){const w=16*t,M=4*t,C=8*t;return this.uint8[w+0]=r,this.uint8[w+1]=o,this.float32[M+1]=h,this.float32[M+2]=g,this.int16[C+6]=_,this.int16[C+7]=v,t}}Zs.prototype.bytesPerElement=16,nt("StructArrayLayout2ub2f2i16",Zs);class ac extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,o){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,o)}emplace(t,r,o,h){const g=3*t;return this.uint16[g+0]=r,this.uint16[g+1]=o,this.uint16[g+2]=h,t}}ac.prototype.bytesPerElement=6,nt("StructArrayLayout3ui6",ac);class sc extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,o,h,g,_,v,w,M,C,A,R,k,j,U,H,Q){const ue=this.length;return this.resize(ue+1),this.emplace(ue,t,r,o,h,g,_,v,w,M,C,A,R,k,j,U,H,Q)}emplace(t,r,o,h,g,_,v,w,M,C,A,R,k,j,U,H,Q,ue){const te=24*t,L=12*t,G=48*t;return this.int16[te+0]=r,this.int16[te+1]=o,this.uint16[te+2]=h,this.uint16[te+3]=g,this.uint32[L+2]=_,this.uint32[L+3]=v,this.uint32[L+4]=w,this.uint16[te+10]=M,this.uint16[te+11]=C,this.uint16[te+12]=A,this.float32[L+7]=R,this.float32[L+8]=k,this.uint8[G+36]=j,this.uint8[G+37]=U,this.uint8[G+38]=H,this.uint32[L+10]=Q,this.int16[te+22]=ue,t}}sc.prototype.bytesPerElement=48,nt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",sc);class oc extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,o,h,g,_,v,w,M,C,A,R,k,j,U,H,Q,ue,te,L,G,ie,Te,qe,Ae,De,Xe,$e){const Ye=this.length;return this.resize(Ye+1),this.emplace(Ye,t,r,o,h,g,_,v,w,M,C,A,R,k,j,U,H,Q,ue,te,L,G,ie,Te,qe,Ae,De,Xe,$e)}emplace(t,r,o,h,g,_,v,w,M,C,A,R,k,j,U,H,Q,ue,te,L,G,ie,Te,qe,Ae,De,Xe,$e,Ye){const Be=32*t,ut=16*t;return this.int16[Be+0]=r,this.int16[Be+1]=o,this.int16[Be+2]=h,this.int16[Be+3]=g,this.int16[Be+4]=_,this.int16[Be+5]=v,this.int16[Be+6]=w,this.int16[Be+7]=M,this.uint16[Be+8]=C,this.uint16[Be+9]=A,this.uint16[Be+10]=R,this.uint16[Be+11]=k,this.uint16[Be+12]=j,this.uint16[Be+13]=U,this.uint16[Be+14]=H,this.uint16[Be+15]=Q,this.uint16[Be+16]=ue,this.uint16[Be+17]=te,this.uint16[Be+18]=L,this.uint16[Be+19]=G,this.uint16[Be+20]=ie,this.uint16[Be+21]=Te,this.uint16[Be+22]=qe,this.uint32[ut+12]=Ae,this.float32[ut+13]=De,this.float32[ut+14]=Xe,this.uint16[Be+30]=$e,this.uint16[Be+31]=Ye,t}}oc.prototype.bytesPerElement=64,nt("StructArrayLayout8i15ui1ul2f2ui64",oc);class ou extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.float32[1*t+0]=r,t}}ou.prototype.bytesPerElement=4,nt("StructArrayLayout1f4",ou);class f extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,o){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,o)}emplace(t,r,o,h){const g=3*t;return this.uint16[6*t+0]=r,this.float32[g+1]=o,this.float32[g+2]=h,t}}f.prototype.bytesPerElement=12,nt("StructArrayLayout1ui2f12",f);class e extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,o){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,o)}emplace(t,r,o,h){const g=4*t;return this.uint32[2*t+0]=r,this.uint16[g+2]=o,this.uint16[g+3]=h,t}}e.prototype.bytesPerElement=8,nt("StructArrayLayout1ul2ui8",e);class n extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r){const o=this.length;return this.resize(o+1),this.emplace(o,t,r)}emplace(t,r,o){const h=2*t;return this.uint16[h+0]=r,this.uint16[h+1]=o,t}}n.prototype.bytesPerElement=4,nt("StructArrayLayout2ui4",n);class l extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint16[1*t+0]=r,t}}l.prototype.bytesPerElement=2,nt("StructArrayLayout1ui2",l);class u extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,o,h){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,o,h)}emplace(t,r,o,h,g){const _=4*t;return this.float32[_+0]=r,this.float32[_+1]=o,this.float32[_+2]=h,this.float32[_+3]=g,t}}u.prototype.bytesPerElement=16,nt("StructArrayLayout4f16",u);class m extends ua{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new st(this.anchorPointX,this.anchorPointY)}}m.prototype.size=20;class y extends Vs{get(t){return new m(this,t)}}nt("CollisionBoxArray",y);class b extends ua{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}b.prototype.size=48;class T extends sc{get(t){return new b(this,t)}}nt("PlacedSymbolArray",T);class E extends ua{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}E.prototype.size=64;class z extends oc{get(t){return new E(this,t)}}nt("SymbolInstanceArray",z);class D extends ou{getoffsetX(t){return this.float32[1*t+0]}}nt("GlyphOffsetArray",D);class I extends _o{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}nt("SymbolLineVertexArray",I);class F extends ua{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}F.prototype.size=12;class N extends f{get(t){return new F(this,t)}}nt("TextAnchorOffsetArray",N);class Y extends ua{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Y.prototype.size=8;class X extends e{get(t){return new Y(this,t)}}nt("FeatureIndexArray",X);class K extends Ri{}class J extends Ri{}class re extends Ri{}class ae extends ha{}class oe extends sl{}class he extends wr{}class ce extends vo{}class we extends xo{}class Me extends nc{}class ke extends bo{}class Le extends su{}class Ie extends Zs{}class et extends ac{}class We extends n{}const Ge=Xi([{name:"a_pos",components:2,type:"Int16"}],4),{members:ft}=Ge;class _t{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,r,o,h){const g=this.segments[this.segments.length-1];return t>_t.MAX_VERTEX_ARRAY_LENGTH&&Di(`Max vertices per segment is ${_t.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${_t.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!g||g.vertexLength+t>_t.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==h?this.createNewSegment(r,o,h):g}createNewSegment(t,r,o){const h={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0,vaos:{}};return o!==void 0&&(h.sortKey=o),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(h),h}getOrCreateLatestSegment(t,r,o){return this.prepareSegment(0,t,r,o)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const r in t.vaos)t.vaos[r].destroy()}static simpleSegment(t,r,o,h){return new _t([{vertexOffset:t,primitiveOffset:r,vertexLength:o,primitiveLength:h,vaos:{},sortKey:0}])}}function oi(a,t){return 256*(a=xt(Math.floor(a),0,255))+xt(Math.floor(t),0,255)}_t.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,nt("SegmentVector",_t);const Si=Xi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var fi,_i,xi,ii={exports:{}},pi={exports:{}},kn={exports:{}},Mi=function(){if(xi)return ii.exports;xi=1;var a=(fi||(fi=1,pi.exports=function(r,o){var h,g,_,v,w,M,C,A;for(g=r.length-(h=3&r.length),_=o,w=3432918353,M=461845907,A=0;A<g;)C=255&r.charCodeAt(A)|(255&r.charCodeAt(++A))<<8|(255&r.charCodeAt(++A))<<16|(255&r.charCodeAt(++A))<<24,++A,_=27492+(65535&(v=5*(65535&(_=(_^=C=(65535&(C=(C=(65535&C)*w+(((C>>>16)*w&65535)<<16)&4294967295)<<15|C>>>17))*M+(((C>>>16)*M&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(C=0,h){case 3:C^=(255&r.charCodeAt(A+2))<<16;case 2:C^=(255&r.charCodeAt(A+1))<<8;case 1:_^=C=(65535&(C=(C=(65535&(C^=255&r.charCodeAt(A)))*w+(((C>>>16)*w&65535)<<16)&4294967295)<<15|C>>>17))*M+(((C>>>16)*M&65535)<<16)&4294967295}return _^=r.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0}),pi.exports),t=(_i||(_i=1,kn.exports=function(r,o){for(var h,g=r.length,_=o^g,v=0;g>=4;)h=1540483477*(65535&(h=255&r.charCodeAt(v)|(255&r.charCodeAt(++v))<<8|(255&r.charCodeAt(++v))<<16|(255&r.charCodeAt(++v))<<24))+((1540483477*(h>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),g-=4,++v;switch(g){case 3:_^=(255&r.charCodeAt(v+2))<<16;case 2:_^=(255&r.charCodeAt(v+1))<<8;case 1:_=1540483477*(65535&(_^=255&r.charCodeAt(v)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0}),kn.exports);return ii.exports=a,ii.exports.murmur3=a,ii.exports.murmur2=t,ii.exports}(),ki=it(Mi);class Zi{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,r,o,h){this.ids.push(Dr(t)),this.positions.push(r,o,h)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const r=Dr(t);let o=0,h=this.ids.length-1;for(;o<h;){const _=o+h>>1;this.ids[_]>=r?h=_:o=_+1}const g=[];for(;this.ids[o]===r;)g.push({index:this.positions[3*o],start:this.positions[3*o+1],end:this.positions[3*o+2]}),o++;return g}static serialize(t,r){const o=new Float64Array(t.ids),h=new Uint32Array(t.positions);return Pa(o,h,0,o.length-1),r&&r.push(o.buffer,h.buffer),{ids:o,positions:h}}static deserialize(t){const r=new Zi;return r.ids=t.ids,r.positions=t.positions,r.indexed=!0,r}}function Dr(a){const t=+a;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:ki(String(a))}function Pa(a,t,r,o){for(;r<o;){const h=a[r+o>>1];let g=r-1,_=o+1;for(;;){do g++;while(a[g]<h);do _--;while(a[_]>h);if(g>=_)break;da(a,g,_),da(t,3*g,3*_),da(t,3*g+1,3*_+1),da(t,3*g+2,3*_+2)}_-r<o-_?(Pa(a,t,r,_),r=_+1):(Pa(a,t,_+1,o),o=_)}}function da(a,t,r){const o=a[t];a[t]=a[r],a[r]=o}nt("FeaturePositionMap",Zi);class Yr{constructor(t,r){this.gl=t.gl,this.location=r}}class Gs extends Yr{constructor(t,r){super(t,r),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class Da extends Yr{constructor(t,r){super(t,r),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Qa extends Yr{constructor(t,r){super(t,r),this.current=Xt.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const Kr=new Float32Array(16);function Ia(a){return[oi(255*a.r,255*a.g),oi(255*a.b,255*a.a)]}class fa{constructor(t,r,o){this.value=t,this.uniformNames=r.map(h=>`u_${h}`),this.type=o}setUniform(t,r,o){t.set(o.constantOr(this.value))}getBinding(t,r,o){return this.type==="color"?new Qa(t,r):new Gs(t,r)}}class Qr{constructor(t,r){this.uniformNames=r.map(o=>`u_${o}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=t.tlbr}setUniform(t,r,o,h){const g=h==="u_pattern_to"?this.patternTo:h==="u_pattern_from"?this.patternFrom:h==="u_pixel_ratio_to"?this.pixelRatioTo:h==="u_pixel_ratio_from"?this.pixelRatioFrom:null;g&&t.set(g)}getBinding(t,r,o){return o.substr(0,9)==="u_pattern"?new Da(t,r):new Gs(t,r)}}class bi{constructor(t,r,o,h){this.expression=t,this.type=o,this.maxValue=0,this.paintVertexAttributes=r.map(g=>({name:`a_${g}`,type:"Float32",components:o==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(t,r,o,h,g){const _=this.paintVertexArray.length,v=this.expression.evaluate(new Pi(0),r,{},h,[],g);this.paintVertexArray.resize(t),this._setPaintValue(_,t,v)}updatePaintArray(t,r,o,h){const g=this.expression.evaluate({zoom:0},o,h);this._setPaintValue(t,r,g)}_setPaintValue(t,r,o){if(this.type==="color"){const h=Ia(o);for(let g=t;g<r;g++)this.paintVertexArray.emplace(g,h[0],h[1])}else{for(let h=t;h<r;h++)this.paintVertexArray.emplace(h,o);this.maxValue=Math.max(this.maxValue,Math.abs(o))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class mi{constructor(t,r,o,h,g,_){this.expression=t,this.uniformNames=r.map(v=>`u_${v}_t`),this.type=o,this.useIntegerZoom=h,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=r.map(v=>({name:`a_${v}`,type:"Float32",components:o==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(t,r,o,h,g){const _=this.expression.evaluate(new Pi(this.zoom),r,{},h,[],g),v=this.expression.evaluate(new Pi(this.zoom+1),r,{},h,[],g),w=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(w,t,_,v)}updatePaintArray(t,r,o,h){const g=this.expression.evaluate({zoom:this.zoom},o,h),_=this.expression.evaluate({zoom:this.zoom+1},o,h);this._setPaintValue(t,r,g,_)}_setPaintValue(t,r,o,h){if(this.type==="color"){const g=Ia(o),_=Ia(h);for(let v=t;v<r;v++)this.paintVertexArray.emplace(v,g[0],g[1],_[0],_[1])}else{for(let g=t;g<r;g++)this.paintVertexArray.emplace(g,o,h);this.maxValue=Math.max(this.maxValue,Math.abs(o),Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,r){const o=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,h=xt(this.expression.interpolationFactor(o,this.zoom,this.zoom+1),0,1);t.set(h)}getBinding(t,r,o){return new Gs(t,r)}}class Tn{constructor(t,r,o,h,g,_){this.expression=t,this.type=r,this.useIntegerZoom=o,this.zoom=h,this.layerId=_,this.zoomInPaintVertexArray=new g,this.zoomOutPaintVertexArray=new g}populatePaintArray(t,r,o){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(h,t,r.patterns&&r.patterns[this.layerId],o)}updatePaintArray(t,r,o,h,g){this._setPaintValues(t,r,o.patterns&&o.patterns[this.layerId],g)}_setPaintValues(t,r,o,h){if(!h||!o)return;const{min:g,mid:_,max:v}=o,w=h[g],M=h[_],C=h[v];if(w&&M&&C)for(let A=t;A<r;A++)this.zoomInPaintVertexArray.emplace(A,M.tl[0],M.tl[1],M.br[0],M.br[1],w.tl[0],w.tl[1],w.br[0],w.br[1],M.pixelRatio,w.pixelRatio),this.zoomOutPaintVertexArray.emplace(A,M.tl[0],M.tl[1],M.br[0],M.br[1],C.tl[0],C.tl[1],C.br[0],C.br[1],M.pixelRatio,C.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Si.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Si.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Sn{constructor(t,r,o){this.binders={},this._buffers=[];const h=[];for(const g in t.paint._values){if(!o(g))continue;const _=t.paint.get(g);if(!(_ instanceof Vn&&Ko(_.property.specification)))continue;const v=Nh(g,t.type),w=_.value,M=_.property.specification.type,C=_.property.useIntegerZoom,A=_.property.specification["property-type"],R=A==="cross-faded"||A==="cross-faded-data-driven";if(w.kind==="constant")this.binders[g]=R?new Qr(w.value,v):new fa(w.value,v,M),h.push(`/u_${g}`);else if(w.kind==="source"||R){const k=Ln(g,M,"source");this.binders[g]=R?new Tn(w,M,C,r,k,t.id):new bi(w,v,M,k),h.push(`/a_${g}`)}else{const k=Ln(g,M,"composite");this.binders[g]=new mi(w,v,M,C,r,k),h.push(`/z_${g}`)}}this.cacheKey=h.sort().join("")}getMaxValue(t){const r=this.binders[t];return r instanceof bi||r instanceof mi?r.maxValue:0}populatePaintArrays(t,r,o,h,g){for(const _ in this.binders){const v=this.binders[_];(v instanceof bi||v instanceof mi||v instanceof Tn)&&v.populatePaintArray(t,r,o,h,g)}}setConstantPatternPositions(t,r){for(const o in this.binders){const h=this.binders[o];h instanceof Qr&&h.setConstantPatternPositions(t,r)}}updatePaintArrays(t,r,o,h,g){let _=!1;for(const v in t){const w=r.getPositions(v);for(const M of w){const C=o.feature(M.index);for(const A in this.binders){const R=this.binders[A];if((R instanceof bi||R instanceof mi||R instanceof Tn)&&R.expression.isStateDependent===!0){const k=h.paint.get(A);R.expression=k.value,R.updatePaintArray(M.start,M.end,C,t[v],g),_=!0}}}}return _}defines(){const t=[];for(const r in this.binders){const o=this.binders[r];(o instanceof fa||o instanceof Qr)&&t.push(...o.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return t}getBinderAttributes(){const t=[];for(const r in this.binders){const o=this.binders[r];if(o instanceof bi||o instanceof mi)for(let h=0;h<o.paintVertexAttributes.length;h++)t.push(o.paintVertexAttributes[h].name);else if(o instanceof Tn)for(let h=0;h<Si.members.length;h++)t.push(Si.members[h].name)}return t}getBinderUniforms(){const t=[];for(const r in this.binders){const o=this.binders[r];if(o instanceof fa||o instanceof Qr||o instanceof mi)for(const h of o.uniformNames)t.push(h)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,r){const o=[];for(const h in this.binders){const g=this.binders[h];if(g instanceof fa||g instanceof Qr||g instanceof mi){for(const _ of g.uniformNames)if(r[_]){const v=g.getBinding(t,r[_],_);o.push({name:_,property:h,binding:v})}}}return o}setUniforms(t,r,o,h){for(const{name:g,property:_,binding:v}of r)this.binders[_].setUniform(v,h,o.get(_),g)}updatePaintBuffers(t){this._buffers=[];for(const r in this.binders){const o=this.binders[r];if(t&&o instanceof Tn){const h=t.fromScale===2?o.zoomInPaintVertexBuffer:o.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(o instanceof bi||o instanceof mi)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer)}}upload(t){for(const r in this.binders){const o=this.binders[r];(o instanceof bi||o instanceof mi||o instanceof Tn)&&o.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const r=this.binders[t];(r instanceof bi||r instanceof mi||r instanceof Tn)&&r.destroy()}}}class wo{constructor(t,r,o=()=>!0){this.programConfigurations={};for(const h of t)this.programConfigurations[h.id]=new Sn(h,r,o);this.needsUpload=!1,this._featureMap=new Zi,this._bufferOffset=0}populatePaintArrays(t,r,o,h,g,_){for(const v in this.programConfigurations)this.programConfigurations[v].populatePaintArrays(t,r,h,g,_);r.id!==void 0&&this._featureMap.add(r.id,o,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,r,o,h){for(const g of o)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(t,this._featureMap,r,g,h)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Nh(a,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${t}-`,"").replace(/-/g,"_")]}function Ln(a,t,r){const o={color:{source:wr,composite:u},number:{source:ou,composite:wr}},h=function(g){return{"line-pattern":{source:ce,composite:ce},"fill-pattern":{source:ce,composite:ce},"fill-extrusion-pattern":{source:ce,composite:ce}}[g]}(a);return h&&h[r]||o[t][r]}nt("ConstantBinder",fa),nt("CrossFadedConstantBinder",Qr),nt("SourceExpressionBinder",bi),nt("CrossFadedCompositeBinder",Tn),nt("CompositeExpressionBinder",mi),nt("ProgramConfiguration",Sn,{omit:["_buffers"]}),nt("ProgramConfigurationSet",wo);const Bn=Math.pow(2,14)-1,Yu=-Bn-1;function qs(a){const t=Ke/a.extent,r=a.loadGeometry();for(let o=0;o<r.length;o++){const h=r[o];for(let g=0;g<h.length;g++){const _=h[g],v=Math.round(_.x*t),w=Math.round(_.y*t);_.x=xt(v,Yu,Bn),_.y=xt(w,Yu,Bn),(v<_.x||v>_.x+1||w<_.y||w>_.y+1)&&Di("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function Ir(a,t){return{type:a.type,id:a.id,properties:a.properties,geometry:t?qs(a):[]}}const lu=-32768;function Ku(a,t,r,o,h){a.emplaceBack(lu+8*t+o,lu+8*r+h)}class Hs{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new J,this.indexArray=new et,this.segments=new _t,this.programConfigurations=new wo(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,o){const h=this.layers[0],g=[];let _=null,v=!1,w=h.type==="heatmap";if(h.type==="circle"){const C=h;_=C.layout.get("circle-sort-key"),v=!_.isConstant(),w=w||C.paint.get("circle-pitch-alignment")==="map"}const M=w?r.subdivisionGranularity.circle:1;for(const{feature:C,id:A,index:R,sourceLayerIndex:k}of t){const j=this.layers[0]._featureFilter.needGeometry,U=Ir(C,j);if(!this.layers[0]._featureFilter.filter(new Pi(this.zoom),U,o))continue;const H=v?_.evaluate(U,{},o):void 0,Q={id:A,properties:C.properties,type:C.type,sourceLayerIndex:k,index:R,geometry:j?U.geometry:qs(C),patterns:{},sortKey:H};g.push(Q)}v&&g.sort((C,A)=>C.sortKey-A.sortKey);for(const C of g){const{geometry:A,index:R,sourceLayerIndex:k}=C,j=t[R].feature;this.addFeature(C,A,R,o,M),r.featureIndex.insert(j,A,R,k,this.index)}}update(t,r,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,o)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ft),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,r,o,h,g=1){let _;switch(g){case 1:_=[0,7];break;case 3:_=[0,2,5,7];break;case 5:_=[0,1,3,4,6,7];break;case 7:_=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${g}; valid values are 1, 3, 5, 7.`)}const v=_.length;for(const w of r)for(const M of w){const C=M.x,A=M.y;if(C<0||C>=Ke||A<0||A>=Ke)continue;const R=this.segments.prepareSegment(v*v,this.layoutVertexArray,this.indexArray,t.sortKey),k=R.vertexLength;for(let j=0;j<v;j++)for(let U=0;U<v;U++)Ku(this.layoutVertexArray,C,A,_[U],_[j]);for(let j=0;j<v-1;j++)for(let U=0;U<v-1;U++){const H=k+j*v+U,Q=k+(j+1)*v+U;this.indexArray.emplaceBack(H,Q+1,H+1),this.indexArray.emplaceBack(H,Q,Q+1)}R.vertexLength+=v*v,R.primitiveLength+=(v-1)*(v-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,{},h)}}function ol(a,t){for(let r=0;r<a.length;r++)if(ll(t,a[r]))return!0;for(let r=0;r<t.length;r++)if(ll(a,t[r]))return!0;return!!Wu(a,t)}function Qu(a,t,r){return!!ll(a,t)||!!Ju(t,a,r)}function lc(a,t){if(a.length===1)return Uh(t,a[0]);for(let r=0;r<t.length;r++){const o=t[r];for(let h=0;h<o.length;h++)if(ll(a,o[h]))return!0}for(let r=0;r<a.length;r++)if(Uh(t,a[r]))return!0;for(let r=0;r<t.length;r++)if(Wu(a,t[r]))return!0;return!1}function If(a,t,r){if(a.length>1){if(Wu(a,t))return!0;for(let o=0;o<t.length;o++)if(Ju(t[o],a,r))return!0}for(let o=0;o<a.length;o++)if(Ju(a[o],t,r))return!0;return!1}function Wu(a,t){if(a.length===0||t.length===0)return!1;for(let r=0;r<a.length-1;r++){const o=a[r],h=a[r+1];for(let g=0;g<t.length-1;g++)if(Pd(o,h,t[g],t[g+1]))return!0}return!1}function Pd(a,t,r,o){return Hi(a,r,o)!==Hi(t,r,o)&&Hi(a,t,r)!==Hi(a,t,o)}function Ju(a,t,r){const o=r*r;if(t.length===1)return a.distSqr(t[0])<o;for(let h=1;h<t.length;h++)if(Dd(a,t[h-1],t[h])<o)return!0;return!1}function Dd(a,t,r){const o=t.distSqr(r);if(o===0)return a.distSqr(t);const h=((a.x-t.x)*(r.x-t.x)+(a.y-t.y)*(r.y-t.y))/o;return a.distSqr(h<0?t:h>1?r:r.sub(t)._mult(h)._add(t))}function Uh(a,t){let r,o,h,g=!1;for(let _=0;_<a.length;_++){r=a[_];for(let v=0,w=r.length-1;v<r.length;w=v++)o=r[v],h=r[w],o.y>t.y!=h.y>t.y&&t.x<(h.x-o.x)*(t.y-o.y)/(h.y-o.y)+o.x&&(g=!g)}return g}function ll(a,t){let r=!1;for(let o=0,h=a.length-1;o<a.length;h=o++){const g=a[o],_=a[h];g.y>t.y!=_.y>t.y&&t.x<(_.x-g.x)*(t.y-g.y)/(_.y-g.y)+g.x&&(r=!r)}return r}function Id(a,t,r){const o=r[0],h=r[2];if(a.x<o.x&&t.x<o.x||a.x>h.x&&t.x>h.x||a.y<o.y&&t.y<o.y||a.y>h.y&&t.y>h.y)return!1;const g=Hi(a,t,r[0]);return g!==Hi(a,t,r[1])||g!==Hi(a,t,r[2])||g!==Hi(a,t,r[3])}function cu(a,t,r){const o=t.paint.get(a).value;return o.kind==="constant"?o.value:r.programConfigurations.get(t.id).getMaxValue(a)}function uu(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function eh(a,t,r,o,h){if(!t[0]&&!t[1])return a;const g=st.convert(t)._mult(h);r==="viewport"&&g._rotate(-o);const _=[];for(let v=0;v<a.length;v++)_.push(a[v].sub(g));return _}let $s,Vh;nt("CircleBucket",Hs,{omit:["layers"]});var up={get paint(){return Vh=Vh||new lr({"circle-radius":new yt(P.paint_circle["circle-radius"]),"circle-color":new yt(P.paint_circle["circle-color"]),"circle-blur":new yt(P.paint_circle["circle-blur"]),"circle-opacity":new yt(P.paint_circle["circle-opacity"]),"circle-translate":new mt(P.paint_circle["circle-translate"]),"circle-translate-anchor":new mt(P.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new mt(P.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new mt(P.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new yt(P.paint_circle["circle-stroke-width"]),"circle-stroke-color":new yt(P.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new yt(P.paint_circle["circle-stroke-opacity"])})},get layout(){return $s=$s||new lr({"circle-sort-key":new yt(P.layout_circle["circle-sort-key"])})}};class Rf extends za{constructor(t){super(t,up)}createBucket(t){return new Hs(t)}queryRadius(t){const r=t;return cu("circle-radius",this,r)+cu("circle-stroke-width",this,r)+uu(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:o,geometry:h,transform:g,pixelsToTileUnits:_,pixelPosMatrix:v}){const w=eh(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-g.bearingInRadians,_),M=this.paint.get("circle-radius").evaluate(r,o)+this.paint.get("circle-stroke-width").evaluate(r,o),C=this.paint.get("circle-pitch-alignment")==="map",A=C?w:function(k,j){return k.map(U=>Zh(U,j))}(w,v),R=C?M*_:M;for(const k of h)for(const j of k){const U=C?j:Zh(j,v);let H=R;const Q=Kn([],[j.x,j.y,0,1],v);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?H*=Q[3]/g.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(H*=g.cameraToCenterDistance/Q[3]),Qu(A,U,H))return!0}return!1}}function Zh(a,t){const r=Kn([],[a.x,a.y,0,1],t);return new st(r[0]/r[3],r[1]/r[3])}class cl extends Hs{}let Xs;nt("HeatmapBucket",cl,{omit:["layers"]});var ul={get paint(){return Xs=Xs||new lr({"heatmap-radius":new yt(P.paint_heatmap["heatmap-radius"]),"heatmap-weight":new yt(P.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new mt(P.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ic(P.paint_heatmap["heatmap-color"]),"heatmap-opacity":new mt(P.paint_heatmap["heatmap-opacity"])})}};function ys(a,{width:t,height:r},o,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==t*r*o)throw new RangeError(`mismatched image size. expected: ${h.length} but got: ${t*r*o}`)}else h=new Uint8Array(t*r*o);return a.width=t,a.height=r,a.data=h,a}function Gh(a,{width:t,height:r},o){if(t===a.width&&r===a.height)return;const h=ys({},{width:t,height:r},o);th(a,h,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,t),height:Math.min(a.height,r)},o),a.width=t,a.height=r,a.data=h.data}function th(a,t,r,o,h,g){if(h.width===0||h.height===0)return t;if(h.width>a.width||h.height>a.height||r.x>a.width-h.width||r.y>a.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>t.width||h.height>t.height||o.x>t.width-h.width||o.y>t.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const _=a.data,v=t.data;if(_===v)throw new Error("srcData equals dstData, so image is already copied");for(let w=0;w<h.height;w++){const M=((r.y+w)*a.width+r.x)*g,C=((o.y+w)*t.width+o.x)*g;for(let A=0;A<h.width*g;A++)v[C+A]=_[M+A]}return t}class To{constructor(t,r){ys(this,t,1,r)}resize(t){Gh(this,t,1)}clone(){return new To({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,o,h,g){th(t,r,o,h,g,1)}}class Rr{constructor(t,r){ys(this,t,4,r)}resize(t){Gh(this,t,4)}replace(t,r){r?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Rr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,o,h,g){th(t,r,o,h,g,4)}}function hl(a){const t={},r=a.resolution||256,o=a.clips?a.clips.length:1,h=a.image||new Rr({width:r,height:o});if(Math.log(r)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${r}`);const g=(_,v,w)=>{t[a.evaluationKey]=w;const M=a.expression.evaluate(t);h.data[_+v+0]=Math.floor(255*M.r/M.a),h.data[_+v+1]=Math.floor(255*M.g/M.a),h.data[_+v+2]=Math.floor(255*M.b/M.a),h.data[_+v+3]=Math.floor(255*M.a)};if(a.clips)for(let _=0,v=0;_<o;++_,v+=4*r)for(let w=0,M=0;w<r;w++,M+=4){const C=w/(r-1),{start:A,end:R}=a.clips[_];g(v,M,A*(1-C)+R*C)}else for(let _=0,v=0;_<r;_++,v+=4)g(0,v,_/(r-1));return h}nt("AlphaImage",To),nt("RGBAImage",Rr);const cr="big-fb";class qh extends za{createBucket(t){return new cl(t)}constructor(t){super(t,ul),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=hl({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(cr)&&this.heatmapFbos.delete(cr)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Rd;var dl={get paint(){return Rd=Rd||new lr({"hillshade-illumination-direction":new mt(P.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new mt(P.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new mt(P.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new mt(P.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new mt(P.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new mt(P.paint_hillshade["hillshade-accent-color"])})}};class kd extends za{constructor(t){super(t,dl)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const Ld=Xi([{name:"a_pos",components:2,type:"Int16"}],4),{members:fl}=Ld;function Ys(a,t,r){const o=r.patternDependencies;let h=!1;for(const g of t){const _=g.paint.get(`${a}-pattern`);_.isConstant()||(h=!0);const v=_.constantOr(null);v&&(h=!0,o[v.to]=!0,o[v.from]=!0)}return h}function cc(a,t,r,o,h){const g=h.patternDependencies;for(const _ of t){const v=_.paint.get(`${a}-pattern`).value;if(v.kind!=="constant"){let w=v.evaluate({zoom:o-1},r,{},h.availableImages),M=v.evaluate({zoom:o},r,{},h.availableImages),C=v.evaluate({zoom:o+1},r,{},h.availableImages);w=w&&w.name?w.name:w,M=M&&M.name?M.name:M,C=C&&C.name?C.name:C,g[w]=!0,g[M]=!0,g[C]=!0,r.patterns[_.id]={min:w,mid:M,max:C}}}return r}function Hh(a,t,r,o,h){let g;if(h===function(_,v,w,M){let C=0;for(let A=v,R=w-M;A<w;A+=M)C+=(_[R]-_[A])*(_[A+1]+_[R+1]),R=A;return C}(a,t,r,o)>0)for(let _=t;_<r;_+=o)g=nr(_/o|0,a[_],a[_+1],g);else for(let _=r-o;_>=t;_-=o)g=nr(_/o|0,a[_],a[_+1],g);return g&&ml(g,g.next)&&(du(g),g=g.next),g}function So(a,t){if(!a)return a;t||(t=a);let r,o=a;do if(r=!1,o.steiner||!ml(o,o.next)&&Yi(o.prev,o,o.next)!==0)o=o.next;else{if(du(o),o=t=o.prev,o===o.next)break;r=!0}while(r||o!==t);return t}function Mo(a,t,r,o,h,g,_){if(!a)return;!_&&g&&function(w,M,C,A){let R=w;do R.z===0&&(R.z=Eo(R.x,R.y,M,C,A)),R.prevZ=R.prev,R.nextZ=R.next,R=R.next;while(R!==w);R.prevZ.nextZ=null,R.prevZ=null,function(k){let j,U=1;do{let H,Q=k;k=null;let ue=null;for(j=0;Q;){j++;let te=Q,L=0;for(let ie=0;ie<U&&(L++,te=te.nextZ,te);ie++);let G=U;for(;L>0||G>0&&te;)L!==0&&(G===0||!te||Q.z<=te.z)?(H=Q,Q=Q.nextZ,L--):(H=te,te=te.nextZ,G--),ue?ue.nextZ=H:k=H,H.prevZ=ue,ue=H;Q=te}ue.nextZ=null,U*=2}while(j>1)}(R)}(a,o,h,g);let v=a;for(;a.prev!==a.next;){const w=a.prev,M=a.next;if(g?kf(a,o,h,g):ih(a))t.push(w.i,a.i,M.i),du(a),a=M.next,v=M.next;else if((a=M)===v){_?_===1?Mo(a=Lf(So(a),t),t,r,o,h,g,2):_===2&&nh(a,t,r,o,h,g):Mo(So(a),t,r,o,h,g,1);break}}}function ih(a){const t=a.prev,r=a,o=a.next;if(Yi(t,r,o)>=0)return!1;const h=t.x,g=r.x,_=o.x,v=t.y,w=r.y,M=o.y,C=Math.min(h,g,_),A=Math.min(v,w,M),R=Math.max(h,g,_),k=Math.max(v,w,M);let j=o.next;for(;j!==t;){if(j.x>=C&&j.x<=R&&j.y>=A&&j.y<=k&&hu(h,v,g,w,_,M,j.x,j.y)&&Yi(j.prev,j,j.next)>=0)return!1;j=j.next}return!0}function kf(a,t,r,o){const h=a.prev,g=a,_=a.next;if(Yi(h,g,_)>=0)return!1;const v=h.x,w=g.x,M=_.x,C=h.y,A=g.y,R=_.y,k=Math.min(v,w,M),j=Math.min(C,A,R),U=Math.max(v,w,M),H=Math.max(C,A,R),Q=Eo(k,j,t,r,o),ue=Eo(U,H,t,r,o);let te=a.prevZ,L=a.nextZ;for(;te&&te.z>=Q&&L&&L.z<=ue;){if(te.x>=k&&te.x<=U&&te.y>=j&&te.y<=H&&te!==h&&te!==_&&hu(v,C,w,A,M,R,te.x,te.y)&&Yi(te.prev,te,te.next)>=0||(te=te.prevZ,L.x>=k&&L.x<=U&&L.y>=j&&L.y<=H&&L!==h&&L!==_&&hu(v,C,w,A,M,R,L.x,L.y)&&Yi(L.prev,L,L.next)>=0))return!1;L=L.nextZ}for(;te&&te.z>=Q;){if(te.x>=k&&te.x<=U&&te.y>=j&&te.y<=H&&te!==h&&te!==_&&hu(v,C,w,A,M,R,te.x,te.y)&&Yi(te.prev,te,te.next)>=0)return!1;te=te.prevZ}for(;L&&L.z<=ue;){if(L.x>=k&&L.x<=U&&L.y>=j&&L.y<=H&&L!==h&&L!==_&&hu(v,C,w,A,M,R,L.x,L.y)&&Yi(L.prev,L,L.next)>=0)return!1;L=L.nextZ}return!0}function Lf(a,t){let r=a;do{const o=r.prev,h=r.next.next;!ml(o,h)&&rh(o,r,r.next,h)&&uc(o,h)&&uc(h,o)&&(t.push(o.i,r.i,h.i),du(r),du(r.next),r=a=h),r=r.next}while(r!==a);return So(r)}function nh(a,t,r,o,h,g){let _=a;do{let v=_.next.next;for(;v!==_.prev;){if(_.i!==v.i&&jf(_,v)){let w=Od(_,v);return _=So(_,_.next),w=So(w,w.next),Mo(_,t,r,o,h,g,0),void Mo(w,t,r,o,h,g,0)}v=v.next}_=_.next}while(_!==a)}function pl(a,t){let r=a.x-t.x;return r===0&&(r=a.y-t.y,r===0)&&(r=(a.next.y-a.y)/(a.next.x-a.x)-(t.next.y-t.y)/(t.next.x-t.x)),r}function Bf(a,t){const r=function(h,g){let _=g;const v=h.x,w=h.y;let M,C=-1/0;if(ml(h,_))return _;do{if(ml(h,_.next))return _.next;if(w<=_.y&&w>=_.next.y&&_.next.y!==_.y){const U=_.x+(w-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(U<=v&&U>C&&(C=U,M=_.x<_.next.x?_:_.next,U===v))return M}_=_.next}while(_!==g);if(!M)return null;const A=M,R=M.x,k=M.y;let j=1/0;_=M;do{if(v>=_.x&&_.x>=R&&v!==_.x&&Bd(w<k?v:C,w,R,k,w<k?C:v,w,_.x,_.y)){const U=Math.abs(w-_.y)/(v-_.x);uc(_,h)&&(U<j||U===j&&(_.x>M.x||_.x===M.x&&Of(M,_)))&&(M=_,j=U)}_=_.next}while(_!==A);return M}(a,t);if(!r)return t;const o=Od(r,a);return So(o,o.next),So(r,r.next)}function Of(a,t){return Yi(a.prev,a,t.prev)<0&&Yi(t.next,a,a.next)<0}function Eo(a,t,r,o,h){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-r)*h|0)|a<<8))|a<<4))|a<<2))|a<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-o)*h|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Ra(a){let t=a,r=a;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==a);return r}function Bd(a,t,r,o,h,g,_,v){return(h-_)*(t-v)>=(a-_)*(g-v)&&(a-_)*(o-v)>=(r-_)*(t-v)&&(r-_)*(g-v)>=(h-_)*(o-v)}function hu(a,t,r,o,h,g,_,v){return!(a===_&&t===v)&&Bd(a,t,r,o,h,g,_,v)}function jf(a,t){return a.next.i!==t.i&&a.prev.i!==t.i&&!function(r,o){let h=r;do{if(h.i!==r.i&&h.next.i!==r.i&&h.i!==o.i&&h.next.i!==o.i&&rh(h,h.next,r,o))return!0;h=h.next}while(h!==r);return!1}(a,t)&&(uc(a,t)&&uc(t,a)&&function(r,o){let h=r,g=!1;const _=(r.x+o.x)/2,v=(r.y+o.y)/2;do h.y>v!=h.next.y>v&&h.next.y!==h.y&&_<(h.next.x-h.x)*(v-h.y)/(h.next.y-h.y)+h.x&&(g=!g),h=h.next;while(h!==r);return g}(a,t)&&(Yi(a.prev,a,t.prev)||Yi(a,t.prev,t))||ml(a,t)&&Yi(a.prev,a,a.next)>0&&Yi(t.prev,t,t.next)>0)}function Yi(a,t,r){return(t.y-a.y)*(r.x-t.x)-(t.x-a.x)*(r.y-t.y)}function ml(a,t){return a.x===t.x&&a.y===t.y}function rh(a,t,r,o){const h=Ki(Yi(a,t,r)),g=Ki(Yi(a,t,o)),_=Ki(Yi(r,o,a)),v=Ki(Yi(r,o,t));return h!==g&&_!==v||!(h!==0||!Wa(a,r,t))||!(g!==0||!Wa(a,o,t))||!(_!==0||!Wa(r,a,o))||!(v!==0||!Wa(r,t,o))}function Wa(a,t,r){return t.x<=Math.max(a.x,r.x)&&t.x>=Math.min(a.x,r.x)&&t.y<=Math.max(a.y,r.y)&&t.y>=Math.min(a.y,r.y)}function Ki(a){return a>0?1:a<0?-1:0}function uc(a,t){return Yi(a.prev,a,a.next)<0?Yi(a,t,a.next)>=0&&Yi(a,a.prev,t)>=0:Yi(a,t,a.prev)<0||Yi(a,a.next,t)<0}function Od(a,t){const r=jd(a.i,a.x,a.y),o=jd(t.i,t.x,t.y),h=a.next,g=t.prev;return a.next=t,t.prev=a,r.next=h,h.prev=r,o.next=r,r.prev=o,g.next=o,o.prev=g,o}function nr(a,t,r,o){const h=jd(a,t,r);return o?(h.next=o.next,h.prev=o,o.next.prev=h,o.next=h):(h.prev=h,h.next=h),h}function du(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function jd(a,t,r){return{i:a,x:t,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class hc{constructor(t,r){if(r>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=r}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class ah{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}ah.noSubdivision=new ah({fill:new hc(0,0),line:new hc(0,0),tile:new hc(0,0),stencil:new hc(0,0),circle:1}),nt("SubdivisionGranularityExpression",hc),nt("SubdivisionGranularitySetting",ah);const Qi=-32768,Tr=32767;class Co{constructor(t,r){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=Ke/t,this._canonical=r}_getKey(t,r){return(t+=32768)<<16|(r+=32768)<<0}_vertexToIndex(t,r){if(t<-32768||r<-32768||t>32767||r>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const o=0|Math.round(t),h=0|Math.round(r),g=this._getKey(o,h);if(this._vertexDictionary.has(g))return this._vertexDictionary.get(g);const _=this._vertexBuffer.length/2;return this._vertexDictionary.set(g,_),this._vertexBuffer.push(o,h),_}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(h,g){const _=[];for(let v=0;v<g.length;v+=3){const w=g[v],M=g[v+1],C=g[v+2],A=h[2*w],R=h[2*w+1];(h[2*M]-A)*(h[2*C+1]-R)-(h[2*M+1]-R)*(h[2*C]-A)>0?(_.push(w),_.push(C),_.push(M)):(_.push(w),_.push(M),_.push(C))}return _}(this._vertexBuffer,t);const r=[],o=t.length;for(let h=0;h<o;h+=3){const g=[t[h+0],t[h+1],t[h+2]],_=[this._vertexBuffer[2*t[h+0]+0],this._vertexBuffer[2*t[h+0]+1],this._vertexBuffer[2*t[h+1]+0],this._vertexBuffer[2*t[h+1]+1],this._vertexBuffer[2*t[h+2]+0],this._vertexBuffer[2*t[h+2]+1]];let v=1/0,w=1/0,M=-1/0,C=-1/0;for(let U=0;U<3;U++){const H=_[2*U],Q=_[2*U+1];v=Math.min(v,H),M=Math.max(M,H),w=Math.min(w,Q),C=Math.max(C,Q)}if(v===M||w===C)continue;const A=Math.floor(v/this._granularityCellSize),R=Math.ceil(M/this._granularityCellSize),k=Math.floor(w/this._granularityCellSize),j=Math.ceil(C/this._granularityCellSize);if(A!==R||k!==j)for(let U=k;U<j;U++){const H=this._scanlineGenerateVertexRingForCellRow(U,_,g);hp(this._vertexBuffer,H,r)}else r.push(...g)}return r}_scanlineGenerateVertexRingForCellRow(t,r,o){const h=t*this._granularityCellSize,g=h+this._granularityCellSize,_=[];for(let v=0;v<3;v++){const w=r[2*v],M=r[2*v+1],C=r[2*(v+1)%6],A=r[(2*(v+1)+1)%6],R=r[2*(v+2)%6],k=r[(2*(v+2)+1)%6],j=C-w,U=A-M,H=j===0,Q=U===0,ue=(h-M)/U,te=(g-M)/U,L=Math.min(ue,te),G=Math.max(ue,te);if(!Q&&(L>=1||G<=0)||Q&&(M<h||M>g)){A>=h&&A<=g&&_.push(o[(v+1)%3]);continue}!Q&&L>0&&_.push(this._vertexToIndex(w+j*L,M+U*L));const ie=w+j*Math.max(L,0),Te=w+j*Math.min(G,1);H||this._generateIntraEdgeVertices(_,w,M,C,A,ie,Te),!Q&&G<1&&_.push(this._vertexToIndex(w+j*G,M+U*G)),(Q||A>=h&&A<=g)&&_.push(o[(v+1)%3]),!Q&&(A<=h||A>=g)&&this._generateInterEdgeVertices(_,w,M,C,A,R,k,Te,h,g)}return _}_generateIntraEdgeVertices(t,r,o,h,g,_,v){const w=h-r,M=g-o,C=M===0,A=C?Math.min(r,h):Math.min(_,v),R=C?Math.max(r,h):Math.max(_,v),k=Math.floor(A/this._granularityCellSize)+1,j=Math.ceil(R/this._granularityCellSize)-1;if(C?r<h:_<v)for(let U=k;U<=j;U++){const H=U*this._granularityCellSize;t.push(this._vertexToIndex(H,o+M*(H-r)/w))}else for(let U=j;U>=k;U--){const H=U*this._granularityCellSize;t.push(this._vertexToIndex(H,o+M*(H-r)/w))}}_generateInterEdgeVertices(t,r,o,h,g,_,v,w,M,C){const A=g-o,R=_-h,k=v-g,j=(M-g)/k,U=(C-g)/k,H=Math.min(j,U),Q=Math.max(j,U),ue=h+R*H;let te=Math.floor(Math.min(ue,w)/this._granularityCellSize)+1,L=Math.ceil(Math.max(ue,w)/this._granularityCellSize)-1,G=w<ue;const ie=k===0;if(ie&&(v===M||v===C))return;if(ie||H>=1||Q<=0){const qe=o-v,Ae=_+(r-_)*Math.min((M-v)/qe,(C-v)/qe);te=Math.floor(Math.min(Ae,w)/this._granularityCellSize)+1,L=Math.ceil(Math.max(Ae,w)/this._granularityCellSize)-1,G=w<Ae}const Te=A>0?C:M;if(G)for(let qe=te;qe<=L;qe++)t.push(this._vertexToIndex(qe*this._granularityCellSize,Te));else for(let qe=L;qe>=te;qe--)t.push(this._vertexToIndex(qe*this._granularityCellSize,Te))}_generateOutline(t){const r=[];for(const o of t){const h=gl(o,this._granularity,!0),g=this._pointArrayToIndices(h),_=[];for(let v=1;v<g.length;v++)_.push(g[v-1]),_.push(g[v]);r.push(_)}return r}_handlePoles(t){let r=!1,o=!1;this._canonical&&(this._canonical.y===0&&(r=!0),this._canonical.y===(1<<this._canonical.z)-1&&(o=!0)),(r||o)&&this._fillPoles(t,r,o)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let r=0;r<t.length;r+=2){const o=t[r+1];o===Qi&&(t[r+1]=-32767),o===Tr&&(t[r+1]=32766)}}_generatePoleQuad(t,r,o,h,g,_){h>g!=(_===Qi)?(t.push(r),t.push(o),t.push(this._vertexToIndex(h,_)),t.push(o),t.push(this._vertexToIndex(g,_)),t.push(this._vertexToIndex(h,_))):(t.push(o),t.push(r),t.push(this._vertexToIndex(h,_)),t.push(this._vertexToIndex(g,_)),t.push(o),t.push(this._vertexToIndex(h,_)))}_fillPoles(t,r,o){const h=this._vertexBuffer,g=Ke,_=t.length;for(let v=2;v<_;v+=3){const w=t[v-2],M=t[v-1],C=t[v],A=h[2*w],R=h[2*w+1],k=h[2*M],j=h[2*M+1],U=h[2*C],H=h[2*C+1];r&&(R===0&&j===0&&this._generatePoleQuad(t,w,M,A,k,Qi),j===0&&H===0&&this._generatePoleQuad(t,M,C,k,U,Qi),H===0&&R===0&&this._generatePoleQuad(t,C,w,U,A,Qi)),o&&(R===g&&j===g&&this._generatePoleQuad(t,w,M,A,k,Tr),j===g&&H===g&&this._generatePoleQuad(t,M,C,k,U,Tr),H===g&&R===g&&this._generatePoleQuad(t,C,w,U,A,Tr))}}_initializeVertices(t){for(let r=0;r<t.length;r+=2)this._vertexToIndex(t[r],t[r+1])}subdividePolygonInternal(t,r){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:o,holeIndices:h}=function(v){const w=[],M=[];for(const C of v)if(C.length!==0){C!==v[0]&&w.push(M.length/2);for(let A=0;A<C.length;A++)M.push(C[A].x),M.push(C[A].y)}return{flattened:M,holeIndices:w}}(t);let g;this._initializeVertices(o);try{const v=function(M,C,A=2){const R=C&&C.length,k=R?C[0]*A:M.length;let j=Hh(M,0,k,A,!0);const U=[];if(!j||j.next===j.prev)return U;let H,Q,ue;if(R&&(j=function(te,L,G,ie){const Te=[];for(let qe=0,Ae=L.length;qe<Ae;qe++){const De=Hh(te,L[qe]*ie,qe<Ae-1?L[qe+1]*ie:te.length,ie,!1);De===De.next&&(De.steiner=!0),Te.push(Ra(De))}Te.sort(pl);for(let qe=0;qe<Te.length;qe++)G=Bf(Te[qe],G);return G}(M,C,j,A)),M.length>80*A){H=1/0,Q=1/0;let te=-1/0,L=-1/0;for(let G=A;G<k;G+=A){const ie=M[G],Te=M[G+1];ie<H&&(H=ie),Te<Q&&(Q=Te),ie>te&&(te=ie),Te>L&&(L=Te)}ue=Math.max(te-H,L-Q),ue=ue!==0?32767/ue:0}return Mo(j,U,A,H,Q,ue,0),U}(o,h),w=this._convertIndices(o,v);g=this._subdivideTrianglesScanline(w)}catch(v){console.error(v)}let _=[];return r&&(_=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(g),{verticesFlattened:this._vertexBuffer,indicesTriangles:g,indicesLineList:_}}_convertIndices(t,r){const o=[];for(let h=0;h<r.length;h++)o.push(this._vertexToIndex(t[2*r[h]],t[2*r[h]+1]));return o}_pointArrayToIndices(t){const r=[];for(let o=0;o<t.length;o++){const h=t[o];r.push(this._vertexToIndex(h.x,h.y))}return r}}function Fd(a,t,r,o=!0){return new Co(r,t).subdividePolygonInternal(a,o)}function gl(a,t,r=!1){if(!a||a.length<1)return[];if(a.length<2)return[];const o=a[0],h=a[a.length-1],g=r&&(o.x!==h.x||o.y!==h.y);if(t<2)return g?[...a,a[0]]:[...a];const _=Math.floor(Ke/t),v=[];v.push(new st(a[0].x,a[0].y));const w=a.length,M=g?w:w-1;for(let C=0;C<M;C++){const A=a[C],R=C<w-1?a[C+1]:a[0],k=A.x,j=A.y,U=R.x,H=R.y,Q=k!==U,ue=j!==H;if(!Q&&!ue)continue;const te=U-k,L=H-j,G=Math.abs(te),ie=Math.abs(L);let Te=k,qe=j;for(;;){const De=te>0?(Math.floor(Te/_)+1)*_:(Math.ceil(Te/_)-1)*_,Xe=L>0?(Math.floor(qe/_)+1)*_:(Math.ceil(qe/_)-1)*_,$e=Math.abs(Te-De),Ye=Math.abs(qe-Xe),Be=Math.abs(Te-U),ut=Math.abs(qe-H),wt=Q?$e/G:Number.POSITIVE_INFINITY,vt=ue?Ye/ie:Number.POSITIVE_INFINITY;if((Be<=$e||!Q)&&(ut<=Ye||!ue))break;if(wt<vt&&Q||!ue){Te=De,qe+=L*wt;const dt=new st(Te,Math.round(qe));v[v.length-1].x===dt.x&&v[v.length-1].y===dt.y||v.push(dt)}else{Te+=te*vt,qe=Xe;const dt=new st(Math.round(Te),qe);v[v.length-1].x===dt.x&&v[v.length-1].y===dt.y||v.push(dt)}}const Ae=new st(U,H);v[v.length-1].x===Ae.x&&v[v.length-1].y===Ae.y||v.push(Ae)}return v}function hp(a,t,r){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let o=0,h=a[2*t[0]];for(let w=1;w<t.length;w++){const M=a[2*t[w]];M<h&&(h=M,o=w)}const g=t.length;let _=o,v=(_+1)%g;for(;;){const w=_-1>=0?_-1:g-1,M=(v+1)%g,C=a[2*t[w]],A=a[2*t[M]],R=a[2*t[_]],k=a[2*t[_]+1],j=a[2*t[v]+1];let U=!1;if(C<A)U=!0;else if(C>A)U=!1;else{const H=j-k,Q=-(a[2*t[v]]-R),ue=k<j?1:-1;((C-R)*H+(a[2*t[w]+1]-k)*Q)*ue>((A-R)*H+(a[2*t[M]+1]-k)*Q)*ue&&(U=!0)}if(U){const H=t[w],Q=t[_],ue=t[v];H!==Q&&H!==ue&&Q!==ue&&r.push(ue,Q,H),_--,_<0&&(_=g-1)}else{const H=t[M],Q=t[_],ue=t[v];H!==Q&&H!==ue&&Q!==ue&&r.push(ue,Q,H),v++,v>=g&&(v=0)}if(w===M)break}}function $h(a,t,r,o,h,g,_,v,w){const M=h.length/2,C=_&&v&&w;if(M<_t.MAX_VERTEX_ARRAY_LENGTH){const A=t.prepareSegment(M,r,o),R=A.vertexLength;for(let U=0;U<g.length;U+=3)o.emplaceBack(R+g[U],R+g[U+1],R+g[U+2]);let k,j;A.vertexLength+=M,A.primitiveLength+=g.length/3,C&&(j=_.prepareSegment(M,r,v),k=j.vertexLength,j.vertexLength+=M);for(let U=0;U<h.length;U+=2)a(h[U],h[U+1]);if(C)for(let U=0;U<w.length;U++){const H=w[U];for(let Q=1;Q<H.length;Q+=2)v.emplaceBack(k+H[Q-1],k+H[Q]);j.primitiveLength+=H.length/2}}else(function(A,R,k,j,U,H){const Q=[];for(let ie=0;ie<j.length/2;ie++)Q.push(-1);const ue={count:0};let te=0,L=A.getOrCreateLatestSegment(R,k),G=L.vertexLength;for(let ie=2;ie<U.length;ie+=3){const Te=U[ie-2],qe=U[ie-1],Ae=U[ie];let De=Q[Te]<te,Xe=Q[qe]<te,$e=Q[Ae]<te;L.vertexLength+((De?1:0)+(Xe?1:0)+($e?1:0))>_t.MAX_VERTEX_ARRAY_LENGTH&&(L=A.createNewSegment(R,k),te=ue.count,De=!0,Xe=!0,$e=!0,G=0);const Ye=kr(Q,j,H,ue,Te,De,L),Be=kr(Q,j,H,ue,qe,Xe,L),ut=kr(Q,j,H,ue,Ae,$e,L);k.emplaceBack(G+Ye-te,G+Be-te,G+ut-te),L.primitiveLength++}})(t,r,o,h,g,a),C&&function(A,R,k,j,U,H){const Q=[];for(let ie=0;ie<j.length/2;ie++)Q.push(-1);const ue={count:0};let te=0,L=A.getOrCreateLatestSegment(R,k),G=L.vertexLength;for(let ie=0;ie<U.length;ie++){const Te=U[ie];for(let qe=1;qe<U[ie].length;qe+=2){const Ae=Te[qe-1],De=Te[qe];let Xe=Q[Ae]<te,$e=Q[De]<te;L.vertexLength+((Xe?1:0)+($e?1:0))>_t.MAX_VERTEX_ARRAY_LENGTH&&(L=A.createNewSegment(R,k),te=ue.count,Xe=!0,$e=!0,G=0);const Ye=kr(Q,j,H,ue,Ae,Xe,L),Be=kr(Q,j,H,ue,De,$e,L);k.emplaceBack(G+Ye-te,G+Be-te),L.primitiveLength++}}}(_,r,v,h,w,a),t.forceNewSegmentOnNextPrepare(),_==null||_.forceNewSegmentOnNextPrepare()}function kr(a,t,r,o,h,g,_){if(g){const v=o.count;return r(t[2*h],t[2*h+1]),a[h]=o.count,o.count++,_.vertexLength++,v}return a[h]}class ka{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new re,this.indexArray=new et,this.indexArray2=new We,this.programConfigurations=new wo(t.layers,t.zoom),this.segments=new _t,this.segments2=new _t,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,o){this.hasPattern=Ys("fill",this.layers,r);const h=this.layers[0].layout.get("fill-sort-key"),g=!h.isConstant(),_=[];for(const{feature:v,id:w,index:M,sourceLayerIndex:C}of t){const A=this.layers[0]._featureFilter.needGeometry,R=Ir(v,A);if(!this.layers[0]._featureFilter.filter(new Pi(this.zoom),R,o))continue;const k=g?h.evaluate(R,{},o,r.availableImages):void 0,j={id:w,properties:v.properties,type:v.type,sourceLayerIndex:C,index:M,geometry:A?R.geometry:qs(v),patterns:{},sortKey:k};_.push(j)}g&&_.sort((v,w)=>v.sortKey-w.sortKey);for(const v of _){const{geometry:w,index:M,sourceLayerIndex:C}=v;if(this.hasPattern){const A=cc("fill",this.layers,v,this.zoom,r);this.patternFeatures.push(A)}else this.addFeature(v,w,M,o,{},r.subdivisionGranularity);r.featureIndex.insert(t[M].feature,w,M,C,this.index)}}update(t,r,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,o)}addFeatures(t,r,o){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,r,o,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,fl),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,r,o,h,g,_){for(const v of Fl(r,500)){const w=Fd(v,h,_.fill.getGranularityForZoomLevel(h.z)),M=this.layoutVertexArray;$h((C,A)=>{M.emplaceBack(C,A)},this.segments,this.layoutVertexArray,this.indexArray,w.verticesFlattened,w.indicesTriangles,this.segments2,this.indexArray2,w.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,g,h)}}let Nd,La;nt("FillBucket",ka,{omit:["layers","patternFeatures"]});var Ff={get paint(){return La=La||new lr({"fill-antialias":new mt(P.paint_fill["fill-antialias"]),"fill-opacity":new yt(P.paint_fill["fill-opacity"]),"fill-color":new yt(P.paint_fill["fill-color"]),"fill-outline-color":new yt(P.paint_fill["fill-outline-color"]),"fill-translate":new mt(P.paint_fill["fill-translate"]),"fill-translate-anchor":new mt(P.paint_fill["fill-translate-anchor"]),"fill-pattern":new tc(P.paint_fill["fill-pattern"])})},get layout(){return Nd=Nd||new lr({"fill-sort-key":new yt(P.layout_fill["fill-sort-key"])})}};class Ao extends za{constructor(t){super(t,Ff)}recalculate(t,r){super.recalculate(t,r);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new ka(t)}queryRadius(){return uu(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:r,transform:o,pixelsToTileUnits:h}){return lc(eh(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-o.bearingInRadians,h),r)}isTileClipped(){return!0}}const fu=Xi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),_l=Xi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Ud}=fu;var sh,zo,Xh,dc,fc,pu,pc,oh={};function Vd(){if(zo)return sh;zo=1;var a=Bt();function t(h,g,_,v,w){this.properties={},this.extent=_,this.type=0,this._pbf=h,this._geometry=-1,this._keys=v,this._values=w,h.readFields(r,this,g)}function r(h,g,_){h==1?g.id=_.readVarint():h==2?function(v,w){for(var M=v.readVarint()+v.pos;v.pos<M;){var C=w._keys[v.readVarint()],A=w._values[v.readVarint()];w.properties[C]=A}}(_,g):h==3?g.type=_.readVarint():h==4&&(g._geometry=_.pos)}function o(h){for(var g,_,v=0,w=0,M=h.length,C=M-1;w<M;C=w++)v+=((_=h[C]).x-(g=h[w]).x)*(g.y+_.y);return v}return sh=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var h=this._pbf;h.pos=this._geometry;for(var g,_=h.readVarint()+h.pos,v=1,w=0,M=0,C=0,A=[];h.pos<_;){if(w<=0){var R=h.readVarint();v=7&R,w=R>>3}if(w--,v===1||v===2)M+=h.readSVarint(),C+=h.readSVarint(),v===1&&(g&&A.push(g),g=[]),g.push(new a(M,C));else{if(v!==7)throw new Error("unknown command "+v);g&&g.push(g[0].clone())}}return g&&A.push(g),A},t.prototype.bbox=function(){var h=this._pbf;h.pos=this._geometry;for(var g=h.readVarint()+h.pos,_=1,v=0,w=0,M=0,C=1/0,A=-1/0,R=1/0,k=-1/0;h.pos<g;){if(v<=0){var j=h.readVarint();_=7&j,v=j>>3}if(v--,_===1||_===2)(w+=h.readSVarint())<C&&(C=w),w>A&&(A=w),(M+=h.readSVarint())<R&&(R=M),M>k&&(k=M);else if(_!==7)throw new Error("unknown command "+_)}return[C,R,A,k]},t.prototype.toGeoJSON=function(h,g,_){var v,w,M=this.extent*Math.pow(2,_),C=this.extent*h,A=this.extent*g,R=this.loadGeometry(),k=t.types[this.type];function j(Q){for(var ue=0;ue<Q.length;ue++){var te=Q[ue];Q[ue]=[360*(te.x+C)/M-180,360/Math.PI*Math.atan(Math.exp((180-360*(te.y+A)/M)*Math.PI/180))-90]}}switch(this.type){case 1:var U=[];for(v=0;v<R.length;v++)U[v]=R[v][0];j(R=U);break;case 2:for(v=0;v<R.length;v++)j(R[v]);break;case 3:for(R=function(Q){var ue=Q.length;if(ue<=1)return[Q];for(var te,L,G=[],ie=0;ie<ue;ie++){var Te=o(Q[ie]);Te!==0&&(L===void 0&&(L=Te<0),L===Te<0?(te&&G.push(te),te=[Q[ie]]):te.push(Q[ie]))}return te&&G.push(te),G}(R),v=0;v<R.length;v++)for(w=0;w<R[v].length;w++)j(R[v][w])}R.length===1?R=R[0]:k="Multi"+k;var H={type:"Feature",geometry:{type:k,coordinates:R},properties:this.properties};return"id"in this&&(H.id=this.id),H},sh}function mu(){if(dc)return Xh;dc=1;var a=Vd();function t(o,h){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(r,this,h),this.length=this._features.length}function r(o,h,g){o===15?h.version=g.readVarint():o===1?h.name=g.readString():o===5?h.extent=g.readVarint():o===2?h._features.push(g.pos):o===3?h._keys.push(g.readString()):o===4&&h._values.push(function(_){for(var v=null,w=_.readVarint()+_.pos;_.pos<w;){var M=_.readVarint()>>3;v=M===1?_.readString():M===2?_.readFloat():M===3?_.readDouble():M===4?_.readVarint64():M===5?_.readVarint():M===6?_.readSVarint():M===7?_.readBoolean():null}return v}(g))}return Xh=t,t.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var h=this._pbf.readVarint()+this._pbf.pos;return new a(this._pbf,h,this.extent,this._keys,this._values)},Xh}function Zd(){return pc||(pc=1,oh.VectorTile=function(){if(pu)return fc;pu=1;var a=mu();function t(r,o,h){if(r===3){var g=new a(h,h.readVarint()+h.pos);g.length&&(o[g.name]=g)}}return fc=function(r,o){this.layers=r.readFields(t,{},o)},fc}(),oh.VectorTileFeature=Vd(),oh.VectorTileLayer=mu()),oh}var yl=it(Zd());const Nf=yl.VectorTileFeature.types,Gd=Math.pow(2,13);function Lr(a,t,r,o,h,g,_,v){a.emplaceBack(t,r,2*Math.floor(o*Gd)+_,h*Gd*2,g*Gd*2,Math.round(v))}class lh{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ae,this.centroidVertexArray=new K,this.indexArray=new et,this.programConfigurations=new wo(t.layers,t.zoom),this.segments=new _t,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,o){this.features=[],this.hasPattern=Ys("fill-extrusion",this.layers,r);for(const{feature:h,id:g,index:_,sourceLayerIndex:v}of t){const w=this.layers[0]._featureFilter.needGeometry,M=Ir(h,w);if(!this.layers[0]._featureFilter.filter(new Pi(this.zoom),M,o))continue;const C={id:g,sourceLayerIndex:v,index:_,geometry:w?M.geometry:qs(h),properties:h.properties,type:h.type,patterns:{}};this.hasPattern?this.features.push(cc("fill-extrusion",this.layers,C,this.zoom,r)):this.addFeature(C,C.geometry,_,o,{},r.subdivisionGranularity),r.featureIndex.insert(h,C.geometry,_,v,this.index,!0)}}addFeatures(t,r,o){for(const h of this.features){const{geometry:g}=h;this.addFeature(h,g,h.index,r,o,t.subdivisionGranularity)}}update(t,r,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,o)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ud),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,_l.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,r,o,h,g,_){for(const v of Fl(r,500)){const w={x:0,y:0,sampleCount:0},M=this.layoutVertexArray.length;this.processPolygon(w,h,t,v,_);const C=this.layoutVertexArray.length-M,A=Math.floor(w.x/w.sampleCount),R=Math.floor(w.y/w.sampleCount);for(let k=0;k<C;k++)this.centroidVertexArray.emplaceBack(A,R)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,g,h)}processPolygon(t,r,o,h,g){if(h.length<1||ch(h[0]))return;for(const A of h)A.length!==0&&vl(t,A);const _={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},v=g.fill.getGranularityForZoomLevel(r.z),w=Nf[o.type]==="Polygon";for(const A of h){if(A.length===0||ch(A))continue;const R=gl(A,v,w);this._generateSideFaces(R,_)}if(!w)return;const M=Fd(h,r,v,!1),C=this.layoutVertexArray;$h((A,R)=>{Lr(C,A,R,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,M.verticesFlattened,M.indicesTriangles)}_generateSideFaces(t,r){let o=0;for(let h=1;h<t.length;h++){const g=t[h],_=t[h-1];if(Uf(g,_))continue;r.segment.vertexLength+4>_t.MAX_VERTEX_ARRAY_LENGTH&&(r.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const v=g.sub(_)._perp()._unit(),w=_.dist(g);o+w>32768&&(o=0),Lr(this.layoutVertexArray,g.x,g.y,v.x,v.y,0,0,o),Lr(this.layoutVertexArray,g.x,g.y,v.x,v.y,0,1,o),o+=w,Lr(this.layoutVertexArray,_.x,_.y,v.x,v.y,0,0,o),Lr(this.layoutVertexArray,_.x,_.y,v.x,v.y,0,1,o);const M=r.segment.vertexLength;this.indexArray.emplaceBack(M,M+2,M+1),this.indexArray.emplaceBack(M+1,M+2,M+3),r.segment.vertexLength+=4,r.segment.primitiveLength+=2}}}function vl(a,t){for(let r=0;r<t.length;r++){const o=t[r];r===t.length-1&&t[0].x===o.x&&t[0].y===o.y||(a.x+=o.x,a.y+=o.y,a.sampleCount++)}}function Uf(a,t){return a.x===t.x&&(a.x<0||a.x>Ke)||a.y===t.y&&(a.y<0||a.y>Ke)}function ch(a){return a.every(t=>t.x<0)||a.every(t=>t.x>Ke)||a.every(t=>t.y<0)||a.every(t=>t.y>Ke)}let xl;nt("FillExtrusionBucket",lh,{omit:["layers","features"]});var Vf={get paint(){return xl=xl||new lr({"fill-extrusion-opacity":new mt(P["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new yt(P["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new mt(P["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new mt(P["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new tc(P["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new yt(P["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new yt(P["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new mt(P["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class qd extends za{constructor(t){super(t,Vf)}createBucket(t){return new lh(t)}queryRadius(){return uu(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:o,geometry:h,transform:g,pixelsToTileUnits:_,pixelPosMatrix:v}){const w=eh(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-g.bearingInRadians,_),M=this.paint.get("fill-extrusion-height").evaluate(r,o),C=this.paint.get("fill-extrusion-base").evaluate(r,o),A=function(k,j,U){const H=[];for(const Q of k){const ue=[Q.x,Q.y,0,1];Kn(ue,ue,j),H.push(new st(ue[0]/ue[3],ue[1]/ue[3]))}return H}(w,v),R=function(k,j,U,H){const Q=[],ue=[],te=H[8]*j,L=H[9]*j,G=H[10]*j,ie=H[11]*j,Te=H[8]*U,qe=H[9]*U,Ae=H[10]*U,De=H[11]*U;for(const Xe of k){const $e=[],Ye=[];for(const Be of Xe){const ut=Be.x,wt=Be.y,vt=H[0]*ut+H[4]*wt+H[12],dt=H[1]*ut+H[5]*wt+H[13],Ht=H[2]*ut+H[6]*wt+H[14],qi=H[3]*ut+H[7]*wt+H[15],yn=Ht+G,Ji=qi+ie,qn=vt+Te,En=dt+qe,vn=Ht+Ae,wi=qi+De,Oi=new st((vt+te)/Ji,(dt+L)/Ji);Oi.z=yn/Ji,$e.push(Oi);const ar=new st(qn/wi,En/wi);ar.z=vn/wi,Ye.push(ar)}Q.push($e),ue.push(Ye)}return[Q,ue]}(h,C,M,v);return function(k,j,U){let H=1/0;lc(U,j)&&(H=Ks(U,j[0]));for(let Q=0;Q<j.length;Q++){const ue=j[Q],te=k[Q];for(let L=0;L<ue.length-1;L++){const G=ue[L],ie=[G,ue[L+1],te[L+1],te[L],G];ol(U,ie)&&(H=Math.min(H,Ks(U,ie)))}}return H!==1/0&&H}(R[0],R[1],A)}}function mc(a,t){return a.x*t.x+a.y*t.y}function Ks(a,t){if(a.length===1){let r=0;const o=t[r++];let h;for(;!h||o.equals(h);)if(h=t[r++],!h)return 1/0;for(;r<t.length;r++){const g=t[r],_=a[0],v=h.sub(o),w=g.sub(o),M=_.sub(o),C=mc(v,v),A=mc(v,w),R=mc(w,w),k=mc(M,v),j=mc(M,w),U=C*R-A*A,H=(R*k-A*j)/U,Q=(C*j-A*k)/U,ue=o.z*(1-H-Q)+h.z*H+g.z*Q;if(isFinite(ue))return ue}return 1/0}{let r=1/0;for(const o of t)r=Math.min(r,o.z);return r}}const Zf=Xi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Yh}=Zf,uh=Xi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:_n}=uh,dp=yl.VectorTileFeature.types,fp=Math.cos(Math.PI/180*37.5),Hd=Math.pow(2,14)/.5;class $d{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new oe,this.layoutVertexArray2=new he,this.indexArray=new et,this.programConfigurations=new wo(t.layers,t.zoom),this.segments=new _t,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,o){this.hasPattern=Ys("line",this.layers,r);const h=this.layers[0].layout.get("line-sort-key"),g=!h.isConstant(),_=[];for(const{feature:v,id:w,index:M,sourceLayerIndex:C}of t){const A=this.layers[0]._featureFilter.needGeometry,R=Ir(v,A);if(!this.layers[0]._featureFilter.filter(new Pi(this.zoom),R,o))continue;const k=g?h.evaluate(R,{},o):void 0,j={id:w,properties:v.properties,type:v.type,sourceLayerIndex:C,index:M,geometry:A?R.geometry:qs(v),patterns:{},sortKey:k};_.push(j)}g&&_.sort((v,w)=>v.sortKey-w.sortKey);for(const v of _){const{geometry:w,index:M,sourceLayerIndex:C}=v;if(this.hasPattern){const A=cc("line",this.layers,v,this.zoom,r);this.patternFeatures.push(A)}else this.addFeature(v,w,M,o,{},r.subdivisionGranularity);r.featureIndex.insert(t[M].feature,w,M,C,this.index)}}update(t,r,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,o)}addFeatures(t,r,o){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,r,o,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,_n)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Yh),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,r,o,h,g,_){const v=this.layers[0].layout,w=v.get("line-join").evaluate(t,{}),M=v.get("line-cap"),C=v.get("line-miter-limit"),A=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const R of r)this.addLine(R,t,w,M,C,A,h,_);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,g,h)}addLine(t,r,o,h,g,_,v,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=gl(t,v?w.line.getGranularityForZoomLevel(v.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let te=0;te<t.length-1;te++)this.totalDistance+=t[te].dist(t[te+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const M=dp[r.type]==="Polygon";let C=t.length;for(;C>=2&&t[C-1].equals(t[C-2]);)C--;let A=0;for(;A<C-1&&t[A].equals(t[A+1]);)A++;if(C<(M?3:2))return;o==="bevel"&&(g=1.05);const R=this.overscaling<=16?15*Ke/(512*this.overscaling):0,k=this.segments.prepareSegment(10*C,this.layoutVertexArray,this.indexArray);let j,U,H,Q,ue;this.e1=this.e2=-1,M&&(j=t[C-2],ue=t[A].sub(j)._unit()._perp());for(let te=A;te<C;te++){if(H=te===C-1?M?t[A+1]:void 0:t[te+1],H&&t[te].equals(H))continue;ue&&(Q=ue),j&&(U=j),j=t[te],ue=H?H.sub(j)._unit()._perp():Q,Q=Q||ue;let L=Q.add(ue);L.x===0&&L.y===0||L._unit();const G=Q.x*ue.x+Q.y*ue.y,ie=L.x*ue.x+L.y*ue.y,Te=ie!==0?1/ie:1/0,qe=2*Math.sqrt(2-2*ie),Ae=ie<fp&&U&&H,De=Q.x*ue.y-Q.y*ue.x>0;if(Ae&&te>A){const Ye=j.dist(U);if(Ye>2*R){const Be=j.sub(j.sub(U)._mult(R/Ye)._round());this.updateDistance(U,Be),this.addCurrentVertex(Be,Q,0,0,k),U=Be}}const Xe=U&&H;let $e=Xe?o:M?"butt":h;if(Xe&&$e==="round"&&(Te<_?$e="miter":Te<=2&&($e="fakeround")),$e==="miter"&&Te>g&&($e="bevel"),$e==="bevel"&&(Te>2&&($e="flipbevel"),Te<g&&($e="miter")),U&&this.updateDistance(U,j),$e==="miter")L._mult(Te),this.addCurrentVertex(j,L,0,0,k);else if($e==="flipbevel"){if(Te>100)L=ue.mult(-1);else{const Ye=Te*Q.add(ue).mag()/Q.sub(ue).mag();L._perp()._mult(Ye*(De?-1:1))}this.addCurrentVertex(j,L,0,0,k),this.addCurrentVertex(j,L.mult(-1),0,0,k)}else if($e==="bevel"||$e==="fakeround"){const Ye=-Math.sqrt(Te*Te-1),Be=De?Ye:0,ut=De?0:Ye;if(U&&this.addCurrentVertex(j,Q,Be,ut,k),$e==="fakeround"){const wt=Math.round(180*qe/Math.PI/20);for(let vt=1;vt<wt;vt++){let dt=vt/wt;if(dt!==.5){const qi=dt-.5;dt+=dt*qi*(dt-1)*((1.0904+G*(G*(3.55645-1.43519*G)-3.2452))*qi*qi+(.848013+G*(.215638*G-1.06021)))}const Ht=ue.sub(Q)._mult(dt)._add(Q)._unit()._mult(De?-1:1);this.addHalfVertex(j,Ht.x,Ht.y,!1,De,0,k)}}H&&this.addCurrentVertex(j,ue,-Be,-ut,k)}else if($e==="butt")this.addCurrentVertex(j,L,0,0,k);else if($e==="square"){const Ye=U?1:-1;this.addCurrentVertex(j,L,Ye,Ye,k)}else $e==="round"&&(U&&(this.addCurrentVertex(j,Q,0,0,k),this.addCurrentVertex(j,Q,1,1,k,!0)),H&&(this.addCurrentVertex(j,ue,-1,-1,k,!0),this.addCurrentVertex(j,ue,0,0,k)));if(Ae&&te<C-1){const Ye=j.dist(H);if(Ye>2*R){const Be=j.add(H.sub(j)._mult(R/Ye)._round());this.updateDistance(j,Be),this.addCurrentVertex(Be,ue,0,0,k),j=Be}}}}addCurrentVertex(t,r,o,h,g,_=!1){const v=r.y*h-r.x,w=-r.y-r.x*h;this.addHalfVertex(t,r.x+r.y*o,r.y-r.x*o,_,!1,o,g),this.addHalfVertex(t,v,w,_,!0,-h,g),this.distance>Hd/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,r,o,h,g,_))}addHalfVertex({x:t,y:r},o,h,g,_,v,w){const M=.5*(this.lineClips?this.scaledDistance*(Hd-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(g?1:0),(r<<1)+(_?1:0),Math.round(63*o)+128,Math.round(63*h)+128,1+(v===0?0:v<0?-1:1)|(63&M)<<2,M>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const C=w.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,C,this.e2),w.primitiveLength++),_?this.e2=C:this.e1=C}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,r){this.distance+=t.dist(r),this.updateScaledDistance()}}let Gf,on;nt("LineBucket",$d,{omit:["layers","patternFeatures"]});var Li={get paint(){return on=on||new lr({"line-opacity":new yt(P.paint_line["line-opacity"]),"line-color":new yt(P.paint_line["line-color"]),"line-translate":new mt(P.paint_line["line-translate"]),"line-translate-anchor":new mt(P.paint_line["line-translate-anchor"]),"line-width":new yt(P.paint_line["line-width"]),"line-gap-width":new yt(P.paint_line["line-gap-width"]),"line-offset":new yt(P.paint_line["line-offset"]),"line-blur":new yt(P.paint_line["line-blur"]),"line-dasharray":new Vi(P.paint_line["line-dasharray"]),"line-pattern":new tc(P.paint_line["line-pattern"]),"line-gradient":new ic(P.paint_line["line-gradient"])})},get layout(){return Gf=Gf||new lr({"line-cap":new mt(P.layout_line["line-cap"]),"line-join":new yt(P.layout_line["line-join"]),"line-miter-limit":new mt(P.layout_line["line-miter-limit"]),"line-round-limit":new mt(P.layout_line["line-round-limit"]),"line-sort-key":new yt(P.layout_line["line-sort-key"])})}};class ni extends yt{possiblyEvaluate(t,r){return r=new Pi(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(t,r)}evaluate(t,r,o,h){return r=Rt({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(t,r,o,h)}}let ri;class Gi extends za{constructor(t){super(t,Li),this.gradientVersion=0,ri||(ri=new ni(Li.paint.properties["line-width"].specification),ri.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const r=this.gradientExpression();this.stepInterpolant=!!function(o){return o._styleExpression!==void 0}(r)&&r._styleExpression.expression instanceof Za,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,r){super.recalculate(t,r),this.paint._values["line-floorwidth"]=ri.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new $d(t)}queryRadius(t){const r=t,o=pa(cu("line-width",this,r),cu("line-gap-width",this,r)),h=cu("line-offset",this,r);return o/2+Math.abs(h)+uu(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:o,geometry:h,transform:g,pixelsToTileUnits:_}){const v=eh(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-g.bearingInRadians,_),w=_/2*pa(this.paint.get("line-width").evaluate(r,o),this.paint.get("line-gap-width").evaluate(r,o)),M=this.paint.get("line-offset").evaluate(r,o);return M&&(h=function(C,A){const R=[];for(let k=0;k<C.length;k++){const j=C[k],U=[];for(let H=0;H<j.length;H++){const Q=j[H-1],ue=j[H],te=j[H+1],L=H===0?new st(0,0):ue.sub(Q)._unit()._perp(),G=H===j.length-1?new st(0,0):te.sub(ue)._unit()._perp(),ie=L._add(G)._unit(),Te=ie.x*G.x+ie.y*G.y;Te!==0&&ie._mult(1/Te),U.push(ie._mult(A)._add(ue))}R.push(U)}return R}(h,M*_)),function(C,A,R){for(let k=0;k<A.length;k++){const j=A[k];if(C.length>=3){for(let U=0;U<j.length;U++)if(ll(C,j[U]))return!0}if(If(C,j,R))return!0}return!1}(v,h,w)}isTileClipped(){return!0}}function pa(a,t){return t>0?t+2*a:a}const Po=Xi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),gu=Xi([{name:"a_projected_pos",components:3,type:"Float32"}],4);Xi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Xd=Xi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Xi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Qs=Xi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Mn=Xi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function bl(a,t,r){return a.sections.forEach(o=>{o.text=function(h,g,_){const v=g.layout.get("text-transform").evaluate(_,{});return v==="uppercase"?h=h.toLocaleUpperCase():v==="lowercase"&&(h=h.toLocaleLowerCase()),Aa.applyArabicShaping&&(h=Aa.applyArabicShaping(h)),h}(o.text,t,r)}),a}Xi([{name:"triangle",components:3,type:"Uint16"}]),Xi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Xi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Xi([{type:"Float32",name:"offsetX"}]),Xi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Xi([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const vs={"!":"ï¸•","#":"ï¼ƒ",$:"ï¼„","%":"ï¼…","&":"ï¼†","(":"ï¸µ",")":"ï¸¶","*":"ï¼Š","+":"ï¼‹",",":"ï¸","-":"ï¸²",".":"ãƒ»","/":"ï¼",":":"ï¸“",";":"ï¸”","<":"ï¸¿","=":"ï¼",">":"ï¹€","?":"ï¸–","@":"ï¼ ","[":"ï¹‡","\\":"ï¼¼","]":"ï¹ˆ","^":"ï¼¾",_:"ï¸³","`":"ï½€","{":"ï¸·","|":"â€•","}":"ï¸¸","~":"ï½ž","Â¢":"ï¿ ","Â£":"ï¿¡","Â¥":"ï¿¥","Â¦":"ï¿¤","Â¬":"ï¿¢","Â¯":"ï¿£","â€“":"ï¸²","â€”":"ï¸±","â€˜":"ï¹ƒ","â€™":"ï¹„","â€œ":"ï¹","â€":"ï¹‚","â€¦":"ï¸™","â€§":"ãƒ»","â‚©":"ï¿¦","ã€":"ï¸‘","ã€‚":"ï¸’","ã€ˆ":"ï¸¿","ã€‰":"ï¹€","ã€Š":"ï¸½","ã€‹":"ï¸¾","ã€Œ":"ï¹","ã€":"ï¹‚","ã€Ž":"ï¹ƒ","ã€":"ï¹„","ã€":"ï¸»","ã€‘":"ï¸¼","ã€”":"ï¸¹","ã€•":"ï¸º","ã€–":"ï¸—","ã€—":"ï¸˜","ï¼":"ï¸•","ï¼ˆ":"ï¸µ","ï¼‰":"ï¸¶","ï¼Œ":"ï¸","ï¼":"ï¸²","ï¼Ž":"ãƒ»","ï¼š":"ï¸“","ï¼›":"ï¸”","ï¼œ":"ï¸¿","ï¼ž":"ï¹€","ï¼Ÿ":"ï¸–","ï¼»":"ï¹‡","ï¼½":"ï¹ˆ","ï¼¿":"ï¸³","ï½›":"ï¸·","ï½œ":"â€•","ï½":"ï¸¸","ï½Ÿ":"ï¸µ","ï½ ":"ï¸¶","ï½¡":"ï¸’","ï½¢":"ï¹","ï½£":"ï¹‚"};var Kh,ma,gc,Wi=24,Ja={};function Yd(){return Kh||(Kh=1,Ja.read=function(a,t,r,o,h){var g,_,v=8*h-o-1,w=(1<<v)-1,M=w>>1,C=-7,A=r?h-1:0,R=r?-1:1,k=a[t+A];for(A+=R,g=k&(1<<-C)-1,k>>=-C,C+=v;C>0;g=256*g+a[t+A],A+=R,C-=8);for(_=g&(1<<-C)-1,g>>=-C,C+=o;C>0;_=256*_+a[t+A],A+=R,C-=8);if(g===0)g=1-M;else{if(g===w)return _?NaN:1/0*(k?-1:1);_+=Math.pow(2,o),g-=M}return(k?-1:1)*_*Math.pow(2,g-o)},Ja.write=function(a,t,r,o,h,g){var _,v,w,M=8*g-h-1,C=(1<<M)-1,A=C>>1,R=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,k=o?0:g-1,j=o?1:-1,U=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(v=isNaN(t)?1:0,_=C):(_=Math.floor(Math.log(t)/Math.LN2),t*(w=Math.pow(2,-_))<1&&(_--,w*=2),(t+=_+A>=1?R/w:R*Math.pow(2,1-A))*w>=2&&(_++,w/=2),_+A>=C?(v=0,_=C):_+A>=1?(v=(t*w-1)*Math.pow(2,h),_+=A):(v=t*Math.pow(2,A-1)*Math.pow(2,h),_=0));h>=8;a[r+k]=255&v,k+=j,v/=256,h-=8);for(_=_<<h|v,M+=h;M>0;a[r+k]=255&_,k+=j,_/=256,M-=8);a[r+k-j]|=128*U}),Ja}function Qh(){if(gc)return ma;gc=1,ma=t;var a=Yd();function t(L){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(L)?L:new Uint8Array(L||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var r=4294967296,o=1/r,h=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function g(L){return L.type===t.Bytes?L.readVarint()+L.pos:L.pos+1}function _(L,G,ie){return ie?4294967296*G+(L>>>0):4294967296*(G>>>0)+(L>>>0)}function v(L,G,ie){var Te=G<=16383?1:G<=2097151?2:G<=268435455?3:Math.floor(Math.log(G)/(7*Math.LN2));ie.realloc(Te);for(var qe=ie.pos-1;qe>=L;qe--)ie.buf[qe+Te]=ie.buf[qe]}function w(L,G){for(var ie=0;ie<L.length;ie++)G.writeVarint(L[ie])}function M(L,G){for(var ie=0;ie<L.length;ie++)G.writeSVarint(L[ie])}function C(L,G){for(var ie=0;ie<L.length;ie++)G.writeFloat(L[ie])}function A(L,G){for(var ie=0;ie<L.length;ie++)G.writeDouble(L[ie])}function R(L,G){for(var ie=0;ie<L.length;ie++)G.writeBoolean(L[ie])}function k(L,G){for(var ie=0;ie<L.length;ie++)G.writeFixed32(L[ie])}function j(L,G){for(var ie=0;ie<L.length;ie++)G.writeSFixed32(L[ie])}function U(L,G){for(var ie=0;ie<L.length;ie++)G.writeFixed64(L[ie])}function H(L,G){for(var ie=0;ie<L.length;ie++)G.writeSFixed64(L[ie])}function Q(L,G){return(L[G]|L[G+1]<<8|L[G+2]<<16)+16777216*L[G+3]}function ue(L,G,ie){L[ie]=G,L[ie+1]=G>>>8,L[ie+2]=G>>>16,L[ie+3]=G>>>24}function te(L,G){return(L[G]|L[G+1]<<8|L[G+2]<<16)+(L[G+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(L,G,ie){for(ie=ie||this.length;this.pos<ie;){var Te=this.readVarint(),qe=Te>>3,Ae=this.pos;this.type=7&Te,L(qe,G,this),this.pos===Ae&&this.skip(Te)}return G},readMessage:function(L,G){return this.readFields(L,G,this.readVarint()+this.pos)},readFixed32:function(){var L=Q(this.buf,this.pos);return this.pos+=4,L},readSFixed32:function(){var L=te(this.buf,this.pos);return this.pos+=4,L},readFixed64:function(){var L=Q(this.buf,this.pos)+Q(this.buf,this.pos+4)*r;return this.pos+=8,L},readSFixed64:function(){var L=Q(this.buf,this.pos)+te(this.buf,this.pos+4)*r;return this.pos+=8,L},readFloat:function(){var L=a.read(this.buf,this.pos,!0,23,4);return this.pos+=4,L},readDouble:function(){var L=a.read(this.buf,this.pos,!0,52,8);return this.pos+=8,L},readVarint:function(L){var G,ie,Te=this.buf;return G=127&(ie=Te[this.pos++]),ie<128?G:(G|=(127&(ie=Te[this.pos++]))<<7,ie<128?G:(G|=(127&(ie=Te[this.pos++]))<<14,ie<128?G:(G|=(127&(ie=Te[this.pos++]))<<21,ie<128?G:function(qe,Ae,De){var Xe,$e,Ye=De.buf;if(Xe=(112&($e=Ye[De.pos++]))>>4,$e<128||(Xe|=(127&($e=Ye[De.pos++]))<<3,$e<128)||(Xe|=(127&($e=Ye[De.pos++]))<<10,$e<128)||(Xe|=(127&($e=Ye[De.pos++]))<<17,$e<128)||(Xe|=(127&($e=Ye[De.pos++]))<<24,$e<128)||(Xe|=(1&($e=Ye[De.pos++]))<<31,$e<128))return _(qe,Xe,Ae);throw new Error("Expected varint not more than 10 bytes")}(G|=(15&(ie=Te[this.pos]))<<28,L,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var L=this.readVarint();return L%2==1?(L+1)/-2:L/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var L=this.readVarint()+this.pos,G=this.pos;return this.pos=L,L-G>=12&&h?function(ie,Te,qe){return h.decode(ie.subarray(Te,qe))}(this.buf,G,L):function(ie,Te,qe){for(var Ae="",De=Te;De<qe;){var Xe,$e,Ye,Be=ie[De],ut=null,wt=Be>239?4:Be>223?3:Be>191?2:1;if(De+wt>qe)break;wt===1?Be<128&&(ut=Be):wt===2?(192&(Xe=ie[De+1]))==128&&(ut=(31&Be)<<6|63&Xe)<=127&&(ut=null):wt===3?($e=ie[De+2],(192&(Xe=ie[De+1]))==128&&(192&$e)==128&&((ut=(15&Be)<<12|(63&Xe)<<6|63&$e)<=2047||ut>=55296&&ut<=57343)&&(ut=null)):wt===4&&($e=ie[De+2],Ye=ie[De+3],(192&(Xe=ie[De+1]))==128&&(192&$e)==128&&(192&Ye)==128&&((ut=(15&Be)<<18|(63&Xe)<<12|(63&$e)<<6|63&Ye)<=65535||ut>=1114112)&&(ut=null)),ut===null?(ut=65533,wt=1):ut>65535&&(ut-=65536,Ae+=String.fromCharCode(ut>>>10&1023|55296),ut=56320|1023&ut),Ae+=String.fromCharCode(ut),De+=wt}return Ae}(this.buf,G,L)},readBytes:function(){var L=this.readVarint()+this.pos,G=this.buf.subarray(this.pos,L);return this.pos=L,G},readPackedVarint:function(L,G){if(this.type!==t.Bytes)return L.push(this.readVarint(G));var ie=g(this);for(L=L||[];this.pos<ie;)L.push(this.readVarint(G));return L},readPackedSVarint:function(L){if(this.type!==t.Bytes)return L.push(this.readSVarint());var G=g(this);for(L=L||[];this.pos<G;)L.push(this.readSVarint());return L},readPackedBoolean:function(L){if(this.type!==t.Bytes)return L.push(this.readBoolean());var G=g(this);for(L=L||[];this.pos<G;)L.push(this.readBoolean());return L},readPackedFloat:function(L){if(this.type!==t.Bytes)return L.push(this.readFloat());var G=g(this);for(L=L||[];this.pos<G;)L.push(this.readFloat());return L},readPackedDouble:function(L){if(this.type!==t.Bytes)return L.push(this.readDouble());var G=g(this);for(L=L||[];this.pos<G;)L.push(this.readDouble());return L},readPackedFixed32:function(L){if(this.type!==t.Bytes)return L.push(this.readFixed32());var G=g(this);for(L=L||[];this.pos<G;)L.push(this.readFixed32());return L},readPackedSFixed32:function(L){if(this.type!==t.Bytes)return L.push(this.readSFixed32());var G=g(this);for(L=L||[];this.pos<G;)L.push(this.readSFixed32());return L},readPackedFixed64:function(L){if(this.type!==t.Bytes)return L.push(this.readFixed64());var G=g(this);for(L=L||[];this.pos<G;)L.push(this.readFixed64());return L},readPackedSFixed64:function(L){if(this.type!==t.Bytes)return L.push(this.readSFixed64());var G=g(this);for(L=L||[];this.pos<G;)L.push(this.readSFixed64());return L},skip:function(L){var G=7&L;if(G===t.Varint)for(;this.buf[this.pos++]>127;);else if(G===t.Bytes)this.pos=this.readVarint()+this.pos;else if(G===t.Fixed32)this.pos+=4;else{if(G!==t.Fixed64)throw new Error("Unimplemented type: "+G);this.pos+=8}},writeTag:function(L,G){this.writeVarint(L<<3|G)},realloc:function(L){for(var G=this.length||16;G<this.pos+L;)G*=2;if(G!==this.length){var ie=new Uint8Array(G);ie.set(this.buf),this.buf=ie,this.length=G}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(L){this.realloc(4),ue(this.buf,L,this.pos),this.pos+=4},writeSFixed32:function(L){this.realloc(4),ue(this.buf,L,this.pos),this.pos+=4},writeFixed64:function(L){this.realloc(8),ue(this.buf,-1&L,this.pos),ue(this.buf,Math.floor(L*o),this.pos+4),this.pos+=8},writeSFixed64:function(L){this.realloc(8),ue(this.buf,-1&L,this.pos),ue(this.buf,Math.floor(L*o),this.pos+4),this.pos+=8},writeVarint:function(L){(L=+L||0)>268435455||L<0?function(G,ie){var Te,qe;if(G>=0?(Te=G%4294967296|0,qe=G/4294967296|0):(qe=~(-G/4294967296),4294967295^(Te=~(-G%4294967296))?Te=Te+1|0:(Te=0,qe=qe+1|0)),G>=18446744073709552e3||G<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ie.realloc(10),function(Ae,De,Xe){Xe.buf[Xe.pos++]=127&Ae|128,Ae>>>=7,Xe.buf[Xe.pos++]=127&Ae|128,Ae>>>=7,Xe.buf[Xe.pos++]=127&Ae|128,Ae>>>=7,Xe.buf[Xe.pos++]=127&Ae|128,Xe.buf[Xe.pos]=127&(Ae>>>=7)}(Te,0,ie),function(Ae,De){var Xe=(7&Ae)<<4;De.buf[De.pos++]|=Xe|((Ae>>>=3)?128:0),Ae&&(De.buf[De.pos++]=127&Ae|((Ae>>>=7)?128:0),Ae&&(De.buf[De.pos++]=127&Ae|((Ae>>>=7)?128:0),Ae&&(De.buf[De.pos++]=127&Ae|((Ae>>>=7)?128:0),Ae&&(De.buf[De.pos++]=127&Ae|((Ae>>>=7)?128:0),Ae&&(De.buf[De.pos++]=127&Ae)))))}(qe,ie)}(L,this):(this.realloc(4),this.buf[this.pos++]=127&L|(L>127?128:0),L<=127||(this.buf[this.pos++]=127&(L>>>=7)|(L>127?128:0),L<=127||(this.buf[this.pos++]=127&(L>>>=7)|(L>127?128:0),L<=127||(this.buf[this.pos++]=L>>>7&127))))},writeSVarint:function(L){this.writeVarint(L<0?2*-L-1:2*L)},writeBoolean:function(L){this.writeVarint(!!L)},writeString:function(L){L=String(L),this.realloc(4*L.length),this.pos++;var G=this.pos;this.pos=function(Te,qe,Ae){for(var De,Xe,$e=0;$e<qe.length;$e++){if((De=qe.charCodeAt($e))>55295&&De<57344){if(!Xe){De>56319||$e+1===qe.length?(Te[Ae++]=239,Te[Ae++]=191,Te[Ae++]=189):Xe=De;continue}if(De<56320){Te[Ae++]=239,Te[Ae++]=191,Te[Ae++]=189,Xe=De;continue}De=Xe-55296<<10|De-56320|65536,Xe=null}else Xe&&(Te[Ae++]=239,Te[Ae++]=191,Te[Ae++]=189,Xe=null);De<128?Te[Ae++]=De:(De<2048?Te[Ae++]=De>>6|192:(De<65536?Te[Ae++]=De>>12|224:(Te[Ae++]=De>>18|240,Te[Ae++]=De>>12&63|128),Te[Ae++]=De>>6&63|128),Te[Ae++]=63&De|128)}return Ae}(this.buf,L,this.pos);var ie=this.pos-G;ie>=128&&v(G,ie,this),this.pos=G-1,this.writeVarint(ie),this.pos+=ie},writeFloat:function(L){this.realloc(4),a.write(this.buf,L,this.pos,!0,23,4),this.pos+=4},writeDouble:function(L){this.realloc(8),a.write(this.buf,L,this.pos,!0,52,8),this.pos+=8},writeBytes:function(L){var G=L.length;this.writeVarint(G),this.realloc(G);for(var ie=0;ie<G;ie++)this.buf[this.pos++]=L[ie]},writeRawMessage:function(L,G){this.pos++;var ie=this.pos;L(G,this);var Te=this.pos-ie;Te>=128&&v(ie,Te,this),this.pos=ie-1,this.writeVarint(Te),this.pos+=Te},writeMessage:function(L,G,ie){this.writeTag(L,t.Bytes),this.writeRawMessage(G,ie)},writePackedVarint:function(L,G){G.length&&this.writeMessage(L,w,G)},writePackedSVarint:function(L,G){G.length&&this.writeMessage(L,M,G)},writePackedBoolean:function(L,G){G.length&&this.writeMessage(L,R,G)},writePackedFloat:function(L,G){G.length&&this.writeMessage(L,C,G)},writePackedDouble:function(L,G){G.length&&this.writeMessage(L,A,G)},writePackedFixed32:function(L,G){G.length&&this.writeMessage(L,k,G)},writePackedSFixed32:function(L,G){G.length&&this.writeMessage(L,j,G)},writePackedFixed64:function(L,G){G.length&&this.writeMessage(L,U,G)},writePackedSFixed64:function(L,G){G.length&&this.writeMessage(L,H,G)},writeBytesField:function(L,G){this.writeTag(L,t.Bytes),this.writeBytes(G)},writeFixed32Field:function(L,G){this.writeTag(L,t.Fixed32),this.writeFixed32(G)},writeSFixed32Field:function(L,G){this.writeTag(L,t.Fixed32),this.writeSFixed32(G)},writeFixed64Field:function(L,G){this.writeTag(L,t.Fixed64),this.writeFixed64(G)},writeSFixed64Field:function(L,G){this.writeTag(L,t.Fixed64),this.writeSFixed64(G)},writeVarintField:function(L,G){this.writeTag(L,t.Varint),this.writeVarint(G)},writeSVarintField:function(L,G){this.writeTag(L,t.Varint),this.writeSVarint(G)},writeStringField:function(L,G){this.writeTag(L,t.Bytes),this.writeString(G)},writeFloatField:function(L,G){this.writeTag(L,t.Fixed32),this.writeFloat(G)},writeDoubleField:function(L,G){this.writeTag(L,t.Fixed64),this.writeDouble(G)},writeBooleanField:function(L,G){this.writeVarintField(L,!!G)}},ma}var _u=it(Qh());const yu=3;function wl(a,t,r){a===1&&r.readMessage(Wh,t)}function Wh(a,t,r){if(a===3){const{id:o,bitmap:h,width:g,height:_,left:v,top:w,advance:M}=r.readMessage(_c,{});t.push({id:o,bitmap:new To({width:g+2*yu,height:_+2*yu},h),metrics:{width:g,height:_,left:v,top:w,advance:M}})}}function _c(a,t,r){a===1?t.id=r.readVarint():a===2?t.bitmap=r.readBytes():a===3?t.width=r.readVarint():a===4?t.height=r.readVarint():a===5?t.left=r.readSVarint():a===6?t.top=r.readSVarint():a===7&&(t.advance=r.readVarint())}const hh=yu;function Jh(a){let t=0,r=0;for(const _ of a)t+=_.w*_.h,r=Math.max(r,_.w);a.sort((_,v)=>v.h-_.h);const o=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}];let h=0,g=0;for(const _ of a)for(let v=o.length-1;v>=0;v--){const w=o[v];if(!(_.w>w.w||_.h>w.h)){if(_.x=w.x,_.y=w.y,g=Math.max(g,_.y+_.h),h=Math.max(h,_.x+_.w),_.w===w.w&&_.h===w.h){const M=o.pop();v<o.length&&(o[v]=M)}else _.h===w.h?(w.x+=_.w,w.w-=_.w):_.w===w.w?(w.y+=_.h,w.h-=_.h):(o.push({x:w.x+_.w,y:w.y,w:w.w-_.w,h:_.h}),w.y+=_.h,w.h-=_.h);break}}return{w:h,h:g,fill:t/(h*g)||0}}const Sr=1;class yc{constructor(t,{pixelRatio:r,version:o,stretchX:h,stretchY:g,content:_,textFitWidth:v,textFitHeight:w}){this.paddedRect=t,this.pixelRatio=r,this.stretchX=h,this.stretchY=g,this.content=_,this.version=o,this.textFitWidth=v,this.textFitHeight=w}get tl(){return[this.paddedRect.x+Sr,this.paddedRect.y+Sr]}get br(){return[this.paddedRect.x+this.paddedRect.w-Sr,this.paddedRect.y+this.paddedRect.h-Sr]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Sr)/this.pixelRatio,(this.paddedRect.h-2*Sr)/this.pixelRatio]}}class ed{constructor(t,r){const o={},h={};this.haveRenderCallbacks=[];const g=[];this.addImages(t,o,g),this.addImages(r,h,g);const{w:_,h:v}=Jh(g),w=new Rr({width:_||1,height:v||1});for(const M in t){const C=t[M],A=o[M].paddedRect;Rr.copy(C.data,w,{x:0,y:0},{x:A.x+Sr,y:A.y+Sr},C.data)}for(const M in r){const C=r[M],A=h[M].paddedRect,R=A.x+Sr,k=A.y+Sr,j=C.data.width,U=C.data.height;Rr.copy(C.data,w,{x:0,y:0},{x:R,y:k},C.data),Rr.copy(C.data,w,{x:0,y:U-1},{x:R,y:k-1},{width:j,height:1}),Rr.copy(C.data,w,{x:0,y:0},{x:R,y:k+U},{width:j,height:1}),Rr.copy(C.data,w,{x:j-1,y:0},{x:R-1,y:k},{width:1,height:U}),Rr.copy(C.data,w,{x:0,y:0},{x:R+j,y:k},{width:1,height:U})}this.image=w,this.iconPositions=o,this.patternPositions=h}addImages(t,r,o){for(const h in t){const g=t[h],_={x:0,y:0,w:g.data.width+2*Sr,h:g.data.height+2*Sr};o.push(_),r[h]=new yc(_,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(t,r){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const o in t.updatedImages)this.patchUpdatedImage(this.iconPositions[o],t.getImage(o),r),this.patchUpdatedImage(this.patternPositions[o],t.getImage(o),r)}patchUpdatedImage(t,r,o){if(!t||!r||t.version===r.version)return;t.version=r.version;const[h,g]=t.tl;o.update(r.data,void 0,{x:h,y:g})}}var Zn;nt("ImagePosition",yc),nt("ImageAtlas",ed),O.ag=void 0,(Zn=O.ag||(O.ag={}))[Zn.none=0]="none",Zn[Zn.horizontal=1]="horizontal",Zn[Zn.vertical=2]="vertical",Zn[Zn.horizontalOnly=3]="horizontalOnly";const dh=-17;class rr{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,r,o){const h=new rr;return h.scale=t||1,h.fontStack=r,h.verticalAlign=o||"bottom",h}static forImage(t,r){const o=new rr;return o.imageName=t,o.verticalAlign=r||"bottom",o}}class vc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,r){const o=new vc;for(let h=0;h<t.sections.length;h++){const g=t.sections[h];g.image?o.addImageSection(g):o.addTextSection(g,r)}return o}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let r="";for(let o=0;o<t.length;o++){const h=t.charCodeAt(o+1)||null,g=t.charCodeAt(o-1)||null;r+=h&&nu(h)&&!vs[t[o+1]]||g&&nu(g)&&!vs[t[o-1]]||!vs[t[o]]?t[o]:vs[t[o]]}return r}(this.text)}trim(){let t=0;for(let o=0;o<this.text.length&&fh[this.text.charCodeAt(o)];o++)t++;let r=this.text.length;for(let o=this.text.length-1;o>=0&&o>=t&&fh[this.text.charCodeAt(o)];o--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)}substring(t,r){const o=new vc;return o.text=this.text.substring(t,r),o.sectionIndex=this.sectionIndex.slice(t,r),o.sections=this.sections,o}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,r)=>Math.max(t,this.sections[r].scale),0)}getMaxImageSize(t){let r=0,o=0;for(let h=0;h<this.length();h++){const g=this.getSection(h);if(g.imageName){const _=t[g.imageName];if(!_)continue;const v=_.displaySize;r=Math.max(r,v[0]),o=Math.max(o,v[1])}}return{maxImageWidth:r,maxImageHeight:o}}addTextSection(t,r){this.text+=t.text,this.sections.push(rr.forText(t.scale,t.fontStack||r,t.verticalAlign));const o=this.sections.length-1;for(let h=0;h<t.text.length;++h)this.sectionIndex.push(o)}addImageSection(t){const r=t.image?t.image.name:"";if(r.length===0)return void Di("Can't add FormattedSection with an empty image.");const o=this.getNextImageSectionCharCode();o?(this.text+=String.fromCharCode(o),this.sections.push(rr.forImage(r,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Di("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function vu(a,t,r,o,h,g,_,v,w,M,C,A,R,k,j){const U=vc.fromFeature(a,h);let H;A===O.ag.vertical&&U.verticalizePunctuation();const{processBidirectionalText:Q,processStyledBidirectionalText:ue}=Aa;if(Q&&U.sections.length===1){H=[];const G=Q(U.toString(),id(U,M,g,t,o,k));for(const ie of G){const Te=new vc;Te.text=ie,Te.sections=U.sections;for(let qe=0;qe<ie.length;qe++)Te.sectionIndex.push(0);H.push(Te)}}else if(ue){H=[];const G=ue(U.text,U.sectionIndex,id(U,M,g,t,o,k));for(const ie of G){const Te=new vc;Te.text=ie[0],Te.sectionIndex=ie[1],Te.sections=U.sections,H.push(Te)}}else H=function(G,ie){const Te=[],qe=G.text;let Ae=0;for(const De of ie)Te.push(G.substring(Ae,De)),Ae=De;return Ae<qe.length&&Te.push(G.substring(Ae,qe.length)),Te}(U,id(U,M,g,t,o,k));const te=[],L={positionedLines:te,text:U.toString(),top:C[1],bottom:C[1],left:C[0],right:C[0],writingMode:A,iconsInText:!1,verticalizable:!1};return function(G,ie,Te,qe,Ae,De,Xe,$e,Ye,Be,ut,wt){let vt=0,dt=0,Ht=0,qi=0;const yn=$e==="right"?1:$e==="left"?0:.5,Ji=Wi/wt;let qn=0;for(const wi of Ae){wi.trim();const Oi=wi.getMaxScale(),ar={positionedGlyphs:[],lineOffset:0};G.positionedLines[qn]=ar;const Hn=ar.positionedGlyphs;let $n=0;if(!wi.length()){dt+=De,++qn;continue}const Ba=Wd(qe,wi,Ji);for(let hr=0;hr<wi.length();hr++){const Cn=wi.getSection(hr),Xn=wi.getSectionIndex(hr),xn=wi.getCharCode(hr),en=mp(Ye,ut,xn);let Ci;if(Cn.imageName){if(G.iconsInText=!0,Cn.scale=Cn.scale*Ji,Ci=Hf(Cn,en,Oi,Ba,qe),!Ci)continue;$n=Math.max($n,Ci.imageOffset)}else if(Ci=gp(Cn,xn,en,Ba,ie,Te),!Ci)continue;const{rect:Wr,metrics:zl,baselineOffset:_a}=Ci;Hn.push({glyph:xn,imageName:Cn.imageName,x:vt,y:dt+_a+dh,vertical:en,scale:Cn.scale,fontStack:Cn.fontStack,sectionIndex:Xn,metrics:zl,rect:Wr}),en?(G.verticalizable=!0,vt+=(Cn.imageName?zl.advance:Wi)*Cn.scale+Be):vt+=zl.advance*Cn.scale+Be}Hn.length!==0&&(Ht=Math.max(vt-Be,Ht),$f(Hn,0,Hn.length-1,yn)),vt=0,ar.lineOffset=Math.max($n,(Oi-1)*Wi);const On=De*Oi+$n;dt+=On,qi=Math.max(On,qi),++qn}const{horizontalAlign:En,verticalAlign:vn}=mh(Xe);(function(wi,Oi,ar,Hn,$n,Ba,On,hr,Cn){const Xn=(Oi-ar)*$n;let xn=0;xn=Ba!==On?-hr*Hn-dh:-Hn*Cn*On+.5*On;for(const en of wi)for(const Ci of en.positionedGlyphs)Ci.x+=Xn,Ci.y+=xn})(G.positionedLines,yn,En,vn,Ht,qi,De,dt,Ae.length),G.top+=-vn*dt,G.bottom=G.top+dt,G.left+=-En*Ht,G.right=G.left+Ht}(L,t,r,o,H,_,v,w,A,M,R,j),!function(G){for(const ie of G)if(ie.positionedGlyphs.length!==0)return!1;return!0}(te)&&L}const fh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},pp={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Do={40:!0};function ph(a,t,r,o,h,g){if(t.imageName){const _=o[t.imageName];return _?_.displaySize[0]*t.scale*Wi/g+h:0}{const _=r[t.fontStack],v=_&&_[a];return v?v.metrics.advance*t.scale+h:0}}function td(a,t,r,o){const h=Math.pow(a-t,2);return o?a<t?h/2:2*h:h+Math.abs(r)*r}function xu(a,t,r){let o=0;return a===10&&(o-=1e4),r&&(o+=150),a!==40&&a!==65288||(o+=50),t!==41&&t!==65289||(o+=50),o}function Kd(a,t,r,o,h,g){let _=null,v=td(t,r,h,g);for(const w of o){const M=td(t-w.x,r,h,g)+w.badness;M<=v&&(_=w,v=M)}return{index:a,x:t,priorBreak:_,badness:v}}function Qd(a){return a?Qd(a.priorBreak).concat(a.index):[]}function id(a,t,r,o,h,g){if(!a)return[];const _=[],v=function(A,R,k,j,U,H){let Q=0;for(let ue=0;ue<A.length();ue++){const te=A.getSection(ue);Q+=ph(A.getCharCode(ue),te,j,U,R,H)}return Q/Math.max(1,Math.ceil(Q/k))}(a,t,r,o,h,g),w=a.text.indexOf("â€‹")>=0;let M=0;for(let A=0;A<a.length();A++){const R=a.getSection(A),k=a.getCharCode(A);if(fh[k]||(M+=ph(k,R,o,h,t,g)),A<a.length()-1){const j=!((C=k)<11904)&&(!!Tt["CJK Compatibility Forms"](C)||!!Tt["CJK Compatibility"](C)||!!Tt["CJK Strokes"](C)||!!Tt["CJK Symbols and Punctuation"](C)||!!Tt["Enclosed CJK Letters and Months"](C)||!!Tt["Halfwidth and Fullwidth Forms"](C)||!!Tt["Ideographic Description Characters"](C)||!!Tt["Vertical Forms"](C)||Fs.test(String.fromCodePoint(C)));(pp[k]||j||R.imageName||A!==a.length()-2&&Do[a.getCharCode(A+1)])&&_.push(Kd(A+1,M,v,_,xu(k,a.getCharCode(A+1),j&&w),!1))}}var C;return Qd(Kd(a.length(),M,v,_,0,!0))}function mh(a){let t=.5,r=.5;switch(a){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function Wd(a,t,r){const o=t.getMaxScale()*Wi,{maxImageWidth:h,maxImageHeight:g}=t.getMaxImageSize(a),_=Math.max(o,g*r);return{verticalLineContentWidth:Math.max(o,h*r),horizontalLineContentHeight:_}}function qf(a){switch(a){case"top":return 0;case"center":return .5;default:return 1}}function mp(a,t,r){return!(a===O.ag.horizontal||!t&&!$u(r)||t&&(fh[r]||(o=r,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(o)))));var o}function gp(a,t,r,o,h,g){const _=g[a.fontStack],v=function(M,C,A,R){if(M&&M.rect)return M;const k=C[A.fontStack],j=k&&k[R];return j?{rect:null,metrics:j.metrics}:null}(_&&_[t],h,a,t);if(v===null)return null;let w;if(r)w=o.verticalLineContentWidth-a.scale*Wi;else{const M=qf(a.verticalAlign);w=(o.horizontalLineContentHeight-a.scale*Wi)*M}return{rect:v.rect,metrics:v.metrics,baselineOffset:w}}function Hf(a,t,r,o,h){const g=h[a.imageName];if(!g)return null;const _=g.paddedRect,v=g.displaySize,w={width:v[0],height:v[1],left:Sr,top:-3,advance:t?v[1]:v[0]};let M;if(t)M=o.verticalLineContentWidth-v[1]*a.scale;else{const C=qf(a.verticalAlign);M=(o.horizontalLineContentHeight-v[1]*a.scale)*C}return{rect:_,metrics:w,baselineOffset:M,imageOffset:(t?v[0]:v[1])*a.scale-Wi*r}}function $f(a,t,r,o){if(o===0)return;const h=a[r],g=(a[r].x+h.metrics.advance*h.scale)*o;for(let _=t;_<=r;_++)a[_].x-=g}function bu(a,t,r){const{horizontalAlign:o,verticalAlign:h}=mh(r),g=t[0]-a.displaySize[0]*o,_=t[1]-a.displaySize[1]*h;return{image:a,top:_,bottom:_+a.displaySize[1],left:g,right:g+a.displaySize[0]}}function gh(a){var t,r;let o=a.left,h=a.top,g=a.right-o,_=a.bottom-h;const v=(t=a.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",w=(r=a.image.textFitHeight)!==null&&r!==void 0?r:"stretchOrShrink",M=(a.image.content[2]-a.image.content[0])/(a.image.content[3]-a.image.content[1]);if(w==="proportional"){if(v==="stretchOnly"&&g/_<M||v==="proportional"){const C=Math.ceil(_*M);o*=C/g,g=C}}else if(v==="proportional"&&w==="stretchOnly"&&M!==0&&g/_>M){const C=Math.ceil(g/M);h*=C/_,_=C}return{x1:o,y1:h,x2:o+g,y2:h+_}}function Jd(a,t,r,o,h,g){const _=a.image;let v;if(_.content){const H=_.content,Q=_.pixelRatio||1;v=[H[0]/Q,H[1]/Q,_.displaySize[0]-H[2]/Q,_.displaySize[1]-H[3]/Q]}const w=t.left*g,M=t.right*g;let C,A,R,k;r==="width"||r==="both"?(k=h[0]+w-o[3],A=h[0]+M+o[1]):(k=h[0]+(w+M-_.displaySize[0])/2,A=k+_.displaySize[0]);const j=t.top*g,U=t.bottom*g;return r==="height"||r==="both"?(C=h[1]+j-o[0],R=h[1]+U+o[2]):(C=h[1]+(j+U-_.displaySize[1])/2,R=C+_.displaySize[1]),{image:_,top:C,right:A,bottom:R,left:k,collisionPadding:v}}const wu=255,Ws=128,Io=wu*Ws;function xc(a,t){const{expression:r}=t;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Pi(a+1))};if(r.kind==="source")return{kind:"source"};{const{zoomStops:o,interpolationType:h}=r;let g=0;for(;g<o.length&&o[g]<=a;)g++;g=Math.max(0,g-1);let _=g;for(;_<o.length&&o[_]<a+1;)_++;_=Math.min(o.length-1,_);const v=o[g],w=o[_];return r.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:w,interpolationType:h}:{kind:"camera",minZoom:v,maxZoom:w,minSize:r.evaluate(new Pi(v)),maxSize:r.evaluate(new Pi(w)),interpolationType:h}}}function nd(a,t,r){let o="never";const h=a.get(t);return h?o=h:a.get(r)&&(o="always"),o}const Bi=yl.VectorTileFeature.types,ef=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function rd(a,t,r,o,h,g,_,v,w,M,C,A,R){const k=v?Math.min(Io,Math.round(v[0])):0,j=v?Math.min(Io,Math.round(v[1])):0;a.emplaceBack(t,r,Math.round(32*o),Math.round(32*h),g,_,(k<<1)+(w?1:0),j,16*M,16*C,256*A,256*R)}function ad(a,t,r){a.emplaceBack(t.x,t.y,r),a.emplaceBack(t.x,t.y,r),a.emplaceBack(t.x,t.y,r),a.emplaceBack(t.x,t.y,r)}function _p(a){for(const t of a.sections)if(au(t.text))return!0;return!1}class tf{constructor(t){this.layoutVertexArray=new we,this.indexArray=new et,this.programConfigurations=t,this.segments=new _t,this.dynamicLayoutVertexArray=new Me,this.opacityVertexArray=new ke,this.hasVisibleVertices=!1,this.placedSymbolArray=new T}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,r,o,h){this.isEmpty()||(o&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Po.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,gu.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,ef,!0),this.opacityVertexBuffer.itemSize=1),(o||h)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}nt("SymbolBuffers",tf);class nf{constructor(t,r,o){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new o,this.segments=new _t,this.collisionVertexArray=new Ie}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Xd.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}nt("CollisionBuffers",nf);class Ro{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(_=>_.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=xc(this.zoom,r["text-size"]),this.iconSizeData=xc(this.zoom,r["icon-size"]);const o=this.layers[0].layout,h=o.get("symbol-sort-key"),g=o.get("symbol-z-order");this.canOverlap=nd(o,"text-overlap","text-allow-overlap")!=="never"||nd(o,"icon-overlap","icon-allow-overlap")!=="never"||o.get("text-ignore-placement")||o.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&!h.isConstant(),this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,o.get("symbol-placement")==="point"&&(this.writingModes=o.get("text-writing-mode").map(_=>O.ag[_])),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=t.sourceID}createArrays(){this.text=new tf(new wo(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new tf(new wo(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new D,this.lineVertexArray=new I,this.symbolInstances=new z,this.textAnchorOffsets=new N}calculateGlyphDependencies(t,r,o,h,g){for(let _=0;_<t.length;_++)if(r[t.charCodeAt(_)]=!0,(o||h)&&g){const v=vs[t.charAt(_)];v&&(r[v.charCodeAt(0)]=!0)}}populate(t,r,o){const h=this.layers[0],g=h.layout,_=g.get("text-font"),v=g.get("text-field"),w=g.get("icon-image"),M=(v.value.kind!=="constant"||v.value.value instanceof rn&&!v.value.value.isEmpty()||v.value.value.toString().length>0)&&(_.value.kind!=="constant"||_.value.value.length>0),C=w.value.kind!=="constant"||!!w.value.value||Object.keys(w.parameters).length>0,A=g.get("symbol-sort-key");if(this.features=[],!M&&!C)return;const R=r.iconDependencies,k=r.glyphDependencies,j=r.availableImages,U=new Pi(this.zoom);for(const{feature:H,id:Q,index:ue,sourceLayerIndex:te}of t){const L=h._featureFilter.needGeometry,G=Ir(H,L);if(!h._featureFilter.filter(U,G,o))continue;let ie,Te;if(L||(G.geometry=qs(H)),M){const Ae=h.getValueAndResolveTokens("text-field",G,o,j),De=rn.factory(Ae),Xe=this.hasRTLText=this.hasRTLText||_p(De);(!Xe||Aa.getRTLTextPluginStatus()==="unavailable"||Xe&&Aa.isParsed())&&(ie=bl(De,h,G))}if(C){const Ae=h.getValueAndResolveTokens("icon-image",G,o,j);Te=Ae instanceof gr?Ae:gr.fromString(Ae)}if(!ie&&!Te)continue;const qe=this.sortFeaturesByKey?A.evaluate(G,{},o):void 0;if(this.features.push({id:Q,text:ie,icon:Te,index:ue,sourceLayerIndex:te,geometry:G.geometry,properties:H.properties,type:Bi[H.type],sortKey:qe}),Te&&(R[Te.name]=!0),ie){const Ae=_.evaluate(G,{},o).join(","),De=g.get("text-rotation-alignment")!=="viewport"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(O.ag.vertical)>=0;for(const Xe of ie.sections)if(Xe.image)R[Xe.image.name]=!0;else{const $e=nl(ie.toString()),Ye=Xe.fontStack||Ae,Be=k[Ye]=k[Ye]||{};this.calculateGlyphDependencies(Xe.text,Be,De,this.allowVerticalPlacement,$e)}}}g.get("symbol-placement")==="line"&&(this.features=function(H){const Q={},ue={},te=[];let L=0;function G(Ae){te.push(H[Ae]),L++}function ie(Ae,De,Xe){const $e=ue[Ae];return delete ue[Ae],ue[De]=$e,te[$e].geometry[0].pop(),te[$e].geometry[0]=te[$e].geometry[0].concat(Xe[0]),$e}function Te(Ae,De,Xe){const $e=Q[De];return delete Q[De],Q[Ae]=$e,te[$e].geometry[0].shift(),te[$e].geometry[0]=Xe[0].concat(te[$e].geometry[0]),$e}function qe(Ae,De,Xe){const $e=Xe?De[0][De[0].length-1]:De[0][0];return`${Ae}:${$e.x}:${$e.y}`}for(let Ae=0;Ae<H.length;Ae++){const De=H[Ae],Xe=De.geometry,$e=De.text?De.text.toString():null;if(!$e){G(Ae);continue}const Ye=qe($e,Xe),Be=qe($e,Xe,!0);if(Ye in ue&&Be in Q&&ue[Ye]!==Q[Be]){const ut=Te(Ye,Be,Xe),wt=ie(Ye,Be,te[ut].geometry);delete Q[Ye],delete ue[Be],ue[qe($e,te[wt].geometry,!0)]=wt,te[ut].geometry=null}else Ye in ue?ie(Ye,Be,Xe):Be in Q?Te(Ye,Be,Xe):(G(Ae),Q[Ye]=L-1,ue[Be]=L-1)}return te.filter(Ae=>Ae.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((H,Q)=>H.sortKey-Q.sortKey)}update(t,r,o){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,r,this.layers,o),this.icon.programConfigurations.updatePaintArrays(t,r,this.layers,o))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,r){const o=this.lineVertexArray.length;if(t.segment!==void 0){let h=t.dist(r[t.segment+1]),g=t.dist(r[t.segment]);const _={};for(let v=t.segment+1;v<r.length;v++)_[v]={x:r[v].x,y:r[v].y,tileUnitDistanceFromAnchor:h},v<r.length-1&&(h+=r[v+1].dist(r[v]));for(let v=t.segment||0;v>=0;v--)_[v]={x:r[v].x,y:r[v].y,tileUnitDistanceFromAnchor:g},v>0&&(g+=r[v-1].dist(r[v]));for(let v=0;v<r.length;v++){const w=_[v];this.lineVertexArray.emplaceBack(w.x,w.y,w.tileUnitDistanceFromAnchor)}}return{lineStartIndex:o,lineLength:this.lineVertexArray.length-o}}addSymbols(t,r,o,h,g,_,v,w,M,C,A,R){const k=t.indexArray,j=t.layoutVertexArray,U=t.segments.prepareSegment(4*r.length,j,k,this.canOverlap?_.sortKey:void 0),H=this.glyphOffsetArray.length,Q=U.vertexLength,ue=this.allowVerticalPlacement&&v===O.ag.vertical?Math.PI/2:0,te=_.text&&_.text.sections;for(let L=0;L<r.length;L++){const{tl:G,tr:ie,bl:Te,br:qe,tex:Ae,pixelOffsetTL:De,pixelOffsetBR:Xe,minFontScaleX:$e,minFontScaleY:Ye,glyphOffset:Be,isSDF:ut,sectionIndex:wt}=r[L],vt=U.vertexLength,dt=Be[1];rd(j,w.x,w.y,G.x,dt+G.y,Ae.x,Ae.y,o,ut,De.x,De.y,$e,Ye),rd(j,w.x,w.y,ie.x,dt+ie.y,Ae.x+Ae.w,Ae.y,o,ut,Xe.x,De.y,$e,Ye),rd(j,w.x,w.y,Te.x,dt+Te.y,Ae.x,Ae.y+Ae.h,o,ut,De.x,Xe.y,$e,Ye),rd(j,w.x,w.y,qe.x,dt+qe.y,Ae.x+Ae.w,Ae.y+Ae.h,o,ut,Xe.x,Xe.y,$e,Ye),ad(t.dynamicLayoutVertexArray,w,ue),k.emplaceBack(vt,vt+2,vt+1),k.emplaceBack(vt+1,vt+2,vt+3),U.vertexLength+=4,U.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Be[0]),L!==r.length-1&&wt===r[L+1].sectionIndex||t.programConfigurations.populatePaintArrays(j.length,_,_.index,{},R,te&&te[wt])}t.placedSymbolArray.emplaceBack(w.x,w.y,H,this.glyphOffsetArray.length-H,Q,M,C,w.segment,o?o[0]:0,o?o[1]:0,h[0],h[1],v,0,!1,0,A)}_addCollisionDebugVertex(t,r,o,h,g,_){return r.emplaceBack(0,0),t.emplaceBack(o.x,o.y,h,g,Math.round(_.x),Math.round(_.y))}addCollisionDebugVertices(t,r,o,h,g,_,v){const w=g.segments.prepareSegment(4,g.layoutVertexArray,g.indexArray),M=w.vertexLength,C=g.layoutVertexArray,A=g.collisionVertexArray,R=v.anchorX,k=v.anchorY;this._addCollisionDebugVertex(C,A,_,R,k,new st(t,r)),this._addCollisionDebugVertex(C,A,_,R,k,new st(o,r)),this._addCollisionDebugVertex(C,A,_,R,k,new st(o,h)),this._addCollisionDebugVertex(C,A,_,R,k,new st(t,h)),w.vertexLength+=4;const j=g.indexArray;j.emplaceBack(M,M+1),j.emplaceBack(M+1,M+2),j.emplaceBack(M+2,M+3),j.emplaceBack(M+3,M),w.primitiveLength+=4}addDebugCollisionBoxes(t,r,o,h){for(let g=t;g<r;g++){const _=this.collisionBoxArray.get(g);this.addCollisionDebugVertices(_.x1,_.y1,_.x2,_.y2,h?this.textCollisionBox:this.iconCollisionBox,_.anchorPoint,o)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new nf(Le,Qs.members,We),this.iconCollisionBox=new nf(Le,Qs.members,We);for(let t=0;t<this.symbolInstances.length;t++){const r=this.symbolInstances.get(t);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(t,r,o,h,g,_,v,w,M){const C={};for(let A=r;A<o;A++){const R=t.get(A);C.textBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,anchorPointX:R.anchorPointX,anchorPointY:R.anchorPointY},C.textFeatureIndex=R.featureIndex;break}for(let A=h;A<g;A++){const R=t.get(A);C.verticalTextBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,anchorPointX:R.anchorPointX,anchorPointY:R.anchorPointY},C.verticalTextFeatureIndex=R.featureIndex;break}for(let A=_;A<v;A++){const R=t.get(A);C.iconBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,anchorPointX:R.anchorPointX,anchorPointY:R.anchorPointY},C.iconFeatureIndex=R.featureIndex;break}for(let A=w;A<M;A++){const R=t.get(A);C.verticalIconBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,anchorPointX:R.anchorPointX,anchorPointY:R.anchorPointY},C.verticalIconFeatureIndex=R.featureIndex;break}return C}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const o=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,o.textBoxStartIndex,o.textBoxEndIndex,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o.iconBoxStartIndex,o.iconBoxEndIndex,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,r){const o=t.placedSymbolArray.get(r),h=o.vertexStartIndex+4*o.numGlyphs;for(let g=o.vertexStartIndex;g<h;g+=4)t.indexArray.emplaceBack(g,g+2,g+1),t.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const r=Math.sin(t),o=Math.cos(t),h=[],g=[],_=[];for(let v=0;v<this.symbolInstances.length;++v){_.push(v);const w=this.symbolInstances.get(v);h.push(0|Math.round(r*w.anchorX+o*w.anchorY)),g.push(w.featureIndex)}return _.sort((v,w)=>h[v]-h[w]||g[w]-g[v]),_}addToSortKeyRanges(t,r){const o=this.sortKeyRanges[this.sortKeyRanges.length-1];o&&o.sortKey===r?o.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const o=this.symbolInstances.get(r);this.featureSortOrder.push(o.featureIndex),[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach((h,g,_)=>{h>=0&&_.indexOf(h)===g&&this.addIndicesForPlacedSymbol(this.text,h)}),o.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,o.verticalPlacedTextSymbolIndex),o.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.placedIconSymbolIndex),o.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let bc,sd;nt("SymbolBucket",Ro,{omit:["layers","collisionBoxArray","features","compareText"]}),Ro.MAX_GLYPHS=65535,Ro.addDynamicAttributes=ad;var Tu={get paint(){return sd=sd||new lr({"icon-opacity":new yt(P.paint_symbol["icon-opacity"]),"icon-color":new yt(P.paint_symbol["icon-color"]),"icon-halo-color":new yt(P.paint_symbol["icon-halo-color"]),"icon-halo-width":new yt(P.paint_symbol["icon-halo-width"]),"icon-halo-blur":new yt(P.paint_symbol["icon-halo-blur"]),"icon-translate":new mt(P.paint_symbol["icon-translate"]),"icon-translate-anchor":new mt(P.paint_symbol["icon-translate-anchor"]),"text-opacity":new yt(P.paint_symbol["text-opacity"]),"text-color":new yt(P.paint_symbol["text-color"],{runtimeType:Zt,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new yt(P.paint_symbol["text-halo-color"]),"text-halo-width":new yt(P.paint_symbol["text-halo-width"]),"text-halo-blur":new yt(P.paint_symbol["text-halo-blur"]),"text-translate":new mt(P.paint_symbol["text-translate"]),"text-translate-anchor":new mt(P.paint_symbol["text-translate-anchor"])})},get layout(){return bc=bc||new lr({"symbol-placement":new mt(P.layout_symbol["symbol-placement"]),"symbol-spacing":new mt(P.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new mt(P.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new yt(P.layout_symbol["symbol-sort-key"]),"symbol-z-order":new mt(P.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new mt(P.layout_symbol["icon-allow-overlap"]),"icon-overlap":new mt(P.layout_symbol["icon-overlap"]),"icon-ignore-placement":new mt(P.layout_symbol["icon-ignore-placement"]),"icon-optional":new mt(P.layout_symbol["icon-optional"]),"icon-rotation-alignment":new mt(P.layout_symbol["icon-rotation-alignment"]),"icon-size":new yt(P.layout_symbol["icon-size"]),"icon-text-fit":new mt(P.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new mt(P.layout_symbol["icon-text-fit-padding"]),"icon-image":new yt(P.layout_symbol["icon-image"]),"icon-rotate":new yt(P.layout_symbol["icon-rotate"]),"icon-padding":new yt(P.layout_symbol["icon-padding"]),"icon-keep-upright":new mt(P.layout_symbol["icon-keep-upright"]),"icon-offset":new yt(P.layout_symbol["icon-offset"]),"icon-anchor":new yt(P.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new mt(P.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new mt(P.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new mt(P.layout_symbol["text-rotation-alignment"]),"text-field":new yt(P.layout_symbol["text-field"]),"text-font":new yt(P.layout_symbol["text-font"]),"text-size":new yt(P.layout_symbol["text-size"]),"text-max-width":new yt(P.layout_symbol["text-max-width"]),"text-line-height":new mt(P.layout_symbol["text-line-height"]),"text-letter-spacing":new yt(P.layout_symbol["text-letter-spacing"]),"text-justify":new yt(P.layout_symbol["text-justify"]),"text-radial-offset":new yt(P.layout_symbol["text-radial-offset"]),"text-variable-anchor":new mt(P.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new yt(P.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new yt(P.layout_symbol["text-anchor"]),"text-max-angle":new mt(P.layout_symbol["text-max-angle"]),"text-writing-mode":new mt(P.layout_symbol["text-writing-mode"]),"text-rotate":new yt(P.layout_symbol["text-rotate"]),"text-padding":new mt(P.layout_symbol["text-padding"]),"text-keep-upright":new mt(P.layout_symbol["text-keep-upright"]),"text-transform":new yt(P.layout_symbol["text-transform"]),"text-offset":new yt(P.layout_symbol["text-offset"]),"text-allow-overlap":new mt(P.layout_symbol["text-allow-overlap"]),"text-overlap":new mt(P.layout_symbol["text-overlap"]),"text-ignore-placement":new mt(P.layout_symbol["text-ignore-placement"]),"text-optional":new mt(P.layout_symbol["text-optional"])})}};class od{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:At,this.defaultValue=t}evaluate(t){if(t.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(t.formattedSection))return r.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}nt("FormatSectionOverride",od,{omit:["defaultValue"]});class Js extends za{constructor(t){super(t,Tu)}recalculate(t,r){if(super.recalculate(t,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const o=this.layout.get("text-writing-mode");if(o){const h=[];for(const g of o)h.indexOf(g)<0&&h.push(g);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,r,o,h){const g=this.layout.get(t).evaluate(r,{},o,h),_=this._unevaluatedLayout._values[t];return _.isDataDriven()||Xl(_.value)||!g?g:function(v,w){return w.replace(/{([^{}]+)}/g,(M,C)=>v&&C in v?String(v[C]):"")}(r.properties,g)}createBucket(t){return new Ro(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of Tu.paint.overridableProperties){if(!Js.hasPaintOverride(this.layout,t))continue;const r=this.paint.get(t),o=new od(r),h=new $a(o,r.property.specification);let g=null;g=r.value.kind==="constant"||r.value.kind==="source"?new ds("source",h):new Xc("composite",h,r.value.zoomStops),this.paint._values[t]=new Vn(r.property,g,r.parameters)}}_handleOverridablePaintPropertyUpdate(t,r,o){return!(!this.layout||r.isDataDriven()||o.isDataDriven())&&Js.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,r){const o=t.get("text-field"),h=Tu.paint.properties[r];let g=!1;const _=v=>{for(const w of v)if(h.overrides&&h.overrides.hasOverride(w))return void(g=!0)};if(o.value.kind==="constant"&&o.value.value instanceof rn)_(o.value.value.sections);else if(o.value.kind==="source"){const v=M=>{g||(M instanceof Wn&&an(M.value)===nn?_(M.value.sections):M instanceof cs?_(M.sections):M.eachChild(v))},w=o.value;w._styleExpression&&v(w._styleExpression.expression)}return g}}let xs;var _h={get paint(){return xs=xs||new lr({"background-color":new mt(P.paint_background["background-color"]),"background-pattern":new Vi(P.paint_background["background-pattern"]),"background-opacity":new mt(P.paint_background["background-opacity"])})}};class yp extends za{constructor(t){super(t,_h)}}let rf;var Xf={get paint(){return rf=rf||new lr({"raster-opacity":new mt(P.paint_raster["raster-opacity"]),"raster-hue-rotate":new mt(P.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new mt(P.paint_raster["raster-brightness-min"]),"raster-brightness-max":new mt(P.paint_raster["raster-brightness-max"]),"raster-saturation":new mt(P.paint_raster["raster-saturation"]),"raster-contrast":new mt(P.paint_raster["raster-contrast"]),"raster-resampling":new mt(P.paint_raster["raster-resampling"]),"raster-fade-duration":new mt(P.paint_raster["raster-fade-duration"])})}};class Yf extends za{constructor(t){super(t,Xf)}}class vp extends za{constructor(t){super(t,{}),this.onAdd=r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},this.onRemove=r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class af{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Kf={once:!0},ld=63710088e-1;class Tl{constructor(t,r){if(isNaN(t)||isNaN(r))throw new Error(`Invalid LngLat object: (${t}, ${r})`);if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Tl(ot(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const r=Math.PI/180,o=this.lat*r,h=t.lat*r,g=Math.sin(o)*Math.sin(h)+Math.cos(o)*Math.cos(h)*Math.cos((t.lng-this.lng)*r);return ld*Math.acos(Math.min(g,1))}static convert(t){if(t instanceof Tl)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Tl(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Tl(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const cd=2*Math.PI*ld;function ud(a){return cd*Math.cos(a*Math.PI/180)}function Qf(a){return(180+a)/360}function Wf(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function Su(a,t){return a/ud(t)}function sf(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function of(a,t){return a*ud(sf(t))}class Kt{constructor(t,r,o=0){this.x=+t,this.y=+r,this.z=+o}static fromLngLat(t,r=0){const o=Tl.convert(t);return new Kt(Qf(o.lng),Wf(o.lat),Su(r,o.lat))}toLngLat(){return new Tl(360*this.x-180,sf(this.y))}toAltitude(){return of(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/cd*(t=sf(this.y),1/Math.cos(t*Math.PI/180));var t}}function hd(a,t,r){var o=2*Math.PI*6378137/256/Math.pow(2,r);return[a*o-2*Math.PI*6378137/2,t*o-2*Math.PI*6378137/2]}class Mu{constructor(t,r,o){if(!function(h,g,_){return!(h<0||h>25||_<0||_>=Math.pow(2,h)||g<0||g>=Math.pow(2,h))}(t,r,o))throw new Error(`x=${r}, y=${o}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=r,this.y=o,this.key=Sl(0,t,t,r,o)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,r,o){const h=(_=this.y,v=this.z,w=hd(256*(g=this.x),256*(_=Math.pow(2,v)-_-1),v),M=hd(256*(g+1),256*(_+1),v),w[0]+","+w[1]+","+M[0]+","+M[1]);var g,_,v,w,M;const C=function(A,R,k){let j,U="";for(let H=A;H>0;H--)j=1<<H-1,U+=(R&j?1:0)+(k&j?2:0);return U}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,C).replace(/{bbox-epsg-3857}/g,h)}isChildOf(t){const r=this.z-t.z;return r>0&&t.x===this.x>>r&&t.y===this.y>>r}getTilePoint(t){const r=Math.pow(2,this.z);return new st((t.x*r-this.x)*Ke,(t.y*r-this.y)*Ke)}toString(){return`${this.z}/${this.x}/${this.y}`}}class dd{constructor(t,r){this.wrap=t,this.canonical=r,this.key=Sl(t,r.z,r.z,r.x,r.y)}}class ga{constructor(t,r,o,h,g){if(this.terrainRttPosMatrix32f=null,t<o)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${o}`);this.overscaledZ=t,this.wrap=r,this.canonical=new Mu(o,+h,+g),this.key=Sl(r,t,o,h,g)}clone(){return new ga(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const r=this.canonical.z-t;return t>this.canonical.z?new ga(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ga(t,this.wrap,t,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(t,r){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-t;return t>this.canonical.z?Sl(this.wrap*+r,t,this.canonical.z,this.canonical.x,this.canonical.y):Sl(this.wrap*+r,t,t,this.canonical.x>>o,this.canonical.y>>o)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const r=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>r&&t.canonical.y===this.canonical.y>>r}children(t){if(this.overscaledZ>=t)return[new ga(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,o=2*this.canonical.x,h=2*this.canonical.y;return[new ga(r,this.wrap,r,o,h),new ga(r,this.wrap,r,o+1,h),new ga(r,this.wrap,r,o,h+1),new ga(r,this.wrap,r,o+1,h+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new ga(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new ga(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new dd(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Kt(t.x-this.wrap,t.y))}}function Sl(a,t,r,o,h){(a*=2)<0&&(a=-1*a-1);const g=1<<r;return(g*g*a+g*h+o).toString(36)+r.toString(36)+t.toString(36)}nt("CanonicalTileID",Mu),nt("OverscaledTileID",ga,{omit:["terrainRttPosMatrix32f"]});class Eu{constructor(t,r,o,h=1,g=1,_=1,v=0){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(o&&!["mapbox","terrarium","custom"].includes(o))return void Di(`"${o}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=r.height;const w=this.dim=r.height-2;switch(this.data=new Uint32Array(r.data.buffer),o){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=h,this.greenFactor=g,this.blueFactor=_,this.baseShift=v;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let M=0;M<w;M++)this.data[this._idx(-1,M)]=this.data[this._idx(0,M)],this.data[this._idx(w,M)]=this.data[this._idx(w-1,M)],this.data[this._idx(M,-1)]=this.data[this._idx(M,0)],this.data[this._idx(M,w)]=this.data[this._idx(M,w-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(w,-1)]=this.data[this._idx(w-1,0)],this.data[this._idx(-1,w)]=this.data[this._idx(0,w-1)],this.data[this._idx(w,w)]=this.data[this._idx(w-1,w-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let M=0;M<w;M++)for(let C=0;C<w;C++){const A=this.get(M,C);A>this.max&&(this.max=A),A<this.min&&(this.min=A)}}get(t,r){const o=new Uint8Array(this.data.buffer),h=4*this._idx(t,r);return this.unpack(o[h],o[h+1],o[h+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,r){if(t<-1||t>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(t+1)}unpack(t,r,o){return t*this.redFactor+r*this.greenFactor+o*this.blueFactor-this.baseShift}getPixels(){return new Rr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,r,o){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let h=r*this.dim,g=r*this.dim+this.dim,_=o*this.dim,v=o*this.dim+this.dim;switch(r){case-1:h=g-1;break;case 1:g=h+1}switch(o){case-1:_=v-1;break;case 1:v=_+1}const w=-r*this.dim,M=-o*this.dim;for(let C=_;C<v;C++)for(let A=h;A<g;A++)this.data[this._idx(A,C)]=t.data[this._idx(A+w,C+M)]}}nt("DEMData",Eu);class yh{constructor(t){this._stringToNumber={},this._numberToString=[];for(let r=0;r<t.length;r++){const o=t[r];this._stringToNumber[o]=r,this._numberToString[r]=o}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class wc{constructor(t,r,o,h,g){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=o,t._y=h,this.properties=t.properties,this.id=g}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const r in this)r!=="_geometry"&&r!=="_vectorTileFeature"&&(t[r]=this[r]);return t}}class lf{constructor(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new la(Ke,16,0),this.grid3D=new la(Ke,16,0),this.featureIndexArray=new X,this.promoteId=r}insert(t,r,o,h,g,_){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(o,h,g);const w=_?this.grid3D:this.grid;for(let M=0;M<r.length;M++){const C=r[M],A=[1/0,1/0,-1/0,-1/0];for(let R=0;R<C.length;R++){const k=C[R];A[0]=Math.min(A[0],k.x),A[1]=Math.min(A[1],k.y),A[2]=Math.max(A[2],k.x),A[3]=Math.max(A[3],k.y)}A[0]<Ke&&A[1]<Ke&&A[2]>=0&&A[3]>=0&&w.insert(v,A[0],A[1],A[2],A[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new yl.VectorTile(new _u(this.rawTileData)).layers,this.sourceLayerCoder=new yh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,r,o,h){this.loadVTLayers();const g=t.params,_=Ke/t.tileSize/t.scale,v=vr(g.filter),w=t.queryGeometry,M=t.queryPadding*_,C=ep(w),A=this.grid.query(C.minX-M,C.minY-M,C.maxX+M,C.maxY+M),R=ep(t.cameraQueryGeometry),k=this.grid3D.query(R.minX-M,R.minY-M,R.maxX+M,R.maxY+M,(H,Q,ue,te)=>function(L,G,ie,Te,qe){for(const De of L)if(G<=De.x&&ie<=De.y&&Te>=De.x&&qe>=De.y)return!0;const Ae=[new st(G,ie),new st(G,qe),new st(Te,qe),new st(Te,ie)];if(L.length>2){for(const De of Ae)if(ll(L,De))return!0}for(let De=0;De<L.length-1;De++)if(Id(L[De],L[De+1],Ae))return!0;return!1}(t.cameraQueryGeometry,H-M,Q-M,ue+M,te+M));for(const H of k)A.push(H);A.sort(tp);const j={};let U;for(let H=0;H<A.length;H++){const Q=A[H];if(Q===U)continue;U=Q;const ue=this.featureIndexArray.get(Q);let te=null;this.loadMatchingFeature(j,ue.bucketIndex,ue.sourceLayerIndex,ue.featureIndex,v,g.layers,g.availableImages,r,o,h,(L,G,ie)=>(te||(te=qs(L)),G.queryIntersectsFeature({queryGeometry:w,feature:L,featureState:ie,geometry:te,zoom:this.z,transform:t.transform,pixelsToTileUnits:_,pixelPosMatrix:t.pixelPosMatrix})))}return j}loadMatchingFeature(t,r,o,h,g,_,v,w,M,C,A){const R=this.bucketLayerIDs[r];if(_&&!R.some(H=>_.has(H)))return;const k=this.sourceLayerCoder.decode(o),j=this.vtLayers[k].feature(h);if(g.needGeometry){const H=Ir(j,!0);if(!g.filter(new Pi(this.tileID.overscaledZ),H,this.tileID.canonical))return}else if(!g.filter(new Pi(this.tileID.overscaledZ),j))return;const U=this.getId(j,k);for(let H=0;H<R.length;H++){const Q=R[H];if(_&&!_.has(Q))continue;const ue=w[Q];if(!ue)continue;let te={};U&&C&&(te=C.getState(ue.sourceLayer||"_geojsonTileLayer",U));const L=Rt({},M[Q]);L.paint=Jf(L.paint,ue.paint,j,te,v),L.layout=Jf(L.layout,ue.layout,j,te,v);const G=!A||A(j,ue,te);if(!G)continue;const ie=new wc(j,this.z,this.x,this.y,U);ie.layer=L;let Te=t[Q];Te===void 0&&(Te=t[Q]=[]),Te.push({featureIndex:h,feature:ie,intersectionZ:G})}}lookupSymbolFeatures(t,r,o,h,g,_,v,w){const M={};this.loadVTLayers();const C=vr(g);for(const A of t)this.loadMatchingFeature(M,o,h,A,C,_,v,w,r);return M}hasLayer(t){for(const r of this.bucketLayerIDs)for(const o of r)if(t===o)return!0;return!1}getId(t,r){var o;let h=t.id;return this.promoteId&&(h=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[r]],typeof h=="boolean"&&(h=Number(h)),h===void 0&&(!((o=t.properties)===null||o===void 0)&&o.cluster)&&this.promoteId&&(h=Number(t.properties.cluster_id))),h}}function Jf(a,t,r,o,h){return hn(a,(g,_)=>{const v=t instanceof go?t.get(_):null;return v&&v.evaluate?v.evaluate(r,o,h):v})}function ep(a){let t=1/0,r=1/0,o=-1/0,h=-1/0;for(const g of a)t=Math.min(t,g.x),r=Math.min(r,g.y),o=Math.max(o,g.x),h=Math.max(h,g.y);return{minX:t,minY:r,maxX:o,maxY:h}}function tp(a,t){return t-a}function cf(a,t,r,o,h){const g=[];for(let _=0;_<a.length;_++){const v=a[_];let w;for(let M=0;M<v.length-1;M++){let C=v[M],A=v[M+1];C.x<t&&A.x<t||(C.x<t?C=new st(t,C.y+(t-C.x)/(A.x-C.x)*(A.y-C.y))._round():A.x<t&&(A=new st(t,C.y+(t-C.x)/(A.x-C.x)*(A.y-C.y))._round()),C.y<r&&A.y<r||(C.y<r?C=new st(C.x+(r-C.y)/(A.y-C.y)*(A.x-C.x),r)._round():A.y<r&&(A=new st(C.x+(r-C.y)/(A.y-C.y)*(A.x-C.x),r)._round()),C.x>=o&&A.x>=o||(C.x>=o?C=new st(o,C.y+(o-C.x)/(A.x-C.x)*(A.y-C.y))._round():A.x>=o&&(A=new st(o,C.y+(o-C.x)/(A.x-C.x)*(A.y-C.y))._round()),C.y>=h&&A.y>=h||(C.y>=h?C=new st(C.x+(h-C.y)/(A.y-C.y)*(A.x-C.x),h)._round():A.y>=h&&(A=new st(C.x+(h-C.y)/(A.y-C.y)*(A.x-C.x),h)._round()),w&&C.equals(w[w.length-1])||(w=[C],g.push(w)),w.push(A)))))}}return g}nt("FeatureIndex",lf,{omit:["rawTileData","sourceLayerCoder"]});class bs extends st{constructor(t,r,o,h){super(t,r),this.angle=o,h!==void 0&&(this.segment=h)}clone(){return new bs(this.x,this.y,this.angle,this.segment)}}function Ei(a,t,r,o,h){if(t.segment===void 0||r===0)return!0;let g=t,_=t.segment+1,v=0;for(;v>-r/2;){if(_--,_<0)return!1;v-=a[_].dist(g),g=a[_]}v+=a[_].dist(a[_+1]),_++;const w=[];let M=0;for(;v<r/2;){const C=a[_],A=a[_+1];if(!A)return!1;let R=a[_-1].angleTo(C)-C.angleTo(A);for(R=Math.abs((R+3*Math.PI)%(2*Math.PI)-Math.PI),w.push({distance:v,angleDelta:R}),M+=R;v-w[0].distance>o;)M-=w.shift().angleDelta;if(M>h)return!1;_++,v+=C.dist(A)}return!0}function fd(a){let t=0;for(let r=0;r<a.length-1;r++)t+=a[r].dist(a[r+1]);return t}function ur(a,t,r){return a?.6*t*r:0}function ip(a,t){return Math.max(a?a.right-a.left:0,t?t.right-t.left:0)}function uf(a,t,r,o,h,g){const _=ur(r,h,g),v=ip(r,o)*g;let w=0;const M=fd(a)/2;for(let C=0;C<a.length-1;C++){const A=a[C],R=a[C+1],k=A.dist(R);if(w+k>M){const j=(M-w)/k,U=Zr.number(A.x,R.x,j),H=Zr.number(A.y,R.y,j),Q=new bs(U,H,R.angleTo(A),C);return Q._round(),!_||Ei(a,Q,v,_,t)?Q:void 0}w+=k}}function hf(a,t,r,o,h,g,_,v,w){const M=ur(o,g,_),C=ip(o,h),A=C*_,R=a[0].x===0||a[0].x===w||a[0].y===0||a[0].y===w;return t-A<t/4&&(t=A+t/4),vh(a,R?t/2*v%t:(C/2+2*g)*_*v%t,t,M,r,A,R,!1,w)}function vh(a,t,r,o,h,g,_,v,w){const M=g/2,C=fd(a);let A=0,R=t-r,k=[];for(let j=0;j<a.length-1;j++){const U=a[j],H=a[j+1],Q=U.dist(H),ue=H.angleTo(U);for(;R+r<A+Q;){R+=r;const te=(R-A)/Q,L=Zr.number(U.x,H.x,te),G=Zr.number(U.y,H.y,te);if(L>=0&&L<w&&G>=0&&G<w&&R-M>=0&&R+M<=C){const ie=new bs(L,G,ue,j);ie._round(),o&&!Ei(a,ie,g,o,h)||k.push(ie)}}A+=Q}return v||k.length||_||(k=vh(a,A/2,r,o,h,g,_,!0,w)),k}nt("Anchor",bs);const Cu=Sr;function df(a,t,r,o){const h=[],g=a.image,_=g.pixelRatio,v=g.paddedRect.w-2*Cu,w=g.paddedRect.h-2*Cu;let M={x1:a.left,y1:a.top,x2:a.right,y2:a.bottom};const C=g.stretchX||[[0,v]],A=g.stretchY||[[0,w]],R=(Be,ut)=>Be+ut[1]-ut[0],k=C.reduce(R,0),j=A.reduce(R,0),U=v-k,H=w-j;let Q=0,ue=k,te=0,L=j,G=0,ie=U,Te=0,qe=H;if(g.content&&o){const Be=g.content,ut=Be[2]-Be[0],wt=Be[3]-Be[1];(g.textFitWidth||g.textFitHeight)&&(M=gh(a)),Q=Au(C,0,Be[0]),te=Au(A,0,Be[1]),ue=Au(C,Be[0],Be[2]),L=Au(A,Be[1],Be[3]),G=Be[0]-Q,Te=Be[1]-te,ie=ut-ue,qe=wt-L}const Ae=M.x1,De=M.y1,Xe=M.x2-Ae,$e=M.y2-De,Ye=(Be,ut,wt,vt)=>{const dt=md(Be.stretch-Q,ue,Xe,Ae),Ht=xh(Be.fixed-G,ie,Be.stretch,k),qi=md(ut.stretch-te,L,$e,De),yn=xh(ut.fixed-Te,qe,ut.stretch,j),Ji=md(wt.stretch-Q,ue,Xe,Ae),qn=xh(wt.fixed-G,ie,wt.stretch,k),En=md(vt.stretch-te,L,$e,De),vn=xh(vt.fixed-Te,qe,vt.stretch,j),wi=new st(dt,qi),Oi=new st(Ji,qi),ar=new st(Ji,En),Hn=new st(dt,En),$n=new st(Ht/_,yn/_),Ba=new st(qn/_,vn/_),On=t*Math.PI/180;if(On){const Xn=Math.sin(On),xn=Math.cos(On),en=[xn,-Xn,Xn,xn];wi._matMult(en),Oi._matMult(en),Hn._matMult(en),ar._matMult(en)}const hr=Be.stretch+Be.fixed,Cn=ut.stretch+ut.fixed;return{tl:wi,tr:Oi,bl:Hn,br:ar,tex:{x:g.paddedRect.x+Cu+hr,y:g.paddedRect.y+Cu+Cn,w:wt.stretch+wt.fixed-hr,h:vt.stretch+vt.fixed-Cn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:$n,pixelOffsetBR:Ba,minFontScaleX:ie/_/Xe,minFontScaleY:qe/_/$e,isSDF:r}};if(o&&(g.stretchX||g.stretchY)){const Be=pd(C,U,k),ut=pd(A,H,j);for(let wt=0;wt<Be.length-1;wt++){const vt=Be[wt],dt=Be[wt+1];for(let Ht=0;Ht<ut.length-1;Ht++)h.push(Ye(vt,ut[Ht],dt,ut[Ht+1]))}}else h.push(Ye({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:w+1}));return h}function Au(a,t,r){let o=0;for(const h of a)o+=Math.max(t,Math.min(r,h[1]))-Math.max(t,Math.min(r,h[0]));return o}function pd(a,t,r){const o=[{fixed:-1,stretch:0}];for(const[h,g]of a){const _=o[o.length-1];o.push({fixed:h-_.stretch,stretch:_.stretch}),o.push({fixed:h-_.stretch,stretch:_.stretch+(g-h)})}return o.push({fixed:t+Cu,stretch:r}),o}function md(a,t,r,o){return a/t*r+o}function xh(a,t,r,o){return a-t*r/o}class gd{constructor(t,r,o,h,g,_,v,w,M,C){var A;if(this.boxStartIndex=t.length,M){let R=_.top,k=_.bottom;const j=_.collisionPadding;j&&(R-=j[1],k+=j[3]);let U=k-R;U>0&&(U=Math.max(10,U),this.circleDiameter=U)}else{const R=!((A=_.image)===null||A===void 0)&&A.content&&(_.image.textFitWidth||_.image.textFitHeight)?gh(_):{x1:_.left,y1:_.top,x2:_.right,y2:_.bottom};R.y1=R.y1*v-w[0],R.y2=R.y2*v+w[2],R.x1=R.x1*v-w[3],R.x2=R.x2*v+w[1];const k=_.collisionPadding;if(k&&(R.x1-=k[0]*v,R.y1-=k[1]*v,R.x2+=k[2]*v,R.y2+=k[3]*v),C){const j=new st(R.x1,R.y1),U=new st(R.x2,R.y1),H=new st(R.x1,R.y2),Q=new st(R.x2,R.y2),ue=C*Math.PI/180;j._rotate(ue),U._rotate(ue),H._rotate(ue),Q._rotate(ue),R.x1=Math.min(j.x,U.x,H.x,Q.x),R.x2=Math.max(j.x,U.x,H.x,Q.x),R.y1=Math.min(j.y,U.y,H.y,Q.y),R.y2=Math.max(j.y,U.y,H.y,Q.y)}t.emplaceBack(r.x,r.y,R.x1,R.y1,R.x2,R.y2,o,h,g)}this.boxEndIndex=t.length}}class np{constructor(t=[],r=(o,h)=>o<h?-1:o>h?1:0){if(this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:r,compare:o}=this,h=r[t];for(;t>0;){const g=t-1>>1,_=r[g];if(o(h,_)>=0)break;r[t]=_,t=g}r[t]=h}_down(t){const{data:r,compare:o}=this,h=this.length>>1,g=r[t];for(;t<h;){let _=1+(t<<1);const v=_+1;if(v<this.length&&o(r[v],r[_])<0&&(_=v),o(r[_],g)>=0)break;r[t]=r[_],t=_}r[t]=g}}function xp(a,t=1,r=!1){let o=1/0,h=1/0,g=-1/0,_=-1/0;const v=a[0];for(let k=0;k<v.length;k++){const j=v[k];(!k||j.x<o)&&(o=j.x),(!k||j.y<h)&&(h=j.y),(!k||j.x>g)&&(g=j.x),(!k||j.y>_)&&(_=j.y)}const w=Math.min(g-o,_-h);let M=w/2;const C=new np([],bp);if(w===0)return new st(o,h);for(let k=o;k<g;k+=w)for(let j=h;j<_;j+=w)C.push(new Ml(k+M,j+M,M,a));let A=function(k){let j=0,U=0,H=0;const Q=k[0];for(let ue=0,te=Q.length,L=te-1;ue<te;L=ue++){const G=Q[ue],ie=Q[L],Te=G.x*ie.y-ie.x*G.y;U+=(G.x+ie.x)*Te,H+=(G.y+ie.y)*Te,j+=3*Te}return new Ml(U/j,H/j,0,k)}(a),R=C.length;for(;C.length;){const k=C.pop();(k.d>A.d||!A.d)&&(A=k,r&&console.log("found best %d after %d probes",Math.round(1e4*k.d)/1e4,R)),k.max-A.d<=t||(M=k.h/2,C.push(new Ml(k.p.x-M,k.p.y-M,M,a)),C.push(new Ml(k.p.x+M,k.p.y-M,M,a)),C.push(new Ml(k.p.x-M,k.p.y+M,M,a)),C.push(new Ml(k.p.x+M,k.p.y+M,M,a)),R+=4)}return r&&(console.log(`num probes: ${R}`),console.log(`best distance: ${A.d}`)),A.p}function bp(a,t){return t.max-a.max}function Ml(a,t,r,o){this.p=new st(a,t),this.h=r,this.d=function(h,g){let _=!1,v=1/0;for(let w=0;w<g.length;w++){const M=g[w];for(let C=0,A=M.length,R=A-1;C<A;R=C++){const k=M[C],j=M[R];k.y>h.y!=j.y>h.y&&h.x<(j.x-k.x)*(h.y-k.y)/(j.y-k.y)+k.x&&(_=!_),v=Math.min(v,Dd(h,k,j))}}return(_?1:-1)*Math.sqrt(v)}(this.p,o),this.max=this.d+this.h*Math.SQRT2}var Gn;O.ax=void 0,(Gn=O.ax||(O.ax={}))[Gn.center=1]="center",Gn[Gn.left=2]="left",Gn[Gn.right=3]="right",Gn[Gn.top=4]="top",Gn[Gn.bottom=5]="bottom",Gn[Gn["top-left"]=6]="top-left",Gn[Gn["top-right"]=7]="top-right",Gn[Gn["bottom-left"]=8]="bottom-left",Gn[Gn["bottom-right"]=9]="bottom-right";const El=7,ff=Number.POSITIVE_INFINITY;function es(a,t){return t[1]!==ff?function(r,o,h){let g=0,_=0;switch(o=Math.abs(o),h=Math.abs(h),r){case"top-right":case"top-left":case"top":_=h-El;break;case"bottom-right":case"bottom-left":case"bottom":_=-h+El}switch(r){case"top-right":case"bottom-right":case"right":g=-o;break;case"top-left":case"bottom-left":case"left":g=o}return[g,_]}(a,t[0],t[1]):function(r,o){let h=0,g=0;o<0&&(o=0);const _=o/Math.SQRT2;switch(r){case"top-right":case"top-left":g=_-El;break;case"bottom-right":case"bottom-left":g=-_+El;break;case"bottom":g=-o+El;break;case"top":g=o-El}switch(r){case"top-right":case"bottom-right":h=-_;break;case"top-left":case"bottom-left":h=_;break;case"left":h=o;break;case"right":h=-o}return[h,g]}(a,t[0])}function pf(a,t,r){var o;const h=a.layout,g=(o=h.get("text-variable-anchor-offset"))===null||o===void 0?void 0:o.evaluate(t,{},r);if(g){const v=g.values,w=[];for(let M=0;M<v.length;M+=2){const C=w[M]=v[M],A=v[M+1].map(R=>R*Wi);C.startsWith("top")?A[1]-=El:C.startsWith("bottom")&&(A[1]+=El),w[M+1]=A}return new bn(w)}const _=h.get("text-variable-anchor");if(_){let v;v=a._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[h.get("text-radial-offset").evaluate(t,{},r)*Wi,ff]:h.get("text-offset").evaluate(t,{},r).map(M=>M*Wi);const w=[];for(const M of _)w.push(M,es(M,v));return new bn(w)}return null}function _d(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function ts(a,t,r,o,h,g,_,v,w,M,C,A){let R=g.textMaxSize.evaluate(t,{});R===void 0&&(R=_);const k=a.layers[0].layout,j=k.get("icon-offset").evaluate(t,{},C),U=bh(r.horizontal),H=_/24,Q=a.tilePixelRatio*H,ue=a.tilePixelRatio*R/24,te=a.tilePixelRatio*v,L=a.tilePixelRatio*k.get("symbol-spacing"),G=k.get("text-padding")*a.tilePixelRatio,ie=function(wt,vt,dt,Ht=1){const qi=wt.get("icon-padding").evaluate(vt,{},dt),yn=qi&&qi.values;return[yn[0]*Ht,yn[1]*Ht,yn[2]*Ht,yn[3]*Ht]}(k,t,C,a.tilePixelRatio),Te=k.get("text-max-angle")/180*Math.PI,qe=k.get("text-rotation-alignment")!=="viewport"&&k.get("symbol-placement")!=="point",Ae=k.get("icon-rotation-alignment")==="map"&&k.get("symbol-placement")!=="point",De=k.get("symbol-placement"),Xe=L/2,$e=k.get("icon-text-fit");let Ye;o&&$e!=="none"&&(a.allowVerticalPlacement&&r.vertical&&(Ye=Jd(o,r.vertical,$e,k.get("icon-text-fit-padding"),j,H)),U&&(o=Jd(o,U,$e,k.get("icon-text-fit-padding"),j,H)));const Be=C?A.line.getGranularityForZoomLevel(C.z):1,ut=(wt,vt)=>{vt.x<0||vt.x>=Ke||vt.y<0||vt.y>=Ke||function(dt,Ht,qi,yn,Ji,qn,En,vn,wi,Oi,ar,Hn,$n,Ba,On,hr,Cn,Xn,xn,en,Ci,Wr,zl,_a,sp){const zu=dt.addToLineVertexArray(Ht,qi);let eo,i,s,c,p=0,x=0,S=0,B=0,q=-1,ne=-1;const me={};let Ze=ki("");if(dt.allowVerticalPlacement&&yn.vertical){const Nt=vn.layout.get("text-rotate").evaluate(Ci,{},_a)+90;s=new gd(wi,Ht,Oi,ar,Hn,yn.vertical,$n,Ba,On,Nt),En&&(c=new gd(wi,Ht,Oi,ar,Hn,En,Cn,Xn,On,Nt))}if(Ji){const Nt=vn.layout.get("icon-rotate").evaluate(Ci,{}),Yn=vn.layout.get("icon-text-fit")!=="none",Tc=df(Ji,Nt,zl,Yn),Lo=En?df(En,Nt,zl,Yn):void 0;i=new gd(wi,Ht,Oi,ar,Hn,Ji,Cn,Xn,!1,Nt),p=4*Tc.length;const Mh=dt.iconSizeData;let Pl=null;Mh.kind==="source"?(Pl=[Ws*vn.layout.get("icon-size").evaluate(Ci,{})],Pl[0]>Io&&Di(`${dt.layerIds[0]}: Value for "icon-size" is >= ${wu}. Reduce your "icon-size".`)):Mh.kind==="composite"&&(Pl=[Ws*Wr.compositeIconSizes[0].evaluate(Ci,{},_a),Ws*Wr.compositeIconSizes[1].evaluate(Ci,{},_a)],(Pl[0]>Io||Pl[1]>Io)&&Di(`${dt.layerIds[0]}: Value for "icon-size" is >= ${wu}. Reduce your "icon-size".`)),dt.addSymbols(dt.icon,Tc,Pl,en,xn,Ci,O.ag.none,Ht,zu.lineStartIndex,zu.lineLength,-1,_a),q=dt.icon.placedSymbolArray.length-1,Lo&&(x=4*Lo.length,dt.addSymbols(dt.icon,Lo,Pl,en,xn,Ci,O.ag.vertical,Ht,zu.lineStartIndex,zu.lineLength,-1,_a),ne=dt.icon.placedSymbolArray.length-1)}const Qe=Object.keys(yn.horizontal);for(const Nt of Qe){const Yn=yn.horizontal[Nt];if(!eo){Ze=ki(Yn.text);const Lo=vn.layout.get("text-rotate").evaluate(Ci,{},_a);eo=new gd(wi,Ht,Oi,ar,Hn,Yn,$n,Ba,On,Lo)}const Tc=Yn.positionedLines.length===1;if(S+=mf(dt,Ht,Yn,qn,vn,On,Ci,hr,zu,yn.vertical?O.ag.horizontal:O.ag.horizontalOnly,Tc?Qe:[Nt],me,q,Wr,_a),Tc)break}yn.vertical&&(B+=mf(dt,Ht,yn.vertical,qn,vn,On,Ci,hr,zu,O.ag.vertical,["vertical"],me,ne,Wr,_a));const Pe=eo?eo.boxStartIndex:dt.collisionBoxArray.length,Ue=eo?eo.boxEndIndex:dt.collisionBoxArray.length,Ct=s?s.boxStartIndex:dt.collisionBoxArray.length,qt=s?s.boxEndIndex:dt.collisionBoxArray.length,An=i?i.boxStartIndex:dt.collisionBoxArray.length,be=i?i.boxEndIndex:dt.collisionBoxArray.length,ge=c?c.boxStartIndex:dt.collisionBoxArray.length,Ce=c?c.boxEndIndex:dt.collisionBoxArray.length;let He=-1;const gt=(Nt,Yn)=>Nt&&Nt.circleDiameter?Math.max(Nt.circleDiameter,Yn):Yn;He=gt(eo,He),He=gt(s,He),He=gt(i,He),He=gt(c,He);const Qt=He>-1?1:0;Qt&&(He*=sp/Wi),dt.glyphOffsetArray.length>=Ro.MAX_GLYPHS&&Di("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ci.sortKey!==void 0&&dt.addToSortKeyRanges(dt.symbolInstances.length,Ci.sortKey);const Pt=pf(vn,Ci,_a),[Lt,dr]=function(Nt,Yn){const Tc=Nt.length,Lo=Yn==null?void 0:Yn.values;if((Lo==null?void 0:Lo.length)>0)for(let Mh=0;Mh<Lo.length;Mh+=2){const Pl=Lo[Mh+1];Nt.emplaceBack(O.ax[Lo[Mh]],Pl[0],Pl[1])}return[Tc,Nt.length]}(dt.textAnchorOffsets,Pt);dt.symbolInstances.emplaceBack(Ht.x,Ht.y,me.right>=0?me.right:-1,me.center>=0?me.center:-1,me.left>=0?me.left:-1,me.vertical||-1,q,ne,Ze,Pe,Ue,Ct,qt,An,be,ge,Ce,Oi,S,B,p,x,Qt,0,$n,He,Lt,dr)}(a,vt,wt,r,o,h,Ye,a.layers[0],a.collisionBoxArray,t.index,t.sourceLayerIndex,a.index,Q,[G,G,G,G],qe,w,te,ie,Ae,j,t,g,M,C,_)};if(De==="line")for(const wt of cf(t.geometry,0,0,Ke,Ke)){const vt=gl(wt,Be),dt=hf(vt,L,Te,r.vertical||U,o,24,ue,a.overscaling,Ke);for(const Ht of dt)U&&ko(a,U.text,Xe,Ht)||ut(vt,Ht)}else if(De==="line-center"){for(const wt of t.geometry)if(wt.length>1){const vt=gl(wt,Be),dt=uf(vt,Te,r.vertical||U,o,24,ue);dt&&ut(vt,dt)}}else if(t.type==="Polygon")for(const wt of Fl(t.geometry,0)){const vt=xp(wt,16);ut(gl(wt[0],Be,!0),new bs(vt.x,vt.y,0))}else if(t.type==="LineString")for(const wt of t.geometry){const vt=gl(wt,Be);ut(vt,new bs(vt[0].x,vt[0].y,0))}else if(t.type==="Point")for(const wt of t.geometry)for(const vt of wt)ut([vt],new bs(vt.x,vt.y,0))}function mf(a,t,r,o,h,g,_,v,w,M,C,A,R,k,j){const U=function(ue,te,L,G,ie,Te,qe,Ae){const De=G.layout.get("text-rotate").evaluate(Te,{})*Math.PI/180,Xe=[];for(const $e of te.positionedLines)for(const Ye of $e.positionedGlyphs){if(!Ye.rect)continue;const Be=Ye.rect||{};let ut=hh+1,wt=!0,vt=1,dt=0;const Ht=(ie||Ae)&&Ye.vertical,qi=Ye.metrics.advance*Ye.scale/2;if(Ae&&te.verticalizable&&(dt=$e.lineOffset/2-(Ye.imageName?-(Wi-Ye.metrics.width*Ye.scale)/2:(Ye.scale-1)*Wi)),Ye.imageName){const Xn=qe[Ye.imageName];wt=Xn.sdf,vt=Xn.pixelRatio,ut=Sr/vt}const yn=ie?[Ye.x+qi,Ye.y]:[0,0];let Ji=ie?[0,0]:[Ye.x+qi+L[0],Ye.y+L[1]-dt],qn=[0,0];Ht&&(qn=Ji,Ji=[0,0]);const En=Ye.metrics.isDoubleResolution?2:1,vn=(Ye.metrics.left-ut)*Ye.scale-qi+Ji[0],wi=(-Ye.metrics.top-ut)*Ye.scale+Ji[1],Oi=vn+Be.w/En*Ye.scale/vt,ar=wi+Be.h/En*Ye.scale/vt,Hn=new st(vn,wi),$n=new st(Oi,wi),Ba=new st(vn,ar),On=new st(Oi,ar);if(Ht){const Xn=new st(-qi,qi-dh),xn=-Math.PI/2,en=Wi/2-qi,Ci=new st(5-dh-en,-(Ye.imageName?en:0)),Wr=new st(...qn);Hn._rotateAround(xn,Xn)._add(Ci)._add(Wr),$n._rotateAround(xn,Xn)._add(Ci)._add(Wr),Ba._rotateAround(xn,Xn)._add(Ci)._add(Wr),On._rotateAround(xn,Xn)._add(Ci)._add(Wr)}if(De){const Xn=Math.sin(De),xn=Math.cos(De),en=[xn,-Xn,Xn,xn];Hn._matMult(en),$n._matMult(en),Ba._matMult(en),On._matMult(en)}const hr=new st(0,0),Cn=new st(0,0);Xe.push({tl:Hn,tr:$n,bl:Ba,br:On,tex:Be,writingMode:te.writingMode,glyphOffset:yn,sectionIndex:Ye.sectionIndex,isSDF:wt,pixelOffsetTL:hr,pixelOffsetBR:Cn,minFontScaleX:0,minFontScaleY:0})}return Xe}(0,r,v,h,g,_,o,a.allowVerticalPlacement),H=a.textSizeData;let Q=null;H.kind==="source"?(Q=[Ws*h.layout.get("text-size").evaluate(_,{})],Q[0]>Io&&Di(`${a.layerIds[0]}: Value for "text-size" is >= ${wu}. Reduce your "text-size".`)):H.kind==="composite"&&(Q=[Ws*k.compositeTextSizes[0].evaluate(_,{},j),Ws*k.compositeTextSizes[1].evaluate(_,{},j)],(Q[0]>Io||Q[1]>Io)&&Di(`${a.layerIds[0]}: Value for "text-size" is >= ${wu}. Reduce your "text-size".`)),a.addSymbols(a.text,U,Q,v,g,_,M,t,w.lineStartIndex,w.lineLength,R,j);for(const ue of C)A[ue]=a.text.placedSymbolArray.length-1;return 4*U.length}function bh(a){for(const t in a)return a[t];return null}function ko(a,t,r,o){const h=a.compareText;if(t in h){const g=h[t];for(let _=g.length-1;_>=0;_--)if(o.dist(g[_])<r)return!0}else h[t]=[];return h[t].push(o),!1}const rp=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class gf{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,o]=new Uint8Array(t,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=o>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const g=rp[15&o];if(!g)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(t,2,1),[v]=new Uint32Array(t,4,1);return new gf(v,_,g,t)}constructor(t,r=64,o=Float64Array,h){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=o,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const g=rp.indexOf(this.ArrayType),_=2*t*this.ArrayType.BYTES_PER_ELEMENT,v=t*this.IndexArrayType.BYTES_PER_ELEMENT,w=(8-v%8)%8;if(g<0)throw new Error(`Unexpected typed array class: ${o}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+w,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+_+v+w),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+w,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+g]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t)}add(t,r){const o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=t,this.coords[this._pos++]=r,o}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Cl(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,r,o,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:_,nodeSize:v}=this,w=[0,g.length-1,0],M=[];for(;w.length;){const C=w.pop()||0,A=w.pop()||0,R=w.pop()||0;if(A-R<=v){for(let H=R;H<=A;H++){const Q=_[2*H],ue=_[2*H+1];Q>=t&&Q<=o&&ue>=r&&ue<=h&&M.push(g[H])}continue}const k=R+A>>1,j=_[2*k],U=_[2*k+1];j>=t&&j<=o&&U>=r&&U<=h&&M.push(g[k]),(C===0?t<=j:r<=U)&&(w.push(R),w.push(k-1),w.push(1-C)),(C===0?o>=j:h>=U)&&(w.push(k+1),w.push(A),w.push(1-C))}return M}within(t,r,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:g,nodeSize:_}=this,v=[0,h.length-1,0],w=[],M=o*o;for(;v.length;){const C=v.pop()||0,A=v.pop()||0,R=v.pop()||0;if(A-R<=_){for(let H=R;H<=A;H++)ap(g[2*H],g[2*H+1],t,r)<=M&&w.push(h[H]);continue}const k=R+A>>1,j=g[2*k],U=g[2*k+1];ap(j,U,t,r)<=M&&w.push(h[k]),(C===0?t-o<=j:r-o<=U)&&(v.push(R),v.push(k-1),v.push(1-C)),(C===0?t+o>=j:r+o>=U)&&(v.push(k+1),v.push(A),v.push(1-C))}return w}}function Cl(a,t,r,o,h,g){if(h-o<=r)return;const _=o+h>>1;_f(a,t,_,o,h,g),Cl(a,t,r,o,_-1,1-g),Cl(a,t,r,_+1,h,1-g)}function _f(a,t,r,o,h,g){for(;h>o;){if(h-o>600){const M=h-o+1,C=r-o+1,A=Math.log(M),R=.5*Math.exp(2*A/3),k=.5*Math.sqrt(A*R*(M-R)/M)*(C-M/2<0?-1:1);_f(a,t,r,Math.max(o,Math.floor(r-C*R/M+k)),Math.min(h,Math.floor(r+(M-C)*R/M+k)),g)}const _=t[2*r+g];let v=o,w=h;for(wh(a,t,o,r),t[2*h+g]>_&&wh(a,t,o,h);v<w;){for(wh(a,t,v,w),v++,w--;t[2*v+g]<_;)v++;for(;t[2*w+g]>_;)w--}t[2*o+g]===_?wh(a,t,o,w):(w++,wh(a,t,w,h)),w<=r&&(o=w+1),r<=w&&(h=w-1)}}function wh(a,t,r,o){yf(a,r,o),yf(t,2*r,2*o),yf(t,2*r+1,2*o+1)}function yf(a,t,r){const o=a[t];a[t]=a[r],a[r]=o}function ap(a,t,r,o){const h=a-r,g=t-o;return h*h+g*g}var vf;O.cg=void 0,(vf=O.cg||(O.cg={})).create="create",vf.load="load",vf.fullLoad="fullLoad";let yd=null,Th=[];const xf=1e3/60,vd="loadTime",Al="fullLoadTime",Sh={mark(a){performance.mark(a)},frame(a){const t=a;yd!=null&&Th.push(t-yd),yd=t},clearMetrics(){yd=null,Th=[],performance.clearMeasures(vd),performance.clearMeasures(Al);for(const a in O.cg)performance.clearMarks(O.cg[a])},getPerformanceMetrics(){performance.measure(vd,O.cg.create,O.cg.load),performance.measure(Al,O.cg.create,O.cg.fullLoad);const a=performance.getEntriesByName(vd)[0].duration,t=performance.getEntriesByName(Al)[0].duration,r=Th.length,o=1/(Th.reduce((g,_)=>g+_,0)/r/1e3),h=Th.filter(g=>g>xf).reduce((g,_)=>g+(_-xf)/xf,0);return{loadTime:a,fullLoadTime:t,fps:o,percentDroppedFrames:h/(r+h)*100,totalFrames:r}}};O.$=Kt,O.A=li,O.B=Zr,O.C=Pi,O.D=mt,O.E=ye,O.F=eu,O.G=function(a){if(Fi==null){const t=a.navigator?a.navigator.userAgent:null;Fi=!!a.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Fi},O.H=class{constructor(a,t){this.target=a,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new af(()=>this.process()),this.subscription=ta(this.target,"message",r=>this.receive(r),!1),this.globalScope=sr(self)?a:window}registerMessageHandler(a,t){this.messageHandlers[a]=t}sendAsync(a,t){return new Promise((r,o)=>{const h=Math.round(1e18*Math.random()).toString(36).substring(0,10),g=t?ta(t.signal,"abort",()=>{g==null||g.unsubscribe(),delete this.resolveRejects[h];const w={id:h,type:"<cancel>",origin:location.origin,targetMapId:a.targetMapId,sourceMapId:this.mapId};this.target.postMessage(w)},Kf):null;this.resolveRejects[h]={resolve:w=>{g==null||g.unsubscribe(),r(w)},reject:w=>{g==null||g.unsubscribe(),o(w)}};const _=[],v=Object.assign(Object.assign({},a),{id:h,sourceMapId:this.mapId,origin:location.origin,data:Bs(a.data,_)});this.target.postMessage(v,{transfer:_})})}receive(a){const t=a.data,r=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[r];const o=this.abortControllers[r];return delete this.abortControllers[r],void(o&&o.abort())}if(sr(self)||t.mustQueue)return this.tasks[r]=t,this.taskQueue.push(r),void this.invoker.trigger();this.processTask(r,t)}}process(){if(this.taskQueue.length===0)return;const a=this.taskQueue.shift(),t=this.tasks[a];delete this.tasks[a],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(a,t)}processTask(a,t){return d(this,void 0,void 0,function*(){if(t.type==="<response>"){const h=this.resolveRejects[a];return delete this.resolveRejects[a],h?void(t.error?h.reject(ec(t.error)):h.resolve(ec(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(a,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const r=ec(t.data),o=new AbortController;this.abortControllers[a]=o;try{const h=yield this.messageHandlers[t.type](t.sourceMapId,r,o);this.completeTask(a,null,h)}catch(h){this.completeTask(a,h)}})}completeTask(a,t,r){const o=[];delete this.abortControllers[a];const h={id:a,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?Bs(t):null,data:Bs(r,o)};this.target.postMessage(h,{transfer:o})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},O.I=yc,O.J=ws,O.K=function(){var a=new li(16);return li!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},O.L=function(a,t,r){var o,h,g,_,v,w,M,C,A,R,k,j,U=r[0],H=r[1],Q=r[2];return t===a?(a[12]=t[0]*U+t[4]*H+t[8]*Q+t[12],a[13]=t[1]*U+t[5]*H+t[9]*Q+t[13],a[14]=t[2]*U+t[6]*H+t[10]*Q+t[14],a[15]=t[3]*U+t[7]*H+t[11]*Q+t[15]):(h=t[1],g=t[2],_=t[3],v=t[4],w=t[5],M=t[6],C=t[7],A=t[8],R=t[9],k=t[10],j=t[11],a[0]=o=t[0],a[1]=h,a[2]=g,a[3]=_,a[4]=v,a[5]=w,a[6]=M,a[7]=C,a[8]=A,a[9]=R,a[10]=k,a[11]=j,a[12]=o*U+v*H+A*Q+t[12],a[13]=h*U+w*H+R*Q+t[13],a[14]=g*U+M*H+k*Q+t[14],a[15]=_*U+C*H+j*Q+t[15]),a},O.M=function(a,t,r){var o=r[0],h=r[1],g=r[2];return a[0]=t[0]*o,a[1]=t[1]*o,a[2]=t[2]*o,a[3]=t[3]*o,a[4]=t[4]*h,a[5]=t[5]*h,a[6]=t[6]*h,a[7]=t[7]*h,a[8]=t[8]*g,a[9]=t[9]*g,a[10]=t[10]*g,a[11]=t[11]*g,a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15],a},O.N=function(a,t,r){var o=t[0],h=t[1],g=t[2],_=t[3],v=t[4],w=t[5],M=t[6],C=t[7],A=t[8],R=t[9],k=t[10],j=t[11],U=t[12],H=t[13],Q=t[14],ue=t[15],te=r[0],L=r[1],G=r[2],ie=r[3];return a[0]=te*o+L*v+G*A+ie*U,a[1]=te*h+L*w+G*R+ie*H,a[2]=te*g+L*M+G*k+ie*Q,a[3]=te*_+L*C+G*j+ie*ue,a[4]=(te=r[4])*o+(L=r[5])*v+(G=r[6])*A+(ie=r[7])*U,a[5]=te*h+L*w+G*R+ie*H,a[6]=te*g+L*M+G*k+ie*Q,a[7]=te*_+L*C+G*j+ie*ue,a[8]=(te=r[8])*o+(L=r[9])*v+(G=r[10])*A+(ie=r[11])*U,a[9]=te*h+L*w+G*R+ie*H,a[10]=te*g+L*M+G*k+ie*Q,a[11]=te*_+L*C+G*j+ie*ue,a[12]=(te=r[12])*o+(L=r[13])*v+(G=r[14])*A+(ie=r[15])*U,a[13]=te*h+L*w+G*R+ie*H,a[14]=te*g+L*M+G*k+ie*Q,a[15]=te*_+L*C+G*j+ie*ue,a},O.O=function(a,t){const r={};for(let o=0;o<t.length;o++){const h=t[o];h in a&&(r[h]=a[h])}return r},O.P=st,O.Q=Tl,O.R=Rr,O.S=Wf,O.T=di,O.U=Qf,O.V=pr,O.W=tn,O.X=Br,O.Y=ga,O.Z=Ke,O._=d,O.a=or,O.a$=function(){const a=new Float32Array(16);return Dt(a),a},O.a0=Mu,O.a1=a=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(r=>{t.onloadstart=()=>{r(t)};for(const o of a){const h=window.document.createElement("source");is(o)||(t.crossOrigin="Anonymous"),h.src=o,t.appendChild(h)}})},O.a2=xe,O.a3=function(){return Ut++},O.a4=y,O.a5=Ro,O.a6=vr,O.a7=Ir,O.a8=wc,O.a9=function(a){const t={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,o,h,g)=>{const _=h||g;return t[o]=!_||_.toLowerCase(),""}),t["max-age"]){const r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t},O.aA=mh,O.aB=gf,O.aC=Xi,O.aD=ah,O.aE=K,O.aF=_t,O.aG=et,O.aH=function(a){return Math.pow(2,a)},O.aI=85.051129,O.aJ=Su,O.aK=ot,O.aL=Or,O.aM=of,O.aN=function(a,t,r){return a[0]=t[0]*r,a[1]=t[1]*r,a[2]=t[2]*r,a},O.aO=function(a,t,r){return a[0]=t[0]+r[0],a[1]=t[1]+r[1],a[2]=t[2]+r[2],a},O.aP=function(a){var t=new li(3);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t},O.aQ=function(a,t,r){return a[0]=t[0]*r[0],a[1]=t[1]*r[1],a[2]=t[2]*r[2],a[3]=t[3]*r[3],a},O.aR=function(a,t,r){return a[0]=t[0]-r[0],a[1]=t[1]-r[1],a[2]=t[2]-r[2],a},O.aS=function(a,t){var r=t[0],o=t[1],h=t[2],g=r*r+o*o+h*h;return g>0&&(g=1/Math.sqrt(g)),a[0]=t[0]*g,a[1]=t[1]*g,a[2]=t[2]*g,a},O.aT=function(a,t,r){var o=t[0],h=t[1],g=t[2],_=r[0],v=r[1],w=r[2];return a[0]=h*w-g*v,a[1]=g*_-o*w,a[2]=o*v-h*_,a},O.aU=function(a,t){return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]},O.aV=dd,O.aW=Sl,O.aX=function(a,t,r,o,h){var g,_=1/Math.tan(t/2);return a[0]=_/r,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=_,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,h!=null&&h!==1/0?(a[10]=(h+o)*(g=1/(o-h)),a[14]=2*h*o*g):(a[10]=-1,a[14]=-2*o),a},O.aY=function(a){var t=new li(16);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t},O.aZ=function(a,t,r){var o=Math.sin(r),h=Math.cos(r),g=t[0],_=t[1],v=t[2],w=t[3],M=t[4],C=t[5],A=t[6],R=t[7];return t!==a&&(a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[0]=g*h+M*o,a[1]=_*h+C*o,a[2]=v*h+A*o,a[3]=w*h+R*o,a[4]=M*h-g*o,a[5]=C*h-_*o,a[6]=A*h-v*o,a[7]=R*h-w*o,a},O.a_=function(a,t,r){var o=Math.sin(r),h=Math.cos(r),g=t[4],_=t[5],v=t[6],w=t[7],M=t[8],C=t[9],A=t[10],R=t[11];return t!==a&&(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[4]=g*h+M*o,a[5]=_*h+C*o,a[6]=v*h+A*o,a[7]=w*h+R*o,a[8]=M*h-g*o,a[9]=C*h-_*o,a[10]=A*h-v*o,a[11]=R*h-w*o,a},O.aa=function(a){return Math.log(a)/Math.LN2},O.ab=function(a){var t=a[0],r=a[1];return t*t+r*r},O.ac=function(a){return a*Math.PI/180},O.ad=xt,O.ae=function(a,t){const r=[];for(const o in a)o in t||r.push(o);return r},O.af=function(a,t){let r=0,o=0;if(a.kind==="constant")o=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:h,minZoom:g,maxZoom:_}=a,v=h?xt(er.interpolationFactor(h,t,g,_),0,1):0;a.kind==="camera"?o=Zr.number(a.minSize,a.maxSize,v):r=v}return{uSizeT:r,uSize:o}},O.ah=function(a,{uSize:t,uSizeT:r},{lowerSize:o,upperSize:h}){return a.kind==="source"?o/Ws:a.kind==="composite"?Zr.number(o/Ws,h/Ws,r):t},O.ai=function(a,t){var r=t[0],o=t[1],h=t[2],g=t[3],_=t[4],v=t[5],w=t[6],M=t[7],C=t[8],A=t[9],R=t[10],k=t[11],j=t[12],U=t[13],H=t[14],Q=t[15],ue=r*v-o*_,te=r*w-h*_,L=r*M-g*_,G=o*w-h*v,ie=o*M-g*v,Te=h*M-g*w,qe=C*U-A*j,Ae=C*H-R*j,De=C*Q-k*j,Xe=A*H-R*U,$e=A*Q-k*U,Ye=R*Q-k*H,Be=ue*Ye-te*$e+L*Xe+G*De-ie*Ae+Te*qe;return Be?(a[0]=(v*Ye-w*$e+M*Xe)*(Be=1/Be),a[1]=(h*$e-o*Ye-g*Xe)*Be,a[2]=(U*Te-H*ie+Q*G)*Be,a[3]=(R*ie-A*Te-k*G)*Be,a[4]=(w*De-_*Ye-M*Ae)*Be,a[5]=(r*Ye-h*De+g*Ae)*Be,a[6]=(H*L-j*Te-Q*te)*Be,a[7]=(C*Te-R*L+k*te)*Be,a[8]=(_*$e-v*De+M*qe)*Be,a[9]=(o*De-r*$e-g*qe)*Be,a[10]=(j*ie-U*L+Q*ue)*Be,a[11]=(A*L-C*ie-k*ue)*Be,a[12]=(v*Ae-_*Xe-w*qe)*Be,a[13]=(r*Xe-o*Ae+h*qe)*Be,a[14]=(U*te-j*G-H*ue)*Be,a[15]=(C*G-A*te+R*ue)*Be,a):null},O.aj=ji,O.ak=function(a){return Math.hypot(a[0],a[1])},O.al=function(a){return a[0]=0,a[1]=0,a},O.am=function(a,t,r){return a[0]=t[0]*r,a[1]=t[1]*r,a},O.an=ad,O.ao=Kn,O.ap=function(a,t,r,o){const h=t.y-a.y,g=t.x-a.x,_=o.y-r.y,v=o.x-r.x,w=_*g-v*h;if(w===0)return null;const M=(v*(a.y-r.y)-_*(a.x-r.x))/w;return new st(a.x+M*g,a.y+M*h)},O.aq=cf,O.ar=ol,O.as=Dt,O.at=function(a){let t=1/0,r=1/0,o=-1/0,h=-1/0;for(const g of a)t=Math.min(t,g.x),r=Math.min(r,g.y),o=Math.max(o,g.x),h=Math.max(h,g.y);return[t,r,o,h]},O.au=Wi,O.av=Ot,O.aw=function(a,t,r,o,h=!1){if(!r[0]&&!r[1])return[0,0];const g=h?o==="map"?-a.bearingInRadians:0:o==="viewport"?a.bearingInRadians:0;if(g){const _=Math.sin(g),v=Math.cos(g);r=[r[0]*v-r[1]*_,r[0]*_+r[1]*v]}return[h?r[0]:Ot(t,r[0],a.zoom),h?r[1]:Ot(t,r[1],a.zoom)]},O.ay=nd,O.az=_d,O.b=Oa,O.b$=a=>a.type==="circle",O.b0=function(){const a=new Float64Array(16);return Dt(a),a},O.b1=function(){return new Float64Array(16)},O.b2=function(a,t,r){const o=new Float64Array(4);return function(h,g,_,v){var w=.5*Math.PI/180;g*=w,_*=w,v*=w;var M=Math.sin(g),C=Math.cos(g),A=Math.sin(_),R=Math.cos(_),k=Math.sin(v),j=Math.cos(v);h[0]=M*R*j-C*A*k,h[1]=C*A*j+M*R*k,h[2]=C*R*k-M*A*j,h[3]=C*R*j+M*A*k}(o,a,t-90,r),o},O.b3=function(a,t,r,o){var h,g,_,v,w,M=t[0],C=t[1],A=t[2],R=t[3],k=r[0],j=r[1],U=r[2],H=r[3];return(g=M*k+C*j+A*U+R*H)<0&&(g=-g,k=-k,j=-j,U=-U,H=-H),1-g>Jt?(h=Math.acos(g),_=Math.sin(h),v=Math.sin((1-o)*h)/_,w=Math.sin(o*h)/_):(v=1-o,w=o),a[0]=v*M+w*k,a[1]=v*C+w*j,a[2]=v*A+w*U,a[3]=v*R+w*H,a},O.b4=function(a){const t=new Float64Array(9);var r,o,h,g,_,v,w,M,C,A,R,k,j,U,H,Q,ue,te;A=(h=(o=a)[0])*(w=h+h),R=(g=o[1])*w,j=(_=o[2])*w,U=_*(M=g+g),Q=(v=o[3])*w,ue=v*M,te=v*(C=_+_),(r=t)[0]=1-(k=g*M)-(H=_*C),r[3]=R-te,r[6]=j+ue,r[1]=R+te,r[4]=1-A-H,r[7]=U-Q,r[2]=j-ue,r[5]=U+Q,r[8]=1-A-k;const L=Or(-Math.asin(xt(t[2],-1,1)));let G,ie;return Math.hypot(t[5],t[8])<.001?(G=0,ie=-Or(Math.atan2(t[3],t[4]))):(G=Or(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),ie=Or(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:G,pitch:L+90,bearing:ie}},O.b5=function(a,t){return a.roll==t.roll&&a.pitch==t.pitch&&a.bearing==t.bearing},O.b6=Xt,O.b7=Gs,O.b8=Qi,O.b9=Tr,O.bA=function(a){const t=[],r=a.id;return r===void 0&&t.push({message:`layers.${r}: missing required property "id"`}),a.render===void 0&&t.push({message:`layers.${r}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&t.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),t},O.bB=function a(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(let o=0;o<t.length;o++)if(!a(t[o],r[o]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object"||Object.keys(t).length!==Object.keys(r).length)return!1;for(const o in t)if(!a(t[o],r[o]))return!1;return!0}return t===r},O.bC=hn,O.bD=ei,O.bE=class extends Yr{constructor(a,t){super(a,t),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},O.bF=Qa,O.bG=class extends Yr{constructor(a,t){super(a,t),this.current=Kr}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let t=1;t<16;t++)if(a[t]!==this.current[t]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},O.bH=Da,O.bI=class extends Yr{constructor(a,t){super(a,t),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},O.bJ=class extends Yr{constructor(a,t){super(a,t),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},O.bK=gi,O.bL=function(a,t){var r=Math.sin(t),o=Math.cos(t);return a[0]=o,a[1]=r,a[2]=0,a[3]=-r,a[4]=o,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},O.bM=function(a,t,r){var o=t[0],h=t[1],g=t[2];return a[0]=o*r[0]+h*r[3]+g*r[6],a[1]=o*r[1]+h*r[4]+g*r[7],a[2]=o*r[2]+h*r[5]+g*r[8],a},O.bN=function(a,t,r,o,h,g,_){var v=1/(t-r),w=1/(o-h),M=1/(g-_);return a[0]=-2*v,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*w,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*M,a[11]=0,a[12]=(t+r)*v,a[13]=(h+o)*w,a[14]=(_+g)*M,a[15]=1,a},O.bO=class extends rc{},O.bP=Mn,O.bQ=class extends ac{},O.bR=cr,O.bS=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},O.bT=hl,O.bU=function(a,t,r){var o=t[0],h=t[1],g=t[2],_=r[3]*o+r[7]*h+r[11]*g+r[15];return a[0]=(r[0]*o+r[4]*h+r[8]*g+r[12])/(_=_||1),a[1]=(r[1]*o+r[5]*h+r[9]*g+r[13])/_,a[2]=(r[2]*o+r[6]*h+r[10]*g+r[14])/_,a},O.bV=class extends yo{},O.bW=class extends l{},O.bX=function(a,t){return a[0]===t[0]&&a[1]===t[1]&&a[2]===t[2]&&a[3]===t[3]&&a[4]===t[4]&&a[5]===t[5]&&a[6]===t[6]&&a[7]===t[7]&&a[8]===t[8]&&a[9]===t[9]&&a[10]===t[10]&&a[11]===t[11]&&a[12]===t[12]&&a[13]===t[13]&&a[14]===t[14]&&a[15]===t[15]},O.bY=function(a,t){var r=a[0],o=a[1],h=a[2],g=a[3],_=a[4],v=a[5],w=a[6],M=a[7],C=a[8],A=a[9],R=a[10],k=a[11],j=a[12],U=a[13],H=a[14],Q=a[15],ue=t[0],te=t[1],L=t[2],G=t[3],ie=t[4],Te=t[5],qe=t[6],Ae=t[7],De=t[8],Xe=t[9],$e=t[10],Ye=t[11],Be=t[12],ut=t[13],wt=t[14],vt=t[15];return Math.abs(r-ue)<=Jt*Math.max(1,Math.abs(r),Math.abs(ue))&&Math.abs(o-te)<=Jt*Math.max(1,Math.abs(o),Math.abs(te))&&Math.abs(h-L)<=Jt*Math.max(1,Math.abs(h),Math.abs(L))&&Math.abs(g-G)<=Jt*Math.max(1,Math.abs(g),Math.abs(G))&&Math.abs(_-ie)<=Jt*Math.max(1,Math.abs(_),Math.abs(ie))&&Math.abs(v-Te)<=Jt*Math.max(1,Math.abs(v),Math.abs(Te))&&Math.abs(w-qe)<=Jt*Math.max(1,Math.abs(w),Math.abs(qe))&&Math.abs(M-Ae)<=Jt*Math.max(1,Math.abs(M),Math.abs(Ae))&&Math.abs(C-De)<=Jt*Math.max(1,Math.abs(C),Math.abs(De))&&Math.abs(A-Xe)<=Jt*Math.max(1,Math.abs(A),Math.abs(Xe))&&Math.abs(R-$e)<=Jt*Math.max(1,Math.abs(R),Math.abs($e))&&Math.abs(k-Ye)<=Jt*Math.max(1,Math.abs(k),Math.abs(Ye))&&Math.abs(j-Be)<=Jt*Math.max(1,Math.abs(j),Math.abs(Be))&&Math.abs(U-ut)<=Jt*Math.max(1,Math.abs(U),Math.abs(ut))&&Math.abs(H-wt)<=Jt*Math.max(1,Math.abs(H),Math.abs(wt))&&Math.abs(Q-vt)<=Jt*Math.max(1,Math.abs(Q),Math.abs(vt))},O.bZ=function(a,t){return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15],a},O.b_=a=>a.type==="symbol",O.ba=hc,O.bb=ci,O.bc=fe,O.bd=Mr,O.be=function(a,t,r,o,h){return ci(o,h,xt((a-t)/(r-t),0,1))},O.bf=zt,O.bg=function(){return new Float64Array(4)},O.bh=function(){return new Float64Array(3)},O.bi=function(a,t,r,o){var h=[],g=[];return h[0]=t[0]-r[0],h[1]=t[1]-r[1],h[2]=t[2]-r[2],g[0]=h[0]*Math.cos(o)-h[1]*Math.sin(o),g[1]=h[0]*Math.sin(o)+h[1]*Math.cos(o),g[2]=h[2],a[0]=g[0]+r[0],a[1]=g[1]+r[1],a[2]=g[2]+r[2],a},O.bj=function(a,t,r,o){var h=[],g=[];return h[0]=t[0]-r[0],h[1]=t[1]-r[1],h[2]=t[2]-r[2],g[0]=h[0],g[1]=h[1]*Math.cos(o)-h[2]*Math.sin(o),g[2]=h[1]*Math.sin(o)+h[2]*Math.cos(o),a[0]=g[0]+r[0],a[1]=g[1]+r[1],a[2]=g[2]+r[2],a},O.bk=function(a,t,r,o){var h=[],g=[];return h[0]=t[0]-r[0],h[1]=t[1]-r[1],h[2]=t[2]-r[2],g[0]=h[2]*Math.sin(o)+h[0]*Math.cos(o),g[1]=h[1],g[2]=h[2]*Math.cos(o)-h[0]*Math.sin(o),a[0]=g[0]+r[0],a[1]=g[1]+r[1],a[2]=g[2]+r[2],a},O.bl=function(a,t,r){var o=Math.sin(r),h=Math.cos(r),g=t[0],_=t[1],v=t[2],w=t[3],M=t[8],C=t[9],A=t[10],R=t[11];return t!==a&&(a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[0]=g*h-M*o,a[1]=_*h-C*o,a[2]=v*h-A*o,a[3]=w*h-R*o,a[8]=g*o+M*h,a[9]=_*o+C*h,a[10]=v*o+A*h,a[11]=w*o+R*h,a},O.bm=function(a,t){const r=zt(a,360),o=zt(t,360),h=o-r,g=o>r?h-360:h+360;return Math.abs(h)<Math.abs(g)?h:g},O.bn=function(a){return a[0]=0,a[1]=0,a[2]=0,a},O.bo=function(a,t,r,o){const h=Math.sqrt(a*a+t*t),g=Math.sqrt(r*r+o*o);a/=h,t/=h,r/=g,o/=g;const _=Math.acos(a*r+t*o);return-t*r+a*o>0?_:-_},O.bp=function(a,t){return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]+a[3]},O.bq=ld,O.br=function(a,t){const r=zt(a,2*Math.PI),o=zt(t,2*Math.PI);return Math.min(Math.abs(r-o),Math.abs(r-o+2*Math.PI),Math.abs(r-o-2*Math.PI))},O.bs=function(a){return Math.hypot(a[0],a[1],a[2])},O.bt=function(){const a={},t=P.$version;for(const r in P.$root){const o=P.$root[r];if(o.required){let h=null;h=r==="version"?t:o.type==="array"?[]:{},h!=null&&(a[r]=h)}}return a},O.bu=tu,O.bv=ia,O.bw=function(a){a=a.slice();const t=Object.create(null);for(let r=0;r<a.length;r++)t[a[r].id]=a[r];for(let r=0;r<a.length;r++)"ref"in a[r]&&(a[r]=$(a[r],t[a[r].ref]));return a},O.bx=function(a){if(a.type==="custom")return new vp(a);switch(a.type){case"background":return new yp(a);case"circle":return new Rf(a);case"fill":return new Ao(a);case"fill-extrusion":return new qd(a);case"heatmap":return new qh(a);case"hillshade":return new kd(a);case"line":return new Gi(a);case"raster":return new Yf(a);case"symbol":return new Js(a)}},O.by=ui,O.bz=function(a,t){if(!a)return[{command:"setStyle",args:[t]}];let r=[];try{if(!W(a.version,t.version))return[{command:"setStyle",args:[t]}];W(a.center,t.center)||r.push({command:"setCenter",args:[t.center]}),W(a.centerAltitude,t.centerAltitude)||r.push({command:"setCenterAltitude",args:[t.centerAltitude]}),W(a.zoom,t.zoom)||r.push({command:"setZoom",args:[t.zoom]}),W(a.bearing,t.bearing)||r.push({command:"setBearing",args:[t.bearing]}),W(a.pitch,t.pitch)||r.push({command:"setPitch",args:[t.pitch]}),W(a.roll,t.roll)||r.push({command:"setRoll",args:[t.roll]}),W(a.sprite,t.sprite)||r.push({command:"setSprite",args:[t.sprite]}),W(a.glyphs,t.glyphs)||r.push({command:"setGlyphs",args:[t.glyphs]}),W(a.transition,t.transition)||r.push({command:"setTransition",args:[t.transition]}),W(a.light,t.light)||r.push({command:"setLight",args:[t.light]}),W(a.terrain,t.terrain)||r.push({command:"setTerrain",args:[t.terrain]}),W(a.sky,t.sky)||r.push({command:"setSky",args:[t.sky]}),W(a.projection,t.projection)||r.push({command:"setProjection",args:[t.projection]});const o={},h=[];(function(_,v,w,M){let C;for(C in v=v||{},_=_||{})Object.prototype.hasOwnProperty.call(_,C)&&(Object.prototype.hasOwnProperty.call(v,C)||Se(C,w,M));for(C in v)Object.prototype.hasOwnProperty.call(v,C)&&(Object.prototype.hasOwnProperty.call(_,C)?W(_[C],v[C])||(_[C].type==="geojson"&&v[C].type==="geojson"&&Re(_,v,C)?le(w,{command:"setGeoJSONSourceData",args:[C,v[C].data]}):de(C,v,w,M)):pe(C,v,w))})(a.sources,t.sources,h,o);const g=[];a.layers&&a.layers.forEach(_=>{"source"in _&&o[_.source]?r.push({command:"removeLayer",args:[_.id]}):g.push(_)}),r=r.concat(h),function(_,v,w){v=v||[];const M=(_=_||[]).map(ve),C=v.map(ve),A=_.reduce(Ve,{}),R=v.reduce(Ve,{}),k=M.slice(),j=Object.create(null);let U,H,Q,ue,te;for(let L=0,G=0;L<M.length;L++)U=M[L],Object.prototype.hasOwnProperty.call(R,U)?G++:(le(w,{command:"removeLayer",args:[U]}),k.splice(k.indexOf(U,G),1));for(let L=0,G=0;L<C.length;L++)U=C[C.length-1-L],k[k.length-1-L]!==U&&(Object.prototype.hasOwnProperty.call(A,U)?(le(w,{command:"removeLayer",args:[U]}),k.splice(k.lastIndexOf(U,k.length-G),1)):G++,ue=k[k.length-L],le(w,{command:"addLayer",args:[R[U],ue]}),k.splice(k.length-L,0,U),j[U]=!0);for(let L=0;L<C.length;L++)if(U=C[L],H=A[U],Q=R[U],!j[U]&&!W(H,Q))if(W(H.source,Q.source)&&W(H["source-layer"],Q["source-layer"])&&W(H.type,Q.type)){for(te in ze(H.layout,Q.layout,w,U,null,"setLayoutProperty"),ze(H.paint,Q.paint,w,U,null,"setPaintProperty"),W(H.filter,Q.filter)||le(w,{command:"setFilter",args:[U,Q.filter]}),W(H.minzoom,Q.minzoom)&&W(H.maxzoom,Q.maxzoom)||le(w,{command:"setLayerZoomRange",args:[U,Q.minzoom,Q.maxzoom]}),H)Object.prototype.hasOwnProperty.call(H,te)&&te!=="layout"&&te!=="paint"&&te!=="filter"&&te!=="metadata"&&te!=="minzoom"&&te!=="maxzoom"&&(te.indexOf("paint.")===0?ze(H[te],Q[te],w,U,te.slice(6),"setPaintProperty"):W(H[te],Q[te])||le(w,{command:"setLayerProperty",args:[U,te,Q[te]]}));for(te in Q)Object.prototype.hasOwnProperty.call(Q,te)&&!Object.prototype.hasOwnProperty.call(H,te)&&te!=="layout"&&te!=="paint"&&te!=="filter"&&te!=="metadata"&&te!=="minzoom"&&te!=="maxzoom"&&(te.indexOf("paint.")===0?ze(H[te],Q[te],w,U,te.slice(6),"setPaintProperty"):W(H[te],Q[te])||le(w,{command:"setLayerProperty",args:[U,te,Q[te]]}))}else le(w,{command:"removeLayer",args:[U]}),ue=k[k.lastIndexOf(U)+1],le(w,{command:"addLayer",args:[Q,ue]})}(g,t.layers,r)}catch(o){console.warn("Unable to compute style diff:",o),r=[{command:"setStyle",args:[t]}]}return r},O.c=to,O.c0=a=>a.type==="heatmap",O.c1=a=>a.type==="line",O.c2=a=>a.type==="fill",O.c3=a=>a.type==="fill-extrusion",O.c4=a=>a.type==="hillshade",O.c5=a=>a.type==="raster",O.c6=a=>a.type==="background",O.c7=a=>a.type==="custom",O.c8=Je,O.c9=function(a,t,r){const o=Fn(t.x-r.x,t.y-r.y),h=Fn(a.x-r.x,a.y-r.y);var g,_;return Or(Math.atan2(o[0]*h[1]-o[1]*h[0],(g=o)[0]*(_=h)[0]+g[1]*_[1]))},O.cA=Bt,O.cB=Zd,O.cC=Qh,O.cD=Xa,O.cE=Aa,O.ca=St,O.cb=function(a,t,r){var o=t[0],h=t[1];return a[0]=r[0]*o+r[4]*h+r[12],a[1]=r[1]*o+r[5]*h+r[13],a},O.cc=function(a,t){const{x:r,y:o}=Kt.fromLngLat(t);return!(a<0||a>25||o<0||o>=1||r<0||r>=1)},O.cd=function(a,t){return a[0]=t[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=t[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=t[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},O.ce=class extends _o{},O.cf=Sh,O.ch=function(a){return a.message===Bo},O.ci=Fa,O.cj=function(a,t){or.REGISTERED_PROTOCOLS[a]=t},O.ck=function(a){delete or.REGISTERED_PROTOCOLS[a]},O.cl=function(a,t){const r={};for(let h=0;h<a.length;h++){const g=t&&t[a[h].id]||tr(a[h]);t&&(t[a[h].id]=g);let _=r[g];_||(_=r[g]=[]),_.push(a[h])}const o=[];for(const h in r)o.push(r[h]);return o},O.cm=nt,O.cn=yh,O.co=lf,O.cp=ed,O.cq=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=Ke/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;const t=a.bucket.layers[0],r=t.layout,o=t._unevaluatedLayout._values,h={layoutIconSize:o["icon-size"].possiblyEvaluate(new Pi(a.bucket.zoom+1),a.canonical),layoutTextSize:o["text-size"].possiblyEvaluate(new Pi(a.bucket.zoom+1),a.canonical),textMaxSize:o["text-size"].possiblyEvaluate(new Pi(18))};if(a.bucket.textSizeData.kind==="composite"){const{minZoom:M,maxZoom:C}=a.bucket.textSizeData;h.compositeTextSizes=[o["text-size"].possiblyEvaluate(new Pi(M),a.canonical),o["text-size"].possiblyEvaluate(new Pi(C),a.canonical)]}if(a.bucket.iconSizeData.kind==="composite"){const{minZoom:M,maxZoom:C}=a.bucket.iconSizeData;h.compositeIconSizes=[o["icon-size"].possiblyEvaluate(new Pi(M),a.canonical),o["icon-size"].possiblyEvaluate(new Pi(C),a.canonical)]}const g=r.get("text-line-height")*Wi,_=r.get("text-rotation-alignment")!=="viewport"&&r.get("symbol-placement")!=="point",v=r.get("text-keep-upright"),w=r.get("text-size");for(const M of a.bucket.features){const C=r.get("text-font").evaluate(M,{},a.canonical).join(","),A=w.evaluate(M,{},a.canonical),R=h.layoutTextSize.evaluate(M,{},a.canonical),k=h.layoutIconSize.evaluate(M,{},a.canonical),j={horizontal:{},vertical:void 0},U=M.text;let H,Q=[0,0];if(U){const L=U.toString(),G=r.get("text-letter-spacing").evaluate(M,{},a.canonical)*Wi,ie=rl(L)?G:0,Te=r.get("text-anchor").evaluate(M,{},a.canonical),qe=pf(t,M,a.canonical);if(!qe){const $e=r.get("text-radial-offset").evaluate(M,{},a.canonical);Q=$e?es(Te,[$e*Wi,ff]):r.get("text-offset").evaluate(M,{},a.canonical).map(Ye=>Ye*Wi)}let Ae=_?"center":r.get("text-justify").evaluate(M,{},a.canonical);const De=r.get("symbol-placement")==="point"?r.get("text-max-width").evaluate(M,{},a.canonical)*Wi:1/0,Xe=()=>{a.bucket.allowVerticalPlacement&&nl(L)&&(j.vertical=vu(U,a.glyphMap,a.glyphPositions,a.imagePositions,C,De,g,Te,"left",ie,Q,O.ag.vertical,!0,R,A))};if(!_&&qe){const $e=new Set;if(Ae==="auto")for(let Be=0;Be<qe.values.length;Be+=2)$e.add(_d(qe.values[Be]));else $e.add(Ae);let Ye=!1;for(const Be of $e)if(!j.horizontal[Be])if(Ye)j.horizontal[Be]=j.horizontal[0];else{const ut=vu(U,a.glyphMap,a.glyphPositions,a.imagePositions,C,De,g,"center",Be,ie,Q,O.ag.horizontal,!1,R,A);ut&&(j.horizontal[Be]=ut,Ye=ut.positionedLines.length===1)}Xe()}else{Ae==="auto"&&(Ae=_d(Te));const $e=vu(U,a.glyphMap,a.glyphPositions,a.imagePositions,C,De,g,Te,Ae,ie,Q,O.ag.horizontal,!1,R,A);$e&&(j.horizontal[Ae]=$e),Xe(),nl(L)&&_&&v&&(j.vertical=vu(U,a.glyphMap,a.glyphPositions,a.imagePositions,C,De,g,Te,Ae,ie,Q,O.ag.vertical,!1,R,A))}}let ue=!1;if(M.icon&&M.icon.name){const L=a.imageMap[M.icon.name];L&&(H=bu(a.imagePositions[M.icon.name],r.get("icon-offset").evaluate(M,{},a.canonical),r.get("icon-anchor").evaluate(M,{},a.canonical)),ue=!!L.sdf,a.bucket.sdfIcons===void 0?a.bucket.sdfIcons=ue:a.bucket.sdfIcons!==ue&&Di("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(L.pixelRatio!==a.bucket.pixelRatio||r.get("icon-rotate").constantOr(1)!==0)&&(a.bucket.iconsNeedLinear=!0))}const te=bh(j.horizontal)||j.vertical;a.bucket.iconsInText=!!te&&te.iconsInText,(te||H)&&ts(a.bucket,M,j,H,a.imageMap,h,R,k,Q,ue,a.canonical,a.subdivisionGranularity)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},O.cr=$d,O.cs=ka,O.ct=lh,O.cu=yl,O.cv=_u,O.cw=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return a.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},O.cx=function(a,t,r,o,h){return d(this,void 0,void 0,function*(){if(tn())try{return yield Br(a,t,r,o,h)}catch{}return function(g,_,v,w,M){const C=g.width,A=g.height;va&&ja||(va=new OffscreenCanvas(C,A),ja=va.getContext("2d",{willReadFrequently:!0})),va.width=C,va.height=A,ja.drawImage(g,0,0,C,A);const R=ja.getImageData(_,v,w,M);return ja.clearRect(0,0,C,A),R.data}(a,t,r,o,h)})},O.cy=Eu,O.cz=it,O.d=is,O.e=Rt,O.f=a=>d(void 0,void 0,void 0,function*(){if(a.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(a)],{type:"image/png"});try{return createImageBitmap(t)}catch(r){throw new Error(`Could not load image because of ${r.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),O.g=Oo,O.h=a=>new Promise((t,r)=>{const o=new Image;o.onload=()=>{t(o),URL.revokeObjectURL(o.src),o.onload=null,window.requestAnimationFrame(()=>{o.src=ea})},o.onerror=()=>r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const h=new Blob([new Uint8Array(a)],{type:"image/png"});o.src=a.byteLength?URL.createObjectURL(h):ea}),O.i=sr,O.j=(a,t)=>Ts(Rt(a,{type:"json"}),t),O.k=dn,O.l=ns,O.m=Ts,O.n=(a,t)=>Ts(Rt(a,{type:"arrayBuffer"}),t),O.o=function(a){return new _u(a).readFields(wl,[])},O.p=Jh,O.q=To,O.r=lr,O.s=ta,O.t=il,O.u=Tt,O.v=P,O.w=Di,O.x=Xr,O.y=_s,O.z=function([a,t,r]){return t+=90,t*=Math.PI/180,r*=Math.PI/180,{x:a*Math.cos(t)*Math.sin(r),y:a*Math.sin(t)*Math.sin(r),z:a*Math.cos(r)}}}),Oe("worker",["./shared"],function(O){class d{constructor(P){this.keyCache={},P&&this.replace(P)}replace(P){this._layerConfigs={},this._layers={},this.update(P,[])}update(P,V){for(const W of P){this._layerConfigs[W.id]=W;const le=this._layers[W.id]=O.bx(W);le._featureFilter=O.a6(le.filter),this.keyCache[W.id]&&delete this.keyCache[W.id]}for(const W of V)delete this.keyCache[W],delete this._layerConfigs[W],delete this._layers[W];this.familiesBySource={};const $=O.cl(Object.values(this._layerConfigs),this.keyCache);for(const W of $){const le=W.map(ve=>this._layers[ve.id]),pe=le[0];if(pe.visibility==="none")continue;const Se=pe.source||"";let de=this.familiesBySource[Se];de||(de=this.familiesBySource[Se]={});const Re=pe.sourceLayer||"_geojsonTileLayer";let ze=de[Re];ze||(ze=de[Re]=[]),ze.push(le)}}}class it{constructor(P){const V={},$=[];for(const Se in P){const de=P[Se],Re=V[Se]={};for(const ze in de){const ve=de[+ze];if(!ve||ve.bitmap.width===0||ve.bitmap.height===0)continue;const Ve={x:0,y:0,w:ve.bitmap.width+2,h:ve.bitmap.height+2};$.push(Ve),Re[ze]={rect:Ve,metrics:ve.metrics}}}const{w:W,h:le}=O.p($),pe=new O.q({width:W||1,height:le||1});for(const Se in P){const de=P[Se];for(const Re in de){const ze=de[+Re];if(!ze||ze.bitmap.width===0||ze.bitmap.height===0)continue;const ve=V[Se][Re].rect;O.q.copy(ze.bitmap,pe,{x:0,y:0},{x:ve.x+1,y:ve.y+1},ze.bitmap)}}this.image=pe,this.positions=V}}O.cm("GlyphAtlas",it);class Ne{constructor(P){this.tileID=new O.Y(P.tileID.overscaledZ,P.tileID.wrap,P.tileID.canonical.z,P.tileID.canonical.x,P.tileID.canonical.y),this.uid=P.uid,this.zoom=P.zoom,this.pixelRatio=P.pixelRatio,this.tileSize=P.tileSize,this.source=P.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=P.showCollisionBoxes,this.collectResourceTiming=!!P.collectResourceTiming,this.returnDependencies=!!P.returnDependencies,this.promoteId=P.promoteId,this.inFlightDependencies=[]}parse(P,V,$,W,le){return O._(this,void 0,void 0,function*(){this.status="parsing",this.data=P,this.collisionBoxArray=new O.a4;const pe=new O.cn(Object.keys(P.layers).sort()),Se=new O.co(this.tileID,this.promoteId);Se.bucketLayerIDs=[];const de={},Re={featureIndex:Se,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:$,subdivisionGranularity:le},ze=V.familiesBySource[this.source];for(const bt in ze){const Et=P.layers[bt];if(!Et)continue;Et.version===1&&O.w(`Vector tile source "${this.source}" layer "${bt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ct=pe.encode(bt),na=[];for(let nn=0;nn<Et.length;nn++){const In=Et.feature(nn),zi=Se.getId(In,bt);na.push({feature:In,id:zi,index:nn,sourceLayerIndex:ct})}for(const nn of ze[bt]){const In=nn[0];In.source!==this.source&&O.w(`layer.source = ${In.source} does not equal this.source = ${this.source}`),In.minzoom&&this.zoom<Math.floor(In.minzoom)||In.maxzoom&&this.zoom>=In.maxzoom||In.visibility!=="none"&&(Mt(nn,this.zoom,$),(de[In.id]=In.createBucket({index:Se.bucketLayerIDs.length,layers:nn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ct,sourceID:this.source})).populate(na,Re,this.tileID.canonical),Se.bucketLayerIDs.push(nn.map(zi=>zi.id)))}}const ve=O.bC(Re.glyphDependencies,bt=>Object.keys(bt).map(Number));this.inFlightDependencies.forEach(bt=>bt==null?void 0:bt.abort()),this.inFlightDependencies=[];let Ve=Promise.resolve({});if(Object.keys(ve).length){const bt=new AbortController;this.inFlightDependencies.push(bt),Ve=W.sendAsync({type:"GG",data:{stacks:ve,source:this.source,tileID:this.tileID,type:"glyphs"}},bt)}const xe=Object.keys(Re.iconDependencies);let tt=Promise.resolve({});if(xe.length){const bt=new AbortController;this.inFlightDependencies.push(bt),tt=W.sendAsync({type:"GI",data:{icons:xe,source:this.source,tileID:this.tileID,type:"icons"}},bt)}const pt=Object.keys(Re.patternDependencies);let kt=Promise.resolve({});if(pt.length){const bt=new AbortController;this.inFlightDependencies.push(bt),kt=W.sendAsync({type:"GI",data:{icons:pt,source:this.source,tileID:this.tileID,type:"patterns"}},bt)}const[At,je,ht]=yield Promise.all([Ve,tt,kt]),lt=new it(At),Zt=new O.cp(je,ht);for(const bt in de){const Et=de[bt];Et instanceof O.a5?(Mt(Et.layers,this.zoom,$),O.cq({bucket:Et,glyphMap:At,glyphPositions:lt.positions,imageMap:je,imagePositions:Zt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Re.subdivisionGranularity})):Et.hasPattern&&(Et instanceof O.cr||Et instanceof O.cs||Et instanceof O.ct)&&(Mt(Et.layers,this.zoom,$),Et.addFeatures(Re,this.tileID.canonical,Zt.patternPositions))}return this.status="done",{buckets:Object.values(de).filter(bt=>!bt.isEmpty()),featureIndex:Se,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:lt.image,imageAtlas:Zt,glyphMap:this.returnDependencies?At:null,iconMap:this.returnDependencies?je:null,glyphPositions:this.returnDependencies?lt.positions:null}})}}function Mt(ye,P,V){const $=new O.C(P);for(const W of ye)W.recalculate($,V)}class Bt{constructor(P,V,$){this.actor=P,this.layerIndex=V,this.availableImages=$,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(P,V){return O._(this,void 0,void 0,function*(){const $=yield O.n(P.request,V);try{return{vectorTile:new O.cu.VectorTile(new O.cv($.data)),rawData:$.data,cacheControl:$.cacheControl,expires:$.expires}}catch(W){const le=new Uint8Array($.data);let pe=`Unable to parse the tile at ${P.request.url}, `;throw pe+=le[0]===31&&le[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${W.message}`,new Error(pe)}})}loadTile(P){return O._(this,void 0,void 0,function*(){const V=P.uid,$=!!(P&&P.request&&P.request.collectResourceTiming)&&new O.cw(P.request),W=new Ne(P);this.loading[V]=W;const le=new AbortController;W.abort=le;try{const pe=yield this.loadVectorTile(P,le);if(delete this.loading[V],!pe)return null;const Se=pe.rawData,de={};pe.expires&&(de.expires=pe.expires),pe.cacheControl&&(de.cacheControl=pe.cacheControl);const Re={};if($){const ve=$.finish();ve&&(Re.resourceTiming=JSON.parse(JSON.stringify(ve)))}W.vectorTile=pe.vectorTile;const ze=W.parse(pe.vectorTile,this.layerIndex,this.availableImages,this.actor,P.subdivisionGranularity);this.loaded[V]=W,this.fetching[V]={rawTileData:Se,cacheControl:de,resourceTiming:Re};try{const ve=yield ze;return O.e({rawTileData:Se.slice(0)},ve,de,Re)}finally{delete this.fetching[V]}}catch(pe){throw delete this.loading[V],W.status="done",this.loaded[V]=W,pe}})}reloadTile(P){return O._(this,void 0,void 0,function*(){const V=P.uid;if(!this.loaded||!this.loaded[V])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const $=this.loaded[V];if($.showCollisionBoxes=P.showCollisionBoxes,$.status==="parsing"){const W=yield $.parse($.vectorTile,this.layerIndex,this.availableImages,this.actor,P.subdivisionGranularity);let le;if(this.fetching[V]){const{rawTileData:pe,cacheControl:Se,resourceTiming:de}=this.fetching[V];delete this.fetching[V],le=O.e({rawTileData:pe.slice(0)},W,Se,de)}else le=W;return le}if($.status==="done"&&$.vectorTile)return $.parse($.vectorTile,this.layerIndex,this.availableImages,this.actor,P.subdivisionGranularity)})}abortTile(P){return O._(this,void 0,void 0,function*(){const V=this.loading,$=P.uid;V&&V[$]&&V[$].abort&&(V[$].abort.abort(),delete V[$])})}removeTile(P){return O._(this,void 0,void 0,function*(){this.loaded&&this.loaded[P.uid]&&delete this.loaded[P.uid]})}}class at{constructor(){this.loaded={}}loadTile(P){return O._(this,void 0,void 0,function*(){const{uid:V,encoding:$,rawImageData:W,redFactor:le,greenFactor:pe,blueFactor:Se,baseShift:de}=P,Re=W.width+2,ze=W.height+2,ve=O.b(W)?new O.R({width:Re,height:ze},yield O.cx(W,-1,-1,Re,ze)):W,Ve=new O.cy(V,ve,$,le,pe,Se,de);return this.loaded=this.loaded||{},this.loaded[V]=Ve,Ve})}removeTile(P){const V=this.loaded,$=P.uid;V&&V[$]&&delete V[$]}}var _e,st,yi=function(){if(st)return _e;function ye(V,$){if(V.length!==0){P(V[0],$);for(var W=1;W<V.length;W++)P(V[W],!$)}}function P(V,$){for(var W=0,le=0,pe=0,Se=V.length,de=Se-1;pe<Se;de=pe++){var Re=(V[pe][0]-V[de][0])*(V[de][1]+V[pe][1]),ze=W+Re;le+=Math.abs(W)>=Math.abs(Re)?W-ze+Re:Re-ze+W,W=ze}W+le>=0!=!!$&&V.reverse()}return st=1,_e=function V($,W){var le,pe=$&&$.type;if(pe==="FeatureCollection")for(le=0;le<$.features.length;le++)V($.features[le],W);else if(pe==="GeometryCollection")for(le=0;le<$.geometries.length;le++)V($.geometries[le],W);else if(pe==="Feature")V($.geometry,W);else if(pe==="Polygon")ye($.coordinates,W);else if(pe==="MultiPolygon")for(le=0;le<$.coordinates.length;le++)ye($.coordinates[le],W);return $}}(),Ai=O.cz(yi);const Pn=O.cu.VectorTileFeature.prototype.toGeoJSON;class cn{constructor(P){this._feature=P,this.extent=O.Z,this.type=P.type,this.properties=P.tags,"id"in P&&!isNaN(P.id)&&(this.id=parseInt(P.id,10))}loadGeometry(){if(this._feature.type===1){const P=[];for(const V of this._feature.geometry)P.push([new O.P(V[0],V[1])]);return P}{const P=[];for(const V of this._feature.geometry){const $=[];for(const W of V)$.push(new O.P(W[0],W[1]));P.push($)}return P}}toGeoJSON(P,V,$){return Pn.call(this,P,V,$)}}class pr{constructor(P){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=O.Z,this.length=P.length,this._features=P}feature(P){return new cn(this._features[P])}}var tn,$t,Jt,li={exports:{}},gi=function(){if(Jt)return li.exports;Jt=1;var ye=O.cC(),P=function(){if($t)return tn;$t=1;var ze=O.cA(),ve=O.cB().VectorTileFeature;function Ve(tt,pt){this.options=pt||{},this.features=tt,this.length=tt.length}function xe(tt,pt){this.id=typeof tt.id=="number"?tt.id:void 0,this.type=tt.type,this.rawGeometry=tt.type===1?[tt.geometry]:tt.geometry,this.properties=tt.tags,this.extent=pt||4096}return tn=Ve,Ve.prototype.feature=function(tt){return new xe(this.features[tt],this.options.extent)},xe.prototype.loadGeometry=function(){var tt=this.rawGeometry;this.geometry=[];for(var pt=0;pt<tt.length;pt++){for(var kt=tt[pt],At=[],je=0;je<kt.length;je++)At.push(new ze(kt[je][0],kt[je][1]));this.geometry.push(At)}return this.geometry},xe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var tt=this.geometry,pt=1/0,kt=-1/0,At=1/0,je=-1/0,ht=0;ht<tt.length;ht++)for(var lt=tt[ht],Zt=0;Zt<lt.length;Zt++){var bt=lt[Zt];pt=Math.min(pt,bt.x),kt=Math.max(kt,bt.x),At=Math.min(At,bt.y),je=Math.max(je,bt.y)}return[pt,At,kt,je]},xe.prototype.toGeoJSON=ve.prototype.toGeoJSON,tn}();function V(ze){var ve=new ye;return function(Ve,xe){for(var tt in Ve.layers)xe.writeMessage(3,$,Ve.layers[tt])}(ze,ve),ve.finish()}function $(ze,ve){var Ve;ve.writeVarintField(15,ze.version||1),ve.writeStringField(1,ze.name||""),ve.writeVarintField(5,ze.extent||4096);var xe={keys:[],values:[],keycache:{},valuecache:{}};for(Ve=0;Ve<ze.length;Ve++)xe.feature=ze.feature(Ve),ve.writeMessage(2,W,xe);var tt=xe.keys;for(Ve=0;Ve<tt.length;Ve++)ve.writeStringField(3,tt[Ve]);var pt=xe.values;for(Ve=0;Ve<pt.length;Ve++)ve.writeMessage(4,Re,pt[Ve])}function W(ze,ve){var Ve=ze.feature;Ve.id!==void 0&&ve.writeVarintField(1,Ve.id),ve.writeMessage(2,le,ze),ve.writeVarintField(3,Ve.type),ve.writeMessage(4,de,Ve)}function le(ze,ve){var Ve=ze.feature,xe=ze.keys,tt=ze.values,pt=ze.keycache,kt=ze.valuecache;for(var At in Ve.properties){var je=Ve.properties[At],ht=pt[At];if(je!==null){ht===void 0&&(xe.push(At),pt[At]=ht=xe.length-1),ve.writeVarint(ht);var lt=typeof je;lt!=="string"&&lt!=="boolean"&&lt!=="number"&&(je=JSON.stringify(je));var Zt=lt+":"+je,bt=kt[Zt];bt===void 0&&(tt.push(je),kt[Zt]=bt=tt.length-1),ve.writeVarint(bt)}}}function pe(ze,ve){return(ve<<3)+(7&ze)}function Se(ze){return ze<<1^ze>>31}function de(ze,ve){for(var Ve=ze.loadGeometry(),xe=ze.type,tt=0,pt=0,kt=Ve.length,At=0;At<kt;At++){var je=Ve[At],ht=1;xe===1&&(ht=je.length),ve.writeVarint(pe(1,ht));for(var lt=xe===3?je.length-1:je.length,Zt=0;Zt<lt;Zt++){Zt===1&&xe!==1&&ve.writeVarint(pe(2,lt-1));var bt=je[Zt].x-tt,Et=je[Zt].y-pt;ve.writeVarint(Se(bt)),ve.writeVarint(Se(Et)),tt+=bt,pt+=Et}xe===3&&ve.writeVarint(pe(7,1))}}function Re(ze,ve){var Ve=typeof ze;Ve==="string"?ve.writeStringField(1,ze):Ve==="boolean"?ve.writeBooleanField(7,ze):Ve==="number"&&(ze%1!=0?ve.writeDoubleField(3,ze):ze<0?ve.writeSVarintField(6,ze):ve.writeVarintField(5,ze))}return li.exports=V,li.exports.fromVectorTileJs=V,li.exports.fromGeojsonVt=function(ze,ve){ve=ve||{};var Ve={};for(var xe in ze)Ve[xe]=new P(ze[xe].features,ve),Ve[xe].name=xe,Ve[xe].version=ve.version,Ve[xe].extent=ve.extent;return V({layers:Ve})},li.exports.GeoJSONWrapper=P,li.exports}(),Dt=O.cz(gi);const ai={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ye=>ye},Dn=Math.fround||(Kn=new Float32Array(1),ye=>(Kn[0]=+ye,Kn[0]));var Kn;const un=3,ji=5,Fn=6;class Ke{constructor(P){this.options=Object.assign(Object.create(ai),P),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(P){const{log:V,minZoom:$,maxZoom:W}=this.options;V&&console.time("total time");const le=`prepare ${P.length} points`;V&&console.time(le),this.points=P;const pe=[];for(let de=0;de<P.length;de++){const Re=P[de];if(!Re.geometry)continue;const[ze,ve]=Re.geometry.coordinates,Ve=Dn(ci(ze)),xe=Dn(fe(ve));pe.push(Ve,xe,1/0,de,-1,1),this.options.reduce&&pe.push(0)}let Se=this.trees[W+1]=this._createTree(pe);V&&console.timeEnd(le);for(let de=W;de>=$;de--){const Re=+Date.now();Se=this.trees[de]=this._createTree(this._cluster(Se,de)),V&&console.log("z%d: %d clusters in %dms",de,Se.numItems,+Date.now()-Re)}return V&&console.timeEnd("total time"),this}getClusters(P,V){let $=((P[0]+180)%360+360)%360-180;const W=Math.max(-90,Math.min(90,P[1]));let le=P[2]===180?180:((P[2]+180)%360+360)%360-180;const pe=Math.max(-90,Math.min(90,P[3]));if(P[2]-P[0]>=360)$=-180,le=180;else if($>le){const ve=this.getClusters([$,W,180,pe],V),Ve=this.getClusters([-180,W,le,pe],V);return ve.concat(Ve)}const Se=this.trees[this._limitZoom(V)],de=Se.range(ci($),fe(pe),ci(le),fe(W)),Re=Se.data,ze=[];for(const ve of de){const Ve=this.stride*ve;ze.push(Re[Ve+ji]>1?Ot(Re,Ve,this.clusterProps):this.points[Re[Ve+un]])}return ze}getChildren(P){const V=this._getOriginId(P),$=this._getOriginZoom(P),W="No cluster with the specified id.",le=this.trees[$];if(!le)throw new Error(W);const pe=le.data;if(V*this.stride>=pe.length)throw new Error(W);const Se=this.options.radius/(this.options.extent*Math.pow(2,$-1)),de=le.within(pe[V*this.stride],pe[V*this.stride+1],Se),Re=[];for(const ze of de){const ve=ze*this.stride;pe[ve+4]===P&&Re.push(pe[ve+ji]>1?Ot(pe,ve,this.clusterProps):this.points[pe[ve+un]])}if(Re.length===0)throw new Error(W);return Re}getLeaves(P,V,$){const W=[];return this._appendLeaves(W,P,V=V||10,$=$||0,0),W}getTile(P,V,$){const W=this.trees[this._limitZoom(P)],le=Math.pow(2,P),{extent:pe,radius:Se}=this.options,de=Se/pe,Re=($-de)/le,ze=($+1+de)/le,ve={features:[]};return this._addTileFeatures(W.range((V-de)/le,Re,(V+1+de)/le,ze),W.data,V,$,le,ve),V===0&&this._addTileFeatures(W.range(1-de/le,Re,1,ze),W.data,le,$,le,ve),V===le-1&&this._addTileFeatures(W.range(0,Re,de/le,ze),W.data,-1,$,le,ve),ve.features.length?ve:null}getClusterExpansionZoom(P){let V=this._getOriginZoom(P)-1;for(;V<=this.options.maxZoom;){const $=this.getChildren(P);if(V++,$.length!==1)break;P=$[0].properties.cluster_id}return V}_appendLeaves(P,V,$,W,le){const pe=this.getChildren(V);for(const Se of pe){const de=Se.properties;if(de&&de.cluster?le+de.point_count<=W?le+=de.point_count:le=this._appendLeaves(P,de.cluster_id,$,W,le):le<W?le++:P.push(Se),P.length===$)break}return le}_createTree(P){const V=new O.aB(P.length/this.stride|0,this.options.nodeSize,Float32Array);for(let $=0;$<P.length;$+=this.stride)V.add(P[$],P[$+1]);return V.finish(),V.data=P,V}_addTileFeatures(P,V,$,W,le,pe){for(const Se of P){const de=Se*this.stride,Re=V[de+ji]>1;let ze,ve,Ve;if(Re)ze=zt(V,de,this.clusterProps),ve=V[de],Ve=V[de+1];else{const pt=this.points[V[de+un]];ze=pt.properties;const[kt,At]=pt.geometry.coordinates;ve=ci(kt),Ve=fe(At)}const xe={type:1,geometry:[[Math.round(this.options.extent*(ve*le-$)),Math.round(this.options.extent*(Ve*le-W))]],tags:ze};let tt;tt=Re||this.options.generateId?V[de+un]:this.points[V[de+un]].id,tt!==void 0&&(xe.id=tt),pe.features.push(xe)}}_limitZoom(P){return Math.max(this.options.minZoom,Math.min(Math.floor(+P),this.options.maxZoom+1))}_cluster(P,V){const{radius:$,extent:W,reduce:le,minPoints:pe}=this.options,Se=$/(W*Math.pow(2,V)),de=P.data,Re=[],ze=this.stride;for(let ve=0;ve<de.length;ve+=ze){if(de[ve+2]<=V)continue;de[ve+2]=V;const Ve=de[ve],xe=de[ve+1],tt=P.within(de[ve],de[ve+1],Se),pt=de[ve+ji];let kt=pt;for(const At of tt){const je=At*ze;de[je+2]>V&&(kt+=de[je+ji])}if(kt>pt&&kt>=pe){let At,je=Ve*pt,ht=xe*pt,lt=-1;const Zt=((ve/ze|0)<<5)+(V+1)+this.points.length;for(const bt of tt){const Et=bt*ze;if(de[Et+2]<=V)continue;de[Et+2]=V;const ct=de[Et+ji];je+=de[Et]*ct,ht+=de[Et+1]*ct,de[Et+4]=Zt,le&&(At||(At=this._map(de,ve,!0),lt=this.clusterProps.length,this.clusterProps.push(At)),le(At,this._map(de,Et)))}de[ve+4]=Zt,Re.push(je/kt,ht/kt,1/0,Zt,-1,kt),le&&Re.push(lt)}else{for(let At=0;At<ze;At++)Re.push(de[ve+At]);if(kt>1)for(const At of tt){const je=At*ze;if(!(de[je+2]<=V)){de[je+2]=V;for(let ht=0;ht<ze;ht++)Re.push(de[je+ht])}}}}return Re}_getOriginId(P){return P-this.points.length>>5}_getOriginZoom(P){return(P-this.points.length)%32}_map(P,V,$){if(P[V+ji]>1){const pe=this.clusterProps[P[V+Fn]];return $?Object.assign({},pe):pe}const W=this.points[P[V+un]].properties,le=this.options.map(W);return $&&le===W?Object.assign({},le):le}}function Ot(ye,P,V){return{type:"Feature",id:ye[P+un],properties:zt(ye,P,V),geometry:{type:"Point",coordinates:[($=ye[P],360*($-.5)),Je(ye[P+1])]}};var $}function zt(ye,P,V){const $=ye[P+ji],W=$>=1e4?`${Math.round($/1e3)}k`:$>=1e3?Math.round($/100)/10+"k":$,le=ye[P+Fn],pe=le===-1?{}:Object.assign({},V[le]);return Object.assign(pe,{cluster:!0,cluster_id:ye[P+un],point_count:$,point_count_abbreviated:W})}function ci(ye){return ye/360+.5}function fe(ye){const P=Math.sin(ye*Math.PI/180),V=.5-.25*Math.log((1+P)/(1-P))/Math.PI;return V<0?0:V>1?1:V}function Je(ye){const P=(180-360*ye)*Math.PI/180;return 360*Math.atan(Math.exp(P))/Math.PI-90}function St(ye,P,V,$){let W=$;const le=P+(V-P>>1);let pe,Se=V-P;const de=ye[P],Re=ye[P+1],ze=ye[V],ve=ye[V+1];for(let Ve=P+3;Ve<V;Ve+=3){const xe=xt(ye[Ve],ye[Ve+1],de,Re,ze,ve);if(xe>W)pe=Ve,W=xe;else if(xe===W){const tt=Math.abs(Ve-le);tt<Se&&(pe=Ve,Se=tt)}}W>$&&(pe-P>3&&St(ye,P,pe,$),ye[pe+2]=W,V-pe>3&&St(ye,pe,V,$))}function xt(ye,P,V,$,W,le){let pe=W-V,Se=le-$;if(pe!==0||Se!==0){const de=((ye-V)*pe+(P-$)*Se)/(pe*pe+Se*Se);de>1?(V=W,$=le):de>0&&(V+=pe*de,$+=Se*de)}return pe=ye-V,Se=P-$,pe*pe+Se*Se}function ot(ye,P,V,$){const W={id:ye??null,type:P,geometry:V,tags:$,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(P==="Point"||P==="MultiPoint"||P==="LineString")Rt(W,V);else if(P==="Polygon")Rt(W,V[0]);else if(P==="MultiLineString")for(const le of V)Rt(W,le);else if(P==="MultiPolygon")for(const le of V)Rt(W,le[0]);return W}function Rt(ye,P){for(let V=0;V<P.length;V+=3)ye.minX=Math.min(ye.minX,P[V]),ye.minY=Math.min(ye.minY,P[V+1]),ye.maxX=Math.max(ye.maxX,P[V]),ye.maxY=Math.max(ye.maxY,P[V+1])}function Ut(ye,P,V,$){if(!P.geometry)return;const W=P.geometry.coordinates;if(W&&W.length===0)return;const le=P.geometry.type,pe=Math.pow(V.tolerance/((1<<V.maxZoom)*V.extent),2);let Se=[],de=P.id;if(V.promoteId?de=P.properties[V.promoteId]:V.generateId&&(de=$||0),le==="Point")hn(W,Se);else if(le==="MultiPoint")for(const Re of W)hn(Re,Se);else if(le==="LineString")ei(W,Se,pe,!1);else if(le==="MultiLineString"){if(V.lineMetrics){for(const Re of W)Se=[],ei(Re,Se,pe,!1),ye.push(ot(de,"LineString",Se,P.properties));return}ui(W,Se,pe,!1)}else if(le==="Polygon")ui(W,Se,pe,!0);else{if(le!=="MultiPolygon"){if(le==="GeometryCollection"){for(const Re of P.geometry.geometries)Ut(ye,{id:de,geometry:Re,properties:P.properties},V,$);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Re of W){const ze=[];ui(Re,ze,pe,!0),Se.push(ze)}}ye.push(ot(de,le,Se,P.properties))}function hn(ye,P){P.push(vi(ye[0]),Di(ye[1]),0)}function ei(ye,P,V,$){let W,le,pe=0;for(let de=0;de<ye.length;de++){const Re=vi(ye[de][0]),ze=Di(ye[de][1]);P.push(Re,ze,0),de>0&&(pe+=$?(W*ze-Re*le)/2:Math.sqrt(Math.pow(Re-W,2)+Math.pow(ze-le,2))),W=Re,le=ze}const Se=P.length-3;P[2]=1,St(P,0,Se,V),P[Se+2]=1,P.size=Math.abs(pe),P.start=0,P.end=P.size}function ui(ye,P,V,$){for(let W=0;W<ye.length;W++){const le=[];ei(ye[W],le,V,$),P.push(le)}}function vi(ye){return ye/360+.5}function Di(ye){const P=Math.sin(ye*Math.PI/180),V=.5-.25*Math.log((1+P)/(1-P))/Math.PI;return V<0?0:V>1?1:V}function Hi(ye,P,V,$,W,le,pe,Se){if($/=P,le>=(V/=P)&&pe<$)return ye;if(pe<V||le>=$)return null;const de=[];for(const Re of ye){const ze=Re.geometry;let ve=Re.type;const Ve=W===0?Re.minX:Re.minY,xe=W===0?Re.maxX:Re.maxY;if(Ve>=V&&xe<$){de.push(Re);continue}if(xe<V||Ve>=$)continue;let tt=[];if(ve==="Point"||ve==="MultiPoint")sr(ze,tt,V,$,W);else if(ve==="LineString")Fi(ze,tt,V,$,W,!1,Se.lineMetrics);else if(ve==="MultiLineString")ea(ze,tt,V,$,W,!1);else if(ve==="Polygon")ea(ze,tt,V,$,W,!0);else if(ve==="MultiPolygon")for(const pt of ze){const kt=[];ea(pt,kt,V,$,W,!0),kt.length&&tt.push(kt)}if(tt.length){if(Se.lineMetrics&&ve==="LineString"){for(const pt of tt)de.push(ot(Re.id,ve,pt,Re.tags));continue}ve!=="LineString"&&ve!=="MultiLineString"||(tt.length===1?(ve="LineString",tt=tt[0]):ve="MultiLineString"),ve!=="Point"&&ve!=="MultiPoint"||(ve=tt.length===3?"Point":"MultiPoint"),de.push(ot(Re.id,ve,tt,Re.tags))}}return de.length?de:null}function sr(ye,P,V,$,W){for(let le=0;le<ye.length;le+=3){const pe=ye[le+W];pe>=V&&pe<=$&&Br(P,ye[le],ye[le+1],ye[le+2])}}function Fi(ye,P,V,$,W,le,pe){let Se=Oa(ye);const de=W===0?va:ja;let Re,ze,ve=ye.start;for(let kt=0;kt<ye.length-3;kt+=3){const At=ye[kt],je=ye[kt+1],ht=ye[kt+2],lt=ye[kt+3],Zt=ye[kt+4],bt=W===0?At:je,Et=W===0?lt:Zt;let ct=!1;pe&&(Re=Math.sqrt(Math.pow(At-lt,2)+Math.pow(je-Zt,2))),bt<V?Et>V&&(ze=de(Se,At,je,lt,Zt,V),pe&&(Se.start=ve+Re*ze)):bt>$?Et<$&&(ze=de(Se,At,je,lt,Zt,$),pe&&(Se.start=ve+Re*ze)):Br(Se,At,je,ht),Et<V&&bt>=V&&(ze=de(Se,At,je,lt,Zt,V),ct=!0),Et>$&&bt<=$&&(ze=de(Se,At,je,lt,Zt,$),ct=!0),!le&&ct&&(pe&&(Se.end=ve+Re*ze),P.push(Se),Se=Oa(ye)),pe&&(ve+=Re)}let Ve=ye.length-3;const xe=ye[Ve],tt=ye[Ve+1],pt=W===0?xe:tt;pt>=V&&pt<=$&&Br(Se,xe,tt,ye[Ve+2]),Ve=Se.length-3,le&&Ve>=3&&(Se[Ve]!==Se[0]||Se[Ve+1]!==Se[1])&&Br(Se,Se[0],Se[1],Se[2]),Se.length&&P.push(Se)}function Oa(ye){const P=[];return P.size=ye.size,P.start=ye.start,P.end=ye.end,P}function ea(ye,P,V,$,W,le){for(const pe of ye)Fi(pe,P,V,$,W,le,!1)}function Br(ye,P,V,$){ye.push(P,V,$)}function va(ye,P,V,$,W,le){const pe=(le-P)/($-P);return Br(ye,le,V+(W-V)*pe,1),pe}function ja(ye,P,V,$,W,le){const pe=(le-V)/(W-V);return Br(ye,P+($-P)*pe,le,1),pe}function ta(ye,P){const V=[];for(let $=0;$<ye.length;$++){const W=ye[$],le=W.type;let pe;if(le==="Point"||le==="MultiPoint"||le==="LineString")pe=Or(W.geometry,P);else if(le==="MultiLineString"||le==="Polygon"){pe=[];for(const Se of W.geometry)pe.push(Or(Se,P))}else if(le==="MultiPolygon"){pe=[];for(const Se of W.geometry){const de=[];for(const Re of Se)de.push(Or(Re,P));pe.push(de)}}V.push(ot(W.id,le,pe,W.tags))}return V}function Or(ye,P){const V=[];V.size=ye.size,ye.start!==void 0&&(V.start=ye.start,V.end=ye.end);for(let $=0;$<ye.length;$+=3)V.push(ye[$]+P,ye[$+1],ye[$+2]);return V}function Bo(ye,P){if(ye.transformed)return ye;const V=1<<ye.z,$=ye.x,W=ye.y;for(const le of ye.features){const pe=le.geometry,Se=le.type;if(le.geometry=[],Se===1)for(let de=0;de<pe.length;de+=2)le.geometry.push(to(pe[de],pe[de+1],P,V,$,W));else for(let de=0;de<pe.length;de++){const Re=[];for(let ze=0;ze<pe[de].length;ze+=2)Re.push(to(pe[de][ze],pe[de][ze+1],P,V,$,W));le.geometry.push(Re)}}return ye.transformed=!0,ye}function to(ye,P,V,$,W,le){return[Math.round(V*(ye*$-W)),Math.round(V*(P*$-le))]}function or(ye,P,V,$,W){const le=P===W.maxZoom?0:W.tolerance/((1<<P)*W.extent),pe={features:[],numPoints:0,numSimplified:0,numFeatures:ye.length,source:null,x:V,y:$,z:P,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Se of ye)Oo(pe,Se,le,W);return pe}function Oo(ye,P,V,$){const W=P.geometry,le=P.type,pe=[];if(ye.minX=Math.min(ye.minX,P.minX),ye.minY=Math.min(ye.minY,P.minY),ye.maxX=Math.max(ye.maxX,P.maxX),ye.maxY=Math.max(ye.maxY,P.maxY),le==="Point"||le==="MultiPoint")for(let Se=0;Se<W.length;Se+=3)pe.push(W[Se],W[Se+1]),ye.numPoints++,ye.numSimplified++;else if(le==="LineString")ws(pe,W,ye,V,!1,!1);else if(le==="MultiLineString"||le==="Polygon")for(let Se=0;Se<W.length;Se++)ws(pe,W[Se],ye,V,le==="Polygon",Se===0);else if(le==="MultiPolygon")for(let Se=0;Se<W.length;Se++){const de=W[Se];for(let Re=0;Re<de.length;Re++)ws(pe,de[Re],ye,V,!0,Re===0)}if(pe.length){let Se=P.tags||null;if(le==="LineString"&&$.lineMetrics){Se={};for(const Re in P.tags)Se[Re]=P.tags[Re];Se.mapbox_clip_start=W.start/W.size,Se.mapbox_clip_end=W.end/W.size}const de={geometry:pe,type:le==="Polygon"||le==="MultiPolygon"?3:le==="LineString"||le==="MultiLineString"?2:1,tags:Se};P.id!==null&&(de.id=P.id),ye.features.push(de)}}function ws(ye,P,V,$,W,le){const pe=$*$;if($>0&&P.size<(W?pe:$))return void(V.numPoints+=P.length/3);const Se=[];for(let de=0;de<P.length;de+=3)($===0||P[de+2]>pe)&&(V.numSimplified++,Se.push(P[de],P[de+1])),V.numPoints++;W&&function(de,Re){let ze=0;for(let ve=0,Ve=de.length,xe=Ve-2;ve<Ve;xe=ve,ve+=2)ze+=(de[ve]-de[xe])*(de[ve+1]+de[xe+1]);if(ze>0===Re)for(let ve=0,Ve=de.length;ve<Ve/2;ve+=2){const xe=de[ve],tt=de[ve+1];de[ve]=de[Ve-2-ve],de[ve+1]=de[Ve-1-ve],de[Ve-2-ve]=xe,de[Ve-1-ve]=tt}}(Se,le),ye.push(Se)}const Fa={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class ia{constructor(P,V){const $=(V=this.options=function(le,pe){for(const Se in pe)le[Se]=pe[Se];return le}(Object.create(Fa),V)).debug;if($&&console.time("preprocess data"),V.maxZoom<0||V.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(V.promoteId&&V.generateId)throw new Error("promoteId and generateId cannot be used together.");let W=function(le,pe){const Se=[];if(le.type==="FeatureCollection")for(let de=0;de<le.features.length;de++)Ut(Se,le.features[de],pe,de);else Ut(Se,le.type==="Feature"?le:{geometry:le},pe);return Se}(P,V);this.tiles={},this.tileCoords=[],$&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",V.indexMaxZoom,V.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),W=function(le,pe){const Se=pe.buffer/pe.extent;let de=le;const Re=Hi(le,1,-1-Se,Se,0,-1,2,pe),ze=Hi(le,1,1-Se,2+Se,0,-1,2,pe);return(Re||ze)&&(de=Hi(le,1,-Se,1+Se,0,-1,2,pe)||[],Re&&(de=ta(Re,1).concat(de)),ze&&(de=de.concat(ta(ze,-1)))),de}(W,V),W.length&&this.splitTile(W,0,0,0),$&&(W.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(P,V,$,W,le,pe,Se){const de=[P,V,$,W],Re=this.options,ze=Re.debug;for(;de.length;){W=de.pop(),$=de.pop(),V=de.pop(),P=de.pop();const ve=1<<V,Ve=Ts(V,$,W);let xe=this.tiles[Ve];if(!xe&&(ze>1&&console.time("creation"),xe=this.tiles[Ve]=or(P,V,$,W,Re),this.tileCoords.push({z:V,x:$,y:W}),ze)){ze>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",V,$,W,xe.numFeatures,xe.numPoints,xe.numSimplified),console.timeEnd("creation"));const ct=`z${V}`;this.stats[ct]=(this.stats[ct]||0)+1,this.total++}if(xe.source=P,le==null){if(V===Re.indexMaxZoom||xe.numPoints<=Re.indexMaxPoints)continue}else{if(V===Re.maxZoom||V===le)continue;if(le!=null){const ct=le-V;if($!==pe>>ct||W!==Se>>ct)continue}}if(xe.source=null,P.length===0)continue;ze>1&&console.time("clipping");const tt=.5*Re.buffer/Re.extent,pt=.5-tt,kt=.5+tt,At=1+tt;let je=null,ht=null,lt=null,Zt=null,bt=Hi(P,ve,$-tt,$+kt,0,xe.minX,xe.maxX,Re),Et=Hi(P,ve,$+pt,$+At,0,xe.minX,xe.maxX,Re);P=null,bt&&(je=Hi(bt,ve,W-tt,W+kt,1,xe.minY,xe.maxY,Re),ht=Hi(bt,ve,W+pt,W+At,1,xe.minY,xe.maxY,Re),bt=null),Et&&(lt=Hi(Et,ve,W-tt,W+kt,1,xe.minY,xe.maxY,Re),Zt=Hi(Et,ve,W+pt,W+At,1,xe.minY,xe.maxY,Re),Et=null),ze>1&&console.timeEnd("clipping"),de.push(je||[],V+1,2*$,2*W),de.push(ht||[],V+1,2*$,2*W+1),de.push(lt||[],V+1,2*$+1,2*W),de.push(Zt||[],V+1,2*$+1,2*W+1)}}getTile(P,V,$){P=+P,V=+V,$=+$;const W=this.options,{extent:le,debug:pe}=W;if(P<0||P>24)return null;const Se=1<<P,de=Ts(P,V=V+Se&Se-1,$);if(this.tiles[de])return Bo(this.tiles[de],le);pe>1&&console.log("drilling down to z%d-%d-%d",P,V,$);let Re,ze=P,ve=V,Ve=$;for(;!Re&&ze>0;)ze--,ve>>=1,Ve>>=1,Re=this.tiles[Ts(ze,ve,Ve)];return Re&&Re.source?(pe>1&&(console.log("found parent tile z%d-%d-%d",ze,ve,Ve),console.time("drilling down")),this.splitTile(Re.source,ze,ve,Ve,P,V,$),pe>1&&console.timeEnd("drilling down"),this.tiles[de]?Bo(this.tiles[de],le):null):null}}function Ts(ye,P,V){return 32*((1<<ye)*V+P)+ye}function is(ye,P){return P?ye.properties[P]:ye.id}function Il(ye,P){if(ye==null)return!0;if(ye.type==="Feature")return is(ye,P)!=null;if(ye.type==="FeatureCollection"){const V=new Set;for(const $ of ye.features){const W=is($,P);if(W==null||V.has(W))return!1;V.add(W)}return!0}return!1}function jo(ye,P){const V=new Map;if(ye!=null)if(ye.type==="Feature")V.set(is(ye,P),ye);else for(const $ of ye.features)V.set(is($,P),$);return V}class ns extends Bt{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(P,V){return O._(this,void 0,void 0,function*(){const $=P.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const W=this._geoJSONIndex.getTile($.z,$.x,$.y);if(!W)return null;const le=new pr(W.features);let pe=Dt(le);return pe.byteOffset===0&&pe.byteLength===pe.buffer.byteLength||(pe=new Uint8Array(pe)),{vectorTile:le,rawData:pe.buffer}})}loadData(P){return O._(this,void 0,void 0,function*(){var V;(V=this._pendingRequest)===null||V===void 0||V.abort();const $=!!(P&&P.request&&P.request.collectResourceTiming)&&new O.cw(P.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(P,this._pendingRequest),this._geoJSONIndex=P.cluster?new Ke(function({superclusterOptions:pe,clusterProperties:Se}){if(!Se||!pe)return pe;const de={},Re={},ze={accumulated:null,zoom:0},ve={properties:null},Ve=Object.keys(Se);for(const xe of Ve){const[tt,pt]=Se[xe],kt=O.cD(pt),At=O.cD(typeof tt=="string"?[tt,["accumulated"],["get",xe]]:tt);de[xe]=kt.value,Re[xe]=At.value}return pe.map=xe=>{ve.properties=xe;const tt={};for(const pt of Ve)tt[pt]=de[pt].evaluate(ze,ve);return tt},pe.reduce=(xe,tt)=>{ve.properties=tt;for(const pt of Ve)ze.accumulated=xe[pt],xe[pt]=Re[pt].evaluate(ze,ve)},pe}(P)).load((yield this._pendingData).features):(W=yield this._pendingData,new ia(W,P.geojsonVtOptions)),this.loaded={};const le={};if($){const pe=$.finish();pe&&(le.resourceTiming={},le.resourceTiming[P.source]=JSON.parse(JSON.stringify(pe)))}return le}catch(le){if(delete this._pendingRequest,O.ch(le))return{abandoned:!0};throw le}var W})}getData(){return O._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(P){const V=this.loaded;return V&&V[P.uid]?super.reloadTile(P):this.loadTile(P)}loadAndProcessGeoJSON(P,V){return O._(this,void 0,void 0,function*(){let $=yield this.loadGeoJSON(P,V);if(delete this._pendingRequest,typeof $!="object")throw new Error(`Input data given to '${P.source}' is not a valid GeoJSON object.`);if(Ai($,!0),P.filter){const W=O.cD(P.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(W.result==="error")throw new Error(W.value.map(pe=>`${pe.key}: ${pe.message}`).join(", "));$={type:"FeatureCollection",features:$.features.filter(pe=>W.value.evaluate({zoom:0},pe))}}return $})}loadGeoJSON(P,V){return O._(this,void 0,void 0,function*(){const{promoteId:$}=P;if(P.request){const W=yield O.j(P.request,V);return this._dataUpdateable=Il(W.data,$)?jo(W.data,$):void 0,W.data}if(typeof P.data=="string")try{const W=JSON.parse(P.data);return this._dataUpdateable=Il(W,$)?jo(W,$):void 0,W}catch{throw new Error(`Input data given to '${P.source}' is not a valid GeoJSON object.`)}if(!P.dataDiff)throw new Error(`Input data given to '${P.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${P.source}`);return function(W,le,pe){var Se,de,Re,ze;if(le.removeAll&&W.clear(),le.remove)for(const ve of le.remove)W.delete(ve);if(le.add)for(const ve of le.add){const Ve=is(ve,pe);Ve!=null&&W.set(Ve,ve)}if(le.update)for(const ve of le.update){let Ve=W.get(ve.id);if(Ve==null)continue;const xe=!ve.removeAllProperties&&(((Se=ve.removeProperties)===null||Se===void 0?void 0:Se.length)>0||((de=ve.addOrUpdateProperties)===null||de===void 0?void 0:de.length)>0);if((ve.newGeometry||ve.removeAllProperties||xe)&&(Ve=Object.assign({},Ve),W.set(ve.id,Ve),xe&&(Ve.properties=Object.assign({},Ve.properties))),ve.newGeometry&&(Ve.geometry=ve.newGeometry),ve.removeAllProperties)Ve.properties={};else if(((Re=ve.removeProperties)===null||Re===void 0?void 0:Re.length)>0)for(const tt of ve.removeProperties)Object.prototype.hasOwnProperty.call(Ve.properties,tt)&&delete Ve.properties[tt];if(((ze=ve.addOrUpdateProperties)===null||ze===void 0?void 0:ze.length)>0)for(const{key:tt,value:pt}of ve.addOrUpdateProperties)Ve.properties[tt]=pt}}(this._dataUpdateable,P.dataDiff,$),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(P){return O._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(P){return this._geoJSONIndex.getClusterExpansionZoom(P.clusterId)}getClusterChildren(P){return this._geoJSONIndex.getChildren(P.clusterId)}getClusterLeaves(P){return this._geoJSONIndex.getLeaves(P.clusterId,P.limit,P.offset)}}class dn{constructor(P){this.self=P,this.actor=new O.H(P),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(V,$)=>{if(this.externalWorkerSourceTypes[V])throw new Error(`Worker source with name "${V}" already registered.`);this.externalWorkerSourceTypes[V]=$},this.self.addProtocol=O.cj,this.self.removeProtocol=O.ck,this.self.registerRTLTextPlugin=V=>{O.cE.setMethods(V)},this.actor.registerMessageHandler("LDT",(V,$)=>this._getDEMWorkerSource(V,$.source).loadTile($)),this.actor.registerMessageHandler("RDT",(V,$)=>O._(this,void 0,void 0,function*(){this._getDEMWorkerSource(V,$.source).removeTile($)})),this.actor.registerMessageHandler("GCEZ",(V,$)=>O._(this,void 0,void 0,function*(){return this._getWorkerSource(V,$.type,$.source).getClusterExpansionZoom($)})),this.actor.registerMessageHandler("GCC",(V,$)=>O._(this,void 0,void 0,function*(){return this._getWorkerSource(V,$.type,$.source).getClusterChildren($)})),this.actor.registerMessageHandler("GCL",(V,$)=>O._(this,void 0,void 0,function*(){return this._getWorkerSource(V,$.type,$.source).getClusterLeaves($)})),this.actor.registerMessageHandler("LD",(V,$)=>this._getWorkerSource(V,$.type,$.source).loadData($)),this.actor.registerMessageHandler("GD",(V,$)=>this._getWorkerSource(V,$.type,$.source).getData()),this.actor.registerMessageHandler("LT",(V,$)=>this._getWorkerSource(V,$.type,$.source).loadTile($)),this.actor.registerMessageHandler("RT",(V,$)=>this._getWorkerSource(V,$.type,$.source).reloadTile($)),this.actor.registerMessageHandler("AT",(V,$)=>this._getWorkerSource(V,$.type,$.source).abortTile($)),this.actor.registerMessageHandler("RMT",(V,$)=>this._getWorkerSource(V,$.type,$.source).removeTile($)),this.actor.registerMessageHandler("RS",(V,$)=>O._(this,void 0,void 0,function*(){if(!this.workerSources[V]||!this.workerSources[V][$.type]||!this.workerSources[V][$.type][$.source])return;const W=this.workerSources[V][$.type][$.source];delete this.workerSources[V][$.type][$.source],W.removeSource!==void 0&&W.removeSource($)})),this.actor.registerMessageHandler("RM",V=>O._(this,void 0,void 0,function*(){delete this.layerIndexes[V],delete this.availableImages[V],delete this.workerSources[V],delete this.demWorkerSources[V]})),this.actor.registerMessageHandler("SR",(V,$)=>O._(this,void 0,void 0,function*(){this.referrer=$})),this.actor.registerMessageHandler("SRPS",(V,$)=>this._syncRTLPluginState(V,$)),this.actor.registerMessageHandler("IS",(V,$)=>O._(this,void 0,void 0,function*(){this.self.importScripts($)})),this.actor.registerMessageHandler("SI",(V,$)=>this._setImages(V,$)),this.actor.registerMessageHandler("UL",(V,$)=>O._(this,void 0,void 0,function*(){this._getLayerIndex(V).update($.layers,$.removedIds)})),this.actor.registerMessageHandler("SL",(V,$)=>O._(this,void 0,void 0,function*(){this._getLayerIndex(V).replace($)}))}_setImages(P,V){return O._(this,void 0,void 0,function*(){this.availableImages[P]=V;for(const $ in this.workerSources[P]){const W=this.workerSources[P][$];for(const le in W)W[le].availableImages=V}})}_syncRTLPluginState(P,V){return O._(this,void 0,void 0,function*(){return yield O.cE.syncState(V,this.self.importScripts)})}_getAvailableImages(P){let V=this.availableImages[P];return V||(V=[]),V}_getLayerIndex(P){let V=this.layerIndexes[P];return V||(V=this.layerIndexes[P]=new d),V}_getWorkerSource(P,V,$){if(this.workerSources[P]||(this.workerSources[P]={}),this.workerSources[P][V]||(this.workerSources[P][V]={}),!this.workerSources[P][V][$]){const W={sendAsync:(le,pe)=>(le.targetMapId=P,this.actor.sendAsync(le,pe))};switch(V){case"vector":this.workerSources[P][V][$]=new Bt(W,this._getLayerIndex(P),this._getAvailableImages(P));break;case"geojson":this.workerSources[P][V][$]=new ns(W,this._getLayerIndex(P),this._getAvailableImages(P));break;default:this.workerSources[P][V][$]=new this.externalWorkerSourceTypes[V](W,this._getLayerIndex(P),this._getAvailableImages(P))}}return this.workerSources[P][V][$]}_getDEMWorkerSource(P,V){return this.demWorkerSources[P]||(this.demWorkerSources[P]={}),this.demWorkerSources[P][V]||(this.demWorkerSources[P][V]=new at),this.demWorkerSources[P][V]}}return O.i(self)&&(self.worker=new dn(self)),dn}),Oe("index",["exports","./shared"],function(O,d){var it="5.2.0";function Ne(){var f=new d.A(4);return d.A!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f}let Mt,Bt;const at={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(f,e,n){const l=requestAnimationFrame(m=>{u(),e(m)}),{unsubscribe:u}=d.s(f.signal,"abort",()=>{u(),cancelAnimationFrame(l),n(d.c())},!1)},frameAsync(f){return new Promise((e,n)=>{this.frame(f,e,n)})},getImageData(f,e=0){return this.getImageCanvasContext(f).getImageData(-e,-e,f.width+2*e,f.height+2*e)},getImageCanvasContext(f){const e=window.document.createElement("canvas"),n=e.getContext("2d",{willReadFrequently:!0});if(!n)throw new Error("failed to create canvas 2d context");return e.width=f.width,e.height=f.height,n.drawImage(f,0,0,f.width,f.height),n},resolveURL:f=>(Mt||(Mt=document.createElement("a")),Mt.href=f,Mt.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Bt==null&&(Bt=matchMedia("(prefers-reduced-motion: reduce)")),Bt.matches)}};class _e{static testProp(e){if(!_e.docStyle)return e[0];for(let n=0;n<e.length;n++)if(e[n]in _e.docStyle)return e[n];return e[0]}static create(e,n,l){const u=window.document.createElement(e);return n!==void 0&&(u.className=n),l&&l.appendChild(u),u}static createNS(e,n){return window.document.createElementNS(e,n)}static disableDrag(){_e.docStyle&&_e.selectProp&&(_e.userSelect=_e.docStyle[_e.selectProp],_e.docStyle[_e.selectProp]="none")}static enableDrag(){_e.docStyle&&_e.selectProp&&(_e.docStyle[_e.selectProp]=_e.userSelect)}static setTransform(e,n){e.style[_e.transformProp]=n}static addEventListener(e,n,l,u={}){e.addEventListener(n,l,"passive"in u?u:u.capture)}static removeEventListener(e,n,l,u={}){e.removeEventListener(n,l,"passive"in u?u:u.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",_e.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",_e.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",_e.suppressClickInternal,!0)},0)}static getScale(e){const n=e.getBoundingClientRect();return{x:n.width/e.offsetWidth||1,y:n.height/e.offsetHeight||1,boundingClientRect:n}}static getPoint(e,n,l){const u=n.boundingClientRect;return new d.P((l.clientX-u.left)/n.x-e.clientLeft,(l.clientY-u.top)/n.y-e.clientTop)}static mousePos(e,n){const l=_e.getScale(e);return _e.getPoint(e,l,n)}static touchPos(e,n){const l=[],u=_e.getScale(e);for(let m=0;m<n.length;m++)l.push(_e.getPoint(e,u,n[m]));return l}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const n=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),l=n.querySelectorAll("script");for(const u of l)u.remove();return _e.clean(n),n.innerHTML}static isPossiblyDangerous(e,n){const l=n.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!l.includes("javascript:")&&!l.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const n=e.children;for(const l of n)_e.removeAttributes(l),_e.clean(l)}static removeAttributes(e){for(const{name:n,value:l}of e.attributes)_e.isPossiblyDangerous(n,l)&&e.removeAttribute(n)}}_e.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,_e.selectProp=_e.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),_e.transformProp=_e.testProp(["transform","WebkitTransform"]);const st={supported:!1,testSupport:function(f){!Pn&&Ai&&(cn?pr(f):yi=f)}};let yi,Ai,Pn=!1,cn=!1;function pr(f){const e=f.createTexture();f.bindTexture(f.TEXTURE_2D,e);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,Ai),f.isContextLost())return;st.supported=!0}catch{}f.deleteTexture(e),Pn=!0}var tn;typeof document<"u"&&(Ai=document.createElement("img"),Ai.onload=()=>{yi&&pr(yi),yi=null,cn=!0},Ai.onerror=()=>{Pn=!0,yi=null},Ai.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(f){let e,n,l,u;f.resetRequestQueue=()=>{e=[],n=0,l=0,u={}},f.addThrottleControl=T=>{const E=l++;return u[E]=T,E},f.removeThrottleControl=T=>{delete u[T],y()},f.getImage=(T,E,z=!0)=>new Promise((D,I)=>{st.supported&&(T.headers||(T.headers={}),T.headers.accept="image/webp,*/*"),d.e(T,{type:"image"}),e.push({abortController:E,requestParameters:T,supportImageRefresh:z,state:"queued",onError:F=>{I(F)},onSuccess:F=>{D(F)}}),y()});const m=T=>d._(this,void 0,void 0,function*(){T.state="running";const{requestParameters:E,supportImageRefresh:z,onError:D,onSuccess:I,abortController:F}=T,N=z===!1&&!d.i(self)&&!d.g(E.url)&&(!E.headers||Object.keys(E.headers).reduce((K,J)=>K&&J==="accept",!0));n++;const Y=N?b(E,F):d.m(E,F);try{const K=yield Y;delete T.abortController,T.state="completed",K.data instanceof HTMLImageElement||d.b(K.data)?I(K):K.data&&I({data:yield(X=K.data,typeof createImageBitmap=="function"?d.f(X):d.h(X)),cacheControl:K.cacheControl,expires:K.expires})}catch(K){delete T.abortController,D(K)}finally{n--,y()}var X}),y=()=>{const T=(()=>{for(const E of Object.keys(u))if(u[E]())return!0;return!1})()?d.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:d.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let E=n;E<T&&e.length>0;E++){const z=e.shift();z.abortController.signal.aborted?E--:m(z)}},b=(T,E)=>new Promise((z,D)=>{const I=new Image,F=T.url,N=T.credentials;N&&N==="include"?I.crossOrigin="use-credentials":(N&&N==="same-origin"||!d.d(F))&&(I.crossOrigin="anonymous"),E.signal.addEventListener("abort",()=>{I.src="",D(d.c())}),I.fetchPriority="high",I.onload=()=>{I.onerror=I.onload=null,z({data:I})},I.onerror=()=>{I.onerror=I.onload=null,E.signal.aborted||D(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},I.src=F})}(tn||(tn={})),tn.resetRequestQueue();class $t{constructor(e){this._transformRequestFn=e}transformRequest(e,n){return this._transformRequestFn&&this._transformRequestFn(e,n)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function Jt(f){const e=[];if(typeof f=="string")e.push({id:"default",url:f});else if(f&&f.length>0){const n=[];for(const{id:l,url:u}of f){const m=`${l}${u}`;n.indexOf(m)===-1&&(n.push(m),e.push({id:l,url:u}))}}return e}function li(f,e,n){try{const l=new URL(f);return l.pathname+=`${e}${n}`,l.toString()}catch{throw new Error(`Invalid sprite URL "${f}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class gi{constructor(e,n,l,u){this.context=e,this.format=l,this.texture=e.gl.createTexture(),this.update(n,u)}update(e,n,l){const{width:u,height:m}=e,y=!(this.size&&this.size[0]===u&&this.size[1]===m||l),{context:b}=this,{gl:T}=b;if(this.useMipmap=!!(n&&n.useMipmap),T.bindTexture(T.TEXTURE_2D,this.texture),b.pixelStoreUnpackFlipY.set(!1),b.pixelStoreUnpack.set(1),b.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!n||n.premultiply!==!1)),y)this.size=[u,m],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||d.b(e)?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,e):T.texImage2D(T.TEXTURE_2D,0,this.format,u,m,0,this.format,T.UNSIGNED_BYTE,e.data);else{const{x:E,y:z}=l||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||d.b(e)?T.texSubImage2D(T.TEXTURE_2D,0,E,z,T.RGBA,T.UNSIGNED_BYTE,e):T.texSubImage2D(T.TEXTURE_2D,0,E,z,u,m,T.RGBA,T.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&T.generateMipmap(T.TEXTURE_2D)}bind(e,n,l){const{context:u}=this,{gl:m}=u;m.bindTexture(m.TEXTURE_2D,this.texture),l!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(l=m.LINEAR),e!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,e),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,l||e),this.filter=e),n!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,n),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function Dt(f){const{userImage:e}=f;return!!(e&&e.render&&e.render())&&(f.data.replace(new Uint8Array(e.data.buffer)),!0)}class ai extends d.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new d.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:n,promiseResolve:l}of this.requestors)l(this._getImagesForIds(n));this.requestors=[]}}getImage(e){const n=this.images[e];if(n&&!n.data&&n.spriteData){const l=n.spriteData;n.data=new d.R({width:l.width,height:l.height},l.context.getImageData(l.x,l.y,l.width,l.height).data),n.spriteData=null}return n}addImage(e,n){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,n)&&(this.images[e]=n)}_validate(e,n){let l=!0;const u=n.data||n.spriteData;return this._validateStretch(n.stretchX,u&&u.width)||(this.fire(new d.k(new Error(`Image "${e}" has invalid "stretchX" value`))),l=!1),this._validateStretch(n.stretchY,u&&u.height)||(this.fire(new d.k(new Error(`Image "${e}" has invalid "stretchY" value`))),l=!1),this._validateContent(n.content,n)||(this.fire(new d.k(new Error(`Image "${e}" has invalid "content" value`))),l=!1),l}_validateStretch(e,n){if(!e)return!0;let l=0;for(const u of e){if(u[0]<l||u[1]<u[0]||n<u[1])return!1;l=u[1]}return!0}_validateContent(e,n){if(!e)return!0;if(e.length!==4)return!1;const l=n.spriteData,u=l&&l.width||n.data.width,m=l&&l.height||n.data.height;return!(e[0]<0||u<e[0]||e[1]<0||m<e[1]||e[2]<0||u<e[2]||e[3]<0||m<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,n,l=!0){const u=this.getImage(e);if(l&&(u.data.width!==n.data.width||u.data.height!==n.data.height))throw new Error(`size mismatch between old image (${u.data.width}x${u.data.height}) and new image (${n.data.width}x${n.data.height}).`);n.version=u.version+1,this.images[e]=n,this.updatedImages[e]=!0}removeImage(e){const n=this.images[e];delete this.images[e],delete this.patterns[e],n.userImage&&n.userImage.onRemove&&n.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((n,l)=>{let u=!0;if(!this.isLoaded())for(const m of e)this.images[m]||(u=!1);this.isLoaded()||u?n(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:n})})}_getImagesForIds(e){const n={};for(const l of e){let u=this.getImage(l);u||(this.fire(new d.l("styleimagemissing",{id:l})),u=this.getImage(l)),u?n[l]={data:u.data.clone(),pixelRatio:u.pixelRatio,sdf:u.sdf,version:u.version,stretchX:u.stretchX,stretchY:u.stretchY,content:u.content,textFitWidth:u.textFitWidth,textFitHeight:u.textFitHeight,hasRenderCallback:!!(u.userImage&&u.userImage.render)}:d.w(`Image "${l}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return n}getPixelSize(){const{width:e,height:n}=this.atlasImage;return{width:e,height:n}}getPattern(e){const n=this.patterns[e],l=this.getImage(e);if(!l)return null;if(n&&n.position.version===l.version)return n.position;if(n)n.position.version=l.version;else{const u={w:l.data.width+2,h:l.data.height+2,x:0,y:0},m=new d.I(u,l);this.patterns[e]={bin:u,position:m}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const n=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new gi(e,this.atlasImage,n.RGBA),this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const m in this.patterns)e.push(this.patterns[m].bin);const{w:n,h:l}=d.p(e),u=this.atlasImage;u.resize({width:n||1,height:l||1});for(const m in this.patterns){const{bin:y}=this.patterns[m],b=y.x+1,T=y.y+1,E=this.getImage(m).data,z=E.width,D=E.height;d.R.copy(E,u,{x:0,y:0},{x:b,y:T},{width:z,height:D}),d.R.copy(E,u,{x:0,y:D-1},{x:b,y:T-1},{width:z,height:1}),d.R.copy(E,u,{x:0,y:0},{x:b,y:T+D},{width:z,height:1}),d.R.copy(E,u,{x:z-1,y:0},{x:b-1,y:T},{width:1,height:D}),d.R.copy(E,u,{x:0,y:0},{x:b+z,y:T},{width:1,height:D})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const n of e){if(this.callbackDispatchedThisFrame[n])continue;this.callbackDispatchedThisFrame[n]=!0;const l=this.getImage(n);l||d.w(`Image with ID: "${n}" was not found`),Dt(l)&&this.updateImage(n,l)}}}const Dn=1e20;function Kn(f,e,n,l,u,m,y,b,T){for(let E=e;E<e+l;E++)un(f,n*m+E,m,u,y,b,T);for(let E=n;E<n+u;E++)un(f,E*m+e,1,l,y,b,T)}function un(f,e,n,l,u,m,y){m[0]=0,y[0]=-1e20,y[1]=Dn,u[0]=f[e];for(let b=1,T=0,E=0;b<l;b++){u[b]=f[e+b*n];const z=b*b;do{const D=m[T];E=(u[b]-u[D]+z-D*D)/(b-D)/2}while(E<=y[T]&&--T>-1);T++,m[T]=b,y[T]=E,y[T+1]=Dn}for(let b=0,T=0;b<l;b++){for(;y[T+1]<b;)T++;const E=m[T],z=b-E;f[e+b*n]=u[E]+z*z}}class ji{constructor(e,n){this.requestManager=e,this.localIdeographFontFamily=n,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return d._(this,void 0,void 0,function*(){const n=[];for(const m in e)for(const y of e[m])n.push(this._getAndCacheGlyphsPromise(m,y));const l=yield Promise.all(n),u={};for(const{stack:m,id:y,glyph:b}of l)u[m]||(u[m]={}),u[m][y]=b&&{id:b.id,bitmap:b.bitmap.clone(),metrics:b.metrics};return u})}_getAndCacheGlyphsPromise(e,n){return d._(this,void 0,void 0,function*(){let l=this.entries[e];l||(l=this.entries[e]={glyphs:{},requests:{},ranges:{}});let u=l.glyphs[n];if(u!==void 0)return{stack:e,id:n,glyph:u};if(u=this._tinySDF(l,e,n),u)return l.glyphs[n]=u,{stack:e,id:n,glyph:u};const m=Math.floor(n/256);if(256*m>65535)throw new Error("glyphs > 65535 not supported");if(l.ranges[m])return{stack:e,id:n,glyph:u};if(!this.url)throw new Error("glyphsUrl is not set");if(!l.requests[m]){const b=ji.loadGlyphRange(e,m,this.url,this.requestManager);l.requests[m]=b}const y=yield l.requests[m];for(const b in y)this._doesCharSupportLocalGlyph(+b)||(l.glyphs[+b]=y[+b]);return l.ranges[m]=!0,{stack:e,id:n,glyph:y[n]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||d.u["CJK Unified Ideographs"](e)||d.u["Hangul Syllables"](e)||d.u.Hiragana(e)||d.u.Katakana(e)||d.u["CJK Symbols and Punctuation"](e)||d.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,n,l){const u=this.localIdeographFontFamily;if(!u||!this._doesCharSupportLocalGlyph(l))return;let m=e.tinySDF;if(!m){let b="400";/bold/i.test(n)?b="900":/medium/i.test(n)?b="500":/light/i.test(n)&&(b="200"),m=e.tinySDF=new ji.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:u,fontWeight:b})}const y=m.draw(String.fromCharCode(l));return{id:l,bitmap:new d.q({width:y.width||60,height:y.height||60},y.data),metrics:{width:y.glyphWidth/2||24,height:y.glyphHeight/2||24,left:y.glyphLeft/2+.5||0,top:y.glyphTop/2-27.5||-8,advance:y.glyphAdvance/2||24,isDoubleResolution:!0}}}}ji.loadGlyphRange=function(f,e,n,l){return d._(this,void 0,void 0,function*(){const u=256*e,m=u+255,y=l.transformRequest(n.replace("{fontstack}",f).replace("{range}",`${u}-${m}`),"Glyphs"),b=yield d.n(y,new AbortController);if(!b||!b.data)throw new Error(`Could not load glyph range. range: ${e}, ${u}-${m}`);const T={};for(const E of d.o(b.data))T[E.id]=E;return T})},ji.TinySDF=class{constructor({fontSize:f=24,buffer:e=3,radius:n=8,cutoff:l=.25,fontFamily:u="sans-serif",fontWeight:m="normal",fontStyle:y="normal"}={}){this.buffer=e,this.cutoff=l,this.radius=n;const b=this.size=f+4*e,T=this._createCanvas(b),E=this.ctx=T.getContext("2d",{willReadFrequently:!0});E.font=`${y} ${m} ${f}px ${u}`,E.textBaseline="alphabetic",E.textAlign="left",E.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(f){const e=document.createElement("canvas");return e.width=e.height=f,e}draw(f){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:l,actualBoundingBoxLeft:u,actualBoundingBoxRight:m}=this.ctx.measureText(f),y=Math.ceil(n),b=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-u))),T=Math.min(this.size-this.buffer,y+Math.ceil(l)),E=b+2*this.buffer,z=T+2*this.buffer,D=Math.max(E*z,0),I=new Uint8ClampedArray(D),F={data:I,width:E,height:z,glyphWidth:b,glyphHeight:T,glyphTop:y,glyphLeft:0,glyphAdvance:e};if(b===0||T===0)return F;const{ctx:N,buffer:Y,gridInner:X,gridOuter:K}=this;N.clearRect(Y,Y,b,T),N.fillText(f,Y,Y+y);const J=N.getImageData(Y,Y,b,T);K.fill(Dn,0,D),X.fill(0,0,D);for(let re=0;re<T;re++)for(let ae=0;ae<b;ae++){const oe=J.data[4*(re*b+ae)+3]/255;if(oe===0)continue;const he=(re+Y)*E+ae+Y;if(oe===1)K[he]=0,X[he]=Dn;else{const ce=.5-oe;K[he]=ce>0?ce*ce:0,X[he]=ce<0?ce*ce:0}}Kn(K,0,0,E,z,E,this.f,this.v,this.z),Kn(X,Y,Y,b,T,E,this.f,this.v,this.z);for(let re=0;re<D;re++){const ae=Math.sqrt(K[re])-Math.sqrt(X[re]);I[re]=Math.round(255-255*(ae/this.radius+this.cutoff))}return F}};class Fn{constructor(){this.specification=d.v.light.position}possiblyEvaluate(e,n){return d.z(e.expression.evaluate(n))}interpolate(e,n,l){return{x:d.B.number(e.x,n.x,l),y:d.B.number(e.y,n.y,l),z:d.B.number(e.z,n.z,l)}}}let Ke;class Ot extends d.E{constructor(e){super(),Ke=Ke||new d.r({anchor:new d.D(d.v.light.anchor),position:new Fn,color:new d.D(d.v.light.color),intensity:new d.D(d.v.light.intensity)}),this._transitionable=new d.T(Ke),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,n={}){if(!this._validate(d.t,e,n))for(const l in e){const u=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),u):this._transitionable.setValue(l,u)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,n,l){return(!l||l.validate!==!1)&&d.x(this,e.call(d.y,{value:n,style:{glyphs:!0,sprite:!0},styleSpec:d.v}))}}const zt=new d.r({"sky-color":new d.D(d.v.sky["sky-color"]),"horizon-color":new d.D(d.v.sky["horizon-color"]),"fog-color":new d.D(d.v.sky["fog-color"]),"fog-ground-blend":new d.D(d.v.sky["fog-ground-blend"]),"horizon-fog-blend":new d.D(d.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new d.D(d.v.sky["sky-horizon-blend"]),"atmosphere-blend":new d.D(d.v.sky["atmosphere-blend"])});class ci extends d.E{constructor(e){super(),this._transitionable=new d.T(zt),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new d.C(0))}setSky(e,n={}){if(!this._validate(d.F,e,n)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const l in e){const u=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),u):this._transitionable.setValue(l,u)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,n,l={}){return(l==null?void 0:l.validate)!==!1&&d.x(this,e.call(d.y,d.e({value:n,style:{glyphs:!0,sprite:!0},styleSpec:d.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class fe{constructor(e,n){this.width=e,this.height=n,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,n){const l=e.join(",")+String(n);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(e,n)),this.dashEntry[l]}getDashRanges(e,n,l){const u=[];let m=e.length%2==1?-e[e.length-1]*l:0,y=e[0]*l,b=!0;u.push({left:m,right:y,isDash:b,zeroLength:e[0]===0});let T=e[0];for(let E=1;E<e.length;E++){b=!b;const z=e[E];m=T*l,T+=z,y=T*l,u.push({left:m,right:y,isDash:b,zeroLength:z===0})}return u}addRoundDash(e,n,l){const u=n/2;for(let m=-l;m<=l;m++){const y=this.width*(this.nextRow+l+m);let b=0,T=e[b];for(let E=0;E<this.width;E++){E/T.right>1&&(T=e[++b]);const z=Math.abs(E-T.left),D=Math.abs(E-T.right),I=Math.min(z,D);let F;const N=m/l*(u+1);if(T.isDash){const Y=u-Math.abs(N);F=Math.sqrt(I*I+Y*Y)}else F=u-Math.sqrt(I*I+N*N);this.data[y+E]=Math.max(0,Math.min(255,F+128))}}}addRegularDash(e){for(let b=e.length-1;b>=0;--b){const T=e[b],E=e[b+1];T.zeroLength?e.splice(b,1):E&&E.isDash===T.isDash&&(E.left=T.left,e.splice(b,1))}const n=e[0],l=e[e.length-1];n.isDash===l.isDash&&(n.left=l.left-this.width,l.right=n.right+this.width);const u=this.width*this.nextRow;let m=0,y=e[m];for(let b=0;b<this.width;b++){b/y.right>1&&(y=e[++m]);const T=Math.abs(b-y.left),E=Math.abs(b-y.right),z=Math.min(T,E);this.data[u+b]=Math.max(0,Math.min(255,(y.isDash?z:-z)+128))}}addDash(e,n){const l=n?7:0,u=2*l+1;if(this.nextRow+u>this.height)return d.w("LineAtlas out of space"),null;let m=0;for(let b=0;b<e.length;b++)m+=e[b];if(m!==0){const b=this.width/m,T=this.getDashRanges(e,this.width,b);n?this.addRoundDash(T,b,l):this.addRegularDash(T)}const y={y:(this.nextRow+l+.5)/this.height,height:2*l/this.height,width:m};return this.nextRow+=u,this.dirty=!0,y}bind(e){const n=e.gl;this.texture?(n.bindTexture(n.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,n.texSubImage2D(n.TEXTURE_2D,0,0,0,this.width,this.height,n.ALPHA,n.UNSIGNED_BYTE,this.data))):(this.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.ALPHA,this.width,this.height,0,n.ALPHA,n.UNSIGNED_BYTE,this.data))}}const Je="maplibre_preloaded_worker_pool";class St{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<St.workerCount;)this.workers.push(new Worker(d.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(n=>{n.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Je]}numActive(){return Object.keys(this.active).length}}const xt=Math.floor(at.hardwareConcurrency/2);let ot,Rt;function Ut(){return ot||(ot=new St),ot}St.workerCount=d.G(globalThis)?Math.max(Math.min(xt,3),1):1;class hn{constructor(e,n){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=n;const l=this.workerPool.acquire(n);for(let u=0;u<l.length;u++){const m=new d.H(l[u],n);m.name=`Worker ${u}`,this.actors.push(m)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,n){const l=[];for(const u of this.actors)l.push(u.sendAsync({type:e,data:n}));return Promise.all(l)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(n=>{n.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,n){for(const l of this.actors)l.registerMessageHandler(e,n)}}function ei(){return Rt||(Rt=new hn(Ut(),d.J),Rt.registerMessageHandler("GR",(f,e,n)=>d.m(e,n))),Rt}function ui(f,e){const n=d.K();return d.L(n,n,[1,1,0]),d.M(n,n,[.5*f.width,.5*f.height,1]),f.calculatePosMatrix?d.N(n,n,f.calculatePosMatrix(e.toUnwrapped())):n}function vi(f,e,n,l,u,m){var y;const b=function(D,I,F){if(D)for(const N of D){const Y=I[N];if(Y&&Y.source===F&&Y.type==="fill-extrusion")return!0}else for(const N in I){const Y=I[N];if(Y.source===F&&Y.type==="fill-extrusion")return!0}return!1}((y=u==null?void 0:u.layers)!==null&&y!==void 0?y:null,e,f.id),T=m.maxPitchScaleFactor(),E=f.tilesIn(l,T,b);E.sort(Di);const z=[];for(const D of E)z.push({wrappedTileID:D.tileID.wrapped().key,queryResults:D.tile.queryRenderedFeatures(e,n,f._state,D.queryGeometry,D.cameraQueryGeometry,D.scale,u,m,T,ui(f.transform,D.tileID))});return function(D,I){for(const F in D)for(const N of D[F])Hi(N,I);return D}(function(D){const I={},F={};for(const N of D){const Y=N.queryResults,X=N.wrappedTileID,K=F[X]=F[X]||{};for(const J in Y){const re=Y[J],ae=K[J]=K[J]||{},oe=I[J]=I[J]||[];for(const he of re)ae[he.featureIndex]||(ae[he.featureIndex]=!0,oe.push(he))}}return I}(z),f)}function Di(f,e){const n=f.tileID,l=e.tileID;return n.overscaledZ-l.overscaledZ||n.canonical.y-l.canonical.y||n.wrap-l.wrap||n.canonical.x-l.canonical.x}function Hi(f,e){const n=f.feature,l=e.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=l}function sr(f,e,n){return d._(this,void 0,void 0,function*(){let l=f;if(f.url?l=(yield d.j(e.transformRequest(f.url,"Source"),n)).data:yield at.frameAsync(n),!l)return null;const u=d.O(d.e(l,f),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in l&&l.vector_layers&&(u.vectorLayerIds=l.vector_layers.map(m=>m.id)),u})}class Fi{constructor(e,n){e&&(n?this.setSouthWest(e).setNorthEast(n):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof d.Q?new d.Q(e.lng,e.lat):d.Q.convert(e),this}setSouthWest(e){return this._sw=e instanceof d.Q?new d.Q(e.lng,e.lat):d.Q.convert(e),this}extend(e){const n=this._sw,l=this._ne;let u,m;if(e instanceof d.Q)u=e,m=e;else{if(!(e instanceof Fi))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Fi.convert(e)):this.extend(d.Q.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(d.Q.convert(e)):this;if(u=e._sw,m=e._ne,!u||!m)return this}return n||l?(n.lng=Math.min(u.lng,n.lng),n.lat=Math.min(u.lat,n.lat),l.lng=Math.max(m.lng,l.lng),l.lat=Math.max(m.lat,l.lat)):(this._sw=new d.Q(u.lng,u.lat),this._ne=new d.Q(m.lng,m.lat)),this}getCenter(){return new d.Q((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new d.Q(this.getWest(),this.getNorth())}getSouthEast(){return new d.Q(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:n,lat:l}=d.Q.convert(e);let u=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&u}static convert(e){return e instanceof Fi?e:e&&new Fi(e)}static fromLngLat(e,n=0){const l=360*n/40075017,u=l/Math.cos(Math.PI/180*e.lat);return new Fi(new d.Q(e.lng-u,e.lat-l),new d.Q(e.lng+u,e.lat+l))}adjustAntiMeridian(){const e=new d.Q(this._sw.lng,this._sw.lat),n=new d.Q(this._ne.lng,this._ne.lat);return new Fi(e,e.lng>n.lng?new d.Q(n.lng+360,n.lat):n)}}class Oa{constructor(e,n,l){this.bounds=Fi.convert(this.validateBounds(e)),this.minzoom=n||0,this.maxzoom=l||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const n=Math.pow(2,e.z),l=Math.floor(d.U(this.bounds.getWest())*n),u=Math.floor(d.S(this.bounds.getNorth())*n),m=Math.ceil(d.U(this.bounds.getEast())*n),y=Math.ceil(d.S(this.bounds.getSouth())*n);return e.x>=l&&e.x<m&&e.y>=u&&e.y<y}}class ea extends d.E{constructor(e,n,l,u){if(super(),this.id=e,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,d.e(this,d.O(n,["url","scheme","tileSize","promoteId"])),this._options=d.e({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(u)}load(){return d._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new d.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield sr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(d.e(this,e),e.bounds&&(this.tileBounds=new Oa(e.bounds,this.minzoom,this.maxzoom)),this.fire(new d.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new d.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new d.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return d.e({},this._options)}loadTile(e){return d._(this,void 0,void 0,function*(){const n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l={request:this.map._requestManager.transformRequest(n,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};l.request.collectResourceTiming=this._collectResourceTiming;let u="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((m,y)=>{e.reloadPromise={resolve:m,reject:y}})}else e.actor=this.dispatcher.getActor(),u="LT";e.abortController=new AbortController;try{const m=yield e.actor.sendAsync({type:u,data:l},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,m)}catch(m){if(delete e.abortController,e.aborted)return;if(m&&m.status!==404)throw m;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,n){if(n&&n.resourceTiming&&(e.resourceTiming=n.resourceTiming),n&&this.map._refreshExpiredTiles&&e.setExpiryData(n),e.loadVectorData(n,this.map.painter),e.reloadPromise){const l=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(l.resolve).catch(l.reject)}}abortTile(e){return d._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return d._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Br extends d.E{constructor(e,n,l,u){super(),this.id=e,this.dispatcher=l,this.setEventedParent(u),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=d.e({type:"raster"},n),d.e(this,d.O(n,["url","scheme","tileSize"]))}load(){return d._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new d.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield sr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,n&&(d.e(this,n),n.bounds&&(this.tileBounds=new Oa(n.bounds,this.minzoom,this.maxzoom)),this.fire(new d.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new d.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(n){this._tileJSONRequest=null,this.fire(new d.k(n))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return d.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return d._(this,void 0,void 0,function*(){const n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const l=yield tn.getImage(this.map._requestManager.transformRequest(n,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(l&&l.data){this.map._refreshExpiredTiles&&l.cacheControl&&l.expires&&e.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const u=this.map.painter.context,m=u.gl,y=l.data;e.texture=this.map.painter.getTileTexture(y.width),e.texture?e.texture.update(y,{useMipmap:!0}):(e.texture=new gi(u,y,m.RGBA,{useMipmap:!0}),e.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE,m.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(l){if(delete e.abortController,e.aborted)e.state="unloaded";else if(l)throw e.state="errored",l}})}abortTile(e){return d._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return d._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class va extends Br{constructor(e,n,l,u){super(e,n,l,u),this.type="raster-dem",this.maxzoom=22,this._options=d.e({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox",this.redFactor=n.redFactor,this.greenFactor=n.greenFactor,this.blueFactor=n.blueFactor,this.baseShift=n.baseShift}loadTile(e){return d._(this,void 0,void 0,function*(){const n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l=this.map._requestManager.transformRequest(n,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const u=yield tn.getImage(l,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(u&&u.data){const m=u.data;this.map._refreshExpiredTiles&&u.cacheControl&&u.expires&&e.setExpiryData({cacheControl:u.cacheControl,expires:u.expires});const y=d.b(m)&&d.V()?m:yield this.readImageNow(m),b={type:this.type,uid:e.uid,source:this.id,rawImageData:y,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const T=yield e.actor.sendAsync({type:"LDT",data:b});e.dem=T,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(u){if(delete e.abortController,e.aborted)e.state="unloaded";else if(u)throw e.state="errored",u}})}readImageNow(e){return d._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&d.W()){const n=e.width+2,l=e.height+2;try{return new d.R({width:n,height:l},yield d.X(e,-1,-1,n,l))}catch{}}return at.getImageData(e,1)})}_getNeighboringTiles(e){const n=e.canonical,l=Math.pow(2,n.z),u=(n.x-1+l)%l,m=n.x===0?e.wrap-1:e.wrap,y=(n.x+1+l)%l,b=n.x+1===l?e.wrap+1:e.wrap,T={};return T[new d.Y(e.overscaledZ,m,n.z,u,n.y).key]={backfilled:!1},T[new d.Y(e.overscaledZ,b,n.z,y,n.y).key]={backfilled:!1},n.y>0&&(T[new d.Y(e.overscaledZ,m,n.z,u,n.y-1).key]={backfilled:!1},T[new d.Y(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},T[new d.Y(e.overscaledZ,b,n.z,y,n.y-1).key]={backfilled:!1}),n.y+1<l&&(T[new d.Y(e.overscaledZ,m,n.z,u,n.y+1).key]={backfilled:!1},T[new d.Y(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},T[new d.Y(e.overscaledZ,b,n.z,y,n.y+1).key]={backfilled:!1}),T}unloadTile(e){return d._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class ja extends d.E{constructor(e,n,l,u){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=l.getActor(),this.setEventedParent(u),this._data=n.data,this._options=d.e({},n),this._collectResourceTiming=n.collectResourceTiming,n.maxzoom!==void 0&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId,n.clusterMaxZoom!==void 0&&this.maxzoom<=n.clusterMaxZoom&&d.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${n.clusterMaxZoom}".`),this.workerOptions=d.e({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(n.buffer!==void 0?n.buffer:128),tolerance:this._pixelsToTileUnits(n.tolerance!==void 0?n.tolerance:.375),extent:d.Z,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:n.clusterMaxZoom!==void 0?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:d.Z,radius:this._pixelsToTileUnits(n.clusterRadius||50),log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(d.Z/this.tileSize)}load(){return d._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return d._(this,void 0,void 0,function*(){const e=d.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,n,l){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:n,offset:l}})}_updateWorkerData(e){return d._(this,void 0,void 0,function*(){const n=d.e({type:this.type},this.workerOptions);e?n.dataDiff=e:typeof this._data=="string"?(n.request=this.map._requestManager.transformRequest(at.resolveURL(this._data),"Source"),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new d.l("dataloading",{dataType:"source"}));try{const l=yield this.actor.sendAsync({type:"LD",data:n});if(this._pendingLoads--,this._removed||l.abandoned)return void this.fire(new d.l("dataabort",{dataType:"source"}));let u=null;l.resourceTiming&&l.resourceTiming[this.id]&&(u=l.resourceTiming[this.id].slice(0));const m={dataType:"source"};this._collectResourceTiming&&u&&u.length>0&&d.e(m,{resourceTiming:u}),this.fire(new d.l("data",Object.assign(Object.assign({},m),{sourceDataType:"metadata"}))),this.fire(new d.l("data",Object.assign(Object.assign({},m),{sourceDataType:"content"})))}catch(l){if(this._pendingLoads--,this._removed)return void this.fire(new d.l("dataabort",{dataType:"source"}));this.fire(new d.k(l))}})}loaded(){return this._pendingLoads===0}loadTile(e){return d._(this,void 0,void 0,function*(){const n=e.actor?"RT":"LT";e.actor=this.actor;const l={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const u=yield this.actor.sendAsync({type:n,data:l},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(u,this.map.painter,n==="RT")})}abortTile(e){return d._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return d._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return d.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class ta extends d.E{constructor(e,n,l,u){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=l,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(u),this.options=n}load(e){return d._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new d.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const n=yield tn.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,n&&n.data&&(this.image=n.data,e&&(this.coordinates=e),this._finishLoading())}catch(n){this._request=null,this._loaded=!0,this.fire(new d.k(n))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new d.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const n=e.map(d.$.fromLngLat);var l;return this.tileID=function(u){let m=1/0,y=1/0,b=-1/0,T=-1/0;for(const I of u)m=Math.min(m,I.x),y=Math.min(y,I.y),b=Math.max(b,I.x),T=Math.max(T,I.y);const E=Math.max(b-m,T-y),z=Math.max(0,Math.floor(-Math.log(E)/Math.LN2)),D=Math.pow(2,z);return new d.a0(z,Math.floor((m+b)/2*D),Math.floor((y+T)/2*D))}(n),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=n.map(u=>this.tileID.getTilePoint(u)._round()),this.flippedWindingOrder=((l=this.tileCoords)[1].x-l[0].x)*(l[2].y-l[0].y)-(l[1].y-l[0].y)*(l[2].x-l[0].x)<0,this.fire(new d.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,n=e.gl;this.texture||(this.texture=new gi(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let l=!1;for(const u in this.tiles){const m=this.tiles[u];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,l=!0)}l&&this.fire(new d.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return d._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Or extends ta{constructor(e,n,l,u){super(e,n,l,u),this.roundZoom=!0,this.type="video",this.options=n}load(){return d._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const n of e.urls)this.urls.push(this.map._requestManager.transformRequest(n,"Source").url);try{const n=yield d.a1(this.urls);if(this._loaded=!0,!n)return;this.video=n,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(n){this.fire(new d.k(n))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const n=this.video.seekable;e<n.start(0)||e>n.end(0)?this.fire(new d.k(new d.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,n=e.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new gi(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let l=!1;for(const u in this.tiles){const m=this.tiles[u];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,l=!0)}l&&this.fire(new d.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Bo extends ta{constructor(e,n,l,u){super(e,n,l,u),n.coordinates?Array.isArray(n.coordinates)&&n.coordinates.length===4&&!n.coordinates.some(m=>!Array.isArray(m)||m.length!==2||m.some(y=>typeof y!="number"))||this.fire(new d.k(new d.a2(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new d.k(new d.a2(`sources.${e}`,null,'missing required property "coordinates"'))),n.animate&&typeof n.animate!="boolean"&&this.fire(new d.k(new d.a2(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),n.canvas?typeof n.canvas=="string"||n.canvas instanceof HTMLCanvasElement||this.fire(new d.k(new d.a2(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new d.k(new d.a2(`sources.${e}`,null,'missing required property "canvas"'))),this.options=n,this.animate=n.animate===void 0||n.animate}load(){return d._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new d.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const n=this.map.painter.context,l=n.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new gi(n,this.canvas,l.RGBA,{premultiply:!0});let u=!1;for(const m in this.tiles){const y=this.tiles[m];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,u=!0)}u&&this.fire(new d.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const to={},or=f=>{switch(f){case"geojson":return ja;case"image":return ta;case"raster":return Br;case"raster-dem":return va;case"vector":return ea;case"video":return Or;case"canvas":return Bo}return to[f]},Oo="RTLPluginLoaded";class ws extends d.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=ei()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(n=>{throw this.status="error",n})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return d._(this,arguments,void 0,function*(n,l=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=at.resolveURL(n),!this.url)throw new Error(`requested url ${n} is invalid`);if(this.status==="unavailable"){if(!l)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return d._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new d.l(Oo))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Fa=null;function ia(){return Fa||(Fa=new ws),Fa}class Ts{constructor(e,n){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=d.a3(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const n=e+this.timeAdded;n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,n,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(u,m){const y={};if(!m)return y;for(const b of u){const T=b.layerIds.map(E=>m.getLayer(E)).filter(Boolean);if(T.length!==0){b.layers=T,b.stateDependentLayerIds&&(b.stateDependentLayers=b.stateDependentLayerIds.map(E=>T.filter(z=>z.id===E)[0]));for(const E of T)y[E.id]=b}}return y}(e.buckets,n==null?void 0:n.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const m=this.buckets[u];if(m instanceof d.a5){if(this.hasSymbolBuckets=!0,!l)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const m=this.buckets[u];if(m instanceof d.a5&&m.hasRTLText){this.hasRTLText=!0,ia().lazyLoad();break}}this.queryPadding=0;for(const u in this.buckets){const m=this.buckets[u];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(u).queryRadius(m))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new d.a4}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const l in this.buckets){const u=this.buckets[l];u.uploadPending()&&u.upload(e)}const n=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new gi(e,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new gi(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,n,l,u,m,y,b,T,E,z){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:u,cameraQueryGeometry:m,scale:y,tileSize:this.tileSize,pixelPosMatrix:z,transform:T,params:b,queryPadding:this.queryPadding*E},e,n,l):{}}querySourceFeatures(e,n){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const u=l.loadVTLayers(),m=n&&n.sourceLayer?n.sourceLayer:"",y=u._geojsonTileLayer||u[m];if(!y)return;const b=d.a6(n&&n.filter),{z:T,x:E,y:z}=this.tileID.canonical,D={z:T,x:E,y:z};for(let I=0;I<y.length;I++){const F=y.feature(I);if(b.needGeometry){const X=d.a7(F,!0);if(!b.filter(new d.C(this.tileID.overscaledZ),X,this.tileID.canonical))continue}else if(!b.filter(new d.C(this.tileID.overscaledZ),F))continue;const N=l.getId(F,m),Y=new d.a8(F,T,E,z,N);Y.tile=D,e.push(Y)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const n=this.expirationTime;if(e.cacheControl){const l=d.a9(e.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const l=Date.now();let u=!1;if(this.expirationTime>l)u=!1;else if(n)if(this.expirationTime<n)u=!0;else{const m=this.expirationTime-n;m?this.expirationTime=l+Math.max(m,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,n){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const l=this.latestFeatureIndex.loadVTLayers();for(const u in this.buckets){if(!n.style.hasLayer(u))continue;const m=this.buckets[u],y=m.layers[0].sourceLayer||"_geojsonTileLayer",b=l[y],T=e[y];if(!b||!T||Object.keys(T).length===0)continue;m.update(T,b,this.imageAtlas&&this.imageAtlas.patternPositions||{});const E=n&&n.style&&n.style.getLayer(u);E&&(this.queryPadding=Math.max(this.queryPadding,E.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<at.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=at.now()+e}setDependencies(e,n){const l={};for(const u of n)l[u]=!0;this.dependencies[e]=l}hasDependency(e,n){for(const l of e){const u=this.dependencies[l];if(u){for(const m of n)if(u[m])return!0}}return!1}}class is{constructor(e,n){this.max=e,this.onRemove=n,this.reset()}reset(){for(const e in this.data)for(const n of this.data[e])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(e,n,l){const u=e.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);const m={value:n,timeout:void 0};if(l!==void 0&&(m.timeout=setTimeout(()=>{this.remove(e,m)},l)),this.data[u].push(m),this.order.push(u),this.order.length>this.max){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const n=this.data[e].shift();return n.timeout&&clearTimeout(n.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),n.value}getByKey(e){const n=this.data[e];return n?n[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,n){if(!this.has(e))return this;const l=e.wrapped().key,u=n===void 0?0:this.data[l].indexOf(n),m=this.data[l][u];return this.data[l].splice(u,1),m.timeout&&clearTimeout(m.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(m.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(e){const n=[];for(const l in this.data)for(const u of this.data[l])e(u.value)||n.push(u);for(const l of n)this.remove(l.value.tileID,l)}}class Il{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,n,l){const u=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},d.e(this.stateChanges[e][u],l),this.deletedStates[e]===null){this.deletedStates[e]={};for(const m in this.state[e])m!==u&&(this.deletedStates[e][m]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][u]===null){this.deletedStates[e][u]={};for(const m in this.state[e][u])l[m]||(this.deletedStates[e][u][m]=null)}else for(const m in l)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][m]===null&&delete this.deletedStates[e][u][m]}removeFeatureState(e,n,l){if(this.deletedStates[e]===null)return;const u=String(n);if(this.deletedStates[e]=this.deletedStates[e]||{},l&&n!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][l]=null);else if(n!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(l in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][l]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}getState(e,n){const l=String(n),u=d.e({},(this.state[e]||{})[l],(this.stateChanges[e]||{})[l]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const m=this.deletedStates[e][n];if(m===null)return{};for(const y in m)delete u[y]}return u}initializeTileState(e,n){e.setFeatureState(this.state,n)}coalesceChanges(e,n){const l={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const m={};for(const y in this.stateChanges[u])this.state[u][y]||(this.state[u][y]={}),d.e(this.state[u][y],this.stateChanges[u][y]),m[y]=this.state[u][y];l[u]=m}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const m={};if(this.deletedStates[u]===null)for(const y in this.state[u])m[y]={},this.state[u][y]={};else for(const y in this.deletedStates[u]){if(this.deletedStates[u][y]===null)this.state[u][y]={};else for(const b of Object.keys(this.deletedStates[u][y]))delete this.state[u][y][b];m[y]=this.state[u][y]}l[u]=l[u]||{},d.e(l[u],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const u in e)e[u].setFeatureState(l,n)}}function jo(f,e,n){const l=e.intersectsFrustum(f);if(!n)return l;const u=e.intersectsPlane(n);return l===0||u===0?0:l===2&&u===2?2:1}function ns(f,e,n,l,u){let m=f;const y=Math.atan(e/n),b=Math.hypot(e,n);return m=f+d.aa(l/b/Math.max(.5,Math.cos(d.ac(u/2)))),m+=1*d.aa(Math.cos(y))/2,m+=d.ad(f-m,-0,0),m}function dn(f,e){const n=(e.roundZoom?Math.round:Math.floor)(f.zoom+d.aa(f.tileSize/e.tileSize));return Math.max(0,n)}function ye(f,e){const n=f.getCameraFrustum(),l=f.getClippingPlane(),u=f.screenPointToMercatorCoordinate(f.getCameraPoint()),m=d.$.fromLngLat(f.center,f.elevation);u.z=m.z+Math.cos(f.pitchInRadians)*f.cameraToCenterDistance/f.worldSize;const y=f.getCoveringTilesDetailsProvider(),b=y.allowVariableZoom(f,e),T=dn(f,e),E=e.minzoom||0,z=e.maxzoom!==void 0?e.maxzoom:f.maxZoom,D=Math.min(Math.max(0,T),z),I=Math.pow(2,D),F=[I*u.x,I*u.y,0],N=[I*m.x,I*m.y,0],Y=Math.hypot(m.x-u.x,m.y-u.y),X=Math.abs(m.z-u.z),K=Math.hypot(Y,X),J=oe=>({zoom:0,x:0,y:0,wrap:oe,fullyVisible:!1}),re=[],ae=[];if(f.renderWorldCopies&&y.allowWorldCopies())for(let oe=1;oe<=3;oe++)re.push(J(-oe)),re.push(J(oe));for(re.push(J(0));re.length>0;){const oe=re.pop(),he=oe.x,ce=oe.y;let we=oe.fullyVisible;const Me={x:he,y:ce,z:oe.zoom},ke=y.getTileAABB(Me,oe.wrap,f.elevation,e);if(!we){const We=jo(n,ke,l);if(We===0)continue;we=We===2}const Le=y.distanceToTile2d(u.x,u.y,Me,ke);let Ie=T;b&&(Ie=(e.calculateTileZoom||ns)(f.zoom+d.aa(f.tileSize/e.tileSize),Le,X,K,f.fov)),Ie=(e.roundZoom?Math.round:Math.floor)(Ie),Ie=Math.max(0,Ie);const et=Math.min(Ie,z);if(oe.wrap=y.getWrap(m,Me,oe.wrap),oe.zoom>=et){if(oe.zoom<E)continue;const We=D-oe.zoom,Ge=F[0]-.5-(he<<We),ft=F[1]-.5-(ce<<We),_t=e.reparseOverscaled?Math.max(oe.zoom,Ie):oe.zoom;ae.push({tileID:new d.Y(oe.zoom===z?_t:oe.zoom,oe.wrap,oe.zoom,he,ce),distanceSq:d.ab([N[0]-.5-he,N[1]-.5-ce]),tileDistanceToCamera:Math.sqrt(Ge*Ge+ft*ft)})}else for(let We=0;We<4;We++)re.push({zoom:oe.zoom+1,x:(he<<1)+We%2,y:(ce<<1)+(We>>1),wrap:oe.wrap,fullyVisible:we})}return ae.sort((oe,he)=>oe.distanceSq-he.distanceSq).map(oe=>oe.tileID)}class P extends d.E{constructor(e,n,l){super(),this.id=e,this.dispatcher=l,this.on("data",u=>this._dataHandler(u)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((u,m,y,b)=>{const T=new(or(m.type))(u,m,y,b);if(T.id!==u)throw new Error(`Expected Source id to be ${u} instead of ${T.id}`);return T})(e,n,l,this),this._tiles={},this._cache=new is(0,u=>this._unloadTile(u)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Il,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const n=this._tiles[e];if(n.state!=="loaded"&&n.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,n,l){return d._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,n,l)}catch(u){e.state="errored",u.status!==404?this._source.fire(new d.k(u,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new d.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const n in this._tiles){const l=this._tiles[n];l.upload(e),l.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(V).map(e=>e.key)}getRenderableIds(e){const n=[];for(const l in this._tiles)this._isIdRenderable(l,e)&&n.push(this._tiles[l]);return e?n.sort((l,u)=>{const m=l.tileID,y=u.tileID,b=new d.P(m.canonical.x,m.canonical.y)._rotate(-this.transform.bearingInRadians),T=new d.P(y.canonical.x,y.canonical.y)._rotate(-this.transform.bearingInRadians);return m.overscaledZ-y.overscaledZ||T.y-b.y||T.x-b.x}).map(l=>l.tileID.key):n.map(l=>l.tileID).sort(V).map(l=>l.key)}hasRenderableParent(e){const n=this.findLoadedParent(e,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(e,n){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(n||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)(e||this._tiles[n].state!=="errored")&&this._reloadTile(n,"reloading")}}_reloadTile(e,n){return d._(this,void 0,void 0,function*(){const l=this._tiles[e];l&&(l.state!=="loading"&&(l.state=n),yield this._loadTile(l,e,n))})}_tileLoaded(e,n,l){e.timeAdded=at.now(),l==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new d.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const n=this.getRenderableIds();for(let u=0;u<n.length;u++){const m=n[u];if(e.neighboringTiles&&e.neighboringTiles[m]){const y=this.getTileByID(m);l(e,y),l(y,e)}}function l(u,m){u.needsHillshadePrepare=!0,u.needsTerrainPrepare=!0;let y=m.tileID.canonical.x-u.tileID.canonical.x;const b=m.tileID.canonical.y-u.tileID.canonical.y,T=Math.pow(2,u.tileID.canonical.z),E=m.tileID.key;y===0&&b===0||Math.abs(b)>1||(Math.abs(y)>1&&(Math.abs(y+T)===1?y+=T:Math.abs(y-T)===1&&(y-=T)),m.dem&&u.dem&&(u.dem.backfillBorder(m.dem,y,b),u.neighboringTiles&&u.neighboringTiles[E]&&(u.neighboringTiles[E].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,n,l,u){for(const m in this._tiles){let y=this._tiles[m];if(u[m]||!y.hasData()||y.tileID.overscaledZ<=n||y.tileID.overscaledZ>l)continue;let b=y.tileID;for(;y&&y.tileID.overscaledZ>n+1;){const E=y.tileID.scaledTo(y.tileID.overscaledZ-1);y=this._tiles[E.key],y&&y.hasData()&&(b=E)}let T=b;for(;T.overscaledZ>n;)if(T=T.scaledTo(T.overscaledZ-1),e[T.key]||e[T.canonical.key]){u[b.key]=b;break}}}findLoadedParent(e,n){if(e.key in this._loadedParentTiles){const l=this._loadedParentTiles[e.key];return l&&l.tileID.overscaledZ>=n?l:null}for(let l=e.overscaledZ-1;l>=n;l--){const u=e.scaledTo(l),m=this._getLoadedTile(u);if(m)return m}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const n=this._tiles[e.key];return n&&n.hasData()?n:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const n=Math.ceil(e.width/this._source.tileSize)+1,l=Math.ceil(e.height/this._source.tileSize)+1,u=Math.floor(n*l*(this._maxTileCacheZoomLevels===null?d.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),m=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,u):u;this._cache.setMaxSize(m)}handleWrapJump(e){const n=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,n){const l={};for(const u in this._tiles){const m=this._tiles[u];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+n),l[m.tileID.key]=m}this._tiles=l;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(u,this._tiles[u])}}_updateCoveredAndRetainedTiles(e,n,l,u,m,y){const b={},T={},E=Object.keys(e),z=at.now();for(const D of E){const I=e[D],F=this._tiles[D];if(!F||F.fadeEndTime!==0&&F.fadeEndTime<=z)continue;const N=this.findLoadedParent(I,n),Y=this.findLoadedSibling(I),X=N||Y||null;X&&(this._addTile(X.tileID),b[X.tileID.key]=X.tileID),T[D]=I}this._retainLoadedChildren(T,u,l,e);for(const D in b)e[D]||(this._coveredTiles[D]=!0,e[D]=b[D]);if(y){const D={},I={};for(const F of m)this._tiles[F.key].hasData()?D[F.key]=F:I[F.key]=F;for(const F in I){const N=I[F].children(this._source.maxzoom);this._tiles[N[0].key]&&this._tiles[N[1].key]&&this._tiles[N[2].key]&&this._tiles[N[3].key]&&(D[N[0].key]=e[N[0].key]=N[0],D[N[1].key]=e[N[1].key]=N[1],D[N[2].key]=e[N[2].key]=N[2],D[N[3].key]=e[N[3].key]=N[3],delete I[F])}for(const F in I){const N=I[F],Y=this.findLoadedParent(N,this._source.minzoom),X=this.findLoadedSibling(N),K=Y||X||null;if(K){D[K.tileID.key]=e[K.tileID.key]=K.tileID;for(const J in D)D[J].isChildOf(K.tileID)&&delete D[J]}}for(const F in this._tiles)D[F]||(this._coveredTiles[F]=!0)}}update(e,n){if(!this._sourceLoaded||this._paused)return;let l;this.transform=e,this.terrain=n,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?l=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(z=>new d.Y(z.canonical.z,z.wrap,z.canonical.z,z.canonical.x,z.canonical.y)):(l=ye(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:n,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(l=l.filter(z=>this._source.hasTile(z)))):l=[];const u=dn(e,this._source),m=Math.max(u-P.maxOverzooming,this._source.minzoom),y=Math.max(u+P.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const z={};for(const D of l)if(D.canonical.z>this._source.minzoom){const I=D.scaledTo(D.canonical.z-1);z[I.key]=I;const F=D.scaledTo(Math.max(this._source.minzoom,Math.min(D.canonical.z,5)));z[F.key]=F}l=l.concat(Object.values(z))}const b=l.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,b&&this.fire(new d.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const T=this._updateRetainedTiles(l,u);$(this._source.type)&&this._updateCoveredAndRetainedTiles(T,m,y,u,l,n);for(const z in T)this._tiles[z].clearFadeHold();const E=d.ae(this._tiles,T);for(const z of E){const D=this._tiles[z];D.hasSymbolBuckets&&!D.holdingForFade()?D.setHoldDuration(this.map._fadeDuration):D.hasSymbolBuckets&&!D.symbolFadeFinished()||this._removeTile(z)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,n){var l;const u={},m={},y=Math.max(n-P.maxOverzooming,this._source.minzoom),b=Math.max(n+P.maxUnderzooming,this._source.minzoom),T={};for(const E of e){const z=this._addTile(E);u[E.key]=E,z.hasData()||n<this._source.maxzoom&&(T[E.key]=E)}this._retainLoadedChildren(T,n,b,u);for(const E of e){let z=this._tiles[E.key];if(z.hasData())continue;if(n+1>this._source.maxzoom){const I=E.children(this._source.maxzoom)[0],F=this.getTile(I);if(F&&F.hasData()){u[I.key]=I;continue}}else{const I=E.children(this._source.maxzoom);if(u[I[0].key]&&u[I[1].key]&&u[I[2].key]&&u[I[3].key])continue}let D=z.wasRequested();for(let I=E.overscaledZ-1;I>=y;--I){const F=E.scaledTo(I);if(m[F.key])break;if(m[F.key]=!0,z=this.getTile(F),!z&&D&&(z=this._addTile(F)),z){const N=z.hasData();if((N||!(!((l=this.map)===null||l===void 0)&&l.cancelPendingTileRequestsWhileZooming)||D)&&(u[F.key]=F),D=z.wasRequested(),N)break}}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const n=[];let l,u=this._tiles[e].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){l=this._loadedParentTiles[u.key];break}n.push(u.key);const m=u.scaledTo(u.overscaledZ-1);if(l=this._getLoadedTile(m),l)break;u=m}for(const m of n)this._loadedParentTiles[m]=l}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const n=this._tiles[e].tileID,l=this._getLoadedTile(n);this._loadedSiblingTiles[n.key]=l}}_addTile(e){let n=this._tiles[e.key];if(n)return n;n=this._cache.getAndRemove(e),n&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));const l=n;return n||(n=new Ts(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(n,e.key,n.state)),n.uses++,this._tiles[e.key]=n,l||this._source.fire(new d.l("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n}_setTileReloadTimer(e,n){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const l=n.getExpiryTimeout();l&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},l))}_removeTile(e){const n=this._tiles[e];n&&(n.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),n.uses>0||(n.hasData()&&n.state!=="reloading"?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}_dataHandler(e){const n=e.sourceDataType;e.dataType==="source"&&n==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&n==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,n,l){const u=[],m=this.transform;if(!m)return u;const y=l?m.getCameraQueryGeometry(e):e,b=e.map(N=>m.screenPointToMercatorCoordinate(N,this.terrain)),T=y.map(N=>m.screenPointToMercatorCoordinate(N,this.terrain)),E=this.getIds();let z=1/0,D=1/0,I=-1/0,F=-1/0;for(const N of T)z=Math.min(z,N.x),D=Math.min(D,N.y),I=Math.max(I,N.x),F=Math.max(F,N.y);for(let N=0;N<E.length;N++){const Y=this._tiles[E[N]];if(Y.holdingForFade())continue;const X=Y.tileID,K=Math.pow(2,m.zoom-Y.tileID.overscaledZ),J=n*Y.queryPadding*d.Z/Y.tileSize/K,re=[X.getTilePoint(new d.$(z,D)),X.getTilePoint(new d.$(I,F))];if(re[0].x-J<d.Z&&re[0].y-J<d.Z&&re[1].x+J>=0&&re[1].y+J>=0){const ae=b.map(he=>X.getTilePoint(he)),oe=T.map(he=>X.getTilePoint(he));u.push({tile:Y,tileID:X,queryGeometry:ae,cameraQueryGeometry:oe,scale:K})}}return u}getVisibleCoordinates(e){const n=this.getRenderableIds(e).map(l=>this._tiles[l].tileID);return this.transform&&this.transform.populateCache(n),n}hasTransition(){if(this._source.hasTransition())return!0;if($(this._source.type)){const e=at.now();for(const n in this._tiles)if(this._tiles[n].fadeEndTime>=e)return!0}return!1}setFeatureState(e,n,l){this._state.updateState(e=e||"_geojsonTileLayer",n,l)}removeFeatureState(e,n,l){this._state.removeFeatureState(e=e||"_geojsonTileLayer",n,l)}getFeatureState(e,n){return this._state.getState(e=e||"_geojsonTileLayer",n)}setDependencies(e,n,l){const u=this._tiles[e];u&&u.setDependencies(n,l)}reloadTilesForDependencies(e,n){for(const l in this._tiles)this._tiles[l].hasDependency(e,n)&&this._reloadTile(l,"reloading");this._cache.filter(l=>!l.hasDependency(e,n))}}function V(f,e){const n=Math.abs(2*f.wrap)-+(f.wrap<0),l=Math.abs(2*e.wrap)-+(e.wrap<0);return f.overscaledZ-e.overscaledZ||l-n||e.canonical.y-f.canonical.y||e.canonical.x-f.canonical.x}function $(f){return f==="raster"||f==="image"||f==="video"}P.maxOverzooming=10,P.maxUnderzooming=3;class W{constructor(e,n){this.reset(e,n)}reset(e,n){this.points=e||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(n||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=d.ad(e,0,1);let n=1,l=this._distances[n];const u=e*this.paddedLength+this.padding;for(;l<u&&n<this._distances.length;)l=this._distances[++n];const m=n-1,y=this._distances[m],b=l-y,T=b>0?(u-y)/b:0;return this.points[m].mult(1-T).add(this.points[n].mult(T))}}function le(f,e){let n=!0;return f==="always"||f!=="never"&&e!=="never"||(n=!1),n}class pe{constructor(e,n,l){const u=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(e/l),this.yCellCount=Math.ceil(n/l);for(let y=0;y<this.xCellCount*this.yCellCount;y++)u.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=n,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,n,l,u,m){this._forEachCell(n,l,u,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(n),this.bboxes.push(l),this.bboxes.push(u),this.bboxes.push(m)}insertCircle(e,n,l,u){this._forEachCell(n-u,l-u,n+u,l+u,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(n),this.circles.push(l),this.circles.push(u)}_insertBoxCell(e,n,l,u,m,y){this.boxCells[m].push(y)}_insertCircleCell(e,n,l,u,m,y){this.circleCells[m].push(y)}_query(e,n,l,u,m,y,b){if(l<0||e>this.width||u<0||n>this.height)return[];const T=[];if(e<=0&&n<=0&&this.width<=l&&this.height<=u){if(m)return[{key:null,x1:e,y1:n,x2:l,y2:u}];for(let E=0;E<this.boxKeys.length;E++)T.push({key:this.boxKeys[E],x1:this.bboxes[4*E],y1:this.bboxes[4*E+1],x2:this.bboxes[4*E+2],y2:this.bboxes[4*E+3]});for(let E=0;E<this.circleKeys.length;E++){const z=this.circles[3*E],D=this.circles[3*E+1],I=this.circles[3*E+2];T.push({key:this.circleKeys[E],x1:z-I,y1:D-I,x2:z+I,y2:D+I})}}else this._forEachCell(e,n,l,u,this._queryCell,T,{hitTest:m,overlapMode:y,seenUids:{box:{},circle:{}}},b);return T}query(e,n,l,u){return this._query(e,n,l,u,!1,null)}hitTest(e,n,l,u,m,y){return this._query(e,n,l,u,!0,m,y).length>0}hitTestCircle(e,n,l,u,m){const y=e-l,b=e+l,T=n-l,E=n+l;if(b<0||y>this.width||E<0||T>this.height)return!1;const z=[];return this._forEachCell(y,T,b,E,this._queryCellCircle,z,{hitTest:!0,overlapMode:u,circle:{x:e,y:n,radius:l},seenUids:{box:{},circle:{}}},m),z.length>0}_queryCell(e,n,l,u,m,y,b,T){const{seenUids:E,hitTest:z,overlapMode:D}=b,I=this.boxCells[m];if(I!==null){const N=this.bboxes;for(const Y of I)if(!E.box[Y]){E.box[Y]=!0;const X=4*Y,K=this.boxKeys[Y];if(e<=N[X+2]&&n<=N[X+3]&&l>=N[X+0]&&u>=N[X+1]&&(!T||T(K))&&(!z||!le(D,K.overlapMode))&&(y.push({key:K,x1:N[X],y1:N[X+1],x2:N[X+2],y2:N[X+3]}),z))return!0}}const F=this.circleCells[m];if(F!==null){const N=this.circles;for(const Y of F)if(!E.circle[Y]){E.circle[Y]=!0;const X=3*Y,K=this.circleKeys[Y];if(this._circleAndRectCollide(N[X],N[X+1],N[X+2],e,n,l,u)&&(!T||T(K))&&(!z||!le(D,K.overlapMode))){const J=N[X],re=N[X+1],ae=N[X+2];if(y.push({key:K,x1:J-ae,y1:re-ae,x2:J+ae,y2:re+ae}),z)return!0}}}return!1}_queryCellCircle(e,n,l,u,m,y,b,T){const{circle:E,seenUids:z,overlapMode:D}=b,I=this.boxCells[m];if(I!==null){const N=this.bboxes;for(const Y of I)if(!z.box[Y]){z.box[Y]=!0;const X=4*Y,K=this.boxKeys[Y];if(this._circleAndRectCollide(E.x,E.y,E.radius,N[X+0],N[X+1],N[X+2],N[X+3])&&(!T||T(K))&&!le(D,K.overlapMode))return y.push(!0),!0}}const F=this.circleCells[m];if(F!==null){const N=this.circles;for(const Y of F)if(!z.circle[Y]){z.circle[Y]=!0;const X=3*Y,K=this.circleKeys[Y];if(this._circlesCollide(N[X],N[X+1],N[X+2],E.x,E.y,E.radius)&&(!T||T(K))&&!le(D,K.overlapMode))return y.push(!0),!0}}}_forEachCell(e,n,l,u,m,y,b,T){const E=this._convertToXCellCoord(e),z=this._convertToYCellCoord(n),D=this._convertToXCellCoord(l),I=this._convertToYCellCoord(u);for(let F=E;F<=D;F++)for(let N=z;N<=I;N++)if(m.call(this,e,n,l,u,this.xCellCount*N+F,y,b,T))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,n,l,u,m,y){const b=u-e,T=m-n,E=l+y;return E*E>b*b+T*T}_circleAndRectCollide(e,n,l,u,m,y,b){const T=(y-u)/2,E=Math.abs(e-(u+T));if(E>T+l)return!1;const z=(b-m)/2,D=Math.abs(n-(m+z));if(D>z+l)return!1;if(E<=T||D<=z)return!0;const I=E-T,F=D-z;return I*I+F*F<=l*l}}function Se(f,e,n){const l=d.K();if(!f){const{vecSouth:D,vecEast:I}=Re(e),F=Ne();F[0]=I[0],F[1]=I[1],F[2]=D[0],F[3]=D[1],u=F,(z=(y=(m=F)[0])*(E=m[3])-(T=m[2])*(b=m[1]))&&(u[0]=E*(z=1/z),u[1]=-b*z,u[2]=-T*z,u[3]=y*z),l[0]=F[0],l[1]=F[1],l[4]=F[2],l[5]=F[3]}var u,m,y,b,T,E,z;return d.M(l,l,[1/n,1/n,1]),l}function de(f,e,n,l){if(f){const u=d.K();if(!e){const{vecSouth:m,vecEast:y}=Re(n);u[0]=y[0],u[1]=y[1],u[4]=m[0],u[5]=m[1]}return d.M(u,u,[l,l,1]),u}return n.pixelsToClipSpaceMatrix}function Re(f){const e=Math.cos(f.rollInRadians),n=Math.sin(f.rollInRadians),l=Math.cos(f.pitchInRadians),u=Math.cos(f.bearingInRadians),m=Math.sin(f.bearingInRadians),y=d.aj();y[0]=-u*l*n-m*e,y[1]=-m*l*n+u*e;const b=d.ak(y);b<1e-9?d.al(y):d.am(y,y,1/b);const T=d.aj();T[0]=u*l*e-m*n,T[1]=m*l*e+u*n;const E=d.ak(T);return E<1e-9?d.al(T):d.am(T,T,1/E),{vecEast:T,vecSouth:y}}function ze(f,e,n,l){let u;l?(u=[f,e,l(f,e),1],d.ao(u,u,n)):(u=[f,e,0,1],In(u,u,n));const m=u[3];return{point:new d.P(u[0]/m,u[1]/m),signedDistanceFromCamera:m,isOccluded:!1}}function ve(f,e){return .5+f/e*.5}function Ve(f,e){return f.x>=-e[0]&&f.x<=e[0]&&f.y>=-e[1]&&f.y<=e[1]}function xe(f,e,n,l,u,m,y,b,T,E,z,D,I){const F=n?f.textSizeData:f.iconSizeData,N=d.af(F,e.transform.zoom),Y=[256/e.width*2+1,256/e.height*2+1],X=n?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;X.clear();const K=f.lineVertexArray,J=n?f.text.placedSymbolArray:f.icon.placedSymbolArray,re=e.transform.width/e.transform.height;let ae=!1;for(let oe=0;oe<J.length;oe++){const he=J.get(oe);if(he.hidden||he.writingMode===d.ag.vertical&&!ae){nn(he.numGlyphs,X);continue}ae=!1;const ce=new d.P(he.anchorX,he.anchorY),we={getElevation:I,pitchedLabelPlaneMatrix:l,lineVertexArray:K,pitchWithMap:m,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:ce,unwrappedTileID:T,width:E,height:z,translation:D},Me=Zt(he.anchorX,he.anchorY,we);if(!Ve(Me.point,Y)){nn(he.numGlyphs,X);continue}const ke=ve(e.transform.cameraToCenterDistance,Me.signedDistanceFromCamera),Le=d.ah(F,N,he),Ie=m?Le*e.transform.getPitchedTextCorrection(he.anchorX,he.anchorY,T)/ke:Le*ke,et=kt({projectionContext:we,pitchedLabelPlaneMatrixInverse:u,symbol:he,fontSize:Ie,flip:!1,keepUpright:y,glyphOffsetArray:f.glyphOffsetArray,dynamicLayoutVertexArray:X,aspectRatio:re,rotateToLine:b});ae=et.useVertical,(et.notEnoughRoom||ae||et.needsFlipping&&kt({projectionContext:we,pitchedLabelPlaneMatrixInverse:u,symbol:he,fontSize:Ie,flip:!0,keepUpright:y,glyphOffsetArray:f.glyphOffsetArray,dynamicLayoutVertexArray:X,aspectRatio:re,rotateToLine:b}).notEnoughRoom)&&nn(he.numGlyphs,X)}n?f.text.dynamicLayoutVertexBuffer.updateData(X):f.icon.dynamicLayoutVertexBuffer.updateData(X)}function tt(f,e,n,l,u,m,y,b){const T=m.glyphStartIndex+m.numGlyphs,E=m.lineStartIndex,z=m.lineStartIndex+m.lineLength,D=e.getoffsetX(m.glyphStartIndex),I=e.getoffsetX(T-1),F=ct(f*D,n,l,u,m.segment,E,z,b,y);if(!F)return null;const N=ct(f*I,n,l,u,m.segment,E,z,b,y);return N?b.projectionCache.anyProjectionOccluded?null:{first:F,last:N}:null}function pt(f,e,n,l){return f===d.ag.horizontal&&Math.abs(n.y-e.y)>Math.abs(n.x-e.x)*l?{useVertical:!0}:(f===d.ag.vertical?e.y<n.y:e.x>n.x)?{needsFlipping:!0}:null}function kt(f){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:n,symbol:l,fontSize:u,flip:m,keepUpright:y,glyphOffsetArray:b,dynamicLayoutVertexArray:T,aspectRatio:E,rotateToLine:z}=f,D=u/24,I=l.lineOffsetX*D,F=l.lineOffsetY*D;let N;if(l.numGlyphs>1){const Y=l.glyphStartIndex+l.numGlyphs,X=l.lineStartIndex,K=l.lineStartIndex+l.lineLength,J=tt(D,b,I,F,m,l,z,e);if(!J)return{notEnoughRoom:!0};const re=lt(J.first.point.x,J.first.point.y,e,n),ae=lt(J.last.point.x,J.last.point.y,e,n);if(y&&!m){const oe=pt(l.writingMode,re,ae,E);if(oe)return oe}N=[J.first];for(let oe=l.glyphStartIndex+1;oe<Y-1;oe++)N.push(ct(D*b.getoffsetX(oe),I,F,m,l.segment,X,K,e,z));N.push(J.last)}else{if(y&&!m){const X=ht(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,K=l.lineStartIndex+l.segment+1,J=new d.P(e.lineVertexArray.getx(K),e.lineVertexArray.gety(K)),re=ht(J.x,J.y,e),ae=re.signedDistanceFromCamera>0?re.point:At(e.tileAnchorPoint,J,X,1,e),oe=lt(X.x,X.y,e,n),he=lt(ae.x,ae.y,e,n),ce=pt(l.writingMode,oe,he,E);if(ce)return ce}const Y=ct(D*b.getoffsetX(l.glyphStartIndex),I,F,m,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,e,z);if(!Y||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};N=[Y]}for(const Y of N)d.an(T,Y.point,Y.angle);return{}}function At(f,e,n,l,u){const m=f.add(f.sub(e)._unit()),y=ht(m.x,m.y,u).point,b=n.sub(y);return n.add(b._mult(l/b.mag()))}function je(f,e,n){const l=e.projectionCache;if(l.projections[f])return l.projections[f];const u=new d.P(e.lineVertexArray.getx(f),e.lineVertexArray.gety(f)),m=ht(u.x,u.y,e);if(m.signedDistanceFromCamera>0)return l.projections[f]=m.point,l.anyProjectionOccluded=l.anyProjectionOccluded||m.isOccluded,m.point;const y=f-n.direction;return At(n.distanceFromAnchor===0?e.tileAnchorPoint:new d.P(e.lineVertexArray.getx(y),e.lineVertexArray.gety(y)),u,n.previousVertex,n.absOffsetX-n.distanceFromAnchor+1,e)}function ht(f,e,n){const l=f+n.translation[0],u=e+n.translation[1];let m;return n.pitchWithMap?(m=ze(l,u,n.pitchedLabelPlaneMatrix,n.getElevation),m.isOccluded=!1):(m=n.transform.projectTileCoordinates(l,u,n.unwrappedTileID,n.getElevation),m.point.x=(.5*m.point.x+.5)*n.width,m.point.y=(.5*-m.point.y+.5)*n.height),m}function lt(f,e,n,l){if(n.pitchWithMap){const u=[f,e,0,1];return d.ao(u,u,l),n.transform.projectTileCoordinates(u[0]/u[3],u[1]/u[3],n.unwrappedTileID,n.getElevation).point}return{x:f/n.width*2-1,y:e/n.height*2-1}}function Zt(f,e,n){return n.transform.projectTileCoordinates(f,e,n.unwrappedTileID,n.getElevation)}function bt(f,e,n){return f._unit()._perp()._mult(e*n)}function Et(f,e,n,l,u,m,y,b,T){if(b.projectionCache.offsets[f])return b.projectionCache.offsets[f];const E=n.add(e);if(f+T.direction<l||f+T.direction>=u)return b.projectionCache.offsets[f]=E,E;const z=je(f+T.direction,b,T),D=bt(z.sub(n),y,T.direction),I=n.add(D),F=z.add(D);return b.projectionCache.offsets[f]=d.ap(m,E,I,F)||E,b.projectionCache.offsets[f]}function ct(f,e,n,l,u,m,y,b,T){const E=l?f-e:f+e;let z=E>0?1:-1,D=0;l&&(z*=-1,D=Math.PI),z<0&&(D+=Math.PI);let I,F=z>0?m+u:m+u+1;b.projectionCache.cachedAnchorPoint?I=b.projectionCache.cachedAnchorPoint:(I=ht(b.tileAnchorPoint.x,b.tileAnchorPoint.y,b).point,b.projectionCache.cachedAnchorPoint=I);let N,Y,X=I,K=I,J=0,re=0;const ae=Math.abs(E),oe=[];let he;for(;J+re<=ae;){if(F+=z,F<m||F>=y)return null;J+=re,K=X,Y=N;const Me={absOffsetX:ae,direction:z,distanceFromAnchor:J,previousVertex:K};if(X=je(F,b,Me),n===0)oe.push(K),he=X.sub(K);else{let ke;const Le=X.sub(K);ke=Le.mag()===0?bt(je(F+z,b,Me).sub(X),n,z):bt(Le,n,z),Y||(Y=K.add(ke)),N=Et(F,ke,X,m,y,Y,n,b,Me),oe.push(Y),he=N.sub(Y)}re=he.mag()}const ce=he._mult((ae-J)/re)._add(Y||K),we=D+Math.atan2(X.y-K.y,X.x-K.x);return oe.push(ce),{point:ce,angle:T?we:0,path:oe}}const na=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function nn(f,e){for(let n=0;n<f;n++){const l=e.length;e.resize(l+4),e.float32.set(na,3*l)}}function In(f,e,n){const l=e[0],u=e[1];return f[0]=n[0]*l+n[4]*u+n[12],f[1]=n[1]*l+n[5]*u+n[13],f[3]=n[3]*l+n[7]*u+n[15],f}const zi=100;class Rl{constructor(e,n=new pe(e.width+200,e.height+200,25),l=new pe(e.width+200,e.height+200,25)){this.transform=e,this.grid=n,this.ignoredGrid=l,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+zi,this.screenBottomBoundary=e.height+zi,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,n,l,u,m,y,b,T,E,z,D,I){const F=this.projectAndGetPerspectiveRatio(e.anchorPointX+T[0],e.anchorPointY+T[1],m,z,I),N=l*F.perspectiveRatio;let Y;if(y||b)Y=this._projectCollisionBox(e,N,u,m,y,b,T,F,z,D,I);else{const he=F.x+(D?D.x*N:0),ce=F.y+(D?D.y*N:0);Y={allPointsOccluded:!1,box:[he+e.x1*N,ce+e.y1*N,he+e.x2*N,ce+e.y2*N]}}const[X,K,J,re]=Y.box,ae=y?Y.allPointsOccluded:F.isOccluded;let oe=ae;return oe||(oe=F.perspectiveRatio<this.perspectiveRatioCutoff),oe||(oe=!this.isInsideGrid(X,K,J,re)),oe||n!=="always"&&this.grid.hitTest(X,K,J,re,n,E)?{box:[X,K,J,re],placeable:!1,offscreen:!1,occluded:ae}:{box:[X,K,J,re],placeable:!0,offscreen:this.isOffscreen(X,K,J,re),occluded:ae}}placeCollisionCircles(e,n,l,u,m,y,b,T,E,z,D,I,F,N){const Y=[],X=new d.P(n.anchorX,n.anchorY),K=this.getPerspectiveRatio(X.x,X.y,y,N),J=(E?m*this.transform.getPitchedTextCorrection(n.anchorX,n.anchorY,y)/K:m*K)/d.au,re={getElevation:N,pitchedLabelPlaneMatrix:b,lineVertexArray:l,pitchWithMap:E,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:X,unwrappedTileID:y,width:this.transform.width,height:this.transform.height,translation:F},ae=tt(J,u,n.lineOffsetX*J,n.lineOffsetY*J,!1,n,!1,re);let oe=!1,he=!1,ce=!0;if(ae){const we=.5*D*K+I,Me=new d.P(-100,-100),ke=new d.P(this.screenRightBoundary,this.screenBottomBoundary),Le=new W,Ie=ae.first,et=ae.last;let We=[];for(let _t=Ie.path.length-1;_t>=1;_t--)We.push(Ie.path[_t]);for(let _t=1;_t<et.path.length;_t++)We.push(et.path[_t]);const Ge=2.5*we;if(E){const _t=this.projectPathToScreenSpace(We,re);We=_t.some(oi=>oi.signedDistanceFromCamera<=0)?[]:_t.map(oi=>oi.point)}let ft=[];if(We.length>0){const _t=We[0].clone(),oi=We[0].clone();for(let Si=1;Si<We.length;Si++)_t.x=Math.min(_t.x,We[Si].x),_t.y=Math.min(_t.y,We[Si].y),oi.x=Math.max(oi.x,We[Si].x),oi.y=Math.max(oi.y,We[Si].y);ft=_t.x>=Me.x&&oi.x<=ke.x&&_t.y>=Me.y&&oi.y<=ke.y?[We]:oi.x<Me.x||_t.x>ke.x||oi.y<Me.y||_t.y>ke.y?[]:d.aq([We],Me.x,Me.y,ke.x,ke.y)}for(const _t of ft){Le.reset(_t,.25*we);let oi=0;oi=Le.length<=.5*we?1:Math.ceil(Le.paddedLength/Ge)+1;for(let Si=0;Si<oi;Si++){const fi=Si/Math.max(oi-1,1),_i=Le.lerp(fi),xi=_i.x+zi,ii=_i.y+zi;Y.push(xi,ii,we,0);const pi=xi-we,kn=ii-we,Mi=xi+we,ki=ii+we;if(ce=ce&&this.isOffscreen(pi,kn,Mi,ki),he=he||this.isInsideGrid(pi,kn,Mi,ki),e!=="always"&&this.grid.hitTestCircle(xi,ii,we,e,z)&&(oe=!0,!T))return{circles:[],offscreen:!1,collisionDetected:oe}}}}return{circles:!T&&oe||!he||K<this.perspectiveRatioCutoff?[]:Y,offscreen:ce,collisionDetected:oe}}projectPathToScreenSpace(e,n){const l=function(u,m){const y=d.K();return d.ai(y,m.pitchedLabelPlaneMatrix),u.map(b=>{const T=ze(b.x,b.y,y,m.getElevation),E=m.transform.projectTileCoordinates(T.point.x,T.point.y,m.unwrappedTileID,m.getElevation);return E.point.x=(.5*E.point.x+.5)*m.width,E.point.y=(.5*-E.point.y+.5)*m.height,E})}(e,n);return function(u){let m=0,y=0,b=0,T=0;for(let E=0;E<u.length;E++)u[E].isOccluded?(b=E+1,T=0):(T++,T>y&&(y=T,m=b));return u.slice(m,m+y)}(l)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const n=[];let l=1/0,u=1/0,m=-1/0,y=-1/0;for(const z of e){const D=new d.P(z.x+zi,z.y+zi);l=Math.min(l,D.x),u=Math.min(u,D.y),m=Math.max(m,D.x),y=Math.max(y,D.y),n.push(D)}const b=this.grid.query(l,u,m,y).concat(this.ignoredGrid.query(l,u,m,y)),T={},E={};for(const z of b){const D=z.key;if(T[D.bucketInstanceId]===void 0&&(T[D.bucketInstanceId]={}),T[D.bucketInstanceId][D.featureIndex])continue;const I=[new d.P(z.x1,z.y1),new d.P(z.x2,z.y1),new d.P(z.x2,z.y2),new d.P(z.x1,z.y2)];d.ar(n,I)&&(T[D.bucketInstanceId][D.featureIndex]=!0,E[D.bucketInstanceId]===void 0&&(E[D.bucketInstanceId]=[]),E[D.bucketInstanceId].push(D.featureIndex))}return E}insertCollisionBox(e,n,l,u,m,y){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:u,featureIndex:m,collisionGroupID:y,overlapMode:n},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,n,l,u,m,y){const b=l?this.ignoredGrid:this.grid,T={bucketInstanceId:u,featureIndex:m,collisionGroupID:y,overlapMode:n};for(let E=0;E<e.length;E+=4)b.insertCircle(T,e[E],e[E+1],e[E+2])}projectAndGetPerspectiveRatio(e,n,l,u,m){if(m){let y;u?(y=[e,n,u(e,n),1],d.ao(y,y,m)):(y=[e,n,0,1],In(y,y,m));const b=y[3];return{x:(y[0]/b+1)/2*this.transform.width+zi,y:(-y[1]/b+1)/2*this.transform.height+zi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/b*.5,isOccluded:!1,signedDistanceFromCamera:b}}{const y=this.transform.projectTileCoordinates(e,n,l,u);return{x:(y.point.x+1)/2*this.transform.width+zi,y:(1-y.point.y)/2*this.transform.height+zi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/y.signedDistanceFromCamera*.5,isOccluded:y.isOccluded,signedDistanceFromCamera:y.signedDistanceFromCamera}}}getPerspectiveRatio(e,n,l,u){const m=this.transform.projectTileCoordinates(e,n,l,u);return .5+this.transform.cameraToCenterDistance/m.signedDistanceFromCamera*.5}isOffscreen(e,n,l,u){return l<zi||e>=this.screenRightBoundary||u<zi||n>this.screenBottomBoundary}isInsideGrid(e,n,l,u){return l>=0&&e<this.gridRightBoundary&&u>=0&&n<this.gridBottomBoundary}getViewportMatrix(){const e=d.as([]);return d.L(e,e,[-100,-100,0]),e}_projectCollisionBox(e,n,l,u,m,y,b,T,E,z,D){let I=1,F=0,N=0,Y=1;const X=e.anchorPointX+b[0],K=e.anchorPointY+b[1];if(y&&!m){const We=this.projectAndGetPerspectiveRatio(X+1,K,u,E,D),Ge=We.x-T.x,ft=Math.atan((We.y-T.y)/Ge)+(Ge<0?Math.PI:0),_t=Math.sin(ft),oi=Math.cos(ft);I=oi,F=_t,N=-_t,Y=oi}else if(!y&&m){const We=Re(this.transform);I=We.vecEast[0],F=We.vecEast[1],N=We.vecSouth[0],Y=We.vecSouth[1]}let J=T.x,re=T.y,ae=n;m&&(J=X,re=K,ae=Math.pow(2,-(this.transform.zoom-l.overscaledZ)),ae*=this.transform.getPitchedTextCorrection(X,K,u),z||(ae*=d.ad(.5+T.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),z&&(J+=I*z.x*ae+N*z.y*ae,re+=F*z.x*ae+Y*z.y*ae);const oe=e.x1*ae,he=e.x2*ae,ce=(oe+he)/2,we=e.y1*ae,Me=e.y2*ae,ke=(we+Me)/2,Le=[{offsetX:oe,offsetY:we},{offsetX:ce,offsetY:we},{offsetX:he,offsetY:we},{offsetX:he,offsetY:ke},{offsetX:he,offsetY:Me},{offsetX:ce,offsetY:Me},{offsetX:oe,offsetY:Me},{offsetX:oe,offsetY:ke}];let Ie=[];for(const{offsetX:We,offsetY:Ge}of Le)Ie.push(new d.P(J+I*We+N*Ge,re+F*We+Y*Ge));let et=!1;if(m){const We=Ie.map(Ge=>this.projectAndGetPerspectiveRatio(Ge.x,Ge.y,u,E,D));et=We.some(Ge=>!Ge.isOccluded),Ie=We.map(Ge=>new d.P(Ge.x,Ge.y))}else et=!0;return{box:d.at(Ie),allPointsOccluded:!et}}}class Nn{constructor(e,n,l,u){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?n:-n))):u&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class hi{constructor(e,n,l,u,m){this.text=new Nn(e?e.text:null,n,l,m),this.icon=new Nn(e?e.icon:null,n,u,m)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ss{constructor(e,n,l){this.text=e,this.icon=n,this.skipFade=l}}class Na{constructor(e,n,l,u,m){this.bucketInstanceId=e,this.featureIndex=n,this.sourceLayerIndex=l,this.bucketIndex=u,this.tileID=m}}class io{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const n=++this.maxGroupID;this.collisionGroups[e]={ID:n,predicate:l=>l.collisionGroupID===n}}return this.collisionGroups[e]}}function jr(f,e,n,l,u){const{horizontalAlign:m,verticalAlign:y}=d.aA(f);return new d.P(-(m-.5)*e+l[0]*u,-(y-.5)*n+l[1]*u)}class $i{constructor(e,n,l,u,m){this.transform=e.clone(),this.terrain=n,this.collisionIndex=new Rl(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new io(u),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=m,m&&(m.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const n=this.terrain;return n?(l,u)=>n.getElevation(e,l,u):null}getBucketParts(e,n,l,u){const m=l.getBucket(n),y=l.latestFeatureIndex;if(!m||!y||n.id!==m.layerIds[0])return;const b=l.collisionBoxArray,T=m.layers[0].layout,E=m.layers[0].paint,z=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),D=l.tileSize/d.Z,I=l.tileID.toUnwrapped(),F=T.get("text-rotation-alignment")==="map",N=d.av(l,1,this.transform.zoom),Y=d.aw(this.collisionIndex.transform,l,E.get("text-translate"),E.get("text-translate-anchor")),X=d.aw(this.collisionIndex.transform,l,E.get("icon-translate"),E.get("icon-translate-anchor")),K=Se(F,this.transform,N);this.retainedQueryData[m.bucketInstanceId]=new Na(m.bucketInstanceId,y,m.sourceLayerIndex,m.index,l.tileID);const J={bucket:m,layout:T,translationText:Y,translationIcon:X,unwrappedTileID:I,pitchedLabelPlaneMatrix:K,scale:z,textPixelRatio:D,holdingForFade:l.holdingForFade(),collisionBoxArray:b,partiallyEvaluatedTextSize:d.af(m.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(u)for(const re of m.sortKeyRanges){const{sortKey:ae,symbolInstanceStart:oe,symbolInstanceEnd:he}=re;e.push({sortKey:ae,symbolInstanceStart:oe,symbolInstanceEnd:he,parameters:J})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:J})}attemptAnchorPlacement(e,n,l,u,m,y,b,T,E,z,D,I,F,N,Y,X,K,J,re,ae){const oe=d.ax[e.textAnchor],he=[e.textOffset0,e.textOffset1],ce=jr(oe,l,u,he,m),we=this.collisionIndex.placeCollisionBox(n,I,T,E,z,b,y,X,D.predicate,re,ce,ae);if((!J||this.collisionIndex.placeCollisionBox(J,I,T,E,z,b,y,K,D.predicate,re,ce,ae).placeable)&&we.placeable){let Me;if(this.prevPlacement&&this.prevPlacement.variableOffsets[F.crossTileID]&&this.prevPlacement.placements[F.crossTileID]&&this.prevPlacement.placements[F.crossTileID].text&&(Me=this.prevPlacement.variableOffsets[F.crossTileID].anchor),F.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[F.crossTileID]={textOffset:he,width:l,height:u,anchor:oe,textBoxScale:m,prevAnchor:Me},this.markUsedJustification(N,oe,F,Y),N.allowVerticalPlacement&&(this.markUsedOrientation(N,Y,F),this.placedOrientations[F.crossTileID]=Y),{shift:ce,placedGlyphBoxes:we}}}placeLayerBucketPart(e,n,l){const{bucket:u,layout:m,translationText:y,translationIcon:b,unwrappedTileID:T,pitchedLabelPlaneMatrix:E,textPixelRatio:z,holdingForFade:D,collisionBoxArray:I,partiallyEvaluatedTextSize:F,collisionGroup:N}=e.parameters,Y=m.get("text-optional"),X=m.get("icon-optional"),K=d.ay(m,"text-overlap","text-allow-overlap"),J=K==="always",re=d.ay(m,"icon-overlap","icon-allow-overlap"),ae=re==="always",oe=m.get("text-rotation-alignment")==="map",he=m.get("text-pitch-alignment")==="map",ce=m.get("icon-text-fit")!=="none",we=m.get("symbol-z-order")==="viewport-y",Me=J&&(ae||!u.hasIconData()||X),ke=ae&&(J||!u.hasTextData()||Y);!u.collisionArrays&&I&&u.deserializeCollisionBoxes(I);const Le=this.retainedQueryData[u.bucketInstanceId].tileID,Ie=this._getTerrainElevationFunc(Le),et=this.transform.getFastPathSimpleProjectionMatrix(Le),We=(Ge,ft,_t)=>{var oi,Si;if(n[Ge.crossTileID])return;if(D)return void(this.placements[Ge.crossTileID]=new Ss(!1,!1,!1));let fi=!1,_i=!1,xi=!0,ii=null,pi={box:null,placeable:!1,offscreen:null,occluded:!1},kn={placeable:!1},Mi=null,ki=null,Zi=null,Dr=0,Pa=0,da=0;ft.textFeatureIndex?Dr=ft.textFeatureIndex:Ge.useRuntimeCollisionCircles&&(Dr=Ge.featureIndex),ft.verticalTextFeatureIndex&&(Pa=ft.verticalTextFeatureIndex);const Yr=ft.textBox;if(Yr){const Kr=bi=>{let mi=d.ag.horizontal;if(u.allowVerticalPlacement&&!bi&&this.prevPlacement){const Tn=this.prevPlacement.placedOrientations[Ge.crossTileID];Tn&&(this.placedOrientations[Ge.crossTileID]=Tn,mi=Tn,this.markUsedOrientation(u,mi,Ge))}return mi},Ia=(bi,mi)=>{if(u.allowVerticalPlacement&&Ge.numVerticalGlyphVertices>0&&ft.verticalTextBox){for(const Tn of u.writingModes)if(Tn===d.ag.vertical?(pi=mi(),kn=pi):pi=bi(),pi&&pi.placeable)break}else pi=bi()},fa=Ge.textAnchorOffsetStartIndex,Qr=Ge.textAnchorOffsetEndIndex;if(Qr===fa){const bi=(mi,Tn)=>{const Sn=this.collisionIndex.placeCollisionBox(mi,K,z,Le,T,he,oe,y,N.predicate,Ie,void 0,et);return Sn&&Sn.placeable&&(this.markUsedOrientation(u,Tn,Ge),this.placedOrientations[Ge.crossTileID]=Tn),Sn};Ia(()=>bi(Yr,d.ag.horizontal),()=>{const mi=ft.verticalTextBox;return u.allowVerticalPlacement&&Ge.numVerticalGlyphVertices>0&&mi?bi(mi,d.ag.vertical):{box:null,offscreen:null}}),Kr(pi&&pi.placeable)}else{let bi=d.ax[(Si=(oi=this.prevPlacement)===null||oi===void 0?void 0:oi.variableOffsets[Ge.crossTileID])===null||Si===void 0?void 0:Si.anchor];const mi=(Sn,wo,Nh)=>{const Ln=Sn.x2-Sn.x1,Bn=Sn.y2-Sn.y1,Yu=Ge.textBoxScale,qs=ce&&re==="never"?wo:null;let Ir=null,lu=K==="never"?1:2,Ku="never";bi&&lu++;for(let Hs=0;Hs<lu;Hs++){for(let ol=fa;ol<Qr;ol++){const Qu=u.textAnchorOffsets.get(ol);if(bi&&Qu.textAnchor!==bi)continue;const lc=this.attemptAnchorPlacement(Qu,Sn,Ln,Bn,Yu,oe,he,z,Le,T,N,Ku,Ge,u,Nh,y,b,qs,Ie);if(lc&&(Ir=lc.placedGlyphBoxes,Ir&&Ir.placeable))return fi=!0,ii=lc.shift,Ir}bi?bi=null:Ku=K}return l&&!Ir&&(Ir={box:this.collisionIndex.placeCollisionBox(Yr,"always",z,Le,T,he,oe,y,N.predicate,Ie,void 0,et).box,offscreen:!1,placeable:!1,occluded:!1}),Ir};Ia(()=>mi(Yr,ft.iconBox,d.ag.horizontal),()=>{const Sn=ft.verticalTextBox;return u.allowVerticalPlacement&&(!pi||!pi.placeable)&&Ge.numVerticalGlyphVertices>0&&Sn?mi(Sn,ft.verticalIconBox,d.ag.vertical):{box:null,occluded:!0,offscreen:null}}),pi&&(fi=pi.placeable,xi=pi.offscreen);const Tn=Kr(pi&&pi.placeable);if(!fi&&this.prevPlacement){const Sn=this.prevPlacement.variableOffsets[Ge.crossTileID];Sn&&(this.variableOffsets[Ge.crossTileID]=Sn,this.markUsedJustification(u,Sn.anchor,Ge,Tn))}}}if(Mi=pi,fi=Mi&&Mi.placeable,xi=Mi&&Mi.offscreen,Ge.useRuntimeCollisionCircles){const Kr=u.text.placedSymbolArray.get(Ge.centerJustifiedTextSymbolIndex),Ia=d.ah(u.textSizeData,F,Kr),fa=m.get("text-padding");ki=this.collisionIndex.placeCollisionCircles(K,Kr,u.lineVertexArray,u.glyphOffsetArray,Ia,T,E,l,he,N.predicate,Ge.collisionCircleDiameter,fa,y,Ie),ki.circles.length&&ki.collisionDetected&&!l&&d.w("Collisions detected, but collision boxes are not shown"),fi=J||ki.circles.length>0&&!ki.collisionDetected,xi=xi&&ki.offscreen}if(ft.iconFeatureIndex&&(da=ft.iconFeatureIndex),ft.iconBox){const Kr=Ia=>this.collisionIndex.placeCollisionBox(Ia,re,z,Le,T,he,oe,b,N.predicate,Ie,ce&&ii?ii:void 0,et);kn&&kn.placeable&&ft.verticalIconBox?(Zi=Kr(ft.verticalIconBox),_i=Zi.placeable):(Zi=Kr(ft.iconBox),_i=Zi.placeable),xi=xi&&Zi.offscreen}const Gs=Y||Ge.numHorizontalGlyphVertices===0&&Ge.numVerticalGlyphVertices===0,Da=X||Ge.numIconVertices===0;Gs||Da?Da?Gs||(_i=_i&&fi):fi=_i&&fi:_i=fi=_i&&fi;const Qa=_i&&Zi.placeable;if(fi&&Mi.placeable&&this.collisionIndex.insertCollisionBox(Mi.box,K,m.get("text-ignore-placement"),u.bucketInstanceId,kn&&kn.placeable&&Pa?Pa:Dr,N.ID),Qa&&this.collisionIndex.insertCollisionBox(Zi.box,re,m.get("icon-ignore-placement"),u.bucketInstanceId,da,N.ID),ki&&fi&&this.collisionIndex.insertCollisionCircles(ki.circles,K,m.get("text-ignore-placement"),u.bucketInstanceId,Dr,N.ID),l&&this.storeCollisionData(u.bucketInstanceId,_t,ft,Mi,Zi,ki),Ge.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(u.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ge.crossTileID]=new Ss((fi||Me)&&!(Mi!=null&&Mi.occluded),(_i||ke)&&!(Zi!=null&&Zi.occluded),xi||u.justReloaded),n[Ge.crossTileID]=!0};if(we){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ge=u.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let ft=Ge.length-1;ft>=0;--ft){const _t=Ge[ft];We(u.symbolInstances.get(_t),u.collisionArrays[_t],_t)}}else for(let Ge=e.symbolInstanceStart;Ge<e.symbolInstanceEnd;Ge++)We(u.symbolInstances.get(Ge),u.collisionArrays[Ge],Ge);u.justReloaded=!1}storeCollisionData(e,n,l,u,m,y){if(l.textBox||l.iconBox){let b,T;this.collisionBoxArrays.has(e)?b=this.collisionBoxArrays.get(e):(b=new Map,this.collisionBoxArrays.set(e,b)),b.has(n)?T=b.get(n):(T={text:null,icon:null},b.set(n,T)),l.textBox&&(T.text=u.box),l.iconBox&&(T.icon=m.box)}if(y){let b=this.collisionCircleArrays[e];b===void 0&&(b=this.collisionCircleArrays[e]=[]);for(let T=0;T<y.circles.length;T+=4)b.push(y.circles[T+0]-zi),b.push(y.circles[T+1]-zi),b.push(y.circles[T+2]),b.push(y.collisionDetected?1:0)}}markUsedJustification(e,n,l,u){let m;m=u===d.ag.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[d.az(n)];const y=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];for(const b of y)b>=0&&(e.text.placedSymbolArray.get(b).crossTileID=m>=0&&b!==m?0:l.crossTileID)}markUsedOrientation(e,n,l){const u=n===d.ag.horizontal||n===d.ag.horizontalOnly?n:0,m=n===d.ag.vertical?n:0,y=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];for(const b of y)e.text.placedSymbolArray.get(b).placedOrientation=u;l.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=m)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const n=this.prevPlacement;let l=!1;this.prevZoomAdjustment=n?n.zoomAdjustment(this.transform.zoom):0;const u=n?n.symbolFadeChange(e):1,m=n?n.opacities:{},y=n?n.variableOffsets:{},b=n?n.placedOrientations:{};for(const T in this.placements){const E=this.placements[T],z=m[T];z?(this.opacities[T]=new hi(z,u,E.text,E.icon),l=l||E.text!==z.text.placed||E.icon!==z.icon.placed):(this.opacities[T]=new hi(null,u,E.text,E.icon,E.skipFade),l=l||E.text||E.icon)}for(const T in m){const E=m[T];if(!this.opacities[T]){const z=new hi(E,u,!1,!1);z.isHidden()||(this.opacities[T]=z,l=l||E.text.placed||E.icon.placed)}}for(const T in y)this.variableOffsets[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.variableOffsets[T]=y[T]);for(const T in b)this.placedOrientations[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.placedOrientations[T]=b[T]);if(n&&n.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");l?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=n?n.lastPlacementChangeTime:e)}updateLayerOpacities(e,n){const l={};for(const u of n){const m=u.getBucket(e);m&&u.latestFeatureIndex&&e.id===m.layerIds[0]&&this.updateBucketOpacities(m,u.tileID,l,u.collisionBoxArray)}}updateBucketOpacities(e,n,l,u){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const m=e.layers[0],y=m.layout,b=new hi(null,0,!1,!1,!0),T=y.get("text-allow-overlap"),E=y.get("icon-allow-overlap"),z=m._unevaluatedLayout.hasValue("text-variable-anchor")||m._unevaluatedLayout.hasValue("text-variable-anchor-offset"),D=y.get("text-rotation-alignment")==="map",I=y.get("text-pitch-alignment")==="map",F=y.get("icon-text-fit")!=="none",N=new hi(null,0,T&&(E||!e.hasIconData()||y.get("icon-optional")),E&&(T||!e.hasTextData()||y.get("text-optional")),!0);!e.collisionArrays&&u&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(u);const Y=(K,J,re)=>{for(let ae=0;ae<J/4;ae++)K.opacityVertexArray.emplaceBack(re);K.hasVisibleVertices=K.hasVisibleVertices||re!==rs},X=this.collisionBoxArrays.get(e.bucketInstanceId);for(let K=0;K<e.symbolInstances.length;K++){const J=e.symbolInstances.get(K),{numHorizontalGlyphVertices:re,numVerticalGlyphVertices:ae,crossTileID:oe}=J;let he=this.opacities[oe];l[oe]?he=b:he||(he=N,this.opacities[oe]=he),l[oe]=!0;const ce=J.numIconVertices>0,we=this.placedOrientations[J.crossTileID],Me=we===d.ag.vertical,ke=we===d.ag.horizontal||we===d.ag.horizontalOnly;if(re>0||ae>0){const Ie=Du(he.text);Y(e.text,re,Me?rs:Ie),Y(e.text,ae,ke?rs:Ie);const et=he.text.isHidden();[J.rightJustifiedTextSymbolIndex,J.centerJustifiedTextSymbolIndex,J.leftJustifiedTextSymbolIndex].forEach(ft=>{ft>=0&&(e.text.placedSymbolArray.get(ft).hidden=et||Me?1:0)}),J.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(J.verticalPlacedTextSymbolIndex).hidden=et||ke?1:0);const We=this.variableOffsets[J.crossTileID];We&&this.markUsedJustification(e,We.anchor,J,we);const Ge=this.placedOrientations[J.crossTileID];Ge&&(this.markUsedJustification(e,"left",J,Ge),this.markUsedOrientation(e,Ge,J))}if(ce){const Ie=Du(he.icon),et=!(F&&J.verticalPlacedIconSymbolIndex&&Me);J.placedIconSymbolIndex>=0&&(Y(e.icon,J.numIconVertices,et?Ie:rs),e.icon.placedSymbolArray.get(J.placedIconSymbolIndex).hidden=he.icon.isHidden()),J.verticalPlacedIconSymbolIndex>=0&&(Y(e.icon,J.numVerticalIconVertices,et?rs:Ie),e.icon.placedSymbolArray.get(J.verticalPlacedIconSymbolIndex).hidden=he.icon.isHidden())}const Le=X&&X.has(K)?X.get(K):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const Ie=e.collisionArrays[K];if(Ie){let et=new d.P(0,0);if(Ie.textBox||Ie.verticalTextBox){let We=!0;if(z){const Ge=this.variableOffsets[oe];Ge?(et=jr(Ge.anchor,Ge.width,Ge.height,Ge.textOffset,Ge.textBoxScale),D&&et._rotate(I?-this.transform.bearingInRadians:this.transform.bearingInRadians)):We=!1}if(Ie.textBox||Ie.verticalTextBox){let Ge;Ie.textBox&&(Ge=Me),Ie.verticalTextBox&&(Ge=ke),Mc(e.textCollisionBox.collisionVertexArray,he.text.placed,!We||Ge,Le.text,et.x,et.y)}}if(Ie.iconBox||Ie.verticalIconBox){const We=!!(!ke&&Ie.verticalIconBox);let Ge;Ie.iconBox&&(Ge=We),Ie.verticalIconBox&&(Ge=!We),Mc(e.iconCollisionBox.collisionVertexArray,he.icon.placed,Ge,Le.icon,F?et.x:0,F?et.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,n){const l=this.zoomAtLastRecencyCheck===n?1-this.zoomAdjustment(n):1;return this.zoomAtLastRecencyCheck=n,this.commitTime+this.fadeDuration*l>e}setStale(){this.stale=!0}}function Mc(f,e,n,l,u,m){l&&l.length!==0||(l=[0,0,0,0]);const y=l[0]-zi,b=l[1]-zi,T=l[2]-zi,E=l[3]-zi;f.emplaceBack(e?1:0,n?1:0,u||0,m||0,y,b),f.emplaceBack(e?1:0,n?1:0,u||0,m||0,T,b),f.emplaceBack(e?1:0,n?1:0,u||0,m||0,T,E),f.emplaceBack(e?1:0,n?1:0,u||0,m||0,y,E)}const Pu=Math.pow(2,25),Ms=Math.pow(2,24),xa=Math.pow(2,17),Ua=Math.pow(2,16),wd=Math.pow(2,9),Eh=Math.pow(2,8),Ch=Math.pow(2,1);function Du(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const e=f.placed?1:0,n=Math.floor(127*f.opacity);return n*Pu+e*Ms+n*xa+e*Ua+n*wd+e*Eh+n*Ch+e}const rs=0;class Fo{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,n,l,u,m){const y=this._bucketParts;for(;this._currentTileIndex<e.length;)if(n.getBucketParts(y,u,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,y.sort((b,T)=>b.sortKey-T.sortKey));this._currentPartIndex<y.length;)if(n.placeLayerBucketPart(y[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,m())return!0;return!1}}class ba{constructor(e,n,l,u,m,y,b,T){this.placement=new $i(e,n,y,b,T),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=u,this._showCollisionBoxes=m,this._done=!1}isDone(){return this._done}continuePlacement(e,n,l){const u=at.now(),m=()=>!this._forceFullPlacement&&at.now()-u>2;for(;this._currentPlacementIndex>=0;){const y=n[e[this._currentPlacementIndex]],b=this.placement.collisionIndex.transform.zoom;if(y.type==="symbol"&&(!y.minzoom||y.minzoom<=b)&&(!y.maxzoom||y.maxzoom>b)){if(this._inProgressLayer||(this._inProgressLayer=new Fo(y)),this._inProgressLayer.continuePlacement(l[y.source],this.placement,this._showCollisionBoxes,y,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Qn=512/d.Z/2;class Ec{constructor(e,n,l){this.tileID=e,this.bucketInstanceId=l,this._symbolsByKey={};const u=new Map;for(let m=0;m<n.length;m++){const y=n.get(m),b=y.key,T=u.get(b);T?T.push(y):u.set(b,[y])}for(const[m,y]of u){const b={positions:y.map(T=>({x:Math.floor(T.anchorX*Qn),y:Math.floor(T.anchorY*Qn)})),crossTileIDs:y.map(T=>T.crossTileID)};if(b.positions.length>128){const T=new d.aB(b.positions.length,16,Uint16Array);for(const{x:E,y:z}of b.positions)T.add(E,z);T.finish(),delete b.positions,b.index=T}this._symbolsByKey[m]=b}}getScaledCoordinates(e,n){const{x:l,y:u,z:m}=this.tileID.canonical,{x:y,y:b,z:T}=n.canonical,E=Qn/Math.pow(2,T-m),z=(b*d.Z+e.anchorY)*E,D=u*d.Z*Qn;return{x:Math.floor((y*d.Z+e.anchorX)*E-l*d.Z*Qn),y:Math.floor(z-D)}}findMatches(e,n,l){const u=this.tileID.canonical.z<n.canonical.z?1:Math.pow(2,this.tileID.canonical.z-n.canonical.z);for(let m=0;m<e.length;m++){const y=e.get(m);if(y.crossTileID)continue;const b=this._symbolsByKey[y.key];if(!b)continue;const T=this.getScaledCoordinates(y,n);if(b.index){const E=b.index.range(T.x-u,T.y-u,T.x+u,T.y+u).sort();for(const z of E){const D=b.crossTileIDs[z];if(!l[D]){l[D]=!0,y.crossTileID=D;break}}}else if(b.positions)for(let E=0;E<b.positions.length;E++){const z=b.positions[E],D=b.crossTileIDs[E];if(Math.abs(z.x-T.x)<=u&&Math.abs(z.y-T.y)<=u&&!l[D]){l[D]=!0,y.crossTileID=D;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class Iu{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class no{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const n=Math.round((e-this.lng)/360);if(n!==0)for(const l in this.indexes){const u=this.indexes[l],m={};for(const y in u){const b=u[y];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+n),m[b.tileID.key]=b}this.indexes[l]=m}this.lng=e}addBucket(e,n,l){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===n.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let m=0;m<n.symbolInstances.length;m++)n.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const u=this.usedCrossTileIDs[e.overscaledZ];for(const m in this.indexes){const y=this.indexes[m];if(Number(m)>e.overscaledZ)for(const b in y){const T=y[b];T.tileID.isChildOf(e)&&T.findMatches(n.symbolInstances,e,u)}else{const b=y[e.scaledTo(Number(m)).key];b&&b.findMatches(n.symbolInstances,e,u)}}for(let m=0;m<n.symbolInstances.length;m++){const y=n.symbolInstances.get(m);y.crossTileID||(y.crossTileID=l.generate(),u[y.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Ec(e,n.symbolInstances,n.bucketInstanceId),!0}removeBucketCrossTileIDs(e,n){for(const l of n.getCrossTileIDsLists())for(const u of l)delete this.usedCrossTileIDs[e][u]}removeStaleBuckets(e){let n=!1;for(const l in this.indexes){const u=this.indexes[l];for(const m in u)e[u[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,u[m]),delete u[m],n=!0)}return n}}class Cc{constructor(){this.layerIndexes={},this.crossTileIDs=new Iu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,n,l){let u=this.layerIndexes[e.id];u===void 0&&(u=this.layerIndexes[e.id]=new no);let m=!1;const y={};u.handleWrapJump(l);for(const b of n){const T=b.getBucket(e);T&&e.id===T.layerIds[0]&&(T.bucketInstanceId||(T.bucketInstanceId=++this.maxBucketInstanceId),u.addBucket(b.tileID,T,this.crossTileIDs)&&(m=!0),y[T.bucketInstanceId]=!0)}return u.removeStaleBuckets(y)&&(m=!0),m}pruneUnusedLayers(e){const n={};e.forEach(l=>{n[l]=!0});for(const l in this.layerIndexes)n[l]||delete this.layerIndexes[l]}}var Va="void main() {fragColor=vec4(1.0);}";const wa={prelude:Ft(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Ft("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Ft("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Ft(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Ft(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Ft(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Ft(Va,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Ft(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Ft(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Ft("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Ft("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Ft("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Ft(Va,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Ft(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Ft(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Ft(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Ft(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Ft(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Ft(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Ft(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));fragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ft(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Ft(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Ft(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Ft(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Ft(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Ft(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Ft(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Ft(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Ft(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Ft("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Ft("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Ft("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Ft("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Ft(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Ft("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Ft(f,e){const n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=e.match(/in ([\w]+) ([\w]+)/g),u=f.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),m=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=m?m.concat(u):u,b={};return{fragmentSource:f=f.replace(n,(T,E,z,D,I)=>(b[I]=!0,E==="define"?`
#ifndef HAS_UNIFORM_u_${I}
in ${z} ${D} ${I};
#else
uniform ${z} ${D} u_${I};
#endif
`:`
#ifdef HAS_UNIFORM_u_${I}
    ${z} ${D} ${I} = u_${I};
#endif
`)),vertexSource:e=e.replace(n,(T,E,z,D,I)=>{const F=D==="float"?"vec2":"vec4",N=I.match(/color/)?"color":F;return b[I]?E==="define"?`
#ifndef HAS_UNIFORM_u_${I}
uniform lowp float u_${I}_t;
in ${z} ${F} a_${I};
out ${z} ${D} ${I};
#else
uniform ${z} ${D} u_${I};
#endif
`:N==="vec4"?`
#ifndef HAS_UNIFORM_u_${I}
    ${I} = a_${I};
#else
    ${z} ${D} ${I} = u_${I};
#endif
`:`
#ifndef HAS_UNIFORM_u_${I}
    ${I} = unpack_mix_${N}(a_${I}, u_${I}_t);
#else
    ${z} ${D} ${I} = u_${I};
#endif
`:E==="define"?`
#ifndef HAS_UNIFORM_u_${I}
uniform lowp float u_${I}_t;
in ${z} ${F} a_${I};
#else
uniform ${z} ${D} u_${I};
#endif
`:N==="vec4"?`
#ifndef HAS_UNIFORM_u_${I}
    ${z} ${D} ${I} = a_${I};
#else
    ${z} ${D} ${I} = u_${I};
#endif
`:`
#ifndef HAS_UNIFORM_u_${I}
    ${z} ${D} ${I} = unpack_mix_${N}(a_${I}, u_${I}_t);
#else
    ${z} ${D} ${I} = u_${I};
#endif
`}),staticAttributes:l,staticUniforms:y}}class mr{constructor(e,n,l){this.vertexBuffer=e,this.indexBuffer=n,this.segments=l}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Fr=d.aC([{name:"a_pos",type:"Int16",components:2}]);const Xt="#define PROJECTION_MERCATOR",as="mercator";class Ac{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return as}get shaderDefine(){return Xt}get shaderPreludeCode(){return wa.projectionMercator}get vertexShaderPreludeCode(){return wa.projectionMercator.vertexSource}get subdivisionGranularity(){return d.aD.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,n,l,u,m){if(this._cachedMesh)return this._cachedMesh;const y=new d.aE;y.emplaceBack(0,0),y.emplaceBack(d.Z,0),y.emplaceBack(0,d.Z),y.emplaceBack(d.Z,d.Z);const b=e.createVertexBuffer(y,Fr.members),T=d.aF.simpleSegment(0,0,4,2),E=new d.aG;E.emplaceBack(1,0,2),E.emplaceBack(1,2,3);const z=e.createIndexBuffer(E);return this._cachedMesh=new mr(b,z,T),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}function Nr(f,e){const n=d.ad(e.lat,-85.051129,d.aI);return new d.P(d.U(e.lng)*f,d.S(n)*f)}function rn(f,e){return new d.$(e.x/f,e.y/f).toLngLat()}function Un(f){return f.cameraToCenterDistance*Math.min(.85*Math.tan(d.ac(90-f.pitch)),Math.tan(d.ac(89.25-f.pitch)))}function Ni(f,e){const n=f.canonical,l=e/d.aH(n.z),u=n.x+Math.pow(2,n.z)*f.wrap,m=d.as(new Float64Array(16));return d.L(m,m,[u*l,n.y*l,0]),d.M(m,m,[l/d.Z,l/d.Z,1]),m}function zc(f,e,n,l,u){const m=d.$.fromLngLat(f,e),y=u*d.aJ(1,f.lat),b=y*Math.cos(d.ac(n)),T=Math.sqrt(y*y-b*b),E=T*Math.sin(d.ac(-l)),z=T*Math.cos(d.ac(-l));return new d.$(m.x+E,m.y+z,m.z+b)}class bn{constructor(e=0,n=0,l=0,u=0){if(isNaN(e)||e<0||isNaN(n)||n<0||isNaN(l)||l<0||isNaN(u)||u<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=n,this.left=l,this.right=u}interpolate(e,n,l){return n.top!=null&&e.top!=null&&(this.top=d.B.number(e.top,n.top,l)),n.bottom!=null&&e.bottom!=null&&(this.bottom=d.B.number(e.bottom,n.bottom,l)),n.left!=null&&e.left!=null&&(this.left=d.B.number(e.left,n.left,l)),n.right!=null&&e.right!=null&&(this.right=d.B.number(e.right,n.right,l)),this}getCenter(e,n){const l=d.ad((this.left+e-this.right)/2,0,e),u=d.ad((this.top+n-this.bottom)/2,0,n);return new d.P(l,u)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new bn(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function gr(f,e){if(!f.renderWorldCopies||f.lngRange)return;const n=e.lng-f.center.lng;e.lng+=n>180?-360:n<-180?360:0}function Mr(f){return Math.max(0,Math.floor(f))}class ro{constructor(e,n,l,u,m,y){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=y===void 0||!!y,this._minZoom=n||0,this._maxZoom=l||22,this._minPitch=u??0,this._maxPitch=m??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new d.Q(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Mr(this._zoom),this._scale=d.aH(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new bn,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,n,l){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=Mr(this._zoom),this._scale=d.aH(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new bn(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!l&&e.autoCalculateNearFarZ,n&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new d.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const n=d.aK(e,-180,180)*Math.PI/180;var l,u,m,y,b,T,E,z,D;this._bearingInRadians!==n&&(this._unmodified=!1,this._bearingInRadians=n,this._calcMatrices(),this._rotationMatrix=Ne(),l=this._rotationMatrix,m=-this._bearingInRadians,y=(u=this._rotationMatrix)[0],b=u[1],T=u[2],E=u[3],z=Math.sin(m),D=Math.cos(m),l[0]=y*D+T*z,l[1]=b*D+E*z,l[2]=y*-z+T*D,l[3]=b*-z+E*D)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const n=d.ad(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==n&&(this._unmodified=!1,this._pitchInRadians=n,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const n=e/180*Math.PI;this._rollInRadians!==n&&(this._unmodified=!1,this._rollInRadians=n,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return d.aL(this._fovInRadians)}setFov(e){e=d.ad(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=d.ac(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const n=this.getConstrained(this._center,e).zoom;this._zoom!==n&&(this._unmodified=!1,this._zoom=n,this._tileZoom=Math.max(0,Math.floor(n)),this._scale=d.aH(n),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,n){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=n,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,n,l){this._unmodified=!1,this._edgeInsets.interpolate(e,n,l),this._constrain(),this._calcMatrices()}resize(e,n,l=!0){this._width=e,this._height=n,l&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Fi([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,d.aI])}getConstrained(e,n){return this._callbacks.getConstrained(e,n)}getCameraQueryGeometry(e,n){if(n.length===1)return[n[0],e];{let l=e.x,u=e.y,m=e.x,y=e.y;for(const b of n)l=Math.min(l,b.x),u=Math.min(u,b.y),m=Math.max(m,b.x),y=Math.max(y,b.y);return[new d.P(l,u),new d.P(m,u),new d.P(m,y),new d.P(l,y),new d.P(l,u)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:n,zoom:l}=this.getConstrained(this.center,this.zoom);this.setCenter(n),this.setZoom(l),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=d.as(new Float64Array(16));d.M(e,e,[this._width/2,-this._height/2,1]),d.L(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=d.as(new Float64Array(16)),d.M(e,e,[1,-1,1]),d.L(e,e,[-1,-1,0]),d.M(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,n,l,u){const m=l!==void 0?l:this.bearing,y=u=u!==void 0?u:this.pitch,b=d.$.fromLngLat(e,n),T=-Math.cos(d.ac(y)),E=Math.sin(d.ac(y)),z=E*Math.sin(d.ac(m)),D=-E*Math.cos(d.ac(m));let I=this.elevation;const F=n-I;let N;T*F>=0||Math.abs(T)<.1?(N=1e4,I=n+N*T):N=-F/T;let Y,X,K=d.aM(1,b.y),J=0;do{if(J+=1,J>10)break;X=N/K,Y=new d.$(b.x+z*X,b.y+D*X),K=1/Y.meterInMercatorCoordinateUnits()}while(Math.abs(N-X*K)>1e-12);return{center:Y.toLngLat(),elevation:I,zoom:d.aa(this.height/2/Math.tan(this.fovInRadians/2)/X/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const n=d.aJ(1,this.center.lat)*this.worldSize,l=this.cameraToCenterDistance/n,u=d.$.fromLngLat(this.center,this.elevation),m=zc(this.center,this.elevation,this.pitch,this.bearing,l);this._elevation=e;const y=this.calculateCenterFromCameraLngLatAlt(m.toLngLat(),d.aM(m.z,u.y),this.bearing,this.pitch);this._elevation=y.elevation,this._center=y.center,this.setZoom(y.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new d.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=d.aJ(1,this.center.lat)*this.worldSize;return zc(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const n=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/n,e.canonical.y/n,1/n/d.Z,1/n/d.Z]}}class Ur{constructor(e,n){this.min=e,this.max=n,this.center=d.aN([],d.aO([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],l=d.aP(this.min),u=d.aP(this.max);for(let m=0;m<n.length;m++)l[m]=n[m]?this.min[m]:this.center[m],u[m]=n[m]?this.center[m]:this.max[m];return u[2]=this.max[2],new Ur(l,u)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let n=!0;for(let l=0;l<e.planes.length;l++){const u=this.intersectsPlane(e.planes[l]);if(u===0)return 0;u===1&&(n=!1)}return n?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let n=e[3],l=e[3];for(let u=0;u<3;u++)e[u]>0?(n+=e[u]*this.min[u],l+=e[u]*this.max[u]):(l+=e[u]*this.min[u],n+=e[u]*this.max[u]);return n>=0?2:l<0?0:1}}class an{distanceToTile2d(e,n,l,u){const m=u.distanceX([e,n]),y=u.distanceY([e,n]);return Math.hypot(m,y)}getWrap(e,n,l){return l}getTileAABB(e,n,l,u){var m,y;let b=l,T=l;if(u.terrain){const z=new d.Y(e.z,n,e.z,e.x,e.y),D=u.terrain.getMinMaxElevation(z);b=(m=D.minElevation)!==null&&m!==void 0?m:l,T=(y=D.maxElevation)!==null&&y!==void 0?y:l}const E=1<<e.z;return new Ur([n+e.x/E,e.y/E,b],[n+(e.x+1)/E,(e.y+1)/E,T])}allowVariableZoom(e,n){const l=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,u=d.ad(78.5-l/2,0,60);return!!n.terrain||e.pitch>u}allowWorldCopies(){return!0}recalculateCache(){}}class Vr{constructor(e,n,l){this.points=e,this.planes=n,this.aabb=l}static fromInvProjectionMatrix(e,n=1,l=0){const u=Math.pow(2,l),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(E=>{const z=1/(E=d.ao([],E,e))[3]/n*u;return d.aQ(E,E,[z,z,1/E[3],z])}),y=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(E=>{const z=d.aR([],m[E[0]],m[E[1]]),D=d.aR([],m[E[2]],m[E[1]]),I=d.aS([],d.aT([],z,D)),F=-d.aU(I,m[E[1]]);return I.concat(F)}),b=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],T=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const E of m)for(let z=0;z<3;z++)b[z]=Math.min(b[z],E[z]),T[z]=Math.max(T[z],E[z]);return new Vr(m,y,new Ur(b,T))}}class Wn{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,l){return this._helper.interpolatePadding(e,n,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n,l=!0){this._helper.resize(e,n,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,n){}constructor(e,n,l,u,m){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new ro({calcMatrices:()=>{this._calcMatrices()},getConstrained:(y,b)=>this.getConstrained(y,b)},e,n,l,u,m),this._coveringTilesDetailsProvider=new an}clone(){const e=new Wn;return e.apply(this),e}apply(e,n,l){this._helper.apply(e,n,l)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const n=[new d.aV(0,e)];if(this._helper._renderWorldCopies){const l=this.screenPointToMercatorCoordinate(new d.P(0,0)),u=this.screenPointToMercatorCoordinate(new d.P(this._helper._width,0)),m=this.screenPointToMercatorCoordinate(new d.P(this._helper._width,this._helper._height)),y=this.screenPointToMercatorCoordinate(new d.P(0,this._helper._height)),b=Math.floor(Math.min(l.x,u.x,m.x,y.x)),T=Math.floor(Math.max(l.x,u.x,m.x,y.x)),E=1;for(let z=b-E;z<=T+E;z++)z!==0&&n.push(new d.aV(z,e))}return n}getCameraFrustum(){return Vr.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const n=this.screenPointToLocation(this.centerPoint,e),l=e?e.getElevationForLngLatZoom(n,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(l)}setLocationAtPoint(e,n){const l=d.aJ(this.elevation,this.center.lat),u=this.screenPointToMercatorCoordinateAtZ(n,l),m=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,l),y=d.$.fromLngLat(e),b=new d.$(y.x-(u.x-m.x),y.y-(u.y-m.y));this.setCenter(b==null?void 0:b.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,n){return n?this.coordinatePoint(d.$.fromLngLat(e),n.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(d.$.fromLngLat(e))}screenPointToLocation(e,n){var l;return(l=this.screenPointToMercatorCoordinate(e,n))===null||l===void 0?void 0:l.toLngLat()}screenPointToMercatorCoordinate(e,n){if(n){const l=n.pointCoordinate(e);if(l!=null)return l}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,n){const l=n||0,u=[e.x,e.y,0,1],m=[e.x,e.y,1,1];d.ao(u,u,this._pixelMatrixInverse),d.ao(m,m,this._pixelMatrixInverse);const y=u[3],b=m[3],T=u[1]/y,E=m[1]/b,z=u[2]/y,D=m[2]/b,I=z===D?0:(l-z)/(D-z);return new d.$(d.B.number(u[0]/y,m[0]/b,I)/this.worldSize,d.B.number(T,E,I)/this.worldSize,l)}coordinatePoint(e,n=0,l=this._pixelMatrix){const u=[e.x*this.worldSize,e.y*this.worldSize,n,1];return d.ao(u,u,l),new d.P(u[0]/u[3],u[1]/u[3])}getBounds(){const e=Math.max(0,this._helper._height/2-Un(this));return new Fi().extend(this.screenPointToLocation(new d.P(0,e))).extend(this.screenPointToLocation(new d.P(this._helper._width,e))).extend(this.screenPointToLocation(new d.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new d.P(0,this._helper._height)))}isPointOnMapSurface(e,n){return n?n.pointCoordinate(e)!=null:e.y>this.height/2-Un(this)}calculatePosMatrix(e,n=!1,l){var u;const m=(u=e.key)!==null&&u!==void 0?u:d.aW(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),y=n?this._alignedPosMatrixCache:this._posMatrixCache;if(y.has(m)){const E=y.get(m);return l?E.f32:E.f64}const b=Ni(e,this.worldSize);d.N(b,n?this._alignedProjMatrix:this._viewProjMatrix,b);const T={f64:b,f32:new Float32Array(b)};return y.set(m,T),l?T.f32:T.f64}calculateFogMatrix(e){const n=e.key,l=this._fogMatrixCacheF32;if(l.has(n))return l.get(n);const u=Ni(e,this.worldSize);return d.N(u,this._fogMatrix,u),l.set(n,new Float32Array(u)),l.get(n)}getConstrained(e,n){n=d.ad(+n,this.minZoom,this.maxZoom);const l={center:new d.Q(e.lng,e.lat),zoom:n};let u=this._helper._lngRange;this._helper._renderWorldCopies||u!==null||(u=[-179.9999999999,180-1e-10]);const m=this.tileSize*d.aH(l.zoom);let y=0,b=m,T=0,E=m,z=0,D=0;const{x:I,y:F}=this.size;if(this._helper._latRange){const re=this._helper._latRange;y=d.S(re[1])*m,b=d.S(re[0])*m,b-y<F&&(z=F/(b-y))}u&&(T=d.aK(d.U(u[0])*m,0,m),E=d.aK(d.U(u[1])*m,0,m),E<T&&(E+=m),E-T<I&&(D=I/(E-T)));const{x:N,y:Y}=Nr(m,e);let X,K;const J=Math.max(D||0,z||0);if(J){const re=new d.P(D?(E+T)/2:N,z?(b+y)/2:Y);return l.center=rn(m,re).wrap(),l.zoom+=d.aa(J),l}if(this._helper._latRange){const re=F/2;Y-re<y&&(K=y+re),Y+re>b&&(K=b-re)}if(u){const re=(T+E)/2;let ae=N;this._helper._renderWorldCopies&&(ae=d.aK(N,re-m/2,re+m/2));const oe=I/2;ae-oe<T&&(X=T+oe),ae+oe>E&&(X=E-oe)}if(X!==void 0||K!==void 0){const re=new d.P(X??N,K??Y);l.center=rn(m,re).wrap()}return l}calculateCenterFromCameraLngLatAlt(e,n,l,u){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,l,u)}_calculateNearFarZIfNeeded(e,n,l){if(!this._helper.autoCalculateNearFarZ)return;const u=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),m=e-u*this._helper._pixelPerMeter/Math.cos(n),y=u<0?m:e,b=Math.PI/2+this.pitchInRadians,T=d.ac(this.fov)*(Math.abs(Math.cos(d.ac(this.roll)))*this.height+Math.abs(Math.sin(d.ac(this.roll)))*this.width)/this.height*(.5+l.y/this.height),E=Math.sin(T)*y/Math.sin(d.ad(Math.PI-b-T,.01,Math.PI-.01)),z=Un(this),D=Math.atan(z/this._helper.cameraToCenterDistance),I=d.ac(.75),F=D>I?2*D*(.5+l.y/(2*z)):I,N=Math.sin(F)*y/Math.sin(d.ad(Math.PI-b-F,.01,Math.PI-.01)),Y=Math.min(E,N);this._helper._farZ=1.01*(Math.cos(Math.PI/2-n)*Y+y),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,n=Nr(this.worldSize,this.center),l=n.x,u=n.y;this._helper._pixelPerMeter=d.aJ(1,this.center.lat)*this.worldSize;const m=d.ac(Math.min(this.pitch,89.25)),y=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(m));let b;this._calculateNearFarZIfNeeded(y,m,e),b=new Float64Array(16),d.aX(b,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),d.ai(this._invProjMatrix,b),b[8]=2*-e.x/this._helper._width,b[9]=2*e.y/this._helper._height,this._projectionMatrix=d.aY(b),d.M(b,b,[1,-1,1]),d.L(b,b,[0,0,-this._helper.cameraToCenterDistance]),d.aZ(b,b,-this.rollInRadians),d.a_(b,b,this.pitchInRadians),d.aZ(b,b,-this.bearingInRadians),d.L(b,b,[-l,-u,0]),this._mercatorMatrix=d.M([],b,[this.worldSize,this.worldSize,this.worldSize]),d.M(b,b,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=d.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,b),d.L(b,b,[0,0,-this.elevation]),this._viewProjMatrix=b,this._invViewProjMatrix=d.ai([],b);const T=[0,0,-1,1];d.ao(T,T,this._invViewProjMatrix),this._cameraPosition=[T[0]/T[3],T[1]/T[3],T[2]/T[3]],this._fogMatrix=new Float64Array(16),d.aX(this._fogMatrix,this.fovInRadians,this.width/this.height,y,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,d.M(this._fogMatrix,this._fogMatrix,[1,-1,1]),d.L(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),d.aZ(this._fogMatrix,this._fogMatrix,-this.rollInRadians),d.a_(this._fogMatrix,this._fogMatrix,this.pitchInRadians),d.aZ(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),d.L(this._fogMatrix,this._fogMatrix,[-l,-u,0]),d.M(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),d.L(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=d.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,b);const E=this._helper._width%2/2,z=this._helper._height%2/2,D=Math.cos(this.bearingInRadians),I=Math.sin(-this.bearingInRadians),F=l-Math.round(l)+D*E+I*z,N=u-Math.round(u)+D*z+I*E,Y=new Float64Array(b);if(d.L(Y,Y,[F>.5?F-1:F,N>.5?N-1:N,0]),this._alignedProjMatrix=Y,b=d.ai(new Float64Array(16),this._pixelMatrix),!b)throw new Error("failed to invert matrix");this._pixelMatrixInverse=b,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new d.P(0,0)),n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return d.ao(n,n,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=d.aJ(1,this.center.lat)*this.worldSize;return zc(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,n){const l=d.$.fromLngLat(e),u=[l.x*this.worldSize,l.y*this.worldSize,n,1];return d.ao(u,u,this._viewProjMatrix),u[2]/u[3]}getProjectionData(e){const{overscaledTileID:n,aligned:l,applyTerrainMatrix:u}=e,m=this._helper.getMercatorTileCoordinates(n),y=n?this.calculatePosMatrix(n,l,!0):null;let b;return b=n&&n.terrainRttPosMatrix32f&&u?n.terrainRttPosMatrix32f:y||d.a$(),{mainMatrix:b,tileMercatorCoords:m,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:b}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,n,l){return 1}transformLightDirection(e){return d.aP(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,n,l,u){const m=this.calculatePosMatrix(l);let y;u?(y=[e,n,u(e,n),1],d.ao(y,y,m)):(y=[e,n,0,1],In(y,y,m));const b=y[3];return{point:new d.P(y[0]/b,y[1]/b),signedDistanceFromCamera:b,isOccluded:!1}}populateCache(e){for(const n of e)this.calculatePosMatrix(n)}getMatrixForModel(e,n){const l=d.$.fromLngLat(e,n),u=l.meterInMercatorCoordinateUnits(),m=d.b0();return d.L(m,m,[l.x,l.y,l.z]),d.aZ(m,m,Math.PI),d.a_(m,m,Math.PI/2),d.M(m,m,[-u,u,u]),m}getProjectionDataForCustomLayer(e=!0){const n=new d.Y(0,0,0,0,0),l=this.getProjectionData({overscaledTileID:n,applyGlobeMatrix:e}),u=Ni(n,this.worldSize);d.N(u,this._viewProjMatrix,u),l.tileMercatorCoords=[0,0,1,1];const m=[d.Z,d.Z,this.worldSize/this._helper.pixelsPerMeter],y=d.b1();return d.M(y,u,m),l.fallbackMatrix=y,l.mainMatrix=y,l}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function No(){d.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Er(f){if(f.useSlerp)if(f.k<1){const e=d.b2(f.startEulerAngles.roll,f.startEulerAngles.pitch,f.startEulerAngles.bearing),n=d.b2(f.endEulerAngles.roll,f.endEulerAngles.pitch,f.endEulerAngles.bearing),l=new Float64Array(4);d.b3(l,e,n,f.k);const u=d.b4(l);f.tr.setRoll(u.roll),f.tr.setPitch(u.pitch),f.tr.setBearing(u.bearing)}else f.tr.setRoll(f.endEulerAngles.roll),f.tr.setPitch(f.endEulerAngles.pitch),f.tr.setBearing(f.endEulerAngles.bearing);else f.tr.setRoll(d.B.number(f.startEulerAngles.roll,f.endEulerAngles.roll,f.k)),f.tr.setPitch(d.B.number(f.startEulerAngles.pitch,f.endEulerAngles.pitch,f.k)),f.tr.setBearing(d.B.number(f.startEulerAngles.bearing,f.endEulerAngles.bearing,f.k))}function Pc(f,e,n,l,u){const m=u.padding,y=Nr(u.worldSize,n.getNorthWest()),b=Nr(u.worldSize,n.getNorthEast()),T=Nr(u.worldSize,n.getSouthEast()),E=Nr(u.worldSize,n.getSouthWest()),z=d.ac(-l),D=y.rotate(z),I=b.rotate(z),F=T.rotate(z),N=E.rotate(z),Y=new d.P(Math.max(D.x,I.x,N.x,F.x),Math.max(D.y,I.y,N.y,F.y)),X=new d.P(Math.min(D.x,I.x,N.x,F.x),Math.min(D.y,I.y,N.y,F.y)),K=Y.sub(X),J=(u.width-(m.left+m.right+e.left+e.right))/K.x,re=(u.height-(m.top+m.bottom+e.top+e.bottom))/K.y;if(re<0||J<0)return void No();const ae=Math.min(d.aa(u.scale*Math.min(J,re)),f.maxZoom),oe=d.P.convert(f.offset),he=new d.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(d.ac(l)),ce=oe.add(he).mult(u.scale/d.aH(ae));return{center:rn(u.worldSize,y.add(T).div(2).sub(ce)),zoom:ae,bearing:l}}class _r{get useGlobeControls(){return!1}handlePanInertia(e,n){return{easingOffset:e,easingCenter:n.center}}handleMapControlsRollPitchBearingZoom(e,n){e.bearingDelta&&n.setBearing(n.bearing+e.bearingDelta),e.pitchDelta&&n.setPitch(n.pitch+e.pitchDelta),e.rollDelta&&n.setRoll(n.roll+e.rollDelta),e.zoomDelta&&n.setZoom(n.zoom+e.zoomDelta)}handleMapControlsPan(e,n,l){e.around.distSqr(n.centerPoint)<.01||n.setLocationAtPoint(l,e.around)}cameraForBoxAndBearing(e,n,l,u,m){return Pc(e,n,l,u,m)}handleJumpToCenterZoom(e,n){e.zoom!==(n.zoom!==void 0?+n.zoom:e.zoom)&&e.setZoom(+n.zoom),n.center!==void 0&&e.setCenter(d.Q.convert(n.center))}handleEaseTo(e,n){const l=e.zoom,u=e.padding,m={roll:e.roll,pitch:e.pitch,bearing:e.bearing},y={roll:n.roll===void 0?e.roll:n.roll,pitch:n.pitch===void 0?e.pitch:n.pitch,bearing:n.bearing===void 0?e.bearing:n.bearing},b=n.zoom!==void 0,T=!e.isPaddingEqual(n.padding);let E=!1;const z=b?+n.zoom:e.zoom;let D=e.centerPoint.add(n.offsetAsPoint);const I=e.screenPointToLocation(D),{center:F,zoom:N}=e.getConstrained(d.Q.convert(n.center||I),z??l);gr(e,F);const Y=Nr(e.worldSize,I),X=Nr(e.worldSize,F).sub(Y),K=d.aH(N-l);return E=N!==l,{easeFunc:J=>{if(E&&e.setZoom(d.B.number(l,N,J)),d.b5(m,y)||Er({startEulerAngles:m,endEulerAngles:y,tr:e,k:J,useSlerp:m.roll!=y.roll}),T&&(e.interpolatePadding(u,n.padding,J),D=e.centerPoint.add(n.offsetAsPoint)),n.around)e.setLocationAtPoint(n.around,n.aroundPoint);else{const re=d.aH(e.zoom-l),ae=N>l?Math.min(2,K):Math.max(.5,K),oe=Math.pow(ae,1-J),he=rn(e.worldSize,Y.add(X.mult(J*oe)).mult(re));e.setLocationAtPoint(e.renderWorldCopies?he.wrap():he,D)}},isZooming:E,elevationCenter:F}}handleFlyTo(e,n){const l=n.zoom!==void 0,u=e.zoom,m=e.getConstrained(d.Q.convert(n.center||n.locationAtOffset),l?+n.zoom:u),y=m.center,b=m.zoom;gr(e,y);const T=Nr(e.worldSize,n.locationAtOffset),E=Nr(e.worldSize,y).sub(T),z=E.mag(),D=d.aH(b-u);let I;if(n.minZoom!==void 0){const F=Math.min(+n.minZoom,u,b),N=e.getConstrained(y,F).zoom;I=d.aH(N-u)}return{easeFunc:(F,N,Y,X)=>{e.setZoom(F===1?b:u+d.aa(N));const K=F===1?y:rn(e.worldSize,T.add(E.mult(Y)).mult(N));e.setLocationAtPoint(e.renderWorldCopies?K.wrap():K,X)},scaleOfZoom:D,targetCenter:y,scaleOfMinZoom:I,pixelPathLength:z}}}class Ti{constructor(e,n,l){this.blendFunction=e,this.blendColor=n,this.mask=l}}Ti.Replace=[1,0],Ti.disabled=new Ti(Ti.Replace,d.b6.transparent,[!1,!1,!1,!1]),Ti.unblended=new Ti(Ti.Replace,d.b6.transparent,[!0,!0,!0,!0]),Ti.alphaBlended=new Ti([1,771],d.b6.transparent,[!0,!0,!0,!0]);const Es=2305;class Vt{constructor(e,n,l){this.enable=e,this.mode=n,this.frontFace=l}}Vt.disabled=new Vt(!1,1029,Es),Vt.backCCW=new Vt(!0,1029,Es),Vt.frontCCW=new Vt(!0,1028,Es);class jt{constructor(e,n,l){this.func=e,this.mask=n,this.range=l}}jt.ReadOnly=!1,jt.ReadWrite=!0,jt.disabled=new jt(519,jt.ReadOnly,[0,1]);const ss=7680;class Yt{constructor(e,n,l,u,m,y){this.test=e,this.ref=n,this.mask=l,this.fail=u,this.depthFail=m,this.pass=y}}Yt.disabled=new Yt({func:519,mask:0},0,0,ss,ss,ss);const Cs=new WeakMap;function yr(f){var e;if(Cs.has(f))return Cs.get(f);{const n=(e=f.getParameter(f.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return Cs.set(f,n),n}}class Uo{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const n=e.context,l=n.gl;this._texFormat=l.RGBA,this._texType=l.UNSIGNED_BYTE;const u=new d.aE;u.emplaceBack(-1,-1),u.emplaceBack(2,-1),u.emplaceBack(-1,2);const m=new d.aG;m.emplaceBack(0,1,2),this._fullscreenTriangle=new mr(n.createVertexBuffer(u,Fr.members),n.createIndexBuffer(m),d.aF.simpleSegment(0,0,u.length,m.length)),this._resultBuffer=new Uint8Array(4),n.activeTexture.set(l.TEXTURE1);const y=l.createTexture();l.bindTexture(l.TEXTURE_2D,y),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texImage2D(l.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=n.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(y),yr(l)&&(this._pbo=l.createBuffer(),l.bindBuffer(l.PIXEL_PACK_BUFFER,this._pbo),l.bufferData(l.PIXEL_PACK_BUFFER,4,l.STREAM_READ),l.bindBuffer(l.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,n){const l=this._updateCount;return this._readbackQueue?l>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():l>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,n),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,n=e.gl;e.activeTexture.set(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,n){const l=this._cachedRenderContext.context,u=l.gl;if(this._bindFramebuffer(),l.viewport.set([0,0,this._texWidth,this._texHeight]),l.clear({color:d.b6.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(l,u.TRIANGLES,jt.disabled,Yt.disabled,Ti.unblended,Vt.disabled,((m,y)=>({u_input:m,u_output_expected:y}))(e,n),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&yr(u)){u.bindBuffer(u.PIXEL_PACK_BUFFER,this._pbo),u.readBuffer(u.COLOR_ATTACHMENT0),u.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),u.bindBuffer(u.PIXEL_PACK_BUFFER,null);const m=u.fenceSync(u.SYNC_GPU_COMMANDS_COMPLETE,0);u.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:m}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&yr(e)){const n=e.clientWaitSync(this._readbackQueue.sync,0,0);if(n===e.WAIT_FAILED)return d.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(n===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Uo._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let n=0;return n+=e[0]/256,n+=e[1]/65536,n+=e[2]/16777216,e[3]<127&&(n=-n),n/128}}const Jn=d.Z/128;function Ta(f,e){const n=f.granularity!==void 0?Math.max(f.granularity,1):1,l=n+(f.generateBorders?2:0),u=n+(f.extendToNorthPole||f.generateBorders?1:0)+(f.extendToSouthPole||f.generateBorders?1:0),m=l+1,y=u+1,b=f.generateBorders?-1:0,T=f.generateBorders||f.extendToNorthPole?-1:0,E=n+(f.generateBorders?1:0),z=n+(f.generateBorders||f.extendToSouthPole?1:0),D=m*y,I=l*u*6,F=m*y>65536;if(F&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const N=F||e==="32bit",Y=new Int16Array(2*D);let X=0;for(let re=T;re<=z;re++)for(let ae=b;ae<=E;ae++){let oe=ae/n*d.Z;ae===-1&&(oe=-64),ae===n+1&&(oe=d.Z+Jn);let he=re/n*d.Z;re===-1&&(he=f.extendToNorthPole?d.b8:-64),re===n+1&&(he=f.extendToSouthPole?d.b9:d.Z+Jn),Y[X++]=oe,Y[X++]=he}const K=N?new Uint32Array(I):new Uint16Array(I);let J=0;for(let re=0;re<u;re++)for(let ae=0;ae<l;ae++){const oe=ae+1+re*m,he=ae+(re+1)*m,ce=ae+1+(re+1)*m;K[J++]=ae+re*m,K[J++]=he,K[J++]=oe,K[J++]=oe,K[J++]=he,K[J++]=ce}return{vertices:Y.buffer.slice(0),indices:K.buffer.slice(0),uses32bitIndices:N}}const os=new d.aD({fill:new d.ba(128,2),line:new d.ba(512,0),tile:new d.ba(128,32),stencil:new d.ba(128,1),circle:3});class Za{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return wa.projectionGlobe}get vertexShaderPreludeCode(){return wa.projectionMercator.vertexSource}get subdivisionGranularity(){return os}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new Uo(e));const n=d.S(this._errorQueryLatitudeDegrees),l=2*Math.atan(Math.exp(Math.PI-n*Math.PI*2))-.5*Math.PI,u=this._errorMeasurement.updateErrorLoop(n,l),m=at.now();u!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=u,this._errorMeasurementLastChangeTime=m);const y=Math.min(Math.max((m-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=d.bb(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,d.bc(y))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,n,l,u,m){const y=(m==="stencil"?os.stencil:os.tile).getGranularityForZoomLevel(n.z);return this._getMesh(e,{granularity:y,generateBorders:l,extendToNorthPole:n.y===0&&u,extendToSouthPole:n.y===(1<<n.z)-1&&u})}_getMesh(e,n){const l=this._getMeshKey(n);if(l in this._tileMeshCache)return this._tileMeshCache[l];const u=function(m,y){const b=Ta(y,"16bit"),T=d.aE.deserialize({arrayBuffer:b.vertices,length:b.vertices.byteLength/2/2}),E=d.aG.deserialize({arrayBuffer:b.indices,length:b.indices.byteLength/2/3});return new mr(m.createVertexBuffer(T,Fr.members),m.createIndexBuffer(E),d.aF.simpleSegment(0,0,T.length,E.length))}(e,n);return this._tileMeshCache[l]=u,u}recalculate(e){}hasTransition(){const e=at.now();let n=!1;return n=n||(e-this._errorMeasurementLastChangeTime)/1e3<.7,n=n||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,n}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const Td=new d.r({type:new d.D(d.v.projection.type)});class Vo extends d.E{constructor(e){super(),this._transitionable=new d.T(Td),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new d.C(0)),this._mercatorProjection=new Ac,this._verticalPerspectiveProjection=new Za}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof d.bd){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,n,l,u,m){return this.currentProjection.getMeshFromTileID(e,n,l,u,m)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function kl(f){const e=er(f.worldSize,f.center.lat);return 2*Math.PI*e}function ls(f,e,n,l,u){const m=1/(1<<u),y=e/d.Z*m+l*m,b=d.bf((f/d.Z*m+n*m)*Math.PI*2+Math.PI,2*Math.PI),T=2*Math.atan(Math.exp(Math.PI-y*Math.PI*2))-.5*Math.PI,E=Math.cos(T),z=new Float64Array(3);return z[0]=Math.sin(b)*E,z[1]=Math.sin(T),z[2]=Math.cos(b)*E,z}function Rn(f){return function(e,n){const l=Math.cos(n),u=new Float64Array(3);return u[0]=Math.sin(e)*l,u[1]=Math.sin(n),u[2]=Math.cos(e)*l,u}(f.lng*Math.PI/180,f.lat*Math.PI/180)}function er(f,e){return f/(2*Math.PI)/Math.cos(e*Math.PI/180)}function Dc(f){const e=Math.asin(f[1])/Math.PI*180,n=Math.sqrt(f[0]*f[0]+f[2]*f[2]);if(n>1e-6){const l=f[0]/n,u=Math.acos(f[2]/n),m=(l>0?u:-u)/Math.PI*180;return new d.Q(d.aK(m,-180,180),e)}return new d.Q(0,e)}function Zr(f){return Math.cos(f*Math.PI/180)}function fn(f,e){const n=Zr(f),l=Zr(e);return d.aa(l/n)}function Ll(f,e){const n=f.rotate(e.bearingInRadians),l=e.zoom+fn(e.center.lat,0),u=d.bb(1/Zr(e.center.lat),1/Zr(Math.min(Math.abs(e.center.lat),60)),d.be(l,7,3,0,1)),m=360/kl({worldSize:e.worldSize,center:{lat:e.center.lat}});return new d.Q(e.center.lng-n.x*m*u,d.ad(e.center.lat+n.y*m,-85.051129,d.aI))}function Ic(f){const e=.5*f,n=Math.sin(e),l=Math.cos(e);return Math.log(n+l)-Math.log(l-n)}function ao(f,e,n,l){const u=f.lat+n*l;if(Math.abs(n)>1){const m=(Math.sign(f.lat+n)!==Math.sign(f.lat)?-Math.abs(f.lat):Math.abs(f.lat))*Math.PI/180,y=Math.abs(f.lat+n)*Math.PI/180,b=Ic(m+l*(y-m)),T=Ic(m),E=Ic(y);return new d.Q(f.lng+e*((b-T)/(E-T)),u)}return new d.Q(f.lng+e*l,u)}class Sd{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=e}recalculateCache(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(e,n,l,u){const m=`${e.z}_${e.x}_${e.y}`,y=this._cache.get(m);if(y)return y;const b=this._cachePrevious.get(m);if(b)return this._cache.set(m,b),b;const T=this._aabbFactory(e,n,l,u);return this._cache.set(m,T),this._hadAnyChanges=!0,T}}function Rc(f,e,n){const l=f-e;return l<0?-l:Math.max(0,l-n)}function Ru(f,e,n,l,u){const m=f-n;let y;return y=m<0?Math.min(-m,1+m-u):m>1?Math.min(Math.max(m-u,0),1-m):0,Math.max(y,Rc(e,l,u))}class Ah{constructor(){this._aabbCache=new Sd(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(e,n,l,u){const m=1<<l.z,y=1/m,b=l.x/m,T=l.y/m;let E=2;return E=Math.min(E,Ru(e,n,b,T,y)),E=Math.min(E,Ru(e,n,b+.5,-T-y,y)),E=Math.min(E,Ru(e,n,b+.5,2-T-y,y)),E}getWrap(e,n,l){const u=1<<n.z,m=1/u,y=n.x/u,b=Rc(e.x,y,m),T=Rc(e.x,y-1,m),E=Rc(e.x,y+1,m),z=Math.min(b,T,E);return z===E?1:z===T?-1:0}allowVariableZoom(e,n){return dn(e,n)>4}allowWorldCopies(){return!1}getTileAABB(e,n,l,u){return this._aabbCache.getTileAABB(e,n,l,u)}_computeTileAABB(e,n,l,u){if(e.z<=0)return new Ur([-1,-1,-1],[1,1,1]);if(e.z===1)return new Ur([e.x===0?-1:0,e.y===0?0:-1,-1],[e.x===0?0:1,e.y===0?1:0,1]);{const m=[ls(0,0,e.x,e.y,e.z),ls(d.Z,0,e.x,e.y,e.z),ls(d.Z,d.Z,e.x,e.y,e.z),ls(0,d.Z,e.x,e.y,e.z)],y=[1,1,1],b=[-1,-1,-1];for(const T of m)for(let E=0;E<3;E++)y[E]=Math.min(y[E],T[E]),b[E]=Math.max(b[E],T[E]);if(e.y===0||e.y===(1<<e.z)-1){const T=[0,e.y===0?1:-1,0];for(let E=0;E<3;E++)y[E]=Math.min(y[E],T[E]),b[E]=Math.max(b[E],T[E])}return new Ur(y,b)}}}class kc{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,l){return this._helper.interpolatePadding(e,n,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n){this._helper.resize(e,n)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=d.bg(),this._projectionMatrix=d.b0(),this._globeViewProjMatrix32f=d.a$(),this._globeViewProjMatrixNoCorrection=d.b0(),this._globeViewProjMatrixNoCorrectionInverted=d.b0(),this._globeProjMatrixInverted=d.b0(),this._cameraPosition=d.bh(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new ro({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,n)=>this.getConstrained(e,n)}),this._coveringTilesDetailsProvider=new Ah}clone(){const e=new kc;return e.apply(this),e}apply(e,n){this._globeLatitudeErrorCorrectionRadians=n||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=d.bh();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:n,applyGlobeMatrix:l}=e,u=this._helper.getMercatorTileCoordinates(n);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:u,clippingPlane:this._cachedClippingPlane,projectionTransition:l?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const n=this.pitchInRadians,l=this.cameraToCenterDistance/e,u=Math.sin(n)*l,m=Math.cos(n)*l+1,y=1/Math.sqrt(u*u+m*m)*1;let b=-u,T=m;const E=Math.sqrt(b*b+T*T);b/=E,T/=E;const z=[0,b,T];return d.bi(z,z,[0,0,0],-this.bearingInRadians),d.bj(z,z,[0,0,0],-1*this.center.lat*Math.PI/180),d.bk(z,z,[0,0,0],this.center.lng*Math.PI/180),d.aN(z,z,.25),[...z,.25*-y]}isLocationOccluded(e){return!this.isSurfacePointVisible(Rn(e))}transformLightDirection(e){const n=this._helper._center.lng*Math.PI/180,l=this._helper._center.lat*Math.PI/180,u=Math.cos(l),m=[Math.sin(n)*u,Math.sin(l),Math.cos(n)*u],y=[m[2],0,-m[0]],b=[0,0,0];d.aT(b,y,m),d.aS(y,y),d.aS(b,b);const T=[0,0,0];return d.aS(T,[y[0]*e[0]+b[0]*e[1]+m[0]*e[2],y[1]*e[0]+b[1]*e[1]+m[1]*e[2],y[2]*e[0]+b[2]*e[1]+m[2]*e[2]]),T}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,n,l){const u=function(b,T,E){const z=1/(1<<E.z);return new d.$(b/d.Z*z+E.x*z,T/d.Z*z+E.y*z)}(e,n,l.canonical),m=(y=u.y,[d.bf(u.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-y*Math.PI*2))-.5*Math.PI]);var y;return this.getCircleRadiusCorrection()/Math.cos(m[1])}projectTileCoordinates(e,n,l,u){const m=l.canonical,y=ls(e,n,m.x,m.y,m.z),b=1+(u?u(e,n):0)/d.bq,T=[y[0]*b,y[1]*b,y[2]*b,1];d.ao(T,T,this._globeViewProjMatrixNoCorrection);const E=this._cachedClippingPlane,z=E[0]*y[0]+E[1]*y[1]+E[2]*y[2]+E[3]<0;return{point:new d.P(T[0]/T[3],T[1]/T[3]),signedDistanceFromCamera:T[3],isOccluded:z}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=er(this.worldSize,this.center.lat),n=d.b1(),l=d.b1();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),d.aX(n,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const u=this.centerOffset;n[8]=2*-u.x/this._helper._width,n[9]=2*u.y/this._helper._height,this._projectionMatrix=d.aY(n),this._globeProjMatrixInverted=d.b1(),d.ai(this._globeProjMatrixInverted,n),d.L(n,n,[0,0,-this.cameraToCenterDistance]),d.aZ(n,n,this.rollInRadians),d.a_(n,n,-this.pitchInRadians),d.aZ(n,n,this.bearingInRadians),d.L(n,n,[0,0,-e]);const m=d.bh();m[0]=e,m[1]=e,m[2]=e,d.a_(l,n,this.center.lat*Math.PI/180),d.bl(l,l,-this.center.lng*Math.PI/180),d.M(l,l,m),this._globeViewProjMatrixNoCorrection=l,d.a_(n,n,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),d.bl(n,n,-this.center.lng*Math.PI/180),d.M(n,n,m),this._globeViewProjMatrix32f=new Float32Array(n),this._globeViewProjMatrixNoCorrectionInverted=d.b1(),d.ai(this._globeViewProjMatrixNoCorrectionInverted,l);const y=d.bh();this._cameraPosition=d.bh(),this._cameraPosition[2]=this.cameraToCenterDistance/e,d.bi(this._cameraPosition,this._cameraPosition,y,-this.rollInRadians),d.bj(this._cameraPosition,this._cameraPosition,y,this.pitchInRadians),d.bi(this._cameraPosition,this._cameraPosition,y,-this.bearingInRadians),d.aO(this._cameraPosition,this._cameraPosition,[0,0,1]),d.bj(this._cameraPosition,this._cameraPosition,y,-this.center.lat*Math.PI/180),d.bk(this._cameraPosition,this._cameraPosition,y,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const b=d.aY(this._globeViewProjMatrixNoCorrectionInverted);d.M(b,b,[1,1,-1]),this._cachedFrustum=Vr.fromInvProjectionMatrix(b)}calculateFogMatrix(e){d.w("calculateFogMatrix is not supported on globe projection.");const n=d.b1();return d.as(n),n}getVisibleUnwrappedCoordinates(e){return[new d.aV(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&d.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,n){if(!this._globeViewProjMatrixNoCorrection)return 1;const l=Rn(e);d.aN(l,l,1+n/d.bq);const u=d.bg();return d.ao(u,[l[0],l[1],l[2],1],this._globeViewProjMatrixNoCorrection),u[2]/u[3]}populateCache(e){}getBounds(){const e=.5*this.width,n=.5*this.height,l=[new d.P(0,0),new d.P(e,0),new d.P(this.width,0),new d.P(this.width,n),new d.P(this.width,this.height),new d.P(e,this.height),new d.P(0,this.height),new d.P(0,n)],u=[];for(const D of l)u.push(this.unprojectScreenPoint(D));let m=0,y=0,b=0,T=0;const E=this.center;for(const D of u){const I=d.bm(E.lng,D.lng),F=d.bm(E.lat,D.lat);I<y&&(y=I),I>m&&(m=I),F<T&&(T=F),F>b&&(b=F)}const z=[E.lng+y,E.lat+T,E.lng+m,E.lat+b];return this.isSurfacePointOnScreen([0,1,0])&&(z[3]=90,z[0]=-180,z[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(z[1]=-90,z[0]=-180,z[2]=180),new Fi(z)}getConstrained(e,n){const l=d.ad(e.lat,-85.051129,d.aI),u=d.ad(+n,this.minZoom+fn(0,l),this.maxZoom);return{center:new d.Q(e.lng,l),zoom:u}}calculateCenterFromCameraLngLatAlt(e,n,l,u){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,l,u)}setLocationAtPoint(e,n){const l=Rn(this.unprojectScreenPoint(n)),u=Rn(e),m=d.bh();d.bn(m);const y=d.bh();d.bk(y,l,m,-this.center.lng*Math.PI/180),d.bj(y,y,m,this.center.lat*Math.PI/180);const b=u[0]*u[0]+u[2]*u[2],T=y[0]*y[0];if(b<T)return;const E=Math.sqrt(b-T),z=-E,D=d.bo(u[0],u[2],y[0],E),I=d.bo(u[0],u[2],y[0],z),F=d.bh();d.bk(F,u,m,-D);const N=d.bo(F[1],F[2],y[1],y[2]),Y=d.bh();d.bk(Y,u,m,-I);const X=d.bo(Y[1],Y[2],y[1],y[2]),K=.5*Math.PI,J=N>=-K&&N<=K,re=X>=-K&&X<=K;let ae,oe;if(J&&re){const Me=this.center.lng*Math.PI/180,ke=this.center.lat*Math.PI/180;d.br(D,Me)+d.br(N,ke)<d.br(I,Me)+d.br(X,ke)?(ae=D,oe=N):(ae=I,oe=X)}else if(J)ae=D,oe=N;else{if(!re)return;ae=I,oe=X}const he=ae/Math.PI*180,ce=oe/Math.PI*180,we=this.center.lat;this.setCenter(new d.Q(he,d.ad(ce,-90,90))),this.setZoom(this.zoom+fn(we,this.center.lat))}locationToScreenPoint(e,n){const l=Rn(e);if(n){const u=n.getElevationForLngLatZoom(e,this._helper._tileZoom);d.aN(l,l,1+u/d.bq)}return this._projectSurfacePointToScreen(l)}_projectSurfacePointToScreen(e){const n=d.bg();return d.ao(n,[...e,1],this._globeViewProjMatrixNoCorrection),n[0]/=n[3],n[1]/=n[3],new d.P((.5*n[0]+.5)*this.width,(.5*-n[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,n){if(n){const l=n.pointCoordinate(e);if(l)return l}return d.$.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,n){var l;return(l=this.screenPointToMercatorCoordinate(e,n))===null||l===void 0?void 0:l.toLngLat()}isPointOnMapSurface(e,n){const l=this._cameraPosition,u=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(l,u)}getRayDirectionFromPixel(e){const n=d.bg();n[0]=e.x/this.width*2-1,n[1]=-1*(e.y/this.height*2-1),n[2]=1,n[3]=1,d.ao(n,n,this._globeViewProjMatrixNoCorrectionInverted),n[0]/=n[3],n[1]/=n[3],n[2]/=n[3];const l=d.bh();l[0]=n[0]-this._cameraPosition[0],l[1]=n[1]-this._cameraPosition[1],l[2]=n[2]-this._cameraPosition[2];const u=d.bh();return d.aS(u,l),u}isSurfacePointVisible(e){const n=this._cachedClippingPlane;return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const n=d.bg();return d.ao(n,[...e,1],this._globeViewProjMatrixNoCorrection),n[0]/=n[3],n[1]/=n[3],n[2]/=n[3],n[0]>-1&&n[0]<1&&n[1]>-1&&n[1]<1&&n[2]>-1&&n[2]<1}rayPlanetIntersection(e,n){const l=d.aU(e,n),u=d.bh(),m=d.bh();d.aN(m,n,l),d.aR(u,e,m);const y=1-d.aU(u,u);if(y<0)return null;const b=d.aU(e,e)-1,T=-l+(l<0?1:-1)*Math.sqrt(y),E=b/T,z=T;return{tMin:Math.min(E,z),tMax:Math.max(E,z)}}unprojectScreenPoint(e){const n=this._cameraPosition,l=this.getRayDirectionFromPixel(e),u=this.rayPlanetIntersection(n,l);if(u){const E=d.bh();d.aO(E,n,[l[0]*u.tMin,l[1]*u.tMin,l[2]*u.tMin]);const z=d.bh();return d.aS(z,E),Dc(z)}const m=this._cachedClippingPlane[0]*l[0]+this._cachedClippingPlane[1]*l[1]+this._cachedClippingPlane[2]*l[2],y=-d.bp(this._cachedClippingPlane,n)/m,b=d.bh();if(y>0)d.aO(b,n,[l[0]*y,l[1]*y,l[2]*y]);else{const E=d.bh();d.aO(E,n,[2*l[0],2*l[1],2*l[2]]);const z=d.bp(this._cachedClippingPlane,E);d.aR(b,E,[this._cachedClippingPlane[0]*z,this._cachedClippingPlane[1]*z,this._cachedClippingPlane[2]*z])}const T=d.bh();return d.aS(T,b),Dc(T)}getMatrixForModel(e,n){const l=d.Q.convert(e),u=1/d.bq,m=d.b0();return d.bl(m,m,l.lng/180*Math.PI),d.a_(m,m,-l.lat/180*Math.PI),d.L(m,m,[0,0,1+n/d.bq]),d.a_(m,m,.5*Math.PI),d.M(m,m,[u,u,u]),m}getProjectionDataForCustomLayer(e=!0){const n=this.getProjectionData({overscaledTileID:new d.Y(0,0,0,0,0),applyGlobeMatrix:e});return n.tileMercatorCoords=[0,0,1,1],n}getFastPathSimpleProjectionMatrix(e){}}class Lc{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,l){return this._helper.interpolatePadding(e,n,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n,l=!0){this._helper.resize(e,n,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,n){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=n,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new ro({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,n)=>this.getConstrained(e,n)}),this._globeness=1,this._mercatorTransform=new Wn,this._verticalPerspectiveTransform=new kc}clone(){const e=new Lc;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const n=this._mercatorTransform.getProjectionData(e),l=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?l.mainMatrix:n.mainMatrix,clippingPlane:l.clippingPlane,tileMercatorCoords:l.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:n.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return d.bb(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return d.bb(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,n,l){const u=this._mercatorTransform.getPitchedTextCorrection(e,n,l),m=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,n,l);return d.bb(u,m,this._globeness)}projectTileCoordinates(e,n,l,u){return this.currentTransform.projectTileCoordinates(e,n,l,u)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,n){return this.currentTransform.lngLatToCameraDepth(e,n)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,n){return this.currentTransform.getConstrained(e,n)}calculateCenterFromCameraLngLatAlt(e,n,l,u){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,l,u)}setLocationAtPoint(e,n){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,n),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,n),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,n){return this.currentTransform.locationToScreenPoint(e,n)}screenPointToMercatorCoordinate(e,n){return this.currentTransform.screenPointToMercatorCoordinate(e,n)}screenPointToLocation(e,n){return this.currentTransform.screenPointToLocation(e,n)}isPointOnMapSurface(e,n){return this.currentTransform.isPointOnMapSurface(e,n)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,n){return this.currentTransform.getMatrixForModel(e,n)}getProjectionDataForCustomLayer(e=!0){const n=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return n;const l=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return l.fallbackMatrix=n.mainMatrix,l}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class Cr{get useGlobeControls(){return!0}handlePanInertia(e,n){const l=Ll(e,n);return Math.abs(l.lng-n.center.lng)>180&&(l.lng=n.center.lng+179.5*Math.sign(l.lng-n.center.lng)),{easingCenter:l,easingOffset:new d.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,n){const l=e.around,u=n.screenPointToLocation(l);e.bearingDelta&&n.setBearing(n.bearing+e.bearingDelta),e.pitchDelta&&n.setPitch(n.pitch+e.pitchDelta),e.rollDelta&&n.setRoll(n.roll+e.rollDelta);const m=n.zoom;e.zoomDelta&&n.setZoom(n.zoom+e.zoomDelta);const y=n.zoom-m;if(y===0)return;const b=d.bm(n.center.lng,u.lng),T=b/(Math.abs(b/180)+1),E=d.bm(n.center.lat,u.lat),z=n.getRayDirectionFromPixel(l),D=n.cameraPosition,I=-1*d.aU(D,z),F=d.bh();d.aO(F,D,[z[0]*I,z[1]*I,z[2]*I]);const N=d.bs(F)-1,Y=Math.exp(.5*-Math.max(N-.3,0)),X=er(n.worldSize,n.center.lat)/Math.min(n.width,n.height),K=d.be(X,.9,.5,1,.25),J=(1-d.aH(-y))*Math.min(Y,K),re=n.center.lat,ae=n.zoom,oe=new d.Q(n.center.lng+T*J,d.ad(n.center.lat+E*J,-85.051129,d.aI));n.setLocationAtPoint(u,l);const he=n.center,ce=d.be(Math.abs(b),45,85,0,1),we=d.be(X,.75,.35,0,1),Me=Math.pow(Math.max(ce,we),.25),ke=d.bm(he.lng,oe.lng),Le=d.bm(he.lat,oe.lat);n.setCenter(new d.Q(he.lng+ke*Me,he.lat+Le*Me).wrap()),n.setZoom(ae+fn(re,n.center.lat))}handleMapControlsPan(e,n,l){if(!e.panDelta)return;const u=n.center.lat,m=n.zoom;n.setCenter(Ll(e.panDelta,n).wrap()),n.setZoom(m+fn(u,n.center.lat))}cameraForBoxAndBearing(e,n,l,u,m){const y=Pc(e,n,l,u,m),b=n.left/m.width*2-1,T=(m.width-n.right)/m.width*2-1,E=n.top/m.height*-2+1,z=(m.height-n.bottom)/m.height*-2+1,D=d.bm(l.getWest(),l.getEast())<0,I=D?l.getEast():l.getWest(),F=D?l.getWest():l.getEast(),N=Math.max(l.getNorth(),l.getSouth()),Y=Math.min(l.getNorth(),l.getSouth()),X=I+.5*d.bm(I,F),K=N+.5*d.bm(N,Y),J=m.clone();J.setCenter(y.center),J.setBearing(y.bearing),J.setPitch(0),J.setRoll(0),J.setZoom(y.zoom);const re=J.modelViewProjectionMatrix,ae=[Rn(l.getNorthWest()),Rn(l.getNorthEast()),Rn(l.getSouthWest()),Rn(l.getSouthEast()),Rn(new d.Q(F,K)),Rn(new d.Q(I,K)),Rn(new d.Q(X,N)),Rn(new d.Q(X,Y))],oe=Rn(y.center);let he=Number.POSITIVE_INFINITY;for(const ce of ae)b<0&&(he=Cr.getLesserNonNegativeNonNull(he,Cr.solveVectorScale(ce,oe,re,"x",b))),T>0&&(he=Cr.getLesserNonNegativeNonNull(he,Cr.solveVectorScale(ce,oe,re,"x",T))),E>0&&(he=Cr.getLesserNonNegativeNonNull(he,Cr.solveVectorScale(ce,oe,re,"y",E))),z<0&&(he=Cr.getLesserNonNegativeNonNull(he,Cr.solveVectorScale(ce,oe,re,"y",z)));if(Number.isFinite(he)&&he!==0)return y.zoom=J.zoom+d.aa(he),y;No()}handleJumpToCenterZoom(e,n){const l=e.center.lat,u=e.getConstrained(n.center?d.Q.convert(n.center):e.center,e.zoom).center;e.setCenter(u.wrap());const m=n.zoom!==void 0?+n.zoom:e.zoom+fn(l,u.lat);e.zoom!==m&&e.setZoom(m)}handleEaseTo(e,n){const l=e.zoom,u=e.center,m=e.padding,y={roll:e.roll,pitch:e.pitch,bearing:e.bearing},b={roll:n.roll===void 0?e.roll:n.roll,pitch:n.pitch===void 0?e.pitch:n.pitch,bearing:n.bearing===void 0?e.bearing:n.bearing},T=n.zoom!==void 0,E=!e.isPaddingEqual(n.padding);let z=!1;const D=n.center?d.Q.convert(n.center):u,I=e.getConstrained(D,l).center;gr(e,I);const F=e.clone();F.setCenter(I),F.setZoom(T?+n.zoom:l+fn(u.lat,D.lat)),F.setBearing(n.bearing);const N=new d.P(d.ad(e.centerPoint.x+n.offsetAsPoint.x,0,e.width),d.ad(e.centerPoint.y+n.offsetAsPoint.y,0,e.height));F.setLocationAtPoint(I,N);const Y=(n.offset&&n.offsetAsPoint.mag())>0?F.center:I,X=T?+n.zoom:l+fn(u.lat,Y.lat),K=l+fn(u.lat,0),J=X+fn(Y.lat,0),re=d.bm(u.lng,Y.lng),ae=d.bm(u.lat,Y.lat),oe=d.aH(J-K);return z=X!==l,{easeFunc:he=>{if(d.b5(y,b)||Er({startEulerAngles:y,endEulerAngles:b,tr:e,k:he,useSlerp:y.roll!=b.roll}),E&&e.interpolatePadding(m,n.padding,he),n.around)d.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(n.around,n.aroundPoint);else{const ce=J>K?Math.min(2,oe):Math.max(.5,oe),we=Math.pow(ce,1-he),Me=ao(u,re,ae,he*we);e.setCenter(Me.wrap())}if(z){const ce=d.B.number(K,J,he)+fn(0,e.center.lat);e.setZoom(ce)}},isZooming:z,elevationCenter:Y}}handleFlyTo(e,n){const l=n.zoom!==void 0,u=e.center,m=e.zoom,y=e.padding,b=!e.isPaddingEqual(n.padding),T=e.getConstrained(d.Q.convert(n.center||n.locationAtOffset),m).center,E=l?+n.zoom:e.zoom+fn(e.center.lat,T.lat),z=e.clone();z.setCenter(T),z.setZoom(E),z.setBearing(n.bearing);const D=new d.P(d.ad(e.centerPoint.x+n.offsetAsPoint.x,0,e.width),d.ad(e.centerPoint.y+n.offsetAsPoint.y,0,e.height));z.setLocationAtPoint(T,D);const I=z.center;gr(e,I);const F=function(ae,oe,he){const ce=Rn(oe),we=Rn(he),Me=d.aU(ce,we),ke=Math.acos(Me),Le=kl(ae);return ke/(2*Math.PI)*Le}(e,u,I),N=m+fn(u.lat,0),Y=E+fn(I.lat,0),X=d.aH(Y-N);let K;if(typeof n.minZoom=="number"){const ae=+n.minZoom+fn(I.lat,0),oe=Math.min(ae,N,Y)+fn(0,I.lat),he=e.getConstrained(I,oe).zoom+fn(I.lat,0);K=d.aH(he-N)}const J=d.bm(u.lng,I.lng),re=d.bm(u.lat,I.lat);return{easeFunc:(ae,oe,he,ce)=>{const we=ao(u,J,re,he);b&&e.interpolatePadding(y,n.padding,ae);const Me=ae===1?I:we;e.setCenter(Me.wrap());const ke=N+d.aa(oe);e.setZoom(ae===1?E:ke+fn(0,Me.lat))},scaleOfZoom:X,targetCenter:I,scaleOfMinZoom:K,pixelPathLength:F}}static solveVectorScale(e,n,l,u,m){const y=u==="x"?[l[0],l[4],l[8],l[12]]:[l[1],l[5],l[9],l[13]],b=[l[3],l[7],l[11],l[15]],T=e[0]*y[0]+e[1]*y[1]+e[2]*y[2],E=e[0]*b[0]+e[1]*b[1]+e[2]*b[2],z=n[0]*y[0]+n[1]*y[1]+n[2]*y[2],D=n[0]*b[0]+n[1]*b[1]+n[2]*b[2];return z+m*E===T+m*D||b[3]*(T-z)+y[3]*(D-E)+T*D==z*E?null:(z+y[3]-m*D-m*b[3])/(z-T-m*D+m*E)}static getLesserNonNegativeNonNull(e,n){return n!==null&&n>=0&&n<e?n:e}}class Bc{constructor(e){this._globe=e,this._mercatorCameraHelper=new _r,this._verticalPerspectiveCameraHelper=new Cr}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,n){return this.currentHelper.handlePanInertia(e,n)}handleMapControlsRollPitchBearingZoom(e,n){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,n)}handleMapControlsPan(e,n,l){this.currentHelper.handleMapControlsPan(e,n,l)}cameraForBoxAndBearing(e,n,l,u,m){return this.currentHelper.cameraForBoxAndBearing(e,n,l,u,m)}handleJumpToCenterZoom(e,n){this.currentHelper.handleJumpToCenterZoom(e,n)}handleEaseTo(e,n){return this.currentHelper.handleEaseTo(e,n)}handleFlyTo(e,n){return this.currentHelper.handleFlyTo(e,n)}}const cs=(f,e)=>d.x(f,e&&e.filter(n=>n.identifier!=="source.canvas")),ku=d.bt();class Bl extends d.E{constructor(e,n={}){super(),this._rtlPluginLoaded=()=>{for(const l in this.sourceCaches){const u=this.sourceCaches[l].getSource().type;u!=="vector"&&u!=="geojson"||this.sourceCaches[l].reload()}},this.map=e,this.dispatcher=new hn(Ut(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(l,u)=>this.getGlyphs(l,u)),this.dispatcher.registerMessageHandler("GI",(l,u)=>this.getImages(l,u)),this.imageManager=new ai,this.imageManager.setEventedParent(this),this.glyphManager=new ji(e._requestManager,n.localIdeographFontFamily),this.lineAtlas=new fe(256,512),this.crossTileSymbolIndex=new Cc,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new d.bu,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",d.bv()),ia().on(Oo,this._rtlPluginLoaded),this.on("data",l=>{if(l.dataType!=="source"||l.sourceDataType!=="metadata")return;const u=this.sourceCaches[l.sourceId];if(!u)return;const m=u.getSource();if(m&&m.vectorLayerIds)for(const y in this._layers){const b=this._layers[y];b.source===m.id&&this._validateLayer(b)}})}loadURL(e,n={},l){this.fire(new d.l("dataloading",{dataType:"style"})),n.validate=typeof n.validate!="boolean"||n.validate;const u=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const m=this._loadStyleRequest;d.j(u,this._loadStyleRequest).then(y=>{this._loadStyleRequest=null,this._load(y.data,n,l)}).catch(y=>{this._loadStyleRequest=null,y&&!m.signal.aborted&&this.fire(new d.k(y))})}loadJSON(e,n={},l){this.fire(new d.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,at.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,n.validate=n.validate!==!1,this._load(e,n,l)}).catch(()=>{})}loadEmpty(){this.fire(new d.l("dataloading",{dataType:"style"})),this._load(ku,{validate:!1})}_load(e,n,l){var u,m;const y=n.transformStyle?n.transformStyle(l,e):e;if(!n.validate||!cs(this,d.y(y))){this._loaded=!0,this.stylesheet=y;for(const b in y.sources)this.addSource(b,y.sources[b],{validate:!1});y.sprite?this._loadSprite(y.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(y.glyphs),this._createLayers(),this.light=new Ot(this.stylesheet.light),this._setProjectionInternal(((u=this.stylesheet.projection)===null||u===void 0?void 0:u.type)||"mercator"),this.sky=new ci(this.stylesheet.sky),this.map.setTerrain((m=this.stylesheet.terrain)!==null&&m!==void 0?m:null),this.fire(new d.l("data",{dataType:"style"})),this.fire(new d.l("style.load"))}}_createLayers(){const e=d.bw(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(n=>n.id),this._layers={},this._serializedLayers=null;for(const n of e){const l=d.bx(n);l.setEventedParent(this,{layer:{id:n.id}}),this._layers[n.id]=l}}_loadSprite(e,n=!1,l=void 0){let u;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(m,y,b,T){return d._(this,void 0,void 0,function*(){const E=Jt(m),z=b>1?"@2x":"",D={},I={};for(const{id:F,url:N}of E){const Y=y.transformRequest(li(N,z,".json"),"SpriteJSON");D[F]=d.j(Y,T);const X=y.transformRequest(li(N,z,".png"),"SpriteImage");I[F]=tn.getImage(X,T)}return yield Promise.all([...Object.values(D),...Object.values(I)]),function(F,N){return d._(this,void 0,void 0,function*(){const Y={};for(const X in F){Y[X]={};const K=at.getImageCanvasContext((yield N[X]).data),J=(yield F[X]).data;for(const re in J){const{width:ae,height:oe,x:he,y:ce,sdf:we,pixelRatio:Me,stretchX:ke,stretchY:Le,content:Ie,textFitWidth:et,textFitHeight:We}=J[re];Y[X][re]={data:null,pixelRatio:Me,sdf:we,stretchX:ke,stretchY:Le,content:Ie,textFitWidth:et,textFitHeight:We,spriteData:{width:ae,height:oe,x:he,y:ce,context:K}}}}return Y})}(D,I)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(m=>{if(this._spriteRequest=null,m)for(const y in m){this._spritesImagesIds[y]=[];const b=this._spritesImagesIds[y]?this._spritesImagesIds[y].filter(T=>!(T in m)):[];for(const T of b)this.imageManager.removeImage(T),this._changedImages[T]=!0;for(const T in m[y]){const E=y==="default"?T:`${y}:${T}`;this._spritesImagesIds[y].push(E),E in this.imageManager.images?this.imageManager.updateImage(E,m[y][T],!1):this.imageManager.addImage(E,m[y][T]),n&&(this._changedImages[E]=!0)}}}).catch(m=>{this._spriteRequest=null,u=m,this.fire(new d.k(u))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),n&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.l("data",{dataType:"style"})),l&&l(u)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.l("data",{dataType:"style"}))}_validateLayer(e){const n=this.sourceCaches[e.source];if(!n)return;const l=e.sourceLayer;if(!l)return;const u=n.getSource();(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(l)===-1)&&this.fire(new d.k(new Error(`Source layer "${l}" does not exist on source "${u.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,n=!1){const l=this._serializedAllLayers();if(!e||e.length===0)return Object.values(n?d.by(l):l);const u=[];for(const m of e)if(l[m]){const y=n?d.by(l[m]):l[m];u.push(y)}return u}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const n=Object.keys(this._layers);for(const l of n){const u=this._layers[l];u.type!=="custom"&&(e[l]=u.serialize())}return e}hasTransitions(){var e,n,l;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((n=this.sky)===null||n===void 0)&&n.hasTransition()||!((l=this.projection)===null||l===void 0)&&l.hasTransition())return!0;for(const u in this.sourceCaches)if(this.sourceCaches[u].hasTransition())return!0;for(const u in this._layers)if(this._layers[u].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const n=this._changed;if(n){const u=Object.keys(this._updatedLayers),m=Object.keys(this._removedLayers);(u.length||m.length)&&this._updateWorkerLayers(u,m);for(const y in this._updatedSources){const b=this._updatedSources[y];if(b==="reload")this._reloadSource(y);else{if(b!=="clear")throw new Error(`Invalid action ${b}`);this._clearSource(y)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const y in this._updatedPaintProps)this._layers[y].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const l={};for(const u in this.sourceCaches){const m=this.sourceCaches[u];l[u]=m.used,m.used=!1}for(const u of this._order){const m=this._layers[u];m.recalculate(e,this._availableImages),!m.isHidden(e.zoom)&&m.source&&(this.sourceCaches[m.source].used=!0)}for(const u in l){const m=this.sourceCaches[u];!!l[u]!=!!m.used&&m.fire(new d.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:u}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,n&&this.fire(new d.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,n){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:n})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,n={}){var l;this._checkLoaded();const u=this.serialize();if(e=n.transformStyle?n.transformStyle(u,e):e,((l=n.validate)===null||l===void 0||l)&&cs(this,d.y(e)))return!1;(e=d.by(e)).layers=d.bw(e.layers);const m=d.bz(u,e),y=this._getOperationsToPerform(m);if(y.unimplemented.length>0)throw new Error(`Unimplemented: ${y.unimplemented.join(", ")}.`);if(y.operations.length===0)return!1;for(const b of y.operations)b();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const n=[],l=[];for(const u of e)switch(u.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":n.push(()=>this.addLayer.apply(this,u.args));break;case"removeLayer":n.push(()=>this.removeLayer.apply(this,u.args));break;case"setPaintProperty":n.push(()=>this.setPaintProperty.apply(this,u.args));break;case"setLayoutProperty":n.push(()=>this.setLayoutProperty.apply(this,u.args));break;case"setFilter":n.push(()=>this.setFilter.apply(this,u.args));break;case"addSource":n.push(()=>this.addSource.apply(this,u.args));break;case"removeSource":n.push(()=>this.removeSource.apply(this,u.args));break;case"setLayerZoomRange":n.push(()=>this.setLayerZoomRange.apply(this,u.args));break;case"setLight":n.push(()=>this.setLight.apply(this,u.args));break;case"setGeoJSONSourceData":n.push(()=>this.setGeoJSONSourceData.apply(this,u.args));break;case"setGlyphs":n.push(()=>this.setGlyphs.apply(this,u.args));break;case"setSprite":n.push(()=>this.setSprite.apply(this,u.args));break;case"setTerrain":n.push(()=>this.map.setTerrain.apply(this,u.args));break;case"setSky":n.push(()=>this.setSky.apply(this,u.args));break;case"setProjection":this.setProjection.apply(this,u.args);break;case"setTransition":n.push(()=>{});break;default:l.push(u.command)}return{operations:n,unimplemented:l}}addImage(e,n){if(this.getImage(e))return this.fire(new d.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,n),this._afterImageUpdated(e)}updateImage(e,n){this.imageManager.updateImage(e,n)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new d.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,n,l={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!n.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(n).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(d.y.source,`sources.${e}`,n,null,l))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const u=this.sourceCaches[e]=new P(e,n,this.dispatcher);u.style=this,u.setEventedParent(this,()=>({isSourceLoaded:u.loaded(),source:u.serialize(),sourceId:e})),u.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const l in this._layers)if(this._layers[l].source===e)return this.fire(new d.k(new Error(`Source "${e}" cannot be removed while layer "${l}" is using it.`)));const n=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],n.fire(new d.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),n.setEventedParent(null),n.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,n){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const l=this.sourceCaches[e].getSource();if(l.type!=="geojson")throw new Error(`geojsonSource.type is ${l.type}, which is !== 'geojson`);l.setData(n),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,n,l={}){this._checkLoaded();const u=e.id;if(this.getLayer(u))return void this.fire(new d.k(new Error(`Layer "${u}" already exists on this map.`)));let m;if(e.type==="custom"){if(cs(this,d.bA(e)))return;m=d.bx(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(u,e.source),e=d.by(e),e=d.e(e,{source:u})),this._validate(d.y.layer,`layers.${u}`,e,{arrayIndex:-1},l))return;m=d.bx(e),this._validateLayer(m),m.setEventedParent(this,{layer:{id:u}})}const y=n?this._order.indexOf(n):this._order.length;if(n&&y===-1)this.fire(new d.k(new Error(`Cannot add layer "${u}" before non-existing layer "${n}".`)));else{if(this._order.splice(y,0,u),this._layerOrderChanged=!0,this._layers[u]=m,this._removedLayers[u]&&m.source&&m.type!=="custom"){const b=this._removedLayers[u];delete this._removedLayers[u],b.type!==m.type?this._updatedSources[m.source]="clear":(this._updatedSources[m.source]="reload",this.sourceCaches[m.source].pause())}this._updateLayer(m),m.onAdd&&m.onAdd(this.map)}}moveLayer(e,n){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new d.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===n)return;const l=this._order.indexOf(e);this._order.splice(l,1);const u=n?this._order.indexOf(n):this._order.length;n&&u===-1?this.fire(new d.k(new Error(`Cannot move layer "${e}" before non-existing layer "${n}".`))):(this._order.splice(u,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const n=this._layers[e];if(!n)return void this.fire(new d.k(new Error(`Cannot remove non-existing layer "${e}".`)));n.setEventedParent(null);const l=this._order.indexOf(e);this._order.splice(l,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,n,l){this._checkLoaded();const u=this.getLayer(e);u?u.minzoom===n&&u.maxzoom===l||(n!=null&&(u.minzoom=n),l!=null&&(u.maxzoom=l),this._updateLayer(u)):this.fire(new d.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,n,l={}){this._checkLoaded();const u=this.getLayer(e);if(u){if(!d.bB(u.filter,n))return n==null?(u.filter=void 0,void this._updateLayer(u)):void(this._validate(d.y.filter,`layers.${u.id}.filter`,n,null,l)||(u.filter=d.by(n),this._updateLayer(u)))}else this.fire(new d.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return d.by(this.getLayer(e).filter)}setLayoutProperty(e,n,l,u={}){this._checkLoaded();const m=this.getLayer(e);m?d.bB(m.getLayoutProperty(n),l)||(m.setLayoutProperty(n,l,u),this._updateLayer(m)):this.fire(new d.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,n){const l=this.getLayer(e);if(l)return l.getLayoutProperty(n);this.fire(new d.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,n,l,u={}){this._checkLoaded();const m=this.getLayer(e);m?d.bB(m.getPaintProperty(n),l)||(m.setPaintProperty(n,l,u)&&this._updateLayer(m),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new d.k(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,n){return this.getLayer(e).getPaintProperty(n)}setFeatureState(e,n){this._checkLoaded();const l=e.source,u=e.sourceLayer,m=this.sourceCaches[l];if(m===void 0)return void this.fire(new d.k(new Error(`The source '${l}' does not exist in the map's style.`)));const y=m.getSource().type;y==="geojson"&&u?this.fire(new d.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):y!=="vector"||u?(e.id===void 0&&this.fire(new d.k(new Error("The feature id parameter must be provided."))),m.setFeatureState(u,e.id,n)):this.fire(new d.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,n){this._checkLoaded();const l=e.source,u=this.sourceCaches[l];if(u===void 0)return void this.fire(new d.k(new Error(`The source '${l}' does not exist in the map's style.`)));const m=u.getSource().type,y=m==="vector"?e.sourceLayer:void 0;m!=="vector"||y?n&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new d.k(new Error("A feature id is required to remove its specific state property."))):u.removeFeatureState(y,e.id,n):this.fire(new d.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const n=e.source,l=e.sourceLayer,u=this.sourceCaches[n];if(u!==void 0)return u.getSource().type!=="vector"||l?(e.id===void 0&&this.fire(new d.k(new Error("The feature id parameter must be provided."))),u.getFeatureState(l,e.id)):void this.fire(new d.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new d.k(new Error(`The source '${n}' does not exist in the map's style.`)))}getTransition(){return d.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=d.bC(this.sourceCaches,m=>m.serialize()),n=this._serializeByIds(this._order,!0),l=this.map.getTerrain()||void 0,u=this.stylesheet;return d.bD({version:u.version,name:u.name,metadata:u.metadata,light:u.light,sky:u.sky,center:u.center,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch,sprite:u.sprite,glyphs:u.glyphs,transition:u.transition,projection:u.projection,sources:e,layers:n,terrain:l},m=>m!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const n=y=>this._layers[y].type==="fill-extrusion",l={},u=[];for(let y=this._order.length-1;y>=0;y--){const b=this._order[y];if(n(b)){l[b]=y;for(const T of e){const E=T[b];if(E)for(const z of E)u.push(z)}}}u.sort((y,b)=>b.intersectionZ-y.intersectionZ);const m=[];for(let y=this._order.length-1;y>=0;y--){const b=this._order[y];if(n(b))for(let T=u.length-1;T>=0;T--){const E=u[T].feature;if(l[E.layer.id]<y)break;m.push(E),u.pop()}else for(const T of e){const E=T[b];if(E)for(const z of E)m.push(z.feature)}}return m}queryRenderedFeatures(e,n,l){n&&n.filter&&this._validate(d.y.filter,"queryRenderedFeatures.filter",n.filter,null,n);const u={};if(n&&n.layers){if(!(Array.isArray(n.layers)||n.layers instanceof Set))return this.fire(new d.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const E of n.layers){const z=this._layers[E];if(!z)return this.fire(new d.k(new Error(`The layer '${E}' does not exist in the map's style and cannot be queried for features.`))),[];u[z.source]=!0}}const m=[];n.availableImages=this._availableImages;const y=this._serializedAllLayers(),b=n.layers instanceof Set?n.layers:Array.isArray(n.layers)?new Set(n.layers):null,T=Object.assign(Object.assign({},n),{layers:b});for(const E in this.sourceCaches)n.layers&&!u[E]||m.push(vi(this.sourceCaches[E],this._layers,y,e,T,l));return this.placement&&m.push(function(E,z,D,I,F,N,Y){const X={},K=N.queryRenderedSymbols(I),J=[];for(const re of Object.keys(K).map(Number))J.push(Y[re]);J.sort(Di);for(const re of J){const ae=re.featureIndex.lookupSymbolFeatures(K[re.bucketInstanceId],z,re.bucketIndex,re.sourceLayerIndex,F.filter,F.layers,F.availableImages,E);for(const oe in ae){const he=X[oe]=X[oe]||[],ce=ae[oe];ce.sort((we,Me)=>{const ke=re.featureSortOrder;if(ke){const Le=ke.indexOf(we.featureIndex);return ke.indexOf(Me.featureIndex)-Le}return Me.featureIndex-we.featureIndex});for(const we of ce)he.push(we)}}return function(re,ae,oe){for(const he in re)for(const ce of re[he])Hi(ce,oe[ae[he].source]);return re}(X,E,D)}(this._layers,y,this.sourceCaches,e,T,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(m)}querySourceFeatures(e,n){n&&n.filter&&this._validate(d.y.filter,"querySourceFeatures.filter",n.filter,null,n);const l=this.sourceCaches[e];return l?function(u,m){const y=u.getRenderableIds().map(E=>u.getTileByID(E)),b=[],T={};for(let E=0;E<y.length;E++){const z=y[E],D=z.tileID.canonical.key;T[D]||(T[D]=!0,z.querySourceFeatures(b,m))}return b}(l,n):[]}getLight(){return this.light.getLight()}setLight(e,n={}){this._checkLoaded();const l=this.light.getLight();let u=!1;for(const y in e)if(!d.bB(e[y],l[y])){u=!0;break}if(!u)return;const m={now:at.now(),transition:d.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,n),this.light.updateTransitions(m)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,n={}){this._checkLoaded();const l=this.getSky();let u=!1;if(!e&&!l)return;if(e&&!l)u=!0;else if(!e&&l)u=!0;else for(const y in e)if(!d.bB(e[y],l[y])){u=!0;break}if(!u)return;const m={now:at.now(),transition:d.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,n),this.sky.updateTransitions(m)}_setProjectionInternal(e){const n=function(l){if(Array.isArray(l)){const u=new Vo({type:l});return{projection:u,transform:new Lc,cameraHelper:new Bc(u)}}switch(l){case"mercator":return{projection:new Ac,transform:new Wn,cameraHelper:new _r};case"globe":{const u=new Vo({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:u,transform:new Lc,cameraHelper:new Bc(u)}}case"vertical-perspective":return{projection:new Za,transform:new kc,cameraHelper:new Cr};default:return d.w(`Unknown projection name: ${l}. Falling back to mercator projection.`),{projection:new Ac,transform:new Wn,cameraHelper:new _r}}}(e);this.projection=n.projection,this.map.migrateProjection(n.transform,n.cameraHelper);for(const l in this.sourceCaches)this.sourceCaches[l].reload()}_validate(e,n,l,u,m={}){return(!m||m.validate!==!1)&&cs(this,e.call(d.y,d.e({key:n,style:this.serialize(),value:l,styleSpec:d.v},u)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),ia().off(Oo,this._rtlPluginLoaded);for(const n in this._layers)this._layers[n].setEventedParent(null);for(const n in this.sourceCaches){const l=this.sourceCaches[n];l.setEventedParent(null),l.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const n in this.sourceCaches)this.sourceCaches[n].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,n,l,u,m=!1){let y=!1,b=!1;const T={};for(const E of this._order){const z=this._layers[E];if(z.type!=="symbol")continue;if(!T[z.source]){const I=this.sourceCaches[z.source];T[z.source]=I.getRenderableIds(!0).map(F=>I.getTileByID(F)).sort((F,N)=>N.tileID.overscaledZ-F.tileID.overscaledZ||(F.tileID.isLessThan(N.tileID)?-1:1))}const D=this.crossTileSymbolIndex.addLayer(z,T[z.source],e.center.lng);y=y||D}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((m=m||this._layerOrderChanged||l===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(at.now(),e.zoom))&&(this.pauseablePlacement=new ba(e,this.map.terrain,this._order,m,n,l,u,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,T),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(at.now()),b=!0),y&&this.pauseablePlacement.placement.setStale()),b||y)for(const E of this._order){const z=this._layers[E];z.type==="symbol"&&this.placement.updateLayerOpacities(z,T[z.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(at.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,n){return d._(this,void 0,void 0,function*(){const l=yield this.imageManager.getImages(n.icons);this._updateTilesForChangedImages();const u=this.sourceCaches[n.source];return u&&u.setDependencies(n.tileID.key,n.type,n.icons),l})}getGlyphs(e,n){return d._(this,void 0,void 0,function*(){const l=yield this.glyphManager.getGlyphs(n.stacks),u=this.sourceCaches[n.source];return u&&u.setDependencies(n.tileID.key,n.type,[""]),l})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,n={}){this._checkLoaded(),e&&this._validate(d.y.glyphs,"glyphs",e,null,n)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,n,l={},u){this._checkLoaded();const m=[{id:e,url:n}],y=[...Jt(this.stylesheet.sprite),...m];this._validate(d.y.sprite,"sprite",y,null,l)||(this.stylesheet.sprite=y,this._loadSprite(m,!0,u))}removeSprite(e){this._checkLoaded();const n=Jt(this.stylesheet.sprite);if(n.find(l=>l.id===e)){if(this._spritesImagesIds[e])for(const l of this._spritesImagesIds[e])this.imageManager.removeImage(l),this._changedImages[l]=!0;n.splice(n.findIndex(l=>l.id===e),1),this.stylesheet.sprite=n.length>0?n:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.l("data",{dataType:"style"}))}else this.fire(new d.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return Jt(this.stylesheet.sprite)}setSprite(e,n={},l){this._checkLoaded(),e&&this._validate(d.y.sprite,"sprite",e,null,n)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,l):(this._unloadSprite(),l&&l(null)))}}var Ga=d.aC([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class zh{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,n,l,u,m,y,b,T,E){this.context=e;let z=this.boundPaintVertexBuffers.length!==u.length;for(let D=0;!z&&D<u.length;D++)this.boundPaintVertexBuffers[D]!==u[D]&&(z=!0);!this.vao||this.boundProgram!==n||this.boundLayoutVertexBuffer!==l||z||this.boundIndexBuffer!==m||this.boundVertexOffset!==y||this.boundDynamicVertexBuffer!==b||this.boundDynamicVertexBuffer2!==T||this.boundDynamicVertexBuffer3!==E?this.freshBind(n,l,u,m,y,b,T,E):(e.bindVertexArray.set(this.vao),b&&b.bind(),m&&m.dynamicDraw&&m.bind(),T&&T.bind(),E&&E.bind())}freshBind(e,n,l,u,m,y,b,T){const E=e.numAttributes,z=this.context,D=z.gl;this.vao&&this.destroy(),this.vao=z.createVertexArray(),z.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=n,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=u,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=y,this.boundDynamicVertexBuffer2=b,this.boundDynamicVertexBuffer3=T,n.enableAttributes(D,e);for(const I of l)I.enableAttributes(D,e);y&&y.enableAttributes(D,e),b&&b.enableAttributes(D,e),T&&T.enableAttributes(D,e),n.bind(),n.setVertexAttribPointers(D,e,m);for(const I of l)I.bind(),I.setVertexAttribPointers(D,e,m);y&&(y.bind(),y.setVertexAttribPointers(D,e,m)),u&&u.bind(),b&&(b.bind(),b.setVertexAttribPointers(D,e,m)),T&&(T.bind(),T.setVertexAttribPointers(D,e,m)),z.currentNumAttributes=E}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Lu=(f,e,n,l,u)=>({u_texture:0,u_ele_delta:f,u_fog_matrix:e,u_fog_color:n?n.properties.get("fog-color"):d.b6.white,u_fog_ground_blend:n?n.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:u?0:n?n.calculateFogBlendOpacity(l):0,u_horizon_color:n?n.properties.get("horizon-color"):d.b6.white,u_horizon_fog_blend:n?n.properties.get("horizon-fog-blend"):1,u_is_globe_mode:u?1:0}),Ol={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function As(f){const e=[];for(let n=0;n<f.length;n++){if(f[n]===null)continue;const l=f[n].split(" ");e.push(l.pop())}return e}class Md{constructor(e,n,l,u,m,y,b,T){const E=e.gl;this.program=E.createProgram();const z=As(n.staticAttributes),D=l?l.getBinderAttributes():[],I=z.concat(D),F=wa.prelude.staticUniforms?As(wa.prelude.staticUniforms):[],N=b.staticUniforms?As(b.staticUniforms):[],Y=n.staticUniforms?As(n.staticUniforms):[],X=l?l.getBinderUniforms():[],K=F.concat(N).concat(Y).concat(X),J=[];for(const Me of K)J.indexOf(Me)<0&&J.push(Me);const re=l?l.defines():[];yr(E)&&re.unshift("#version 300 es"),m&&re.push("#define OVERDRAW_INSPECTOR;"),y&&re.push("#define TERRAIN3D;"),T&&re.push(T);let ae=re.concat(wa.prelude.fragmentSource,b.fragmentSource,n.fragmentSource).join(`
`),oe=re.concat(wa.prelude.vertexSource,b.vertexSource,n.vertexSource).join(`
`);yr(E)||(ae=function(Me){return Me.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(ae),oe=function(Me){return Me.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(oe));const he=E.createShader(E.FRAGMENT_SHADER);if(E.isContextLost())return void(this.failedToCreate=!0);if(E.shaderSource(he,ae),E.compileShader(he),!E.getShaderParameter(he,E.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${E.getShaderInfoLog(he)}`);E.attachShader(this.program,he);const ce=E.createShader(E.VERTEX_SHADER);if(E.isContextLost())return void(this.failedToCreate=!0);if(E.shaderSource(ce,oe),E.compileShader(ce),!E.getShaderParameter(ce,E.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${E.getShaderInfoLog(ce)}`);E.attachShader(this.program,ce),this.attributes={};const we={};this.numAttributes=I.length;for(let Me=0;Me<this.numAttributes;Me++)I[Me]&&(E.bindAttribLocation(this.program,Me,I[Me]),this.attributes[I[Me]]=Me);if(E.linkProgram(this.program),!E.getProgramParameter(this.program,E.LINK_STATUS))throw new Error(`Program failed to link: ${E.getProgramInfoLog(this.program)}`);E.deleteShader(ce),E.deleteShader(he);for(let Me=0;Me<J.length;Me++){const ke=J[Me];if(ke&&!we[ke]){const Le=E.getUniformLocation(this.program,ke);Le&&(we[ke]=Le)}}this.fixedUniforms=u(e,we),this.terrainUniforms=((Me,ke)=>({u_depth:new d.bE(Me,ke.u_depth),u_terrain:new d.bE(Me,ke.u_terrain),u_terrain_dim:new d.b7(Me,ke.u_terrain_dim),u_terrain_matrix:new d.bG(Me,ke.u_terrain_matrix),u_terrain_unpack:new d.bH(Me,ke.u_terrain_unpack),u_terrain_exaggeration:new d.b7(Me,ke.u_terrain_exaggeration)}))(e,we),this.projectionUniforms=((Me,ke)=>({u_projection_matrix:new d.bG(Me,ke.u_projection_matrix),u_projection_tile_mercator_coords:new d.bH(Me,ke.u_projection_tile_mercator_coords),u_projection_clipping_plane:new d.bH(Me,ke.u_projection_clipping_plane),u_projection_transition:new d.b7(Me,ke.u_projection_transition),u_projection_fallback_matrix:new d.bG(Me,ke.u_projection_fallback_matrix)}))(e,we),this.binderUniforms=l?l.getUniforms(e,we):[]}draw(e,n,l,u,m,y,b,T,E,z,D,I,F,N,Y,X,K,J,re){const ae=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(l),e.setStencilMode(u),e.setColorMode(m),e.setCullFace(y),T){e.activeTexture.set(ae.TEXTURE2),ae.bindTexture(ae.TEXTURE_2D,T.depthTexture),e.activeTexture.set(ae.TEXTURE3),ae.bindTexture(ae.TEXTURE_2D,T.texture);for(const he in this.terrainUniforms)this.terrainUniforms[he].set(T[he])}if(E)for(const he in E)this.projectionUniforms[Ol[he]].set(E[he]);if(b)for(const he in this.fixedUniforms)this.fixedUniforms[he].set(b[he]);X&&X.setUniforms(e,this.binderUniforms,N,{zoom:Y});let oe=0;switch(n){case ae.LINES:oe=2;break;case ae.TRIANGLES:oe=3;break;case ae.LINE_STRIP:oe=1}for(const he of F.get()){const ce=he.vaos||(he.vaos={});(ce[z]||(ce[z]=new zh)).bind(e,this,D,X?X.getPaintVertexBuffers():[],I,he.vertexOffset,K,J,re),ae.drawElements(n,he.primitiveLength*oe,ae.UNSIGNED_SHORT,he.primitiveOffset*oe*2)}}}function jl(f,e,n){const l=1/d.av(n,1,e.transform.tileZoom),u=Math.pow(2,n.tileID.overscaledZ),m=n.tileSize*Math.pow(2,e.transform.tileZoom)/u,y=m*(n.tileID.canonical.x+n.tileID.wrap*u),b=m*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[l,f.fromScale,f.toScale],u_fade:f.t,u_pixel_coord_upper:[y>>16,b>>16],u_pixel_coord_lower:[65535&y,65535&b]}}const Ph=(f,e,n,l)=>{const u=f.style.light,m=u.properties.get("position"),y=[m.x,m.y,m.z],b=d.bK();u.properties.get("anchor")==="viewport"&&d.bL(b,f.transform.bearingInRadians),d.bM(y,y,b);const T=f.transform.transformLightDirection(y),E=u.properties.get("color");return{u_lightpos:y,u_lightpos_globe:T,u_lightintensity:u.properties.get("intensity"),u_lightcolor:[E.r,E.g,E.b],u_vertical_gradient:+e,u_opacity:n,u_fill_translate:l}},Zo=(f,e,n,l,u,m,y)=>d.e(Ph(f,e,n,l),jl(m,f,y),{u_height_factor:-Math.pow(2,u.overscaledZ)/y.tileSize/8}),Dh=(f,e,n,l)=>d.e(jl(e,f,n),{u_fill_translate:l}),Ih=(f,e)=>({u_world:f,u_fill_translate:e}),Bu=(f,e,n,l,u)=>d.e(Dh(f,e,n,u),{u_world:l}),Go=(f,e,n,l,u)=>{const m=f.transform;let y,b,T=0;if(n.paint.get("circle-pitch-alignment")==="map"){const E=d.av(e,1,m.zoom);y=!0,b=[E,E],T=E/(d.Z*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*u}else y=!1,b=m.pixelsToGLUnits;return{u_camera_to_center_distance:m.cameraToCenterDistance,u_scale_with_map:+(n.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+y,u_device_pixel_ratio:f.pixelRatio,u_extrude_scale:b,u_globe_extrude_scale:T,u_translate:l}},Ou=f=>({u_pixel_extrude_scale:[1/f.width,1/f.height]}),ju=f=>({u_viewport_size:[f.width,f.height]}),Oc=(f,e=1)=>({u_color:f,u_overlay:0,u_overlay_scale:e}),jc=(f,e,n,l)=>{const u=d.av(f,1,e)/(d.Z*Math.pow(2,f.tileID.overscaledZ))*2*Math.PI*l;return{u_extrude_scale:d.av(f,1,e),u_intensity:n,u_globe_extrude_scale:u}},Fc=(f,e,n,l)=>{const u=d.K();d.bN(u,0,f.width,f.height,0,0,1);const m=f.context.gl;return{u_matrix:u,u_world:[m.drawingBufferWidth,m.drawingBufferHeight],u_image:n,u_color_ramp:l,u_opacity:e.paint.get("heatmap-opacity")}},zs=(f,e,n)=>{const l=n.paint.get("hillshade-shadow-color"),u=n.paint.get("hillshade-highlight-color"),m=n.paint.get("hillshade-accent-color");let y=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);return n.paint.get("hillshade-illumination-anchor")==="viewport"&&(y+=f.transform.bearingInRadians),{u_image:0,u_latrange:Rh(0,e.tileID),u_light:[n.paint.get("hillshade-exaggeration"),y],u_shadow:l,u_highlight:u,u_accent:m}},so=(f,e)=>{const n=e.stride,l=d.K();return d.bN(l,0,d.Z,-8192,0,0,1),d.L(l,l,[0,-8192,0]),{u_matrix:l,u_image:1,u_dimension:[n,n],u_zoom:f.overscaledZ,u_unpack:e.getUnpackVector()}};function Rh(f,e){const n=Math.pow(2,e.canonical.z),l=e.canonical.y;return[new d.$(0,l/n).toLngLat().lat,new d.$(0,(l+1)/n).toLngLat().lat]}const oo=(f,e,n,l)=>{const u=f.transform;return{u_translation:lo(f,e,n),u_ratio:l/d.av(e,1,u.zoom),u_device_pixel_ratio:f.pixelRatio,u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]]}},Ed=(f,e,n,l,u)=>d.e(oo(f,e,n,l),{u_image:0,u_image_height:u}),Fl=(f,e,n,l,u)=>{const m=f.transform,y=qo(e,m);return{u_translation:lo(f,e,n),u_texsize:e.imageAtlasTexture.size,u_ratio:l/d.av(e,1,m.zoom),u_device_pixel_ratio:f.pixelRatio,u_image:0,u_scale:[y,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},kh=(f,e,n,l,u,m)=>{const y=f.lineAtlas,b=qo(e,f.transform),T=n.layout.get("line-cap")==="round",E=y.getDash(u.from,T),z=y.getDash(u.to,T),D=E.width*m.fromScale,I=z.width*m.toScale;return d.e(oo(f,e,n,l),{u_patternscale_a:[b/D,-E.height/2],u_patternscale_b:[b/I,-z.height/2],u_sdfgamma:y.width/(256*Math.min(D,I)*f.pixelRatio)/2,u_image:0,u_tex_y_a:E.y,u_tex_y_b:z.y,u_mix:m.t})};function qo(f,e){return 1/d.av(f,1,e.tileZoom)}function lo(f,e,n){return d.aw(f.transform,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}const Lh=(f,e,n,l,u)=>{return{u_tl_parent:f,u_scale_parent:e,u_buffer_scale:1,u_fade_t:n.mix,u_opacity:n.opacity*l.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:l.paint.get("raster-brightness-min"),u_brightness_high:l.paint.get("raster-brightness-max"),u_saturation_factor:(y=l.paint.get("raster-saturation"),y>0?1-1/(1.001-y):-y),u_contrast_factor:(m=l.paint.get("raster-contrast"),m>0?1/(1-m):1+m),u_spin_weights:Nl(l.paint.get("raster-hue-rotate")),u_coords_top:[u[0].x,u[0].y,u[1].x,u[1].y],u_coords_bottom:[u[3].x,u[3].y,u[2].x,u[2].y]};var m,y};function Nl(f){f*=Math.PI/180;const e=Math.sin(f),n=Math.cos(f);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}const Ul=(f,e,n,l,u,m,y,b,T,E,z,D,I)=>{const F=y.transform;return{u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:F.cameraToCenterDistance,u_pitch:F.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:F.width/F.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_label_plane_matrix:b,u_coord_matrix:T,u_is_text:+z,u_pitch_with_map:+l,u_is_along_line:u,u_is_variable_anchor:m,u_texsize:D,u_texture:0,u_translation:E,u_pitched_scale:I}},Nc=(f,e,n,l,u,m,y,b,T,E,z,D,I,F)=>{const N=y.transform;return d.e(Ul(f,e,n,l,u,m,y,b,T,E,z,D,F),{u_gamma_scale:l?Math.cos(N.pitch*Math.PI/180)*N.cameraToCenterDistance:1,u_device_pixel_ratio:y.pixelRatio,u_is_halo:1})},Ho=(f,e,n,l,u,m,y,b,T,E,z,D,I)=>d.e(Nc(f,e,n,l,u,m,y,b,T,E,!0,z,0,I),{u_texsize_icon:D,u_texture_icon:1}),Sa=(f,e)=>({u_opacity:f,u_color:e}),Uc=(f,e,n,l,u)=>d.e(function(m,y,b,T){const E=b.imageManager.getPattern(m.from.toString()),z=b.imageManager.getPattern(m.to.toString()),{width:D,height:I}=b.imageManager.getPixelSize(),F=Math.pow(2,T.tileID.overscaledZ),N=T.tileSize*Math.pow(2,b.transform.tileZoom)/F,Y=N*(T.tileID.canonical.x+T.tileID.wrap*F),X=N*T.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:E.tl,u_pattern_br_a:E.br,u_pattern_tl_b:z.tl,u_pattern_br_b:z.br,u_texsize:[D,I],u_mix:y.t,u_pattern_size_a:E.displaySize,u_pattern_size_b:z.displaySize,u_scale_a:y.fromScale,u_scale_b:y.toScale,u_tile_units_to_pixels:1/d.av(T,1,b.transform.tileZoom),u_pixel_coord_upper:[Y>>16,X>>16],u_pixel_coord_lower:[65535&Y,65535&X]}}(n,u,e,l),{u_opacity:f}),Vl=(f,e)=>{},Vc={fillExtrusion:(f,e)=>({u_lightpos:new d.bI(f,e.u_lightpos),u_lightpos_globe:new d.bI(f,e.u_lightpos_globe),u_lightintensity:new d.b7(f,e.u_lightintensity),u_lightcolor:new d.bI(f,e.u_lightcolor),u_vertical_gradient:new d.b7(f,e.u_vertical_gradient),u_opacity:new d.b7(f,e.u_opacity),u_fill_translate:new d.bJ(f,e.u_fill_translate)}),fillExtrusionPattern:(f,e)=>({u_lightpos:new d.bI(f,e.u_lightpos),u_lightpos_globe:new d.bI(f,e.u_lightpos_globe),u_lightintensity:new d.b7(f,e.u_lightintensity),u_lightcolor:new d.bI(f,e.u_lightcolor),u_vertical_gradient:new d.b7(f,e.u_vertical_gradient),u_height_factor:new d.b7(f,e.u_height_factor),u_opacity:new d.b7(f,e.u_opacity),u_fill_translate:new d.bJ(f,e.u_fill_translate),u_image:new d.bE(f,e.u_image),u_texsize:new d.bJ(f,e.u_texsize),u_pixel_coord_upper:new d.bJ(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new d.bJ(f,e.u_pixel_coord_lower),u_scale:new d.bI(f,e.u_scale),u_fade:new d.b7(f,e.u_fade)}),fill:(f,e)=>({u_fill_translate:new d.bJ(f,e.u_fill_translate)}),fillPattern:(f,e)=>({u_image:new d.bE(f,e.u_image),u_texsize:new d.bJ(f,e.u_texsize),u_pixel_coord_upper:new d.bJ(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new d.bJ(f,e.u_pixel_coord_lower),u_scale:new d.bI(f,e.u_scale),u_fade:new d.b7(f,e.u_fade),u_fill_translate:new d.bJ(f,e.u_fill_translate)}),fillOutline:(f,e)=>({u_world:new d.bJ(f,e.u_world),u_fill_translate:new d.bJ(f,e.u_fill_translate)}),fillOutlinePattern:(f,e)=>({u_world:new d.bJ(f,e.u_world),u_image:new d.bE(f,e.u_image),u_texsize:new d.bJ(f,e.u_texsize),u_pixel_coord_upper:new d.bJ(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new d.bJ(f,e.u_pixel_coord_lower),u_scale:new d.bI(f,e.u_scale),u_fade:new d.b7(f,e.u_fade),u_fill_translate:new d.bJ(f,e.u_fill_translate)}),circle:(f,e)=>({u_camera_to_center_distance:new d.b7(f,e.u_camera_to_center_distance),u_scale_with_map:new d.bE(f,e.u_scale_with_map),u_pitch_with_map:new d.bE(f,e.u_pitch_with_map),u_extrude_scale:new d.bJ(f,e.u_extrude_scale),u_device_pixel_ratio:new d.b7(f,e.u_device_pixel_ratio),u_globe_extrude_scale:new d.b7(f,e.u_globe_extrude_scale),u_translate:new d.bJ(f,e.u_translate)}),collisionBox:(f,e)=>({u_pixel_extrude_scale:new d.bJ(f,e.u_pixel_extrude_scale)}),collisionCircle:(f,e)=>({u_viewport_size:new d.bJ(f,e.u_viewport_size)}),debug:(f,e)=>({u_color:new d.bF(f,e.u_color),u_overlay:new d.bE(f,e.u_overlay),u_overlay_scale:new d.b7(f,e.u_overlay_scale)}),depth:Vl,clippingMask:Vl,heatmap:(f,e)=>({u_extrude_scale:new d.b7(f,e.u_extrude_scale),u_intensity:new d.b7(f,e.u_intensity),u_globe_extrude_scale:new d.b7(f,e.u_globe_extrude_scale)}),heatmapTexture:(f,e)=>({u_matrix:new d.bG(f,e.u_matrix),u_world:new d.bJ(f,e.u_world),u_image:new d.bE(f,e.u_image),u_color_ramp:new d.bE(f,e.u_color_ramp),u_opacity:new d.b7(f,e.u_opacity)}),hillshade:(f,e)=>({u_image:new d.bE(f,e.u_image),u_latrange:new d.bJ(f,e.u_latrange),u_light:new d.bJ(f,e.u_light),u_shadow:new d.bF(f,e.u_shadow),u_highlight:new d.bF(f,e.u_highlight),u_accent:new d.bF(f,e.u_accent)}),hillshadePrepare:(f,e)=>({u_matrix:new d.bG(f,e.u_matrix),u_image:new d.bE(f,e.u_image),u_dimension:new d.bJ(f,e.u_dimension),u_zoom:new d.b7(f,e.u_zoom),u_unpack:new d.bH(f,e.u_unpack)}),line:(f,e)=>({u_translation:new d.bJ(f,e.u_translation),u_ratio:new d.b7(f,e.u_ratio),u_device_pixel_ratio:new d.b7(f,e.u_device_pixel_ratio),u_units_to_pixels:new d.bJ(f,e.u_units_to_pixels)}),lineGradient:(f,e)=>({u_translation:new d.bJ(f,e.u_translation),u_ratio:new d.b7(f,e.u_ratio),u_device_pixel_ratio:new d.b7(f,e.u_device_pixel_ratio),u_units_to_pixels:new d.bJ(f,e.u_units_to_pixels),u_image:new d.bE(f,e.u_image),u_image_height:new d.b7(f,e.u_image_height)}),linePattern:(f,e)=>({u_translation:new d.bJ(f,e.u_translation),u_texsize:new d.bJ(f,e.u_texsize),u_ratio:new d.b7(f,e.u_ratio),u_device_pixel_ratio:new d.b7(f,e.u_device_pixel_ratio),u_image:new d.bE(f,e.u_image),u_units_to_pixels:new d.bJ(f,e.u_units_to_pixels),u_scale:new d.bI(f,e.u_scale),u_fade:new d.b7(f,e.u_fade)}),lineSDF:(f,e)=>({u_translation:new d.bJ(f,e.u_translation),u_ratio:new d.b7(f,e.u_ratio),u_device_pixel_ratio:new d.b7(f,e.u_device_pixel_ratio),u_units_to_pixels:new d.bJ(f,e.u_units_to_pixels),u_patternscale_a:new d.bJ(f,e.u_patternscale_a),u_patternscale_b:new d.bJ(f,e.u_patternscale_b),u_sdfgamma:new d.b7(f,e.u_sdfgamma),u_image:new d.bE(f,e.u_image),u_tex_y_a:new d.b7(f,e.u_tex_y_a),u_tex_y_b:new d.b7(f,e.u_tex_y_b),u_mix:new d.b7(f,e.u_mix)}),raster:(f,e)=>({u_tl_parent:new d.bJ(f,e.u_tl_parent),u_scale_parent:new d.b7(f,e.u_scale_parent),u_buffer_scale:new d.b7(f,e.u_buffer_scale),u_fade_t:new d.b7(f,e.u_fade_t),u_opacity:new d.b7(f,e.u_opacity),u_image0:new d.bE(f,e.u_image0),u_image1:new d.bE(f,e.u_image1),u_brightness_low:new d.b7(f,e.u_brightness_low),u_brightness_high:new d.b7(f,e.u_brightness_high),u_saturation_factor:new d.b7(f,e.u_saturation_factor),u_contrast_factor:new d.b7(f,e.u_contrast_factor),u_spin_weights:new d.bI(f,e.u_spin_weights),u_coords_top:new d.bH(f,e.u_coords_top),u_coords_bottom:new d.bH(f,e.u_coords_bottom)}),symbolIcon:(f,e)=>({u_is_size_zoom_constant:new d.bE(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new d.bE(f,e.u_is_size_feature_constant),u_size_t:new d.b7(f,e.u_size_t),u_size:new d.b7(f,e.u_size),u_camera_to_center_distance:new d.b7(f,e.u_camera_to_center_distance),u_pitch:new d.b7(f,e.u_pitch),u_rotate_symbol:new d.bE(f,e.u_rotate_symbol),u_aspect_ratio:new d.b7(f,e.u_aspect_ratio),u_fade_change:new d.b7(f,e.u_fade_change),u_label_plane_matrix:new d.bG(f,e.u_label_plane_matrix),u_coord_matrix:new d.bG(f,e.u_coord_matrix),u_is_text:new d.bE(f,e.u_is_text),u_pitch_with_map:new d.bE(f,e.u_pitch_with_map),u_is_along_line:new d.bE(f,e.u_is_along_line),u_is_variable_anchor:new d.bE(f,e.u_is_variable_anchor),u_texsize:new d.bJ(f,e.u_texsize),u_texture:new d.bE(f,e.u_texture),u_translation:new d.bJ(f,e.u_translation),u_pitched_scale:new d.b7(f,e.u_pitched_scale)}),symbolSDF:(f,e)=>({u_is_size_zoom_constant:new d.bE(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new d.bE(f,e.u_is_size_feature_constant),u_size_t:new d.b7(f,e.u_size_t),u_size:new d.b7(f,e.u_size),u_camera_to_center_distance:new d.b7(f,e.u_camera_to_center_distance),u_pitch:new d.b7(f,e.u_pitch),u_rotate_symbol:new d.bE(f,e.u_rotate_symbol),u_aspect_ratio:new d.b7(f,e.u_aspect_ratio),u_fade_change:new d.b7(f,e.u_fade_change),u_label_plane_matrix:new d.bG(f,e.u_label_plane_matrix),u_coord_matrix:new d.bG(f,e.u_coord_matrix),u_is_text:new d.bE(f,e.u_is_text),u_pitch_with_map:new d.bE(f,e.u_pitch_with_map),u_is_along_line:new d.bE(f,e.u_is_along_line),u_is_variable_anchor:new d.bE(f,e.u_is_variable_anchor),u_texsize:new d.bJ(f,e.u_texsize),u_texture:new d.bE(f,e.u_texture),u_gamma_scale:new d.b7(f,e.u_gamma_scale),u_device_pixel_ratio:new d.b7(f,e.u_device_pixel_ratio),u_is_halo:new d.bE(f,e.u_is_halo),u_translation:new d.bJ(f,e.u_translation),u_pitched_scale:new d.b7(f,e.u_pitched_scale)}),symbolTextAndIcon:(f,e)=>({u_is_size_zoom_constant:new d.bE(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new d.bE(f,e.u_is_size_feature_constant),u_size_t:new d.b7(f,e.u_size_t),u_size:new d.b7(f,e.u_size),u_camera_to_center_distance:new d.b7(f,e.u_camera_to_center_distance),u_pitch:new d.b7(f,e.u_pitch),u_rotate_symbol:new d.bE(f,e.u_rotate_symbol),u_aspect_ratio:new d.b7(f,e.u_aspect_ratio),u_fade_change:new d.b7(f,e.u_fade_change),u_label_plane_matrix:new d.bG(f,e.u_label_plane_matrix),u_coord_matrix:new d.bG(f,e.u_coord_matrix),u_is_text:new d.bE(f,e.u_is_text),u_pitch_with_map:new d.bE(f,e.u_pitch_with_map),u_is_along_line:new d.bE(f,e.u_is_along_line),u_is_variable_anchor:new d.bE(f,e.u_is_variable_anchor),u_texsize:new d.bJ(f,e.u_texsize),u_texsize_icon:new d.bJ(f,e.u_texsize_icon),u_texture:new d.bE(f,e.u_texture),u_texture_icon:new d.bE(f,e.u_texture_icon),u_gamma_scale:new d.b7(f,e.u_gamma_scale),u_device_pixel_ratio:new d.b7(f,e.u_device_pixel_ratio),u_is_halo:new d.bE(f,e.u_is_halo),u_translation:new d.bJ(f,e.u_translation),u_pitched_scale:new d.b7(f,e.u_pitched_scale)}),background:(f,e)=>({u_opacity:new d.b7(f,e.u_opacity),u_color:new d.bF(f,e.u_color)}),backgroundPattern:(f,e)=>({u_opacity:new d.b7(f,e.u_opacity),u_image:new d.bE(f,e.u_image),u_pattern_tl_a:new d.bJ(f,e.u_pattern_tl_a),u_pattern_br_a:new d.bJ(f,e.u_pattern_br_a),u_pattern_tl_b:new d.bJ(f,e.u_pattern_tl_b),u_pattern_br_b:new d.bJ(f,e.u_pattern_br_b),u_texsize:new d.bJ(f,e.u_texsize),u_mix:new d.b7(f,e.u_mix),u_pattern_size_a:new d.bJ(f,e.u_pattern_size_a),u_pattern_size_b:new d.bJ(f,e.u_pattern_size_b),u_scale_a:new d.b7(f,e.u_scale_a),u_scale_b:new d.b7(f,e.u_scale_b),u_pixel_coord_upper:new d.bJ(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new d.bJ(f,e.u_pixel_coord_lower),u_tile_units_to_pixels:new d.b7(f,e.u_tile_units_to_pixels)}),terrain:(f,e)=>({u_texture:new d.bE(f,e.u_texture),u_ele_delta:new d.b7(f,e.u_ele_delta),u_fog_matrix:new d.bG(f,e.u_fog_matrix),u_fog_color:new d.bF(f,e.u_fog_color),u_fog_ground_blend:new d.b7(f,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new d.b7(f,e.u_fog_ground_blend_opacity),u_horizon_color:new d.bF(f,e.u_horizon_color),u_horizon_fog_blend:new d.b7(f,e.u_horizon_fog_blend),u_is_globe_mode:new d.b7(f,e.u_is_globe_mode)}),terrainDepth:(f,e)=>({u_ele_delta:new d.b7(f,e.u_ele_delta)}),terrainCoords:(f,e)=>({u_texture:new d.bE(f,e.u_texture),u_terrain_coords_id:new d.b7(f,e.u_terrain_coords_id),u_ele_delta:new d.b7(f,e.u_ele_delta)}),projectionErrorMeasurement:(f,e)=>({u_input:new d.b7(f,e.u_input),u_output_expected:new d.b7(f,e.u_output_expected)}),atmosphere:(f,e)=>({u_sun_pos:new d.bI(f,e.u_sun_pos),u_atmosphere_blend:new d.b7(f,e.u_atmosphere_blend),u_globe_position:new d.bI(f,e.u_globe_position),u_globe_radius:new d.b7(f,e.u_globe_radius),u_inv_proj_matrix:new d.bG(f,e.u_inv_proj_matrix)}),sky:(f,e)=>({u_sky_color:new d.bF(f,e.u_sky_color),u_horizon_color:new d.bF(f,e.u_horizon_color),u_horizon:new d.bJ(f,e.u_horizon),u_horizon_normal:new d.bJ(f,e.u_horizon_normal),u_sky_horizon_blend:new d.b7(f,e.u_sky_horizon_blend),u_sky_blend:new d.b7(f,e.u_sky_blend)})};class Bh{constructor(e,n,l){this.context=e;const u=e.gl;this.buffer=u.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),u.bufferData(u.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const n=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),n.bufferSubData(n.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Fu={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class co{constructor(e,n,l,u){this.length=n.length,this.attributes=l,this.itemSize=n.bytesPerElement,this.dynamicDraw=u,this.context=e;const m=e.gl;this.buffer=m.createBuffer(),e.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const n=this.context.gl;this.bind(),n.bufferSubData(n.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,n){for(let l=0;l<this.attributes.length;l++){const u=n.attributes[this.attributes[l].name];u!==void 0&&e.enableVertexAttribArray(u)}}setVertexAttribPointers(e,n,l){for(let u=0;u<this.attributes.length;u++){const m=this.attributes[u],y=n.attributes[m.name];y!==void 0&&e.vertexAttribPointer(y,m.components,e[Fu[m.type]],!1,this.itemSize,m.offset+this.itemSize*(l||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class si{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Cd extends si{getDefault(){return d.b6.transparent}set(e){const n=this.current;(e.r!==n.r||e.g!==n.g||e.b!==n.b||e.a!==n.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Gr extends si{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Zl extends si{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Oh extends si{getDefault(){return[!0,!0,!0,!0]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||e[3]!==n[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Nu extends si{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class jh extends si{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class Uu extends si{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const n=this.current;(e.func!==n.func||e.ref!==n.ref||e.mask!==n.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class $o extends si{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Zc extends si{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.STENCIL_TEST):n.disable(n.STENCIL_TEST),this.current=e,this.dirty=!1}}class Gc extends si{getDefault(){return[0,1]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Ps extends si{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.DEPTH_TEST):n.disable(n.DEPTH_TEST),this.current=e,this.dirty=!1}}class us extends si{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class qa extends si{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.BLEND):n.disable(n.BLEND),this.current=e,this.dirty=!1}}class Ar extends si{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class Vu extends si{getDefault(){return d.b6.transparent}set(e){const n=this.current;(e.r!==n.r||e.g!==n.g||e.b!==n.b||e.a!==n.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Ds extends si{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class Is extends si{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE),this.current=e,this.dirty=!1}}class hs extends si{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Gl extends si{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class Ha extends si{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class Xo extends si{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class ql extends si{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||e[3]!==n[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Zu extends si{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindFramebuffer(n.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class Yo extends si{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindRenderbuffer(n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Ko extends si{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindTexture(n.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class Fh extends si{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindBuffer(n.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class qc extends si{getDefault(){return null}set(e){const n=this.gl;n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class ti extends si{getDefault(){return null}set(e){var n;if(e===this.current&&!this.dirty)return;const l=this.gl;yr(l)?l.bindVertexArray(e):(n=l.getExtension("OES_vertex_array_object"))===null||n===void 0||n.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class Hl extends si{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class Ma extends si{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class qr extends si{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class ra extends si{constructor(e,n){super(e),this.context=e,this.parent=n}getDefault(){return null}}class Gu extends ra{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class Hc extends ra{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class $l extends ra{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const $c="Framebuffer is not complete";class $a{constructor(e,n,l,u,m){this.context=e,this.width=n,this.height=l;const y=e.gl,b=this.framebuffer=y.createFramebuffer();if(this.colorAttachment=new Gu(e,b),u)this.depthAttachment=m?new $l(e,b):new Hc(e,b);else if(m)throw new Error("Stencil cannot be set without depth");if(y.checkFramebufferStatus(y.FRAMEBUFFER)!==y.FRAMEBUFFER_COMPLETE)throw new Error($c)}destroy(){const e=this.context.gl,n=this.colorAttachment.get();if(n&&e.deleteTexture(n),this.depthAttachment){const l=this.depthAttachment.get();l&&e.deleteRenderbuffer(l)}e.deleteFramebuffer(this.framebuffer)}}class Xl{constructor(e){var n,l;if(this.gl=e,this.clearColor=new Cd(this),this.clearDepth=new Gr(this),this.clearStencil=new Zl(this),this.colorMask=new Oh(this),this.depthMask=new Nu(this),this.stencilMask=new jh(this),this.stencilFunc=new Uu(this),this.stencilOp=new $o(this),this.stencilTest=new Zc(this),this.depthRange=new Gc(this),this.depthTest=new Ps(this),this.depthFunc=new us(this),this.blend=new qa(this),this.blendFunc=new Ar(this),this.blendColor=new Vu(this),this.blendEquation=new Ds(this),this.cullFace=new Is(this),this.cullFaceSide=new hs(this),this.frontFace=new Gl(this),this.program=new Ha(this),this.activeTexture=new Xo(this),this.viewport=new ql(this),this.bindFramebuffer=new Zu(this),this.bindRenderbuffer=new Yo(this),this.bindTexture=new Ko(this),this.bindVertexBuffer=new Fh(this),this.bindElementBuffer=new qc(this),this.bindVertexArray=new ti(this),this.pixelStoreUnpack=new Hl(this),this.pixelStoreUnpackPremultiplyAlpha=new Ma(this),this.pixelStoreUnpackFlipY=new qr(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),yr(e)){this.HALF_FLOAT=e.HALF_FLOAT;const u=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(n=e.RGBA16F)!==null&&n!==void 0?n:u==null?void 0:u.RGBA16F_EXT,this.RGB16F=(l=e.RGB16F)!==null&&l!==void 0?l:u==null?void 0:u.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const u=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=u==null?void 0:u.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,n){return new Bh(this,e,n)}createVertexBuffer(e,n,l){return new co(this,e,n,l)}createRenderbuffer(e,n,l){const u=this.gl,m=u.createRenderbuffer();return this.bindRenderbuffer.set(m),u.renderbufferStorage(u.RENDERBUFFER,e,n,l),this.bindRenderbuffer.set(null),m}createFramebuffer(e,n,l,u){return new $a(this,e,n,l,u)}clear({color:e,depth:n,stencil:l}){const u=this.gl;let m=0;e&&(m|=u.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),n!==void 0&&(m|=u.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),l!==void 0&&(m|=u.STENCIL_BUFFER_BIT,this.clearStencil.set(l),this.stencilMask.set(255)),u.clear(m)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){d.bB(e.blendFunction,Ti.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return yr(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var n;return yr(this.gl)?this.gl.deleteVertexArray(e):(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let Xa;function ds(f,e,n,l,u){const m=f.context,y=f.transform,b=m.gl,T=f.useProgram("collisionBox"),E=[];let z=0,D=0;for(let K=0;K<l.length;K++){const J=l[K],re=e.getTile(J).getBucket(n);if(!re)continue;const ae=u?re.textCollisionBox:re.iconCollisionBox,oe=re.collisionCircleArray;oe.length>0&&(E.push({circleArray:oe,circleOffset:D,coord:J}),z+=oe.length/4,D=z),ae&&T.draw(m,b.LINES,jt.disabled,Yt.disabled,f.colorModeForRenderPass(),Vt.disabled,Ou(f.transform),f.style.map.terrain&&f.style.map.terrain.getTerrainData(J),y.getProjectionData({overscaledTileID:J,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),n.id,ae.layoutVertexBuffer,ae.indexBuffer,ae.segments,null,f.transform.zoom,null,null,ae.collisionVertexBuffer)}if(!u||!E.length)return;const I=f.useProgram("collisionCircle"),F=new d.bO;F.resize(4*z),F._trim();let N=0;for(const K of E)for(let J=0;J<K.circleArray.length/4;J++){const re=4*J,ae=K.circleArray[re+0],oe=K.circleArray[re+1],he=K.circleArray[re+2],ce=K.circleArray[re+3];F.emplace(N++,ae,oe,he,ce,0),F.emplace(N++,ae,oe,he,ce,1),F.emplace(N++,ae,oe,he,ce,2),F.emplace(N++,ae,oe,he,ce,3)}(!Xa||Xa.length<2*z)&&(Xa=function(K){const J=2*K,re=new d.bQ;re.resize(J),re._trim();for(let ae=0;ae<J;ae++){const oe=6*ae;re.uint16[oe+0]=4*ae+0,re.uint16[oe+1]=4*ae+1,re.uint16[oe+2]=4*ae+2,re.uint16[oe+3]=4*ae+2,re.uint16[oe+4]=4*ae+3,re.uint16[oe+5]=4*ae+0}return re}(z));const Y=m.createIndexBuffer(Xa,!0),X=m.createVertexBuffer(F,d.bP.members,!0);for(const K of E){const J=ju(f.transform);I.draw(m,b.TRIANGLES,jt.disabled,Yt.disabled,f.colorModeForRenderPass(),Vt.disabled,J,f.style.map.terrain&&f.style.map.terrain.getTerrainData(K.coord),null,n.id,X,Y,d.aF.simpleSegment(0,2*K.circleOffset,K.circleArray.length,K.circleArray.length/2),null,f.transform.zoom,null,null,null)}X.destroy(),Y.destroy()}const Xc=d.as(new Float32Array(16));function Hr(f,e,n,l,u,m){const{horizontalAlign:y,verticalAlign:b}=d.aA(f);return new d.P((-(y-.5)*e/u+l[0])*m,(-(b-.5)*n/u+l[1])*m)}function fs(f,e,n,l,u,m){const y=e.tileAnchorPoint.add(new d.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let b=l.mult(m);n||(b=b.rotate(-u));const T=y.add(b);return ze(T.x,T.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(n){const b=ht(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(f),T=Math.atan(b.y/b.x)+(b.x<0?Math.PI:0);return f.add(l.rotate(T))}return f.add(l)}function ps(f,e,n,l,u,m,y,b,T,E,z,D){const I=f.text.placedSymbolArray,F=f.text.dynamicLayoutVertexArray,N=f.icon.dynamicLayoutVertexArray,Y={};F.clear();for(let X=0;X<I.length;X++){const K=I.get(X),J=K.hidden||!K.crossTileID||f.allowVerticalPlacement&&!K.placedOrientation?null:l[K.crossTileID];if(J){const re=new d.P(K.anchorX,K.anchorY),ae={getElevation:D,width:u.width,height:u.height,pitchedLabelPlaneMatrix:m,pitchWithMap:n,transform:u,tileAnchorPoint:re,translation:E,unwrappedTileID:z},oe=n?Zt(re.x,re.y,ae):ht(re.x,re.y,ae),he=ve(u.cameraToCenterDistance,oe.signedDistanceFromCamera);let ce=d.ah(f.textSizeData,b,K)*he/d.au;n&&(ce*=f.tilePixelRatio/y);const{width:we,height:Me,anchor:ke,textOffset:Le,textBoxScale:Ie}=J,et=Hr(ke,we,Me,Le,Ie,ce),We=u.getPitchedTextCorrection(re.x+E[0],re.y+E[1],z),Ge=fs(oe.point,ae,e,et,-u.bearingInRadians,We),ft=f.allowVerticalPlacement&&K.placedOrientation===d.ag.vertical?Math.PI/2:0;for(let _t=0;_t<K.numGlyphs;_t++)d.an(F,Ge,ft);T&&K.associatedIconIndex>=0&&(Y[K.associatedIconIndex]={shiftedAnchor:Ge,angle:ft})}else nn(K.numGlyphs,F)}if(T){N.clear();const X=f.icon.placedSymbolArray;for(let K=0;K<X.length;K++){const J=X.get(K);if(J.hidden)nn(J.numGlyphs,N);else{const re=Y[K];if(re)for(let ae=0;ae<J.numGlyphs;ae++)d.an(N,re.shiftedAnchor,re.angle);else nn(J.numGlyphs,N)}}f.icon.dynamicLayoutVertexBuffer.updateData(N)}f.text.dynamicLayoutVertexBuffer.updateData(F)}function Qo(f,e,n){return n.iconsInText&&e?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function Yl(f,e,n,l,u,m,y,b,T,E,z,D,I){const F=f.context,N=F.gl,Y=f.transform,X=b==="map",K=T==="map",J=b!=="viewport"&&n.layout.get("symbol-placement")!=="point",re=X&&!K&&!J,ae=!n.layout.get("symbol-sort-key").isConstant();let oe=!1;const he=f.getDepthModeForSublayer(0,jt.ReadOnly),ce=n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"),we=[],Me=Y.getCircleRadiusCorrection();for(const ke of l){const Le=e.getTile(ke),Ie=Le.getBucket(n);if(!Ie)continue;const et=u?Ie.text:Ie.icon;if(!et||!et.segments.get().length||!et.hasVisibleVertices)continue;const We=et.programConfigurations.get(n.id),Ge=u||Ie.sdfIcons,ft=u?Ie.textSizeData:Ie.iconSizeData,_t=K||Y.pitch!==0,oi=f.useProgram(Qo(Ge,u,Ie),We),Si=d.af(ft,Y.zoom),fi=f.style.map.terrain&&f.style.map.terrain.getTerrainData(ke);let _i,xi,ii,pi,kn=[0,0],Mi=null;if(u)xi=Le.glyphAtlasTexture,ii=N.LINEAR,_i=Le.glyphAtlasTexture.size,Ie.iconsInText&&(kn=Le.imageAtlasTexture.size,Mi=Le.imageAtlasTexture,pi=_t||f.options.rotating||f.options.zooming||ft.kind==="composite"||ft.kind==="camera"?N.LINEAR:N.NEAREST);else{const bi=n.layout.get("icon-size").constantOr(0)!==1||Ie.iconsNeedLinear;xi=Le.imageAtlasTexture,ii=Ge||f.options.rotating||f.options.zooming||bi||_t?N.LINEAR:N.NEAREST,_i=Le.imageAtlasTexture.size}const ki=d.av(Le,1,f.transform.zoom),Zi=Se(X,f.transform,ki),Dr=d.K();d.ai(Dr,Zi);const Pa=de(K,X,f.transform,ki),da=d.aw(Y,Le,m,y),Yr=Y.getProjectionData({overscaledTileID:ke,applyGlobeMatrix:!I,applyTerrainMatrix:!0}),Gs=ce&&Ie.hasTextData(),Da=n.layout.get("icon-text-fit")!=="none"&&Gs&&Ie.hasIconData();if(J){const bi=f.style.map.terrain?(Tn,Sn)=>f.style.map.terrain.getElevation(ke,Tn,Sn):null,mi=n.layout.get("text-rotation-alignment")==="map";xe(Ie,f,u,Zi,Dr,K,E,mi,ke.toUnwrapped(),Y.width,Y.height,da,bi)}const Qa=u&&ce||Da,Kr=J||Qa?Xc:K?Zi:f.transform.clipSpaceToPixelsMatrix,Ia=Ge&&n.paint.get(u?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let fa;fa=Ge?Ie.iconsInText?Ho(ft.kind,Si,re,K,J,Qa,f,Kr,Pa,da,_i,kn,Me):Nc(ft.kind,Si,re,K,J,Qa,f,Kr,Pa,da,u,_i,0,Me):Ul(ft.kind,Si,re,K,J,Qa,f,Kr,Pa,da,u,_i,Me);const Qr={program:oi,buffers:et,uniformValues:fa,projectionData:Yr,atlasTexture:xi,atlasTextureIcon:Mi,atlasInterpolation:ii,atlasInterpolationIcon:pi,isSDF:Ge,hasHalo:Ia};if(ae&&Ie.canOverlap){oe=!0;const bi=et.segments.get();for(const mi of bi)we.push({segments:new d.aF([mi]),sortKey:mi.sortKey,state:Qr,terrainData:fi})}else we.push({segments:et.segments,sortKey:0,state:Qr,terrainData:fi})}oe&&we.sort((ke,Le)=>ke.sortKey-Le.sortKey);for(const ke of we){const Le=ke.state;if(F.activeTexture.set(N.TEXTURE0),Le.atlasTexture.bind(Le.atlasInterpolation,N.CLAMP_TO_EDGE),Le.atlasTextureIcon&&(F.activeTexture.set(N.TEXTURE1),Le.atlasTextureIcon&&Le.atlasTextureIcon.bind(Le.atlasInterpolationIcon,N.CLAMP_TO_EDGE)),Le.isSDF){const Ie=Le.uniformValues;Le.hasHalo&&(Ie.u_is_halo=1,vr(Le.buffers,ke.segments,n,f,Le.program,he,z,D,Ie,Le.projectionData,ke.terrainData)),Ie.u_is_halo=0}vr(Le.buffers,ke.segments,n,f,Le.program,he,z,D,Le.uniformValues,Le.projectionData,ke.terrainData)}}function vr(f,e,n,l,u,m,y,b,T,E,z){const D=l.context;u.draw(D,D.gl.TRIANGLES,m,y,b,Vt.backCCW,T,z,E,n.id,f.layoutVertexBuffer,f.indexBuffer,e,n.paint,l.transform.zoom,f.programConfigurations.get(n.id),f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer)}function aa(f,e,n,l,u){const m=f.context,y=m.gl,b=Yt.disabled,T=new Ti([y.ONE,y.ONE],d.b6.transparent,[!0,!0,!0,!0]),E=e.getBucket(n);if(!E)return;const z=l.key;let D=n.heatmapFbos.get(z);D||(D=$r(m,e.tileSize,e.tileSize),n.heatmapFbos.set(z,D)),m.bindFramebuffer.set(D.framebuffer),m.viewport.set([0,0,e.tileSize,e.tileSize]),m.clear({color:d.b6.transparent});const I=E.programConfigurations.get(n.id),F=f.useProgram("heatmap",I,!u),N=f.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Y=f.style.map.terrain.getTerrainData(l);F.draw(m,y.TRIANGLES,jt.disabled,b,T,Vt.disabled,jc(e,f.transform.zoom,n.paint.get("heatmap-intensity"),1),Y,N,n.id,E.layoutVertexBuffer,E.indexBuffer,E.segments,n.paint,f.transform.zoom,I)}function Rs(f,e,n,l,u){const m=f.context,y=m.gl,b=f.transform;m.setColorMode(f.colorModeForRenderPass());const T=sa(m,e),E=n.key,z=e.heatmapFbos.get(E);if(!z)return;m.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,z.colorAttachment.get()),m.activeTexture.set(y.TEXTURE1),T.bind(y.LINEAR,y.CLAMP_TO_EDGE);const D=b.getProjectionData({overscaledTileID:n,applyTerrainMatrix:u,applyGlobeMatrix:!l});f.useProgram("heatmapTexture").draw(m,y.TRIANGLES,jt.disabled,Yt.disabled,f.colorModeForRenderPass(),Vt.disabled,Fc(f,e,0,1),null,D,e.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments,e.paint,b.zoom),z.destroy(),e.heatmapFbos.delete(E)}function $r(f,e,n){var l,u;const m=f.gl,y=m.createTexture();m.bindTexture(m.TEXTURE_2D,y),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR);const b=(l=f.HALF_FLOAT)!==null&&l!==void 0?l:m.UNSIGNED_BYTE,T=(u=f.RGBA16F)!==null&&u!==void 0?u:m.RGBA;m.texImage2D(m.TEXTURE_2D,0,T,e,n,0,m.RGBA,b,null);const E=f.createFramebuffer(e,n,!1,!1);return E.colorAttachment.set(y),E}function sa(f,e){return e.colorRampTexture||(e.colorRampTexture=new gi(f,e.colorRamp,f.gl.RGBA)),e.colorRampTexture}function ms(f,e,n,l,u){if(!n||!l||!l.imageAtlas)return;const m=l.imageAtlas.patternPositions;let y=m[n.to.toString()],b=m[n.from.toString()];if(!y&&b&&(y=b),!b&&y&&(b=y),!y||!b){const T=u.getPaintProperty(e);y=m[T],b=m[T]}y&&b&&f.setConstantPatternPositions(y,b)}function Yc(f,e,n,l,u,m,y,b){const T=f.context.gl,E="fill-pattern",z=n.paint.get(E),D=z&&z.constantOr(1),I=n.getCrossfadeParameters();let F,N,Y,X,K;const J=f.transform,re=n.paint.get("fill-translate"),ae=n.paint.get("fill-translate-anchor");y?(N=D&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",F=T.LINES):(N=D?"fillPattern":"fill",F=T.TRIANGLES);const oe=z.constantOr(null);for(const he of l){const ce=e.getTile(he);if(D&&!ce.patternsLoaded())continue;const we=ce.getBucket(n);if(!we)continue;const Me=we.programConfigurations.get(n.id),ke=f.useProgram(N,Me),Le=f.style.map.terrain&&f.style.map.terrain.getTerrainData(he);D&&(f.context.activeTexture.set(T.TEXTURE0),ce.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),Me.updatePaintBuffers(I)),ms(Me,E,oe,ce,n);const Ie=J.getProjectionData({overscaledTileID:he,applyGlobeMatrix:!b,applyTerrainMatrix:!0}),et=d.aw(J,ce,re,ae);if(y){X=we.indexBuffer2,K=we.segments2;const Ge=[T.drawingBufferWidth,T.drawingBufferHeight];Y=N==="fillOutlinePattern"&&D?Bu(f,I,ce,Ge,et):Ih(Ge,et)}else X=we.indexBuffer,K=we.segments,Y=D?Dh(f,I,ce,et):{u_fill_translate:et};let We;if(f.renderPass==="translucent"&&b){const[Ge]=f.getStencilConfigForOverlapAndUpdateStencilID(l);We=Ge[he.overscaledZ]}else We=f.stencilModeForClipping(he);ke.draw(f.context,F,u,We,m,Vt.backCCW,Y,Le,Ie,n.id,we.layoutVertexBuffer,X,K,n.paint,f.transform.zoom,Me)}}function ks(f,e,n,l,u,m,y,b){const T=f.context,E=T.gl,z="fill-extrusion-pattern",D=n.paint.get(z),I=D.constantOr(1),F=n.getCrossfadeParameters(),N=n.paint.get("fill-extrusion-opacity"),Y=D.constantOr(null),X=f.transform;for(const K of l){const J=e.getTile(K),re=J.getBucket(n);if(!re)continue;const ae=f.style.map.terrain&&f.style.map.terrain.getTerrainData(K),oe=re.programConfigurations.get(n.id),he=f.useProgram(I?"fillExtrusionPattern":"fillExtrusion",oe);I&&(f.context.activeTexture.set(E.TEXTURE0),J.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),oe.updatePaintBuffers(F));const ce=X.getProjectionData({overscaledTileID:K,applyGlobeMatrix:!b,applyTerrainMatrix:!0});ms(oe,z,Y,J,n);const we=d.aw(X,J,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),Me=n.paint.get("fill-extrusion-vertical-gradient"),ke=I?Zo(f,Me,N,we,K,F,J):Ph(f,Me,N,we);he.draw(T,T.gl.TRIANGLES,u,m,y,Vt.backCCW,ke,ae,ce,n.id,re.layoutVertexBuffer,re.indexBuffer,re.segments,n.paint,f.transform.zoom,oe,f.style.map.terrain&&re.centroidVertexBuffer)}}function uo(f,e,n,l,u,m,y,b,T){var E;const z=f.style.projection,D=f.context,I=f.transform,F=D.gl,N=f.useProgram("hillshade"),Y=!f.options.moving;for(const X of l){const K=e.getTile(X),J=K.fbo;if(!J)continue;const re=z.getMeshFromTileID(D,X.canonical,b,!0,"raster"),ae=(E=f.style.map.terrain)===null||E===void 0?void 0:E.getTerrainData(X);D.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,J.colorAttachment.get());const oe=I.getProjectionData({overscaledTileID:X,aligned:Y,applyGlobeMatrix:!T,applyTerrainMatrix:!0});N.draw(D,F.TRIANGLES,m,u[X.overscaledZ],y,Vt.backCCW,zs(f,K,n),ae,oe,n.id,re.vertexBuffer,re.indexBuffer,re.segments)}}const tr=[new d.P(0,0),new d.P(d.Z,0),new d.P(d.Z,d.Z),new d.P(0,d.Z)];function pn(f,e,n,l,u,m,y,b,T=!1,E=!1){const z=l[l.length-1].overscaledZ,D=f.context,I=D.gl,F=f.useProgram("raster"),N=f.transform,Y=f.style.projection,X=f.colorModeForRenderPass(),K=!f.options.moving;for(const J of l){const re=f.getDepthModeForSublayer(J.overscaledZ-z,n.paint.get("raster-opacity")===1?jt.ReadWrite:jt.ReadOnly,I.LESS),ae=e.getTile(J);ae.registerFadeDuration(n.paint.get("raster-fade-duration"));const oe=e.findLoadedParent(J,0),he=e.findLoadedSibling(J),ce=It(ae,oe||he||null,e,n,f.transform,f.style.map.terrain);let we,Me;const ke=n.paint.get("raster-resampling")==="nearest"?I.NEAREST:I.LINEAR;D.activeTexture.set(I.TEXTURE0),ae.texture.bind(ke,I.CLAMP_TO_EDGE,I.LINEAR_MIPMAP_NEAREST),D.activeTexture.set(I.TEXTURE1),oe?(oe.texture.bind(ke,I.CLAMP_TO_EDGE,I.LINEAR_MIPMAP_NEAREST),we=Math.pow(2,oe.tileID.overscaledZ-ae.tileID.overscaledZ),Me=[ae.tileID.canonical.x*we%1,ae.tileID.canonical.y*we%1]):ae.texture.bind(ke,I.CLAMP_TO_EDGE,I.LINEAR_MIPMAP_NEAREST),ae.texture.useMipmap&&D.extTextureFilterAnisotropic&&f.transform.pitch>20&&I.texParameterf(I.TEXTURE_2D,D.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,D.extTextureFilterAnisotropicMax);const Le=f.style.map.terrain&&f.style.map.terrain.getTerrainData(J),Ie=N.getProjectionData({overscaledTileID:J,aligned:K,applyGlobeMatrix:!E,applyTerrainMatrix:!0}),et=Lh(Me||[0,0],we||1,ce,n,b),We=Y.getMeshFromTileID(D,J.canonical,m,y,"raster");F.draw(D,I.TRIANGLES,re,u?u[J.overscaledZ]:Yt.disabled,X,T?Vt.frontCCW:Vt.backCCW,et,Le,Ie,n.id,We.vertexBuffer,We.indexBuffer,We.segments)}}function It(f,e,n,l,u,m){const y=l.paint.get("raster-fade-duration");if(!m&&y>0){const b=at.now(),T=(b-f.timeAdded)/y,E=e?(b-e.timeAdded)/y:-1,z=n.getSource(),D=dn(u,{tileSize:z.tileSize,roundZoom:z.roundZoom}),I=!e||Math.abs(e.tileID.overscaledZ-D)>Math.abs(f.tileID.overscaledZ-D),F=I&&f.refreshedUponExpiration?1:d.ad(I?T:1-E,0,1);return f.refreshedUponExpiration&&T>=1&&(f.refreshedUponExpiration=!1),e?{opacity:1,mix:1-F}:{opacity:F,mix:0}}return{opacity:1,mix:0}}const ir=new d.b6(1,0,0,1),mn=new d.b6(0,1,0,1),Kl=new d.b6(0,0,1,1),gs=new d.b6(1,0,1,1),qu=new d.b6(0,1,1,1);function Ls(f,e,n,l){Ka(f,0,e+n/2,f.transform.width,n,l)}function Ya(f,e,n,l){Ka(f,e-n/2,0,n,f.transform.height,l)}function Ka(f,e,n,l,u,m){const y=f.context,b=y.gl;b.enable(b.SCISSOR_TEST),b.scissor(e*f.pixelRatio,n*f.pixelRatio,l*f.pixelRatio,u*f.pixelRatio),y.clear({color:m}),b.disable(b.SCISSOR_TEST)}function Wo(f,e,n){const l=f.context,u=l.gl,m=f.useProgram("debug"),y=jt.disabled,b=Yt.disabled,T=f.colorModeForRenderPass(),E="$debug",z=f.style.map.terrain&&f.style.map.terrain.getTerrainData(n);l.activeTexture.set(u.TEXTURE0);const D=e.getTileByID(n.key).latestRawTileData,I=Math.floor((D&&D.byteLength||0)/1024),F=e.getTile(n).tileSize,N=512/Math.min(F,512)*(n.overscaledZ/f.transform.zoom)*.5;let Y=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(Y+=` => ${n.overscaledZ}`),function(K,J){K.initDebugOverlayCanvas();const re=K.debugOverlayCanvas,ae=K.context.gl,oe=K.debugOverlayCanvas.getContext("2d");oe.clearRect(0,0,re.width,re.height),oe.shadowColor="white",oe.shadowBlur=2,oe.lineWidth=1.5,oe.strokeStyle="white",oe.textBaseline="top",oe.font="bold 36px Open Sans, sans-serif",oe.fillText(J,5,5),oe.strokeText(J,5,5),K.debugOverlayTexture.update(re),K.debugOverlayTexture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE)}(f,`${Y} ${I}kB`);const X=f.transform.getProjectionData({overscaledTileID:n,applyGlobeMatrix:!0,applyTerrainMatrix:!0});m.draw(l,u.TRIANGLES,y,b,Ti.alphaBlended,Vt.disabled,Oc(d.b6.transparent,N),null,X,E,f.debugBuffer,f.quadTriangleIndexBuffer,f.debugSegments),m.draw(l,u.LINE_STRIP,y,b,T,Vt.disabled,Oc(d.b6.red),z,X,E,f.debugBuffer,f.tileBorderIndexBuffer,f.debugSegments)}function ho(f,e,n,l){const{isRenderingGlobe:u}=l,m=f.context,y=m.gl,b=f.transform,T=f.colorModeForRenderPass(),E=f.getDepthModeFor3D(),z=f.useProgram("terrain");m.bindFramebuffer.set(null),m.viewport.set([0,0,f.width,f.height]);for(const D of n){const I=e.getTerrainMesh(D.tileID),F=f.renderToTexture.getTexture(D),N=e.getTerrainData(D.tileID);m.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,F.texture);const Y=e.getMeshFrameDelta(b.zoom),X=b.calculateFogMatrix(D.tileID.toUnwrapped()),K=Lu(Y,X,f.style.sky,b.pitch,u),J=b.getProjectionData({overscaledTileID:D.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});z.draw(m,y.TRIANGLES,E,Yt.disabled,T,Vt.backCCW,K,N,J,"terrain",I.vertexBuffer,I.indexBuffer,I.segments)}}function Kc(f,e){if(!e.mesh){const n=new d.aE;n.emplaceBack(-1,-1),n.emplaceBack(1,-1),n.emplaceBack(1,1),n.emplaceBack(-1,1);const l=new d.aG;l.emplaceBack(0,1,2),l.emplaceBack(0,2,3),e.mesh=new mr(f.createVertexBuffer(n,Fr.members),f.createIndexBuffer(l),d.aF.simpleSegment(0,0,n.length,l.length))}return e.mesh}class Qc{constructor(e,n){this.context=new Xl(e),this.transform=n,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:d.as(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=P.maxUnderzooming+P.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Cc}resize(e,n,l){if(this.width=Math.floor(e*l),this.height=Math.floor(n*l),this.pixelRatio=l,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const u of this.style._order)this.style._layers[u].resize()}setup(){const e=this.context,n=new d.aE;n.emplaceBack(0,0),n.emplaceBack(d.Z,0),n.emplaceBack(0,d.Z),n.emplaceBack(d.Z,d.Z),this.tileExtentBuffer=e.createVertexBuffer(n,Fr.members),this.tileExtentSegments=d.aF.simpleSegment(0,0,4,2);const l=new d.aE;l.emplaceBack(0,0),l.emplaceBack(d.Z,0),l.emplaceBack(0,d.Z),l.emplaceBack(d.Z,d.Z),this.debugBuffer=e.createVertexBuffer(l,Fr.members),this.debugSegments=d.aF.simpleSegment(0,0,4,5);const u=new d.bV;u.emplaceBack(0,0,0,0),u.emplaceBack(d.Z,0,d.Z,0),u.emplaceBack(0,d.Z,0,d.Z),u.emplaceBack(d.Z,d.Z,d.Z,d.Z),this.rasterBoundsBuffer=e.createVertexBuffer(u,Ga.members),this.rasterBoundsSegments=d.aF.simpleSegment(0,0,4,2);const m=new d.aE;m.emplaceBack(0,0),m.emplaceBack(d.Z,0),m.emplaceBack(0,d.Z),m.emplaceBack(d.Z,d.Z),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(m,Fr.members),this.rasterBoundsSegmentsPosOnly=d.aF.simpleSegment(0,0,4,5);const y=new d.aE;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(y,Fr.members),this.viewportSegments=d.aF.simpleSegment(0,0,4,2);const b=new d.bW;b.emplaceBack(0),b.emplaceBack(1),b.emplaceBack(3),b.emplaceBack(2),b.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(b);const T=new d.aG;T.emplaceBack(1,0,2),T.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(T);const E=this.context.gl;this.stencilClearMode=new Yt({func:E.ALWAYS,mask:0},0,255,E.ZERO,E.ZERO,E.ZERO),this.tileExtentMesh=new mr(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,n=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const l=d.K();d.bN(l,0,this.width,this.height,0,0,1),d.M(l,l,[n.drawingBufferWidth,n.drawingBufferHeight,0]);const u={mainMatrix:l,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:l};this.useProgram("clippingMask",null,!0).draw(e,n.TRIANGLES,jt.disabled,this.stencilClearMode,Ti.disabled,Vt.disabled,null,null,u,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,n,l){if(this.currentStencilSource===e.source||!e.isTileClipped()||!n||!n.length)return;this.currentStencilSource=e.source,this.nextStencilID+n.length>256&&this.clearStencil();const u=this.context;u.setColorMode(Ti.disabled),u.setDepthMode(jt.disabled);const m={};for(const y of n)m[y.key]=this.nextStencilID++;this._renderTileMasks(m,n,l,!0),this._renderTileMasks(m,n,l,!1),this._tileClippingMaskIDs=m}_renderTileMasks(e,n,l,u){const m=this.context,y=m.gl,b=this.style.projection,T=this.transform,E=this.useProgram("clippingMask");for(const z of n){const D=e[z.key],I=this.style.map.terrain&&this.style.map.terrain.getTerrainData(z),F=b.getMeshFromTileID(this.context,z.canonical,u,!0,"stencil"),N=T.getProjectionData({overscaledTileID:z,applyGlobeMatrix:!0,applyTerrainMatrix:!0});E.draw(m,y.TRIANGLES,jt.disabled,new Yt({func:y.ALWAYS,mask:0},D,255,y.KEEP,y.KEEP,y.REPLACE),Ti.disabled,l?Vt.disabled:Vt.backCCW,null,I,N,"$clipping",F.vertexBuffer,F.indexBuffer,F.segments)}}_renderTilesDepthBuffer(){const e=this.context,n=e.gl,l=this.style.projection,u=this.transform,m=this.useProgram("depth"),y=this.getDepthModeFor3D(),b=ye(u,{tileSize:u.tileSize});for(const T of b){const E=this.style.map.terrain&&this.style.map.terrain.getTerrainData(T),z=l.getMeshFromTileID(this.context,T.canonical,!0,!0,"raster"),D=u.getProjectionData({overscaledTileID:T,applyGlobeMatrix:!0,applyTerrainMatrix:!0});m.draw(e,n.TRIANGLES,y,Yt.disabled,Ti.disabled,Vt.backCCW,null,E,D,"$clipping",z.vertexBuffer,z.indexBuffer,z.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,n=this.context.gl;return new Yt({func:n.NOTEQUAL,mask:255},e,255,n.KEEP,n.KEEP,n.REPLACE)}stencilModeForClipping(e){const n=this.context.gl;return new Yt({func:n.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,n.KEEP,n.KEEP,n.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const n=this.context.gl,l=e.sort((y,b)=>b.overscaledZ-y.overscaledZ),u=l[l.length-1].overscaledZ,m=l[0].overscaledZ-u+1;if(m>1){this.currentStencilSource=void 0,this.nextStencilID+m>256&&this.clearStencil();const y={};for(let b=0;b<m;b++)y[b+u]=new Yt({func:n.GEQUAL,mask:255},b+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=m,[y,l]}return[{[u]:Yt.disabled},l]}stencilConfigForOverlapTwoPass(e){const n=this.context.gl,l=e.sort((y,b)=>b.overscaledZ-y.overscaledZ),u=l[l.length-1].overscaledZ,m=l[0].overscaledZ-u+1;if(this.clearStencil(),m>1){const y={},b={};for(let T=0;T<m;T++)y[T+u]=new Yt({func:n.GREATER,mask:255},m+1+T,255,n.KEEP,n.KEEP,n.REPLACE),b[T+u]=new Yt({func:n.GREATER,mask:255},1+T,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID=2*m+1,[y,b,l]}return this.nextStencilID=3,[{[u]:new Yt({func:n.GREATER,mask:255},2,255,n.KEEP,n.KEEP,n.REPLACE)},{[u]:new Yt({func:n.GREATER,mask:255},1,255,n.KEEP,n.KEEP,n.REPLACE)},l]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Ti([e.CONSTANT_COLOR,e.ONE],new d.b6(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ti.unblended:Ti.alphaBlended}getDepthModeForSublayer(e,n,l){if(!this.opaquePassEnabledForLayer())return jt.disabled;const u=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new jt(l||this.context.gl.LEQUAL,n,[u,u])}getDepthModeFor3D(){return new jt(this.context.gl.LEQUAL,jt.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,n){var l,u;this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(at.now()),this.imageManager.beginFrame();const m=this.style._order,y=this.style.sourceCaches,b={},T={},E={},z={isRenderingToTexture:!1,isRenderingGlobe:((l=e.projection)===null||l===void 0?void 0:l.transitionState)>0};for(const I in y){const F=y[I];F.used&&F.prepare(this.context),b[I]=F.getVisibleCoordinates(!1),T[I]=b[I].slice().reverse(),E[I]=F.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let I=0;I<m.length;I++)if(this.style._layers[m[I]].is3D()){this.opaquePassCutoff=I;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const I of m){const F=this.style._layers[I];if(!F.hasOffscreenPass()||F.isHidden(this.transform.zoom))continue;const N=T[F.source];(F.type==="custom"||N.length)&&this.renderLayer(this,y[F.source],F,N,z)}if((u=this.style.projection)===null||u===void 0||u.updateGPUdependent({context:this.context,useProgram:I=>this.useProgram(I)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?d.b6.black:d.b6.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(I,F){const N=I.context,Y=N.gl,X=((he,ce,we)=>{const Me=Math.cos(ce.rollInRadians),ke=Math.sin(ce.rollInRadians),Le=Un(ce),Ie=ce.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:he.properties.get("sky-color"),u_horizon_color:he.properties.get("horizon-color"),u_horizon:[(ce.width/2-Le*ke)*we,(ce.height/2+Le*Me)*we],u_horizon_normal:[-ke,Me],u_sky_horizon_blend:he.properties.get("sky-horizon-blend")*ce.height/2*we,u_sky_blend:Ie}})(F,I.style.map.transform,I.pixelRatio),K=new jt(Y.LEQUAL,jt.ReadWrite,[0,1]),J=Yt.disabled,re=I.colorModeForRenderPass(),ae=I.useProgram("sky"),oe=Kc(N,F);ae.draw(N,Y.TRIANGLES,K,J,re,Vt.disabled,X,null,void 0,"sky",oe.vertexBuffer,oe.indexBuffer,oe.segments)}(this,this.style.sky),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){const I=this.style._layers[m[this.currentLayer]],F=y[I.source],N=b[I.source];this._renderTileClippingMasks(I,N,!1),this.renderLayer(this,F,I,N,z)}this.renderPass="translucent";let D=!1;for(this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){const I=this.style._layers[m[this.currentLayer]],F=y[I.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(I,z))continue;this.opaquePassEnabledForLayer()||D||(D=!0,z.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const N=(I.type==="symbol"?E:T)[I.source];this._renderTileClippingMasks(I,b[I.source],!1),this.renderLayer(this,F,I,N,z)}if(z.isRenderingGlobe&&function(I,F,N){const Y=I.context,X=Y.gl,K=I.useProgram("atmosphere"),J=new jt(X.LEQUAL,jt.ReadOnly,[0,1]),re=I.transform,ae=function(Ie,et){const We=Ie.properties.get("position"),Ge=[-We.x,-We.y,-We.z],ft=d.as(new Float64Array(16));return Ie.properties.get("anchor")==="map"&&(d.aZ(ft,ft,et.rollInRadians),d.a_(ft,ft,-et.pitchInRadians),d.aZ(ft,ft,et.bearingInRadians),d.a_(ft,ft,et.center.lat*Math.PI/180),d.bl(ft,ft,-et.center.lng*Math.PI/180)),d.bU(Ge,Ge,ft),Ge}(N,I.transform),oe=re.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),he=F.properties.get("atmosphere-blend")*oe.projectionTransition;if(he===0)return;const ce=er(re.worldSize,re.center.lat),we=re.inverseProjectionMatrix,Me=new Float64Array(4);Me[3]=1,d.ao(Me,Me,re.modelViewProjectionMatrix),Me[0]/=Me[3],Me[1]/=Me[3],Me[2]/=Me[3],Me[3]=1,d.ao(Me,Me,we),Me[0]/=Me[3],Me[1]/=Me[3],Me[2]/=Me[3],Me[3]=1;const ke=((Ie,et,We,Ge,ft)=>({u_sun_pos:Ie,u_atmosphere_blend:et,u_globe_position:We,u_globe_radius:Ge,u_inv_proj_matrix:ft}))(ae,he,[Me[0],Me[1],Me[2]],ce,we),Le=Kc(Y,F);K.draw(Y,X.TRIANGLES,J,Yt.disabled,Ti.alphaBlended,Vt.disabled,ke,null,null,"atmosphere",Le.vertexBuffer,Le.indexBuffer,Le.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const I=function(F,N){let Y=null;const X=Object.values(F._layers).flatMap(ae=>ae.source&&!ae.isHidden(N)?[F.sourceCaches[ae.source]]:[]),K=X.filter(ae=>ae.getSource().type==="vector"),J=X.filter(ae=>ae.getSource().type!=="vector"),re=ae=>{(!Y||Y.getSource().maxzoom<ae.getSource().maxzoom)&&(Y=ae)};return K.forEach(ae=>re(ae)),Y||J.forEach(ae=>re(ae)),Y}(this.style,this.transform.zoom);I&&function(F,N,Y){for(let X=0;X<Y.length;X++)Wo(F,N,Y[X])}(this,I,I.getVisibleCoordinates())}this.options.showPadding&&function(I){const F=I.transform.padding;Ls(I,I.transform.height-(F.top||0),3,ir),Ls(I,F.bottom||0,3,mn),Ya(I,F.left||0,3,Kl),Ya(I,I.transform.width-(F.right||0),3,gs);const N=I.transform.centerPoint;(function(Y,X,K,J){Ka(Y,X-1,K-10,2,20,J),Ka(Y,X-10,K-1,20,2,J)})(I,N.x,I.transform.height-N.y,qu)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const n=this.terrainFacilitator.matrix,l=this.transform.modelViewProjectionMatrix;let u=this.terrainFacilitator.dirty;u||(u=e?!d.bX(n,l):!d.bY(n,l)),u||(u=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),u&&(d.bZ(n,l),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(m,y){const b=m.context,T=b.gl,E=m.transform,z=Ti.unblended,D=new jt(T.LEQUAL,jt.ReadWrite,[0,1]),I=y.sourceCache.getRenderableTiles(),F=m.useProgram("terrainDepth");b.bindFramebuffer.set(y.getFramebuffer("depth").framebuffer),b.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),b.clear({color:d.b6.transparent,depth:1});for(const N of I){const Y=y.getTerrainMesh(N.tileID),X=y.getTerrainData(N.tileID),K=E.getProjectionData({overscaledTileID:N.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),J={u_ele_delta:y.getMeshFrameDelta(E.zoom)};F.draw(b,T.TRIANGLES,D,Yt.disabled,z,Vt.backCCW,J,X,K,"terrain",Y.vertexBuffer,Y.indexBuffer,Y.segments)}b.bindFramebuffer.set(null),b.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain),function(m,y){const b=m.context,T=b.gl,E=m.transform,z=Ti.unblended,D=new jt(T.LEQUAL,jt.ReadWrite,[0,1]),I=y.getCoordsTexture(),F=y.sourceCache.getRenderableTiles(),N=m.useProgram("terrainCoords");b.bindFramebuffer.set(y.getFramebuffer("coords").framebuffer),b.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),b.clear({color:d.b6.transparent,depth:1}),y.coordsIndex=[];for(const Y of F){const X=y.getTerrainMesh(Y.tileID),K=y.getTerrainData(Y.tileID);b.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,I.texture);const J={u_terrain_coords_id:(255-y.coordsIndex.length)/255,u_texture:0,u_ele_delta:y.getMeshFrameDelta(E.zoom)},re=E.getProjectionData({overscaledTileID:Y.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});N.draw(b,T.TRIANGLES,D,Yt.disabled,z,Vt.backCCW,J,K,re,"terrain",X.vertexBuffer,X.indexBuffer,X.segments),y.coordsIndex.push(Y.tileID.key)}b.bindFramebuffer.set(null),b.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain))}renderLayer(e,n,l,u,m){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="custom"||(u||[]).length)&&(this.id=l.id,d.b_(l)?function(y,b,T,E,z,D){if(y.renderPass!=="translucent")return;const{isRenderingToTexture:I}=D,F=Yt.disabled,N=y.colorModeForRenderPass();(T._unevaluatedLayout.hasValue("text-variable-anchor")||T._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(Y,X,K,J,re,ae,oe,he,ce){const we=X.transform,Me=X.style.map.terrain,ke=re==="map",Le=ae==="map";for(const Ie of Y){const et=J.getTile(Ie),We=et.getBucket(K);if(!We||!We.text||!We.text.segments.get().length)continue;const Ge=d.af(We.textSizeData,we.zoom),ft=d.av(et,1,X.transform.zoom),_t=Se(ke,X.transform,ft),oi=K.layout.get("icon-text-fit")!=="none"&&We.hasIconData();if(Ge){const Si=Math.pow(2,we.zoom-et.tileID.overscaledZ),fi=Me?(_i,xi)=>Me.getElevation(Ie,_i,xi):null;ps(We,ke,Le,ce,we,_t,Si,Ge,oi,d.aw(we,et,oe,he),Ie.toUnwrapped(),fi)}}}(E,y,T,b,T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),z),T.paint.get("icon-opacity").constantOr(1)!==0&&Yl(y,b,T,E,!1,T.paint.get("icon-translate"),T.paint.get("icon-translate-anchor"),T.layout.get("icon-rotation-alignment"),T.layout.get("icon-pitch-alignment"),T.layout.get("icon-keep-upright"),F,N,I),T.paint.get("text-opacity").constantOr(1)!==0&&Yl(y,b,T,E,!0,T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.layout.get("text-keep-upright"),F,N,I),b.map.showCollisionBoxes&&(ds(y,b,T,E,!0),ds(y,b,T,E,!1))}(e,n,l,u,this.style.placement.variableOffsets,m):d.b$(l)?function(y,b,T,E,z){if(y.renderPass!=="translucent")return;const{isRenderingToTexture:D}=z,I=T.paint.get("circle-opacity"),F=T.paint.get("circle-stroke-width"),N=T.paint.get("circle-stroke-opacity"),Y=!T.layout.get("circle-sort-key").isConstant();if(I.constantOr(1)===0&&(F.constantOr(1)===0||N.constantOr(1)===0))return;const X=y.context,K=X.gl,J=y.transform,re=y.getDepthModeForSublayer(0,jt.ReadOnly),ae=Yt.disabled,oe=y.colorModeForRenderPass(),he=[],ce=J.getCircleRadiusCorrection();for(let we=0;we<E.length;we++){const Me=E[we],ke=b.getTile(Me),Le=ke.getBucket(T);if(!Le)continue;const Ie=T.paint.get("circle-translate"),et=T.paint.get("circle-translate-anchor"),We=d.aw(J,ke,Ie,et),Ge=Le.programConfigurations.get(T.id),ft=y.useProgram("circle",Ge),_t=Le.layoutVertexBuffer,oi=Le.indexBuffer,Si=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Me),fi={programConfiguration:Ge,program:ft,layoutVertexBuffer:_t,indexBuffer:oi,uniformValues:Go(y,ke,T,We,ce),terrainData:Si,projectionData:J.getProjectionData({overscaledTileID:Me,applyGlobeMatrix:!D,applyTerrainMatrix:!0})};if(Y){const _i=Le.segments.get();for(const xi of _i)he.push({segments:new d.aF([xi]),sortKey:xi.sortKey,state:fi})}else he.push({segments:Le.segments,sortKey:0,state:fi})}Y&&he.sort((we,Me)=>we.sortKey-Me.sortKey);for(const we of he){const{programConfiguration:Me,program:ke,layoutVertexBuffer:Le,indexBuffer:Ie,uniformValues:et,terrainData:We,projectionData:Ge}=we.state;ke.draw(X,K.TRIANGLES,re,ae,oe,Vt.backCCW,et,We,Ge,T.id,Le,Ie,we.segments,T.paint,y.transform.zoom,Me)}}(e,n,l,u,m):d.c0(l)?function(y,b,T,E,z){if(T.paint.get("heatmap-opacity")===0)return;const D=y.context,{isRenderingToTexture:I,isRenderingGlobe:F}=z;if(y.style.map.terrain){for(const N of E){const Y=b.getTile(N);b.hasRenderableParent(N)||(y.renderPass==="offscreen"?aa(y,Y,T,N,F):y.renderPass==="translucent"&&Rs(y,T,N,I,F))}D.viewport.set([0,0,y.width,y.height])}else y.renderPass==="offscreen"?function(N,Y,X,K){const J=N.context,re=J.gl,ae=N.transform,oe=Yt.disabled,he=new Ti([re.ONE,re.ONE],d.b6.transparent,[!0,!0,!0,!0]);(function(ce,we,Me){const ke=ce.gl;ce.activeTexture.set(ke.TEXTURE1),ce.viewport.set([0,0,we.width/4,we.height/4]);let Le=Me.heatmapFbos.get(d.bR);Le?(ke.bindTexture(ke.TEXTURE_2D,Le.colorAttachment.get()),ce.bindFramebuffer.set(Le.framebuffer)):(Le=$r(ce,we.width/4,we.height/4),Me.heatmapFbos.set(d.bR,Le))})(J,N,X),J.clear({color:d.b6.transparent});for(let ce=0;ce<K.length;ce++){const we=K[ce];if(Y.hasRenderableParent(we))continue;const Me=Y.getTile(we),ke=Me.getBucket(X);if(!ke)continue;const Le=ke.programConfigurations.get(X.id),Ie=N.useProgram("heatmap",Le),et=ae.getProjectionData({overscaledTileID:we,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),We=ae.getCircleRadiusCorrection();Ie.draw(J,re.TRIANGLES,jt.disabled,oe,he,Vt.backCCW,jc(Me,ae.zoom,X.paint.get("heatmap-intensity"),We),null,et,X.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,X.paint,ae.zoom,Le)}J.viewport.set([0,0,N.width,N.height])}(y,b,T,E):y.renderPass==="translucent"&&function(N,Y){const X=N.context,K=X.gl;X.setColorMode(N.colorModeForRenderPass());const J=Y.heatmapFbos.get(d.bR);J&&(X.activeTexture.set(K.TEXTURE0),K.bindTexture(K.TEXTURE_2D,J.colorAttachment.get()),X.activeTexture.set(K.TEXTURE1),sa(X,Y).bind(K.LINEAR,K.CLAMP_TO_EDGE),N.useProgram("heatmapTexture").draw(X,K.TRIANGLES,jt.disabled,Yt.disabled,N.colorModeForRenderPass(),Vt.disabled,Fc(N,Y,0,1),null,null,Y.id,N.viewportBuffer,N.quadTriangleIndexBuffer,N.viewportSegments,Y.paint,N.transform.zoom))}(y,T)}(e,n,l,u,m):d.c1(l)?function(y,b,T,E,z){if(y.renderPass!=="translucent")return;const{isRenderingToTexture:D}=z,I=T.paint.get("line-opacity"),F=T.paint.get("line-width");if(I.constantOr(1)===0||F.constantOr(1)===0)return;const N=y.getDepthModeForSublayer(0,jt.ReadOnly),Y=y.colorModeForRenderPass(),X=T.paint.get("line-dasharray"),K=T.paint.get("line-pattern"),J=K.constantOr(1),re=T.paint.get("line-gradient"),ae=T.getCrossfadeParameters(),oe=J?"linePattern":X?"lineSDF":re?"lineGradient":"line",he=y.context,ce=he.gl,we=y.transform;let Me=!0;for(const ke of E){const Le=b.getTile(ke);if(J&&!Le.patternsLoaded())continue;const Ie=Le.getBucket(T);if(!Ie)continue;const et=Ie.programConfigurations.get(T.id),We=y.context.program.get(),Ge=y.useProgram(oe,et),ft=Me||Ge.program!==We,_t=y.style.map.terrain&&y.style.map.terrain.getTerrainData(ke),oi=K.constantOr(null);if(oi&&Le.imageAtlas){const ii=Le.imageAtlas,pi=ii.patternPositions[oi.to.toString()],kn=ii.patternPositions[oi.from.toString()];pi&&kn&&et.setConstantPatternPositions(pi,kn)}const Si=we.getProjectionData({overscaledTileID:ke,applyGlobeMatrix:!D,applyTerrainMatrix:!0}),fi=we.getPixelScale(),_i=J?Fl(y,Le,T,fi,ae):X?kh(y,Le,T,fi,X,ae):re?Ed(y,Le,T,fi,Ie.lineClipsArray.length):oo(y,Le,T,fi);if(J)he.activeTexture.set(ce.TEXTURE0),Le.imageAtlasTexture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE),et.updatePaintBuffers(ae);else if(X&&(ft||y.lineAtlas.dirty))he.activeTexture.set(ce.TEXTURE0),y.lineAtlas.bind(he);else if(re){const ii=Ie.gradients[T.id];let pi=ii.texture;if(T.gradientVersion!==ii.version){let kn=256;if(T.stepInterpolant){const Mi=b.getSource().maxzoom,ki=ke.canonical.z===Mi?Math.ceil(1<<y.transform.maxZoom-ke.canonical.z):1;kn=d.ad(d.bS(Ie.maxLineLength/d.Z*1024*ki),256,he.maxTextureSize)}ii.gradient=d.bT({expression:T.gradientExpression(),evaluationKey:"lineProgress",resolution:kn,image:ii.gradient||void 0,clips:Ie.lineClipsArray}),ii.texture?ii.texture.update(ii.gradient):ii.texture=new gi(he,ii.gradient,ce.RGBA),ii.version=T.gradientVersion,pi=ii.texture}he.activeTexture.set(ce.TEXTURE0),pi.bind(T.stepInterpolant?ce.NEAREST:ce.LINEAR,ce.CLAMP_TO_EDGE)}let xi;if(D){const[ii]=y.getStencilConfigForOverlapAndUpdateStencilID(E);xi=ii[ke.overscaledZ]}else xi=y.stencilModeForClipping(ke);Ge.draw(he,ce.TRIANGLES,N,xi,Y,Vt.disabled,_i,_t,Si,T.id,Ie.layoutVertexBuffer,Ie.indexBuffer,Ie.segments,T.paint,y.transform.zoom,et,Ie.layoutVertexBuffer2),Me=!1}}(e,n,l,u,m):d.c2(l)?function(y,b,T,E,z){const D=T.paint.get("fill-color"),I=T.paint.get("fill-opacity");if(I.constantOr(1)===0)return;const{isRenderingToTexture:F}=z,N=y.colorModeForRenderPass(),Y=T.paint.get("fill-pattern"),X=y.opaquePassEnabledForLayer()&&!Y.constantOr(1)&&D.constantOr(d.b6.transparent).a===1&&I.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===X){const K=y.getDepthModeForSublayer(1,y.renderPass==="opaque"?jt.ReadWrite:jt.ReadOnly);Yc(y,b,T,E,K,N,!1,F)}if(y.renderPass==="translucent"&&T.paint.get("fill-antialias")){const K=y.getDepthModeForSublayer(T.getPaintProperty("fill-outline-color")?2:0,jt.ReadOnly);Yc(y,b,T,E,K,N,!0,F)}}(e,n,l,u,m):d.c3(l)?function(y,b,T,E,z){const D=T.paint.get("fill-extrusion-opacity");if(D===0)return;const{isRenderingToTexture:I}=z;if(y.renderPass==="translucent"){const F=new jt(y.context.gl.LEQUAL,jt.ReadWrite,y.depthRangeFor3D);if(D!==1||T.paint.get("fill-extrusion-pattern").constantOr(1))ks(y,b,T,E,F,Yt.disabled,Ti.disabled,I),ks(y,b,T,E,F,y.stencilModeFor3D(),y.colorModeForRenderPass(),I);else{const N=y.colorModeForRenderPass();ks(y,b,T,E,F,Yt.disabled,N,I)}}}(e,n,l,u,m):d.c4(l)?function(y,b,T,E,z){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;const{isRenderingToTexture:D}=z,I=y.context,F=y.style.projection.useSubdivision,N=y.getDepthModeForSublayer(0,jt.ReadOnly),Y=y.colorModeForRenderPass();if(y.renderPass==="offscreen")(function(X,K,J,re,ae,oe,he){const ce=X.context,we=ce.gl;for(const Me of J){const ke=K.getTile(Me),Le=ke.dem;if(!Le||!Le.data||!ke.needsHillshadePrepare)continue;const Ie=Le.dim,et=Le.stride,We=Le.getPixels();if(ce.activeTexture.set(we.TEXTURE1),ce.pixelStoreUnpackPremultiplyAlpha.set(!1),ke.demTexture=ke.demTexture||X.getTileTexture(et),ke.demTexture){const ft=ke.demTexture;ft.update(We,{premultiply:!1}),ft.bind(we.NEAREST,we.CLAMP_TO_EDGE)}else ke.demTexture=new gi(ce,We,we.RGBA,{premultiply:!1}),ke.demTexture.bind(we.NEAREST,we.CLAMP_TO_EDGE);ce.activeTexture.set(we.TEXTURE0);let Ge=ke.fbo;if(!Ge){const ft=new gi(ce,{width:Ie,height:Ie,data:null},we.RGBA);ft.bind(we.LINEAR,we.CLAMP_TO_EDGE),Ge=ke.fbo=ce.createFramebuffer(Ie,Ie,!0,!1),Ge.colorAttachment.set(ft.texture)}ce.bindFramebuffer.set(Ge.framebuffer),ce.viewport.set([0,0,Ie,Ie]),X.useProgram("hillshadePrepare").draw(ce,we.TRIANGLES,ae,oe,he,Vt.disabled,so(ke.tileID,Le),null,null,re.id,X.rasterBoundsBuffer,X.quadTriangleIndexBuffer,X.rasterBoundsSegments),ke.needsHillshadePrepare=!1}})(y,b,E,T,N,Yt.disabled,Y),I.viewport.set([0,0,y.width,y.height]);else if(y.renderPass==="translucent")if(F){const[X,K,J]=y.stencilConfigForOverlapTwoPass(E);uo(y,b,T,J,X,N,Y,!1,D),uo(y,b,T,J,K,N,Y,!0,D)}else{const[X,K]=y.getStencilConfigForOverlapAndUpdateStencilID(E);uo(y,b,T,K,X,N,Y,!1,D)}}(e,n,l,u,m):d.c5(l)?function(y,b,T,E,z){if(y.renderPass!=="translucent"||T.paint.get("raster-opacity")===0||!E.length)return;const{isRenderingToTexture:D}=z,I=b.getSource(),F=y.style.projection.useSubdivision;if(I instanceof ta)pn(y,b,T,E,null,!1,!1,I.tileCoords,I.flippedWindingOrder,D);else if(F){const[N,Y,X]=y.stencilConfigForOverlapTwoPass(E);pn(y,b,T,X,N,!1,!0,tr,!1,D),pn(y,b,T,X,Y,!0,!0,tr,!1,D)}else{const[N,Y]=y.getStencilConfigForOverlapAndUpdateStencilID(E);pn(y,b,T,Y,N,!1,!0,tr,!1,D)}}(e,n,l,u,m):d.c6(l)?function(y,b,T,E,z){const D=T.paint.get("background-color"),I=T.paint.get("background-opacity");if(I===0)return;const{isRenderingToTexture:F}=z,N=y.context,Y=N.gl,X=y.style.projection,K=y.transform,J=K.tileSize,re=T.paint.get("background-pattern");if(y.isPatternMissing(re))return;const ae=!re&&D.a===1&&I===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==ae)return;const oe=Yt.disabled,he=y.getDepthModeForSublayer(0,ae==="opaque"?jt.ReadWrite:jt.ReadOnly),ce=y.colorModeForRenderPass(),we=y.useProgram(re?"backgroundPattern":"background"),Me=E||ye(K,{tileSize:J,terrain:y.style.map.terrain});re&&(N.activeTexture.set(Y.TEXTURE0),y.imageManager.bind(y.context));const ke=T.getCrossfadeParameters();for(const Le of Me){const Ie=K.getProjectionData({overscaledTileID:Le,applyGlobeMatrix:!F,applyTerrainMatrix:!0}),et=re?Uc(I,y,re,{tileID:Le,tileSize:J},ke):Sa(I,D),We=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Le),Ge=X.getMeshFromTileID(N,Le.canonical,!1,!0,"raster");we.draw(N,Y.TRIANGLES,he,oe,ce,Vt.backCCW,et,We,Ie,T.id,Ge.vertexBuffer,Ge.indexBuffer,Ge.segments)}}(e,0,l,u,m):d.c7(l)&&function(y,b,T,E){const{isRenderingGlobe:z}=E,D=y.context,I=T.implementation,F=y.style.projection,N=y.transform,Y=N.getProjectionDataForCustomLayer(z),X={farZ:N.farZ,nearZ:N.nearZ,fov:N.fov*Math.PI/180,modelViewProjectionMatrix:N.modelViewProjectionMatrix,projectionMatrix:N.projectionMatrix,shaderData:{variantName:F.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${F.shaderPreludeCode.vertexSource}`,define:F.shaderDefine},defaultProjectionData:Y},K=I.renderingMode?I.renderingMode:"2d";if(y.renderPass==="offscreen"){const J=I.prerender;J&&(y.setCustomLayerDefaults(),D.setColorMode(y.colorModeForRenderPass()),J.call(I,D.gl,X),D.setDirty(),y.setBaseState())}else if(y.renderPass==="translucent"){y.setCustomLayerDefaults(),D.setColorMode(y.colorModeForRenderPass()),D.setStencilMode(Yt.disabled);const J=K==="3d"?y.getDepthModeFor3D():y.getDepthModeForSublayer(0,jt.ReadOnly);D.setDepthMode(J),I.render(D.gl,X),D.setDirty(),y.setBaseState(),D.bindFramebuffer.set(null)}}(e,0,l,m))}saveTileTexture(e){const n=this._tileTextures[e.size[0]];n?n.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const n=this._tileTextures[e];return n&&n.length>0?n.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const n=this.imageManager.getPattern(e.from.toString()),l=this.imageManager.getPattern(e.to.toString());return!n||!l}useProgram(e,n,l=!1){this.cache=this.cache||{};const u=!!this.style.map.terrain,m=this.style.projection,y=e+(n?n.cacheKey:"")+`/${l?as:m.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(u?"/terrain":"");return this.cache[y]||(this.cache[y]=new Md(this.context,wa[e],n,Vc[e],this._showOverdrawInspector,u,l?wa.projectionMercator:m.shaderPreludeCode,l?Xt:m.shaderDefine)),this.cache[y]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new gi(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:n}=this.context.gl;return this.width!==e||this.height!==n}}function Wc(f,e){let n,l=!1,u=null,m=null;const y=()=>{u=null,l&&(f.apply(m,n),u=setTimeout(y,e),l=!1)};return(...b)=>(l=!0,m=this,n=b,u||y(),u)}class Ea{constructor(e){this._getCurrentHash=()=>{const n=window.location.hash.replace("#","");if(this._hashName){let l;return n.split("&").map(u=>u.split("=")).forEach(u=>{u[0]===this._hashName&&(l=u)}),(l&&l[1]||"").split("/")}return n.split("/")},this._onHashChange=()=>{const n=this._getCurrentHash();if(!this._isValidHash(n))return!1;const l=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:l,pitch:+(n[4]||0)}),!0},this._updateHashUnthrottled=()=>{const n=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,n)},this._removeHash=()=>{const n=this._getCurrentHash();if(n.length===0)return;const l=n.join("/");let u=l;u.split("&").length>0&&(u=u.split("&")[0]),this._hashName&&(u=`${this._hashName}=${l}`);let m=window.location.hash.replace(u,"");m.startsWith("#&")?m=m.slice(0,1)+m.slice(2):m==="#"&&(m="");let y=window.location.href.replace(/(#.+)?$/,m);y=y.replace("&&","&"),window.history.replaceState(window.history.state,null,y)},this._updateHash=Wc(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const n=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,u=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,u),y=Math.round(n.lng*m)/m,b=Math.round(n.lat*m)/m,T=this._map.getBearing(),E=this._map.getPitch();let z="";if(z+=e?`/${y}/${b}/${l}`:`${l}/${b}/${y}`,(T||E)&&(z+="/"+Math.round(10*T)/10),E&&(z+=`/${Math.round(E)}`),this._hashName){const D=this._hashName;let I=!1;const F=window.location.hash.slice(1).split("&").map(N=>{const Y=N.split("=")[0];return Y===D?(I=!0,`${Y}=${z}`):N}).filter(N=>N);return I||F.push(`${D}=${z}`),`#${F.join("&")}`}return`#${z}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new d.Q(+e[2],+e[1])}catch{return!1}const n=+e[0],l=+(e[3]||0),u=+(e[4]||0);return n>=this._map.getMinZoom()&&n<=this._map.getMaxZoom()&&l>=-180&&l<=180&&u>=this._map.getMinPitch()&&u<=this._map.getMaxPitch()}}const fo={linearity:.3,easing:d.c8(0,0,.3,1)},Jo=d.e({deceleration:2500,maxSpeed:1400},fo),Hu=d.e({deceleration:20,maxSpeed:1400},fo),po=d.e({deceleration:1e3,maxSpeed:360},fo),el=d.e({deceleration:1e3,maxSpeed:90},fo),Ql=d.e({deceleration:1e3,maxSpeed:360},fo);class tl{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:at.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,n=at.now();for(;e.length>0&&n-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const n={zoom:0,bearing:0,pitch:0,roll:0,pan:new d.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:m}of this._inertiaBuffer)n.zoom+=m.zoomDelta||0,n.bearing+=m.bearingDelta||0,n.pitch+=m.pitchDelta||0,n.roll+=m.rollDelta||0,m.panDelta&&n.pan._add(m.panDelta),m.around&&(n.around=m.around),m.pinchAround&&(n.pinchAround=m.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,u={};if(n.pan.mag()){const m=mo(n.pan.mag(),l,d.e({},Jo,e||{})),y=n.pan.mult(m.amount/n.pan.mag()),b=this._map.cameraHelper.handlePanInertia(y,this._map.transform);u.center=b.easingCenter,u.offset=b.easingOffset,Ca(u,m)}if(n.zoom){const m=mo(n.zoom,l,Hu);u.zoom=this._map.transform.zoom+m.amount,Ca(u,m)}if(n.bearing){const m=mo(n.bearing,l,po);u.bearing=this._map.transform.bearing+d.ad(m.amount,-179,179),Ca(u,m)}if(n.pitch){const m=mo(n.pitch,l,el);u.pitch=this._map.transform.pitch+m.amount,Ca(u,m)}if(n.roll){const m=mo(n.roll,l,Ql);u.roll=this._map.transform.roll+d.ad(m.amount,-179,179),Ca(u,m)}if(u.zoom||u.bearing){const m=n.pinchAround===void 0?n.around:n.pinchAround;u.around=m?this._map.unproject(m):this._map.getCenter()}return this.clear(),d.e(u,{noMoveStart:!0})}}function Ca(f,e){(!f.duration||f.duration<e.duration)&&(f.duration=e.duration,f.easing=e.easing)}function mo(f,e,n){const{maxSpeed:l,linearity:u,deceleration:m}=n,y=d.ad(f*u/(e/1e3),-l,l),b=Math.abs(y)/(m*u);return{easing:n.easing,duration:1e3*b,amount:y*(b/2)}}class Ui extends d.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,l,u={}){const m=_e.mousePos(n.getCanvas(),l),y=n.unproject(m);super(e,d.e({point:m,lngLat:y,originalEvent:l},u)),this._defaultPrevented=!1,this.target=n}}class wn extends d.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,l){const u=e==="touchend"?l.changedTouches:l.touches,m=_e.touchPos(n.getCanvasContainer(),u),y=m.map(T=>n.unproject(T)),b=m.reduce((T,E,z,D)=>T.add(E.div(D.length)),new d.P(0,0));super(e,{points:m,point:b,lngLats:y,lngLat:n.unproject(b),originalEvent:l}),this._defaultPrevented=!1}}class Jc extends d.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,l){super(e,{originalEvent:l}),this._defaultPrevented=!1}}class xr{constructor(e,n){this._map=e,this._clickTolerance=n.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Jc(e.type,this._map,e))}mousedown(e,n){return this._mousedownPos=n,this._firePreventable(new Ui(e.type,this._map,e))}mouseup(e){this._map.fire(new Ui(e.type,this._map,e))}click(e,n){this._mousedownPos&&this._mousedownPos.dist(n)>=this._clickTolerance||this._map.fire(new Ui(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Ui(e.type,this._map,e))}mouseover(e){this._map.fire(new Ui(e.type,this._map,e))}mouseout(e){this._map.fire(new Ui(e.type,this._map,e))}touchstart(e){return this._firePreventable(new wn(e.type,this._map,e))}touchmove(e){this._map.fire(new wn(e.type,this._map,e))}touchend(e){this._map.fire(new wn(e.type,this._map,e))}touchcancel(e){this._map.fire(new wn(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class _s{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Ui(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ui("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Ui(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class il{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(d.P.convert(e),this._map.terrain)}}class eu{constructor(e,n){this._map=e,this._tr=new il(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=n.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,n){this.isEnabled()&&e.shiftKey&&e.button===0&&(_e.disableDrag(),this._startPos=this._lastPos=n,this._active=!0)}mousemoveWindow(e,n){if(!this._active)return;const l=n;if(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)return;const u=this._startPos;this._lastPos=l,this._box||(this._box=_e.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const m=Math.min(u.x,l.x),y=Math.max(u.x,l.x),b=Math.min(u.y,l.y),T=Math.max(u.y,l.y);_e.setTransform(this._box,`translate(${m}px,${b}px)`),this._box.style.width=y-m+"px",this._box.style.height=T-b+"px"}mouseupWindow(e,n){if(!this._active||e.button!==0)return;const l=this._startPos,u=n;if(this.reset(),_e.suppressClick(),l.x!==u.x||l.y!==u.y)return this._map.fire(new d.l("boxzoomend",{originalEvent:e})),{cameraAnimation:m=>m.fitScreenCoordinates(l,u,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(_e.remove(this._box),this._box=null),_e.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,n){return this._map.fire(new d.l(e,{originalEvent:n}))}}function Wl(f,e){if(f.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${f.length}, points ${e.length}`);const n={};for(let l=0;l<f.length;l++)n[f[l].identifier]=e[l];return n}class oa{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,n,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),l.length===this.numTouches&&(this.centroid=function(u){const m=new d.P(0,0);for(const y of u)m._add(y);return m.div(u.length)}(n),this.touches=Wl(l,n)))}touchmove(e,n,l){if(this.aborted||!this.centroid)return;const u=Wl(l,n);for(const m in this.touches){const y=u[m];(!y||y.dist(this.touches[m])>30)&&(this.aborted=!0)}}touchend(e,n,l){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const u=!this.aborted&&this.centroid;if(this.reset(),u)return u}}}class Xr{constructor(e){this.singleTap=new oa(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,n,l){this.singleTap.touchstart(e,n,l)}touchmove(e,n,l){this.singleTap.touchmove(e,n,l)}touchend(e,n,l){const u=this.singleTap.touchend(e,n,l);if(u){const m=e.timeStamp-this.lastTime<500,y=!this.lastTap||this.lastTap.dist(u)<30;if(m&&y||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=u,this.count===this.numTaps)return this.reset(),u}}}class la{constructor(e){this._tr=new il(e),this._zoomIn=new Xr({numTouches:1,numTaps:2}),this._zoomOut=new Xr({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,n,l){this._zoomIn.touchstart(e,n,l),this._zoomOut.touchstart(e,n,l)}touchmove(e,n,l){this._zoomIn.touchmove(e,n,l),this._zoomOut.touchmove(e,n,l)}touchend(e,n,l){const u=this._zoomIn.touchend(e,n,l),m=this._zoomOut.touchend(e,n,l),y=this._tr;return u?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:y.zoom+1,around:y.unproject(u)},{originalEvent:e})}):m?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:y.zoom-1,around:y.unproject(m)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zr{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const n=this._moveFunction(...e);if(n.bearingDelta||n.pitchDelta||n.rollDelta||n.around||n.panDelta)return this._active=!0,n}dragStart(e,n){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(n)?n[0]:n,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,n){if(!this.isEnabled())return;const l=this._lastPoint;if(!l)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const u=Array.isArray(n)?n[0]:n;return!this._moved&&u.dist(l)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=u,this._move(l,u))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&_e.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const nt={0:1,2:2};class Pr{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const n=_e.mouseButton(e);this._eventButton=n}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(n,l){const u=nt[l];return n.buttons===void 0||(n.buttons&u)!==u}(e,this._eventButton)}isValidEndEvent(e){return _e.mouseButton(e)===this._eventButton}}class gn{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class Jl{constructor(e=new Pr({checkCorrectEvent:()=>!0}),n=new gn){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=n}_executeRelevantHandler(e,n,l){return e instanceof MouseEvent?n(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?l(e):void 0}startMove(e){this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.startMove(n),n=>this.oneFingerTouchMoveStateManager.startMove(n))}endMove(e){this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.endMove(n),n=>this.oneFingerTouchMoveStateManager.endMove(n))}isValidStartEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidStartEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidStartEvent(n))}isValidMoveEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidMoveEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(n))}isValidEndEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidEndEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidEndEvent(n))}}const Bs=f=>{f.mousedown=f.dragStart,f.mousemoveWindow=f.dragMove,f.mouseup=f.dragEnd,f.contextmenu=e=>{e.preventDefault()}};class ec{constructor(e,n){this._clickTolerance=e.clickTolerance||1,this._map=n,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new d.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,n,l){return this._calculateTransform(e,n,l)}touchmove(e,n,l){if(this._active){if(!this._shouldBePrevented(l.length))return e.preventDefault(),this._calculateTransform(e,n,l);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,n,l){this._calculateTransform(e,n,l),this._active&&this._shouldBePrevented(l.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,n,l){l.length>0&&(this._active=!0);const u=Wl(l,n),m=new d.P(0,0),y=new d.P(0,0);let b=0;for(const E in u){const z=u[E],D=this._touches[E];D&&(m._add(z),y._add(z.sub(D)),b++,u[E]=z)}if(this._touches=u,this._shouldBePrevented(b)||!y.mag())return;const T=y.div(b);return this._sum._add(T),this._sum.mag()<this._clickTolerance?void 0:{around:m.div(b),panDelta:T}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class tu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,n,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([n[0],n[1]]))}touchmove(e,n,l){if(!this._firstTwoTouches)return;e.preventDefault();const[u,m]=this._firstTwoTouches,y=Tt(l,n,u),b=Tt(l,n,m);if(!y||!b)return;const T=this._aroundCenter?null:y.add(b).div(2);return this._move([y,b],T,e)}touchend(e,n,l){if(!this._firstTwoTouches)return;const[u,m]=this._firstTwoTouches,y=Tt(l,n,u),b=Tt(l,n,m);y&&b||(this._active&&_e.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Tt(f,e,n){for(let l=0;l<f.length;l++)if(f[l].identifier===n)return e[l]}function nl(f,e){return Math.log(f/e)/Math.LN2}class rl extends tu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,n){const l=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(nl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:nl(this._distance,l),pinchAround:n}}}function Os(f,e){return 180*f.angleWith(e)/Math.PI}class iu extends tu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,n,l){const u=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Os(this._vector,u),pinchAround:n}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const n=25/(Math.PI*this._minDiameter)*360,l=Os(e,this._startVector);return Math.abs(l)<n}}function js(f){return Math.abs(f.y)>Math.abs(f.x)}class Fs extends tu{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,n,l){super.touchstart(e,n,l),this._currentTouchCount=l.length}_start(e){this._lastPoints=e,js(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,n,l){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const u=e[0].sub(this._lastPoints[0]),m=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(u,m,l.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(u.y+m.y)/2*-.5}):void 0}gestureBeginsVertically(e,n,l){if(this._valid!==void 0)return this._valid;const u=e.mag()>=2,m=n.mag()>=2;if(!u&&!m)return;if(!u||!m)return this._firstMove===void 0&&(this._firstMove=l),l-this._firstMove<100&&void 0;const y=e.y>0==n.y>0;return js(e)&&js(n)&&y}}const $u={panStep:100,bearingStep:15,pitchStep:10};class nu{constructor(e){this._tr=new il(e);const n=$u;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let n=0,l=0,u=0,m=0,y=0;switch(e.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:e.shiftKey?l=-1:(e.preventDefault(),m=-1);break;case 39:e.shiftKey?l=1:(e.preventDefault(),m=1);break;case 38:e.shiftKey?u=1:(e.preventDefault(),y=-1);break;case 40:e.shiftKey?u=-1:(e.preventDefault(),y=1);break;default:return}return this._rotationDisabled&&(l=0,u=0),{cameraAnimation:b=>{const T=this._tr;b.easeTo({duration:300,easeId:"keyboardHandler",easing:Ad,zoom:n?Math.round(T.zoom)+n*(e.shiftKey?2:1):T.zoom,bearing:T.bearing+l*this._bearingStep,pitch:T.pitch+u*this._pitchStep,offset:[-m*this._panStep,-y*this._panStep],center:T.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ad(f){return f*(2-f)}const ru=4.000244140625;class Ns{constructor(e,n){this._onTimeout=l=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},this._map=e,this._tr=new il(e),this._triggerRenderFrame=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let n=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const l=at.now(),u=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,n!==0&&n%ru==0?this._type="wheel":n!==0&&Math.abs(n)<4?this._type="trackpad":u>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(u*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const n=_e.mousePos(this._map.getCanvas(),e),l=this._tr;this._aroundPoint=this._aroundCenter?l.transform.locationToScreenPoint(d.Q.convert(l.center)):n,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const b=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=b),typeof this._targetZoom=="number"&&(this._targetZoom+=b)}if(this._delta!==0){const b=this._type==="wheel"&&Math.abs(this._delta)>ru?this._wheelZoomRate:this._defaultZoomRate;let T=2/(1+Math.exp(-Math.abs(this._delta*b)));this._delta<0&&T!==0&&(T=1/T);const E=typeof this._targetZoom!="number"?e.scale:d.aH(this._targetZoom);this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,d.aa(E*T))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const n=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,l=this._startZoom,u=this._easing;let m,y=!1;if(this._type==="wheel"&&l&&u){const b=at.now()-this._lastWheelEventTime,T=Math.min((b+5)/200,1),E=u(T);m=d.B.number(l,n,E),T<1?this._frameId||(this._frameId=!0):y=!0}else m=n,y=!0;return this._active=!0,y&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=m,{noInertia:!0,needsRenderFrame:!y,zoomDelta:m-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let n=d.ca;if(this._prevEase){const l=this._prevEase,u=(at.now()-l.start)/l.duration,m=l.easing(u+.01)-l.easing(u),y=.27/Math.sqrt(m*m+1e-4)*.01,b=Math.sqrt(.0729-y*y);n=d.c8(y,b,.25,1)}return this._prevEase={start:at.now(),duration:e,easing:n},n}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class au{constructor(e,n){this._clickZoom=e,this._tapZoom=n}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Aa{constructor(e){this._tr=new il(e),this.reset()}reset(){this._active=!1}dblclick(e,n){return e.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(n)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Pi{constructor(){this._tap=new Xr({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,n,l){if(!this._swipePoint)if(this._tapTime){const u=n[0],m=e.timeStamp-this._tapTime<500,y=this._tapPoint.dist(u)<30;m&&y?l.length>0&&(this._swipePoint=u,this._swipeTouch=l[0].identifier):this.reset()}else this._tap.touchstart(e,n,l)}touchmove(e,n,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const u=n[0],m=u.y-this._swipePoint.y;return this._swipePoint=u,e.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(e,n,l)}touchend(e,n,l){if(this._tapTime)this._swipePoint&&l.length===0&&this.reset();else{const u=this._tap.touchend(e,n,l);u&&(this._tapTime=e.timeStamp,this._tapPoint=u)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ca{constructor(e,n,l){this._el=e,this._mousePan=n,this._touchPan=l}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Gt{constructor(e,n,l,u){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=n,this._mousePitch=l,this._mouseRoll=u}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class di{constructor(e,n,l,u){this._el=e,this._touchZoom=n,this._touchRotate=l,this._tapDragZoom=u,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class sn{constructor(e,n){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=n,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=_e.create("div","maplibregl-cooperative-gesture-screen",e);let n=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(n=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const l=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),u=document.createElement("div");u.className="maplibregl-desktop-message",u.textContent=n,this._container.appendChild(u);const m=document.createElement("div");m.className="maplibregl-mobile-message",m.textContent=l,this._container.appendChild(m),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(_e.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,n){this._enabled&&(this._map.fire(new d.l("cooperativegestureprevented",{gestureType:e,originalEvent:n})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Us=f=>f.zoom||f.drag||f.roll||f.pitch||f.rotate;class al extends d.l{}function Vn(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta||f.rollDelta}class go{constructor(e,n){this.handleWindowEvent=u=>{this.handleEvent(u,`${u.type}Window`)},this.handleEvent=(u,m)=>{if(u.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const y=u.type==="renderFrame"?void 0:u,b={needsRenderFrame:!1},T={},E={},z=u.touches,D=z?this._getMapTouches(z):void 0,I=D?_e.touchPos(this._map.getCanvas(),D):_e.mousePos(this._map.getCanvas(),u);for(const{handlerName:Y,handler:X,allowed:K}of this._handlers){if(!X.isEnabled())continue;let J;this._blockedByActive(E,K,Y)?X.reset():X[m||u.type]&&(J=X[m||u.type](u,I,D),this.mergeHandlerResult(b,T,J,Y,y),J&&J.needsRenderFrame&&this._triggerRenderFrame()),(J||X.isActive())&&(E[Y]=X)}const F={};for(const Y in this._previousActiveHandlers)E[Y]||(F[Y]=y);this._previousActiveHandlers=E,(Object.keys(F).length||Vn(b))&&(this._changes.push([b,T,F]),this._triggerRenderFrame()),(Object.keys(E).length||Vn(b))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:N}=b;N&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],N(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new tl(e),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[window,"blur",void 0]];for(const[u,m,y]of this._listeners)_e.addEventListener(u,m,u===document?this.handleWindowEvent:this.handleEvent,y)}destroy(){for(const[e,n,l]of this._listeners)_e.removeEventListener(e,n,e===document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(e){const n=this._map,l=n.getCanvasContainer();this._add("mapEvent",new xr(n,e));const u=n.boxZoom=new eu(n,e);this._add("boxZoom",u),e.interactive&&e.boxZoom&&u.enable();const m=n.cooperativeGestures=new sn(n,e.cooperativeGestures);this._add("cooperativeGestures",m),e.cooperativeGestures&&m.enable();const y=new la(n),b=new Aa(n);n.doubleClickZoom=new au(b,y),this._add("tapZoom",y),this._add("clickZoom",b),e.interactive&&e.doubleClickZoom&&n.doubleClickZoom.enable();const T=new Pi;this._add("tapDragZoom",T);const E=n.touchPitch=new Fs(n);this._add("touchPitch",E),e.interactive&&e.touchPitch&&n.touchPitch.enable(e.touchPitch);const z=()=>n.project(n.getCenter()),D=function({enable:ae,clickTolerance:oe,aroundCenter:he=!0,minPixelCenterThreshold:ce=100,rotateDegreesPerPixelMoved:we=.8},Me){const ke=new Pr({checkCorrectEvent:Le=>_e.mouseButton(Le)===0&&Le.ctrlKey||_e.mouseButton(Le)===2&&!Le.ctrlKey});return new zr({clickTolerance:oe,move:(Le,Ie)=>{const et=Me();if(he&&Math.abs(et.y-Le.y)>ce)return{bearingDelta:d.c9(new d.P(Le.x,Ie.y),Ie,et)};let We=(Ie.x-Le.x)*we;return he&&Ie.y<et.y&&(We=-We),{bearingDelta:We}},moveStateManager:ke,enable:ae,assignEvents:Bs})}(e,z),I=function({enable:ae,clickTolerance:oe,pitchDegreesPerPixelMoved:he=-.5}){const ce=new Pr({checkCorrectEvent:we=>_e.mouseButton(we)===0&&we.ctrlKey||_e.mouseButton(we)===2});return new zr({clickTolerance:oe,move:(we,Me)=>({pitchDelta:(Me.y-we.y)*he}),moveStateManager:ce,enable:ae,assignEvents:Bs})}(e),F=function({enable:ae,clickTolerance:oe,rollDegreesPerPixelMoved:he=.3},ce){const we=new Pr({checkCorrectEvent:Me=>_e.mouseButton(Me)===2&&Me.ctrlKey});return new zr({clickTolerance:oe,move:(Me,ke)=>{const Le=ce();let Ie=(ke.x-Me.x)*he;return ke.y<Le.y&&(Ie=-Ie),{rollDelta:Ie}},moveStateManager:we,enable:ae,assignEvents:Bs})}(e,z);n.dragRotate=new Gt(e,D,I,F),this._add("mouseRotate",D,["mousePitch"]),this._add("mousePitch",I,["mouseRotate","mouseRoll"]),this._add("mouseRoll",F,["mousePitch"]),e.interactive&&e.dragRotate&&n.dragRotate.enable();const N=function({enable:ae,clickTolerance:oe}){const he=new Pr({checkCorrectEvent:ce=>_e.mouseButton(ce)===0&&!ce.ctrlKey});return new zr({clickTolerance:oe,move:(ce,we)=>({around:we,panDelta:we.sub(ce)}),activateOnStart:!0,moveStateManager:he,enable:ae,assignEvents:Bs})}(e),Y=new ec(e,n);n.dragPan=new ca(l,N,Y),this._add("mousePan",N),this._add("touchPan",Y,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&n.dragPan.enable(e.dragPan);const X=new iu,K=new rl;n.touchZoomRotate=new di(l,K,X,T),this._add("touchRotate",X,["touchPan","touchZoom"]),this._add("touchZoom",K,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&n.touchZoomRotate.enable(e.touchZoomRotate);const J=n.scrollZoom=new Ns(n,()=>this._triggerRenderFrame());this._add("scrollZoom",J,["mousePan"]),e.interactive&&e.scrollZoom&&n.scrollZoom.enable(e.scrollZoom);const re=n.keyboard=new nu(n);this._add("keyboard",re),e.interactive&&e.keyboard&&n.keyboard.enable(),this._add("blockableMapEvent",new _s(n))}_add(e,n,l){this._handlers.push({handlerName:e,handler:n,allowed:l}),this._handlersById[e]=n}stop(e){if(!this._updatingCamera){for(const{handler:n}of this._handlers)n.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Us(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,n,l){for(const u in e)if(u!==l&&(!n||n.indexOf(u)<0))return!0;return!1}_getMapTouches(e){const n=[];for(const l of e)this._el.contains(l.target)&&n.push(l);return n}mergeHandlerResult(e,n,l,u,m){if(!l)return;d.e(e,l);const y={handlerName:u,originalEvent:l.originalEvent||m};l.zoomDelta!==void 0&&(n.zoom=y),l.panDelta!==void 0&&(n.drag=y),l.rollDelta!==void 0&&(n.roll=y),l.pitchDelta!==void 0&&(n.pitch=y),l.bearingDelta!==void 0&&(n.rotate=y)}_applyChanges(){const e={},n={},l={};for(const[u,m,y]of this._changes)u.panDelta&&(e.panDelta=(e.panDelta||new d.P(0,0))._add(u.panDelta)),u.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+u.zoomDelta),u.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+u.bearingDelta),u.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+u.pitchDelta),u.rollDelta&&(e.rollDelta=(e.rollDelta||0)+u.rollDelta),u.around!==void 0&&(e.around=u.around),u.pinchAround!==void 0&&(e.pinchAround=u.pinchAround),u.noInertia&&(e.noInertia=u.noInertia),d.e(n,m),d.e(l,y);this._updateMapTransform(e,n,l),this._changes=[]}_updateMapTransform(e,n,l){const u=this._map,m=u._getTransformForUpdate(),y=u.terrain;if(!(Vn(e)||y&&this._terrainMovement))return this._fireEvents(n,l,!0);u._stop(!0);let{panDelta:b,zoomDelta:T,bearingDelta:E,pitchDelta:z,rollDelta:D,around:I,pinchAround:F}=e;F!==void 0&&(I=F),I=I||u.transform.centerPoint,y&&!m.isPointOnMapSurface(I)&&(I=m.centerPoint);const N={panDelta:b,zoomDelta:T,rollDelta:D,pitchDelta:z,bearingDelta:E,around:I};this._map.cameraHelper.useGlobeControls&&!m.isPointOnMapSurface(I)&&(I=m.centerPoint);const Y=I.distSqr(m.centerPoint)<.01?m.center:m.screenPointToLocation(b?I.sub(b):I);y?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(N,m),this._terrainMovement||!n.drag&&!n.zoom?n.drag&&this._terrainMovement?m.setCenter(m.screenPointToLocation(m.centerPoint.sub(b))):this._map.cameraHelper.handleMapControlsPan(N,m,Y):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(N,m,Y))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(N,m),this._map.cameraHelper.handleMapControlsPan(N,m,Y)),u._applyUpdatedTransform(m),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(n,l,!0)}_fireEvents(e,n,l){const u=Us(this._eventsInProgress),m=Us(e),y={};for(const D in e){const{originalEvent:I}=e[D];this._eventsInProgress[D]||(y[`${D}start`]=I),this._eventsInProgress[D]=e[D]}!u&&m&&this._fireEvent("movestart",m.originalEvent);for(const D in y)this._fireEvent(D,y[D]);m&&this._fireEvent("move",m.originalEvent);for(const D in e){const{originalEvent:I}=e[D];this._fireEvent(D,I)}const b={};let T;for(const D in this._eventsInProgress){const{handlerName:I,originalEvent:F}=this._eventsInProgress[D];this._handlersById[I].isActive()||(delete this._eventsInProgress[D],T=n[I]||F,b[`${D}end`]=T)}for(const D in b)this._fireEvent(D,b[D]);const E=Us(this._eventsInProgress),z=(u||m)&&!E;if(z&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const D=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&D.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(D)}if(l&&z){this._updatingCamera=!0;const D=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),I=F=>F!==0&&-this._bearingSnap<F&&F<this._bearingSnap;!D||!D.essential&&at.prefersReducedMotion?(this._map.fire(new d.l("moveend",{originalEvent:T})),I(this._map.getBearing())&&this._map.resetNorth()):(I(D.bearing||this._map.getBearing())&&(D.bearing=0),D.freezeElevation=!0,this._map.easeTo(D,{originalEvent:T})),this._updatingCamera=!1}}_fireEvent(e,n){this._map.fire(new d.l(e,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new al("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class mt extends d.E{constructor(e,n,l){super(),this._renderFrameCallback=()=>{const u=Math.min((at.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(u)),u<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=l.bearingSnap,this.cameraHelper=n,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,n){e.apply(this.transform),this.transform=e,this.cameraHelper=n}getCenter(){return new d.Q(this.transform.center.lng,this.transform.center.lat)}setCenter(e,n){return this.jumpTo({center:e},n)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,n){return this.jumpTo({elevation:e},n),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,n,l){return e=d.P.convert(e).mult(-1),this.panTo(this.transform.center,d.e({offset:e},n),l)}panTo(e,n,l){return this.easeTo(d.e({center:e},n),l)}getZoom(){return this.transform.zoom}setZoom(e,n){return this.jumpTo({zoom:e},n),this}zoomTo(e,n,l){return this.easeTo(d.e({zoom:e},n),l)}zoomIn(e,n){return this.zoomTo(this.getZoom()+1,e,n),this}zoomOut(e,n){return this.zoomTo(this.getZoom()-1,e,n),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,n){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new d.l("movestart",n)).fire(new d.l("move",n)).fire(new d.l("moveend",n))),this}getBearing(){return this.transform.bearing}setBearing(e,n){return this.jumpTo({bearing:e},n),this}getPadding(){return this.transform.padding}setPadding(e,n){return this.jumpTo({padding:e},n),this}rotateTo(e,n,l){return this.easeTo(d.e({bearing:e},n),l)}resetNorth(e,n){return this.rotateTo(0,d.e({duration:1e3},e),n),this}resetNorthPitch(e,n){return this.easeTo(d.e({bearing:0,pitch:0,roll:0,duration:1e3},e),n),this}snapToNorth(e,n){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,n):this}getPitch(){return this.transform.pitch}setPitch(e,n){return this.jumpTo({pitch:e},n),this}getRoll(){return this.transform.roll}setRoll(e,n){return this.jumpTo({roll:e},n),this}cameraForBounds(e,n){e=Fi.convert(e).adjustAntiMeridian();const l=n&&n.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),l,n)}_cameraForBoxAndBearing(e,n,l,u){const m={top:0,bottom:0,right:0,left:0};if(typeof(u=d.e({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},u)).padding=="number"){const E=u.padding;u.padding={top:E,bottom:E,right:E,left:E}}const y=d.e(m,u.padding);u.padding=y;const b=this.transform,T=new Fi(e,n);return this.cameraHelper.cameraForBoxAndBearing(u,y,T,l,b)}fitBounds(e,n,l){return this._fitInternal(this.cameraForBounds(e,n),n,l)}fitScreenCoordinates(e,n,l,u,m){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(d.P.convert(e)),this.transform.screenPointToLocation(d.P.convert(n)),l,u),u,m)}_fitInternal(e,n,l){return e?(delete(n=d.e(e,n)).padding,n.linear?this.easeTo(n,l):this.flyTo(n,l)):this}jumpTo(e,n){this.stop();const l=this._getTransformForUpdate();let u=!1,m=!1,y=!1;const b=l.zoom;this.cameraHelper.handleJumpToCenterZoom(l,e);const T=l.zoom!==b;return"elevation"in e&&l.elevation!==+e.elevation&&l.setElevation(+e.elevation),"bearing"in e&&l.bearing!==+e.bearing&&(u=!0,l.setBearing(+e.bearing)),"pitch"in e&&l.pitch!==+e.pitch&&(m=!0,l.setPitch(+e.pitch)),"roll"in e&&l.roll!==+e.roll&&(y=!0,l.setRoll(+e.roll)),e.padding==null||l.isPaddingEqual(e.padding)||l.setPadding(e.padding),this._applyUpdatedTransform(l),this.fire(new d.l("movestart",n)).fire(new d.l("move",n)),T&&this.fire(new d.l("zoomstart",n)).fire(new d.l("zoom",n)).fire(new d.l("zoomend",n)),u&&this.fire(new d.l("rotatestart",n)).fire(new d.l("rotate",n)).fire(new d.l("rotateend",n)),m&&this.fire(new d.l("pitchstart",n)).fire(new d.l("pitch",n)).fire(new d.l("pitchend",n)),y&&this.fire(new d.l("rollstart",n)).fire(new d.l("roll",n)).fire(new d.l("rollend",n)),this.fire(new d.l("moveend",n))}calculateCameraOptionsFromTo(e,n,l,u=0){const m=d.$.fromLngLat(e,n),y=d.$.fromLngLat(l,u),b=y.x-m.x,T=y.y-m.y,E=y.z-m.z,z=Math.hypot(b,T,E);if(z===0)throw new Error("Can't calculate camera options with same From and To");const D=Math.hypot(b,T),I=d.aa(this.transform.cameraToCenterDistance/z/this.transform.tileSize),F=180*Math.atan2(b,-T)/Math.PI;let N=180*Math.acos(D/z)/Math.PI;return N=E<0?90-N:90+N,{center:y.toLngLat(),elevation:u,zoom:I,pitch:N,bearing:F}}calculateCameraOptionsFromCameraLngLatAltRotation(e,n,l,u,m){const y=this.transform.calculateCenterFromCameraLngLatAlt(e,n,l,u);return{center:y.center,elevation:y.elevation,zoom:y.zoom,bearing:l,pitch:u,roll:m}}easeTo(e,n){this._stop(!1,e.easeId),((e=d.e({offset:[0,0],duration:500,easing:d.ca},e)).animate===!1||!e.essential&&at.prefersReducedMotion)&&(e.duration=0);const l=this._getTransformForUpdate(),u=this.getBearing(),m=l.pitch,y=l.roll,b="bearing"in e?this._normalizeBearing(e.bearing,u):u,T="pitch"in e?+e.pitch:m,E="roll"in e?this._normalizeBearing(e.roll,y):y,z="padding"in e?e.padding:l.padding,D=d.P.convert(e.offset);let I,F;e.around&&(I=d.Q.convert(e.around),F=l.locationToScreenPoint(I));const N={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},Y=this.cameraHelper.handleEaseTo(l,{bearing:b,pitch:T,roll:E,padding:z,around:I,aroundPoint:F,offsetAsPoint:D,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||u!==b,this._pitching=this._pitching||T!==m,this._rolling=this._rolling||E!==y,this._padding=!l.isPaddingEqual(z),this._zooming=this._zooming||Y.isZooming,this._easeId=e.easeId,this._prepareEase(n,e.noMoveStart,N),this.terrain&&this._prepareElevation(Y.elevationCenter),this._ease(X=>{Y.easeFunc(X),this.terrain&&!e.freezeElevation&&this._updateElevation(X),this._applyUpdatedTransform(l),this._fireMoveEvents(n)},X=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(n,X)},e),this}_prepareEase(e,n,l={}){this._moving=!0,n||l.moving||this.fire(new d.l("movestart",e)),this._zooming&&!l.zooming&&this.fire(new d.l("zoomstart",e)),this._rotating&&!l.rotating&&this.fire(new d.l("rotatestart",e)),this._pitching&&!l.pitching&&this.fire(new d.l("pitchstart",e)),this._rolling&&!l.rolling&&this.fire(new d.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const n=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&n!==this._elevationTarget){const l=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(l-(n-(l*e+this._elevationStart))/(1-e)),this._elevationTarget=n}this.transform.setElevation(d.B.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const n=e.getCameraLngLat(),l=e.getCameraAltitude(),u=this.terrain?this.terrain.getElevationForLngLatZoom(n,e.zoom):0;if(l<u){const m=this.calculateCameraOptionsFromTo(n,u,e.center,e.elevation);return{pitch:m.pitch,zoom:m.zoom}}return{}}_applyUpdatedTransform(e){const n=[];if(n.push(u=>this._elevateCameraIfInsideTerrain(u)),this.transformCameraUpdate&&n.push(u=>this.transformCameraUpdate(u)),!n.length)return;const l=e.clone();for(const u of n){const m=l.clone(),{center:y,zoom:b,roll:T,pitch:E,bearing:z,elevation:D}=u(m);y&&m.setCenter(y),D!==void 0&&m.setElevation(D),b!==void 0&&m.setZoom(b),T!==void 0&&m.setRoll(T),E!==void 0&&m.setPitch(E),z!==void 0&&m.setBearing(z),l.apply(m)}this.transform.apply(l)}_fireMoveEvents(e){this.fire(new d.l("move",e)),this._zooming&&this.fire(new d.l("zoom",e)),this._rotating&&this.fire(new d.l("rotate",e)),this._pitching&&this.fire(new d.l("pitch",e)),this._rolling&&this.fire(new d.l("roll",e))}_afterEase(e,n){if(this._easeId&&n&&this._easeId===n)return;delete this._easeId;const l=this._zooming,u=this._rotating,m=this._pitching,y=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,l&&this.fire(new d.l("zoomend",e)),u&&this.fire(new d.l("rotateend",e)),m&&this.fire(new d.l("pitchend",e)),y&&this.fire(new d.l("rollend",e)),this.fire(new d.l("moveend",e))}flyTo(e,n){if(!e.essential&&at.prefersReducedMotion){const Ie=d.O(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Ie,n)}this.stop(),e=d.e({offset:[0,0],speed:1.2,curve:1.42,easing:d.ca},e);const l=this._getTransformForUpdate(),u=l.bearing,m=l.pitch,y=l.roll,b=l.padding,T="bearing"in e?this._normalizeBearing(e.bearing,u):u,E="pitch"in e?+e.pitch:m,z="roll"in e?this._normalizeBearing(e.roll,y):y,D="padding"in e?e.padding:l.padding,I=d.P.convert(e.offset);let F=l.centerPoint.add(I);const N=l.screenPointToLocation(F),Y=this.cameraHelper.handleFlyTo(l,{bearing:T,pitch:E,roll:z,padding:D,locationAtOffset:N,offsetAsPoint:I,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let X=e.curve;const K=Math.max(l.width,l.height),J=K/Y.scaleOfZoom,re=Y.pixelPathLength;typeof Y.scaleOfMinZoom=="number"&&(X=Math.sqrt(K/Y.scaleOfMinZoom/re*2));const ae=X*X;function oe(Ie){const et=(J*J-K*K+(Ie?-1:1)*ae*ae*re*re)/(2*(Ie?J:K)*ae*re);return Math.log(Math.sqrt(et*et+1)-et)}function he(Ie){return(Math.exp(Ie)-Math.exp(-Ie))/2}function ce(Ie){return(Math.exp(Ie)+Math.exp(-Ie))/2}const we=oe(!1);let Me=function(Ie){return ce(we)/ce(we+X*Ie)},ke=function(Ie){return K*((ce(we)*(he(et=we+X*Ie)/ce(et))-he(we))/ae)/re;var et},Le=(oe(!0)-we)/X;if(Math.abs(re)<2e-6||!isFinite(Le)){if(Math.abs(K-J)<1e-6)return this.easeTo(e,n);const Ie=J<K?-1:1;Le=Math.abs(Math.log(J/K))/X,ke=()=>0,Me=et=>Math.exp(Ie*X*et)}return e.duration="duration"in e?+e.duration:1e3*Le/("screenSpeed"in e?+e.screenSpeed/X:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=u!==T,this._pitching=E!==m,this._rolling=z!==y,this._padding=!l.isPaddingEqual(D),this._prepareEase(n,!1),this.terrain&&this._prepareElevation(Y.targetCenter),this._ease(Ie=>{const et=Ie*Le,We=1/Me(et),Ge=ke(et);this._rotating&&l.setBearing(d.B.number(u,T,Ie)),this._pitching&&l.setPitch(d.B.number(m,E,Ie)),this._rolling&&l.setRoll(d.B.number(y,z,Ie)),this._padding&&(l.interpolatePadding(b,D,Ie),F=l.centerPoint.add(I)),Y.easeFunc(Ie,We,Ge,F),this.terrain&&!e.freezeElevation&&this._updateElevation(Ie),this._applyUpdatedTransform(l),this._fireMoveEvents(n)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(n)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,n){var l;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const u=this._onEaseEnd;delete this._onEaseEnd,u.call(this,n)}return e||(l=this.handlers)===null||l===void 0||l.stop(!1),this}_ease(e,n,l){l.animate===!1||l.duration===0?(e(1),n()):(this._easeStart=at.now(),this._easeOptions=l,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,n){e=d.aK(e,-180,180);const l=Math.abs(e-n);return Math.abs(e-360-n)<l&&(e-=360),Math.abs(e+360-n)<l&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(d.Q.convert(e),this.transform.tileZoom):null}}const yt={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class tc{constructor(e=yt){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=n=>{!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"&&n.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=_e.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=_e.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=_e.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){_e.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._sanitizedAttributionHTML=void 0}_setElementTitle(e,n){const l=this._map._getUIString(`AttributionControl.${n}`);e.title=l,e.setAttribute("aria-label",l)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(u=>typeof u!="string"?"":u)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const u=this._map.style.stylesheet;this.styleOwner=u.owner,this.styleId=u.id}const n=this._map.style.sourceCaches;for(const u in n){const m=n[u];if(m.used||m.usedForTerrain){const y=m.getSource();y.attribution&&e.indexOf(y.attribution)<0&&e.push(y.attribution)}}e=e.filter(u=>String(u).trim()),e.sort((u,m)=>u.length-m.length),e=e.filter((u,m)=>{for(let y=m+1;y<e.length;y++)if(e[y].indexOf(u)>=0)return!1;return!0});const l=e.join(" | ");l!==this._sanitizedAttributionHTML&&(this._sanitizedAttributionHTML=_e.sanitize(l),e.length?(this._innerContainer.innerHTML=this._sanitizedAttributionHTML,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Vi{constructor(e={}){this._updateCompact=()=>{const n=this._container.children;if(n.length){const l=n[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&l.classList.add("maplibregl-compact"):l.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=_e.create("div","maplibregl-ctrl");const n=_e.create("a","maplibregl-ctrl-logo");return n.target="_blank",n.rel="noopener nofollow",n.href="https://maplibre.org/",n.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),n.setAttribute("rel","noopener nofollow"),this._container.appendChild(n),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){_e.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class ic{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const n=++this._id;return this._queue.push({callback:e,id:n,cancelled:!1}),n}remove(e){const n=this._currentlyRunning,l=n?this._queue.concat(n):this._queue;for(const u of l)if(u.id===e)return void(u.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const n=this._currentlyRunning=this._queue;this._queue=[];for(const l of n)if(!l.cancelled&&(l.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var lr=d.aC([{name:"a_pos3d",type:"Int16",components:3}]);class Xu extends d.E{constructor(e){super(),this._lastTilesetChange=at.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,n){this.sourceCache.update(e,n),this._renderableTilesKeys=[];const l={};for(const u of ye(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:n,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))l[u.key]=!0,this._renderableTilesKeys.push(u.key),this._tiles[u.key]||(u.terrainRttPosMatrix32f=new Float64Array(16),d.bN(u.terrainRttPosMatrix32f,0,d.Z,d.Z,0,0,1),this._tiles[u.key]=new Ts(u,this.tileSize),this._lastTilesetChange=at.now());for(const u in this._tiles)l[u]||delete this._tiles[u]}freeRtt(e){for(const n in this._tiles){const l=this._tiles[n];(!e||l.tileID.equals(e)||l.tileID.isChildOf(e)||e.isChildOf(l.tileID))&&(l.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){const n={};for(const l of this._renderableTilesKeys){const u=this._tiles[l].tileID,m=e.clone(),y=d.b1();if(u.canonical.equals(e.canonical))d.bN(y,0,d.Z,d.Z,0,0,1);else if(u.canonical.isChildOf(e.canonical)){const b=u.canonical.z-e.canonical.z,T=u.canonical.x-(u.canonical.x>>b<<b),E=u.canonical.y-(u.canonical.y>>b<<b),z=d.Z>>b;d.bN(y,0,z,z,0,0,1),d.L(y,y,[-T*z,-E*z,0])}else{if(!e.canonical.isChildOf(u.canonical))continue;{const b=e.canonical.z-u.canonical.z,T=e.canonical.x-(e.canonical.x>>b<<b),E=e.canonical.y-(e.canonical.y>>b<<b),z=d.Z>>b;d.bN(y,0,d.Z,d.Z,0,0,1),d.L(y,y,[T*z,E*z,0]),d.M(y,y,[1/2**b,1/2**b,0])}}m.terrainRttPosMatrix32f=new Float32Array(y),n[l]=m}return n}getSourceTile(e,n){const l=this.sourceCache._source;let u=e.overscaledZ-this.deltaZoom;if(u>l.maxzoom&&(u=l.maxzoom),u<l.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(u).key);let m=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!m||!m.dem)&&n)for(;u>=l.minzoom&&(!m||!m.dem);)m=this.sourceCache.getTileByID(e.scaledTo(u--).key);return m}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}}class za{constructor(e,n,l){this._meshCache={},this.painter=e,this.sourceCache=new Xu(n),this.options=l,this.exaggeration=typeof l.exaggeration=="number"?l.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,n,l,u=d.Z){var m;if(!(n>=0&&n<u&&l>=0&&l<u))return 0;const y=this.getTerrainData(e),b=(m=y.tile)===null||m===void 0?void 0:m.dem;if(!b)return 0;const T=d.cb([],[n/u*d.Z,l/u*d.Z],y.u_terrain_matrix),E=[T[0]*b.dim,T[1]*b.dim],z=Math.floor(E[0]),D=Math.floor(E[1]),I=E[0]-z,F=E[1]-D;return b.get(z,D)*(1-I)*(1-F)+b.get(z+1,D)*I*(1-F)+b.get(z,D+1)*(1-I)*F+b.get(z+1,D+1)*I*F}getElevationForLngLatZoom(e,n){if(!d.cc(n,e.wrap()))return 0;const{tileID:l,mercatorX:u,mercatorY:m}=this._getOverscaledTileIDFromLngLatZoom(e,n);return this.getElevation(l,u%d.Z,m%d.Z,d.Z)}getElevation(e,n,l,u=d.Z){return this.getDEMElevation(e,n,l,u)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const u=this.painter.context,m=new d.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new gi(u,m,u.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new gi(u,new d.R({width:1,height:1}),u.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(u.gl.NEAREST,u.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=d.as([])}const n=this.sourceCache.getSourceTile(e,!0);if(n&&n.dem&&(!n.demTexture||n.needsTerrainPrepare)){const u=this.painter.context;n.demTexture=this.painter.getTileTexture(n.dem.stride),n.demTexture?n.demTexture.update(n.dem.getPixels(),{premultiply:!1}):n.demTexture=new gi(u,n.dem.getPixels(),u.gl.RGBA,{premultiply:!1}),n.demTexture.bind(u.gl.NEAREST,u.gl.CLAMP_TO_EDGE),n.needsTerrainPrepare=!1}const l=n&&n+n.tileID.key+e.key;if(l&&!this._demMatrixCache[l]){const u=this.sourceCache.sourceCache._source.maxzoom;let m=e.canonical.z-n.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=u?m=e.canonical.z-u:d.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const y=e.canonical.x-(e.canonical.x>>m<<m),b=e.canonical.y-(e.canonical.y>>m<<m),T=d.cd(new Float64Array(16),[1/(d.Z<<m),1/(d.Z<<m),0]);d.L(T,T,[y*d.Z,b*d.Z,0]),this._demMatrixCache[e.key]={matrix:T,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:n&&n.dem&&n.dem.dim||1,u_terrain_matrix:l?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:n&&n.dem&&n.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(n&&n.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:n}}getFramebuffer(e){const n=this.painter,l=n.width/devicePixelRatio,u=n.height/devicePixelRatio;return!this._fbo||this._fbo.width===l&&this._fbo.height===u||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new gi(n.context,{width:l,height:u,data:null},n.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(n.context.gl.NEAREST,n.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new gi(n.context,{width:l,height:u,data:null},n.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(n.context.gl.NEAREST,n.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=n.context.createFramebuffer(l,u,!0,!1),this._fbo.depthAttachment.set(n.context.createRenderbuffer(n.context.gl.DEPTH_COMPONENT16,l,u))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const n=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let m=0,y=0;m<this._coordsTextureSize;m++)for(let b=0;b<this._coordsTextureSize;b++,y+=4)n[y+0]=255&b,n[y+1]=255&m,n[y+2]=b>>8<<4|m>>8,n[y+3]=0;const l=new d.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(n.buffer)),u=new gi(e,l,e.gl.RGBA,{premultiply:!1});return u.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=u,u}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const n=new Uint8Array(4),l=this.painter.context,u=l.gl,m=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),y=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),b=Math.round(this.painter.height/devicePixelRatio);l.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),u.readPixels(m,b-y-1,1,1,u.RGBA,u.UNSIGNED_BYTE,n),l.bindFramebuffer.set(null);const T=n[0]+(n[2]>>4<<8),E=n[1]+((15&n[2])<<8),z=this.coordsIndex[255-n[3]],D=z&&this.sourceCache.getTileByID(z);if(!D)return null;const I=this._coordsTextureSize,F=(1<<D.tileID.canonical.z)*I;return new d.$((D.tileID.canonical.x*I+T)/F+D.tileID.wrap,(D.tileID.canonical.y*I+E)/F,this.getElevation(D.tileID,T,E,I))}depthAtPoint(e){const n=new Uint8Array(4),l=this.painter.context,u=l.gl;return l.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),u.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,u.RGBA,u.UNSIGNED_BYTE,n),l.bindFramebuffer.set(null),(n[0]/16777216+n[1]/65536+n[2]/256+n[3])/256}getTerrainMesh(e){var n;const l=((n=this.painter.style.projection)===null||n===void 0?void 0:n.transitionState)>0,u=l&&e.canonical.y===0,m=l&&e.canonical.y===(1<<e.canonical.z)-1,y=`m_${u?"n":""}_${m?"s":""}`;if(this._meshCache[y])return this._meshCache[y];const b=this.painter.context,T=new d.ce,E=new d.aG,z=this.meshSize,D=d.Z/z,I=z*z;for(let ce=0;ce<=z;ce++)for(let we=0;we<=z;we++)T.emplaceBack(we*D,ce*D,0);for(let ce=0;ce<I;ce+=z+1)for(let we=0;we<z;we++)E.emplaceBack(we+ce,z+we+ce+1,z+we+ce+2),E.emplaceBack(we+ce,z+we+ce+2,we+ce+1);const F=T.length,N=F+(z+1),Y=(z+1)*z,X=u?d.b8:0,K=u?0:1,J=m?d.b9:d.Z,re=m?0:1;for(let ce=0;ce<=z;ce++)T.emplaceBack(ce*D,X,K);for(let ce=0;ce<=z;ce++)T.emplaceBack(ce*D,J,re);for(let ce=0;ce<z;ce++)E.emplaceBack(Y+ce,N+ce,N+ce+1),E.emplaceBack(Y+ce,N+ce+1,Y+ce+1),E.emplaceBack(0+ce,F+ce+1,F+ce),E.emplaceBack(0+ce,0+ce+1,F+ce+1);const ae=T.length,oe=ae+2*(z+1);for(const ce of[0,1])for(let we=0;we<=z;we++)for(const Me of[0,1])T.emplaceBack(ce*d.Z,we*D,Me);for(let ce=0;ce<2*z;ce+=2)E.emplaceBack(ae+ce,ae+ce+1,ae+ce+3),E.emplaceBack(ae+ce,ae+ce+3,ae+ce+2),E.emplaceBack(oe+ce,oe+ce+3,oe+ce+1),E.emplaceBack(oe+ce,oe+ce+2,oe+ce+3);const he=new mr(b.createVertexBuffer(T,lr.members),b.createIndexBuffer(E),d.aF.simpleSegment(0,0,T.length,E.length));return this._meshCache[y]=he,he}getMeshFrameDelta(e){return 2*Math.PI*d.bq/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,n){var l;const{tileID:u}=this._getOverscaledTileIDFromLngLatZoom(e,n);return(l=this.getMinMaxElevation(u).minElevation)!==null&&l!==void 0?l:0}getMinMaxElevation(e){const n=this.getTerrainData(e).tile,l={minElevation:null,maxElevation:null};return n&&n.dem&&(l.minElevation=n.dem.min*this.exaggeration,l.maxElevation=n.dem.max*this.exaggeration),l}_getOverscaledTileIDFromLngLatZoom(e,n){const l=d.$.fromLngLat(e.wrap()),u=(1<<n)*d.Z,m=l.x*u,y=l.y*u,b=Math.floor(m/d.Z),T=Math.floor(y/d.Z);return{tileID:new d.Y(n,0,n,b,T),mercatorX:m,mercatorY:y}}}class zd{constructor(e,n,l){this._context=e,this._size=n,this._tileSize=l,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const n=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),l=new gi(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return l.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),n.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),n.colorAttachment.set(l.texture),{id:e,fbo:n,texture:l,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(n=>e.id!==n),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const n of this._recentlyUsed)if(!this._objects[n].inUse)return this._objects[n];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const ua={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Ii{constructor(e,n){this.painter=e,this.terrain=n,this.pool=new zd(e.context,30,n.sourceCache.tileSize*n.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,n){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(l=>!e._layers[l].isHidden(n)),this._coordsAscending={};for(const l in e.sourceCaches){this._coordsAscending[l]={};const u=e.sourceCaches[l].getVisibleCoordinates();for(const m of u){const y=this.terrain.sourceCache.getTerrainCoords(m);for(const b in y)this._coordsAscending[l][b]||(this._coordsAscending[l][b]=[]),this._coordsAscending[l][b].push(y[b])}}this._coordsAscendingStr={};for(const l of e._order){const u=e._layers[l],m=u.source;if(ua[u.type]&&!this._coordsAscendingStr[m]){this._coordsAscendingStr[m]={};for(const y in this._coordsAscending[m])this._coordsAscendingStr[m][y]=this._coordsAscending[m][y].map(b=>b.key).sort().join()}}for(const l of this._renderableTiles)for(const u in this._coordsAscendingStr){const m=this._coordsAscendingStr[u][l.tileID.key];m&&m!==l.rttCoords[u]&&(l.rtt=[])}}renderLayer(e,n){if(e.isHidden(this.painter.transform.zoom))return!1;const l=Object.assign(Object.assign({},n),{isRenderingToTexture:!0}),u=e.type,m=this.painter,y=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(ua[u]&&(this._prevType&&ua[this._prevType]||this._stacks.push([]),this._prevType=u,this._stacks[this._stacks.length-1].push(e.id),!y))return!0;if(ua[this._prevType]||ua[u]&&y){this._prevType=u;const b=this._stacks.length-1,T=this._stacks[b]||[];for(const E of this._renderableTiles){if(this.pool.isFull()&&(ho(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(E),E.rtt[b]){const D=this.pool.getObjectForId(E.rtt[b].id);if(D.stamp===E.rtt[b].stamp){this.pool.useObject(D);continue}}const z=this.pool.getOrCreateFreeObject();this.pool.useObject(z),this.pool.stampObject(z),E.rtt[b]={id:z.id,stamp:z.stamp},m.context.bindFramebuffer.set(z.fbo.framebuffer),m.context.clear({color:d.b6.transparent,stencil:0}),m.currentStencilSource=void 0;for(let D=0;D<T.length;D++){const I=m.style._layers[T[D]],F=I.source?this._coordsAscending[I.source][E.tileID.key]:[E.tileID];m.context.viewport.set([0,0,z.fbo.width,z.fbo.height]),m._renderTileClippingMasks(I,F,!0),m.renderLayer(m,m.style.sourceCaches[I.source],I,F,l),I.source&&(E.rttCoords[I.source]=this._coordsAscendingStr[I.source][E.tileID.key])}}return ho(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects(),ua[u]}return!1}}const Xi={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use âŒ˜ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},br=it,Ri={hash:!1,interactive:!0,bearingSnap:7,attributionControl:yt,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:d.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},_o={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class yo{constructor(e,n,l=!1){this.mousedown=m=>{this.startMove(m,_e.mousePos(this.element,m)),_e.addEventListener(window,"mousemove",this.mousemove),_e.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=m=>{this.move(m,_e.mousePos(this.element,m))},this.mouseup=m=>{this._rotatePitchHanlder.dragEnd(m),this.offTemp()},this.touchstart=m=>{m.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=_e.touchPos(this.element,m.targetTouches)[0],this.startMove(m,this._startPos),_e.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),_e.addEventListener(window,"touchend",this.touchend))},this.touchmove=m=>{m.targetTouches.length!==1?this.reset():(this._lastPos=_e.touchPos(this.element,m.targetTouches)[0],this.move(m,this._lastPos))},this.touchend=m=>{m.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=n;const u=new Jl;this._rotatePitchHanlder=new zr({clickTolerance:3,move:(m,y)=>{const b=n.getBoundingClientRect(),T=new d.P((b.bottom-b.top)/2,(b.right-b.left)/2);return{bearingDelta:d.c9(new d.P(m.x,y.y),y,T),pitchDelta:l?-.5*(y.y-m.y):void 0}},moveStateManager:u,enable:!0,assignEvents:()=>{}}),this.map=e,_e.addEventListener(n,"mousedown",this.mousedown),_e.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),_e.addEventListener(n,"touchcancel",this.reset)}startMove(e,n){this._rotatePitchHanlder.dragStart(e,n),_e.disableDrag()}move(e,n){const l=this.map,{bearingDelta:u,pitchDelta:m}=this._rotatePitchHanlder.dragMove(e,n)||{};u&&l.setBearing(l.getBearing()+u),m&&l.setPitch(l.getPitch()+m)}off(){const e=this.element;_e.removeEventListener(e,"mousedown",this.mousedown),_e.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),_e.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),_e.removeEventListener(window,"touchend",this.touchend),_e.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){_e.enableDrag(),_e.removeEventListener(window,"mousemove",this.mousemove),_e.removeEventListener(window,"mouseup",this.mouseup),_e.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),_e.removeEventListener(window,"touchend",this.touchend)}}let ha;function sl(f,e,n){const l=new d.Q(f.lng,f.lat);if(f=new d.Q(f.lng,f.lat),e){const u=new d.Q(f.lng-360,f.lat),m=new d.Q(f.lng+360,f.lat),y=n.locationToScreenPoint(f).distSqr(e);n.locationToScreenPoint(u).distSqr(e)<y?f=u:n.locationToScreenPoint(m).distSqr(e)<y&&(f=m)}for(;Math.abs(f.lng-n.center.lng)>180;){const u=n.locationToScreenPoint(f);if(u.x>=0&&u.y>=0&&u.x<=n.width&&u.y<=n.height)break;f.lng>n.center.lng?f.lng-=360:f.lng+=360}return f.lng!==l.lng&&n.isPointOnMapSurface(n.locationToScreenPoint(f))?f:l}const wr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function vo(f,e,n){const l=f.classList;for(const u in wr)l.remove(`maplibregl-${n}-anchor-${u}`);l.add(`maplibregl-${n}-anchor-${e}`)}class xo extends d.E{constructor(e){if(super(),this._onKeyPress=n=>{const l=n.code,u=n.charCode||n.keyCode;l!=="Space"&&l!=="Enter"&&u!==32&&u!==13||this.togglePopup()},this._onMapClick=n=>{const l=n.originalEvent.target,u=this._element;this._popup&&(l===u||u.contains(l))&&this.togglePopup()},this._update=n=>{var l;if(!this._map)return;const u=this._map.loaded()&&!this._map.isMoving();((n==null?void 0:n.type)==="terrain"||(n==null?void 0:n.type)==="render"&&!u)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?sl(this._lngLat,this._flatPos,this._map.transform):(l=this._lngLat)===null||l===void 0?void 0:l.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let m="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?m=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(m=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||n&&n.type!=="moveend"||(this._pos=this._pos.round()),_e.setTransform(this._element,`${wr[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${y} ${m}`),at.frameAsync(new AbortController).then(()=>{this._updateOpacity(n&&n.type==="moveend")}).catch(()=>{})},this._onMove=n=>{if(!this._isDragging){const l=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new d.l("dragstart"))),this.fire(new d.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new d.l("dragend")),this._state="inactive"},this._addDragHandler=n=>{this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=d.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=_e.create("div");const n=_e.createNS("http://www.w3.org/2000/svg","svg"),l=41,u=27;n.setAttributeNS(null,"display","block"),n.setAttributeNS(null,"height",`${l}px`),n.setAttributeNS(null,"width",`${u}px`),n.setAttributeNS(null,"viewBox",`0 0 ${u} ${l}`);const m=_e.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"stroke","none"),m.setAttributeNS(null,"stroke-width","1"),m.setAttributeNS(null,"fill","none"),m.setAttributeNS(null,"fill-rule","evenodd");const y=_e.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"fill-rule","nonzero");const b=_e.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"transform","translate(3.0, 29.0)"),b.setAttributeNS(null,"fill","#000000");const T=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const K of T){const J=_e.createNS("http://www.w3.org/2000/svg","ellipse");J.setAttributeNS(null,"opacity","0.04"),J.setAttributeNS(null,"cx","10.5"),J.setAttributeNS(null,"cy","5.80029008"),J.setAttributeNS(null,"rx",K.rx),J.setAttributeNS(null,"ry",K.ry),b.appendChild(J)}const E=_e.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill",this._color);const z=_e.createNS("http://www.w3.org/2000/svg","path");z.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),E.appendChild(z);const D=_e.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"opacity","0.25"),D.setAttributeNS(null,"fill","#000000");const I=_e.createNS("http://www.w3.org/2000/svg","path");I.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),D.appendChild(I);const F=_e.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"transform","translate(6.0, 7.0)"),F.setAttributeNS(null,"fill","#FFFFFF");const N=_e.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Y=_e.createNS("http://www.w3.org/2000/svg","circle");Y.setAttributeNS(null,"fill","#000000"),Y.setAttributeNS(null,"opacity","0.25"),Y.setAttributeNS(null,"cx","5.5"),Y.setAttributeNS(null,"cy","5.5"),Y.setAttributeNS(null,"r","5.4999962");const X=_e.createNS("http://www.w3.org/2000/svg","circle");X.setAttributeNS(null,"fill","#FFFFFF"),X.setAttributeNS(null,"cx","5.5"),X.setAttributeNS(null,"cy","5.5"),X.setAttributeNS(null,"r","5.4999962"),N.appendChild(Y),N.appendChild(X),y.appendChild(b),y.appendChild(E),y.appendChild(D),y.appendChild(F),y.appendChild(N),n.appendChild(y),n.setAttributeNS(null,"height",l*this._scale+"px"),n.setAttributeNS(null,"width",u*this._scale+"px"),this._element.appendChild(n),this._offset=d.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",n=>{n.preventDefault()}),this._element.addEventListener("mousedown",n=>{n.preventDefault()}),vo(this._element,this._anchor,"marker"),e&&e.className)for(const n of e.className.split(" "))this._element.classList.add(n);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),_e.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=d.Q.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const u=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[u,-1*(38.1-13.5+u)],"bottom-right":[-u,-1*(38.1-13.5+u)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var n,l;if(!(!((n=this._map)===null||n===void 0)&&n.terrain)){const D=this._map.transform.isLocationOccluded(this._lngLat)?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==D&&(this._element.style.opacity=D))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const u=this._map,m=u.terrain.depthAtPoint(this._pos),y=u.terrain.getElevationForLngLatZoom(this._lngLat,u.transform.tileZoom);if(u.transform.lngLatToCameraDepth(this._lngLat,y)-m<.006)return void(this._element.style.opacity=this._opacity);const b=-this._offset.y/u.transform.pixelsPerMeter,T=Math.sin(u.getPitch()*Math.PI/180)*b,E=u.terrain.depthAtPoint(new d.P(this._pos.x,this._pos.y-this._offset.y)),z=u.transform.lngLatToCameraDepth(this._lngLat,y+T)-E>.006;!((l=this._popup)===null||l===void 0)&&l.isOpen()&&z&&this._popup.remove(),this._element.style.opacity=z?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=d.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,n){return(this._opacity===void 0||e===void 0&&n===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),n!==void 0&&(this._opacityWhenCovered=n),this._map&&this._updateOpacity(!0),this}}const nc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let bo=0,Vs=!1;const su={maxWidth:100,unit:"metric"};function rc(f,e,n){const l=n&&n.maxWidth||100,u=f._container.clientHeight/2,m=f._container.clientWidth/2,y=f.unproject([m-l/2,u]),b=f.unproject([m+l/2,u]),T=Math.round(f.project(b).x-f.project(y).x),E=Math.min(l,T,f._container.clientWidth),z=y.distanceTo(b);if(n&&n.unit==="imperial"){const D=3.2808*z;D>5280?Zs(e,E,D/5280,f._getUIString("ScaleControl.Miles")):Zs(e,E,D,f._getUIString("ScaleControl.Feet"))}else n&&n.unit==="nautical"?Zs(e,E,z/1852,f._getUIString("ScaleControl.NauticalMiles")):z>=1e3?Zs(e,E,z/1e3,f._getUIString("ScaleControl.Kilometers")):Zs(e,E,z,f._getUIString("ScaleControl.Meters"))}function Zs(f,e,n,l){const u=function(m){const y=Math.pow(10,`${Math.floor(m)}`.length-1);let b=m/y;return b=b>=10?10:b>=5?5:b>=3?3:b>=2?2:b>=1?1:function(T){const E=Math.pow(10,Math.ceil(-Math.log(T)/Math.LN10));return Math.round(T*E)/E}(b),y*b}(n);f.style.width=e*(u/n)+"px",f.innerHTML=`${u}&nbsp;${l}`}const ac={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},sc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function oc(f){if(f){if(typeof f=="number"){const e=Math.round(Math.abs(f)/Math.SQRT2);return{center:new d.P(0,0),top:new d.P(0,f),"top-left":new d.P(e,e),"top-right":new d.P(-e,e),bottom:new d.P(0,-f),"bottom-left":new d.P(e,-e),"bottom-right":new d.P(-e,-e),left:new d.P(f,0),right:new d.P(-f,0)}}if(f instanceof d.P||Array.isArray(f)){const e=d.P.convert(f);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:d.P.convert(f.center||[0,0]),top:d.P.convert(f.top||[0,0]),"top-left":d.P.convert(f["top-left"]||[0,0]),"top-right":d.P.convert(f["top-right"]||[0,0]),bottom:d.P.convert(f.bottom||[0,0]),"bottom-left":d.P.convert(f["bottom-left"]||[0,0]),"bottom-right":d.P.convert(f["bottom-right"]||[0,0]),left:d.P.convert(f.left||[0,0]),right:d.P.convert(f.right||[0,0])}}return oc(new d.P(0,0))}const ou=it;O.AJAXError=d.ci,O.Event=d.l,O.Evented=d.E,O.LngLat=d.Q,O.MercatorCoordinate=d.$,O.Point=d.P,O.addProtocol=d.cj,O.config=d.a,O.removeProtocol=d.ck,O.AttributionControl=tc,O.BoxZoomHandler=eu,O.CanvasSource=Bo,O.CooperativeGesturesHandler=sn,O.DoubleClickZoomHandler=au,O.DragPanHandler=ca,O.DragRotateHandler=Gt,O.EdgeInsets=bn,O.FullscreenControl=class extends d.E{constructor(f={}){super(),this._onFullscreenChange=()=>{var e;let n=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=n==null?void 0:n.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)n=n.shadowRoot.fullscreenElement;n===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,f&&f.container&&(f.container instanceof HTMLElement?this._container=f.container:d.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=_e.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){_e.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const f=this._fullscreenButton=_e.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);_e.create("span","maplibregl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.title=f}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new d.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new d.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},O.GeoJSONSource=ja,O.GeolocateControl=class extends d.E{constructor(f){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new d.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new d.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const n=new d.Q(e.coords.longitude,e.coords.latitude),l=e.coords.accuracy,u=this._map.getBearing(),m=d.e({bearing:u},this.options.fitBoundsOptions),y=Fi.fromLngLat(n,l);this._map.fitBounds(y,m,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const n=new d.Q(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&Vs)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new d.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=_e.create("button","maplibregl-ctrl-geolocate",this._container),_e.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){d.w("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=_e.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new xo({element:this._dotElement}),this._circleElement=_e.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new xo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new d.l("trackuserlocationend")),this.fire(new d.l("userlocationlostfocus")))})}},this.options=d.e({},nc,f)}onAdd(f){return this._map=f,this._container=_e.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return d._(this,arguments,void 0,function*(e=!1){if(ha!==void 0&&!e)return ha;if(window.navigator.permissions===void 0)return ha=!!window.navigator.geolocation,ha;try{ha=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{ha=!!window.navigator.geolocation}return ha})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),_e.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,bo=0,Vs=!1}_isOutOfMapMaxBounds(f){const e=this._map.getMaxBounds(),n=f.coords;return e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const f=this._map.getBounds(),e=f.getSouthEast(),n=f.getNorthEast(),l=e.distanceTo(n),u=Math.ceil(this._accuracy/(l/this._map._container.clientHeight)*2);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}trigger(){if(!this._setup)return d.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new d.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":bo--,Vs=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new d.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new d.l("trackuserlocationstart")),this.fire(new d.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),bo++,bo>1?(f={maximumAge:6e5,timeout:0},Vs=!0):(f=this.options.positionOptions,Vs=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,f)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},O.GlobeControl=class{constructor(){this._toggleProjection=()=>{var f;const e=(f=this._map.getProjection())===null||f===void 0?void 0:f.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var f;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((f=this._map.getProjection())===null||f===void 0?void 0:f.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(f){return this._map=f,this._container=_e.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=_e.create("button","maplibregl-ctrl-globe",this._container),_e.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){_e.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},O.Hash=Ea,O.ImageSource=ta,O.KeyboardHandler=nu,O.LngLatBounds=Fi,O.LogoControl=Vi,O.Map=class extends mt{constructor(f){var e,n;d.cf.mark(d.cg.create);const l=Object.assign(Object.assign(Object.assign({},Ri),f),{canvasContextAttributes:Object.assign(Object.assign({},Ri.canvasContextAttributes),f.canvasContextAttributes)});if(l.minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const u=new Wn,m=new _r;if(l.minZoom!==void 0&&u.setMinZoom(l.minZoom),l.maxZoom!==void 0&&u.setMaxZoom(l.maxZoom),l.minPitch!==void 0&&u.setMinPitch(l.minPitch),l.maxPitch!==void 0&&u.setMaxPitch(l.maxPitch),l.renderWorldCopies!==void 0&&u.setRenderWorldCopies(l.renderWorldCopies),super(u,m,{bearingSnap:l.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new ic,this._controls=[],this._mapId=d.a3(),this._contextLost=b=>{b.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new d.l("webglcontextlost",{originalEvent:b}))},this._contextRestored=b=>{this._setupPainter(),this.resize(),this._update(),this.fire(new d.l("webglcontextrestored",{originalEvent:b}))},this._onMapScroll=b=>{if(b.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._maxTileCacheZoomLevels=l.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},l.canvasContextAttributes),this._trackResize=l.trackResize===!0,this._bearingSnap=l.bearingSnap,this._centerClampedToGround=l.centerClampedToGround,this._refreshExpiredTiles=l.refreshExpiredTiles===!0,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions===!0,this._collectResourceTiming=l.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Xi),l.locale),this._clickTolerance=l.clickTolerance,this._overridePixelRatio=l.pixelRatio,this._maxCanvasSize=l.maxCanvasSize,this.transformCameraUpdate=l.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=l.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=tn.addThrottleControl(()=>this.isMoving()),this._requestManager=new $t(l.transformRequest),typeof l.container=="string"){if(this._container=document.getElementById(l.container),!this._container)throw new Error(`Container '${l.container}' not found.`)}else{if(!(l.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let b=!1;const T=Wc(E=>{this._trackResize&&!this._removed&&(this.resize(E),this.redraw())},50);this._resizeObserver=new ResizeObserver(E=>{b?T(E):b=!0}),this._resizeObserver.observe(this._container)}this.handlers=new go(this,l),this._hash=l.hash&&new Ea(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,elevation:l.elevation,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch,roll:l.roll}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,d.e({},l.fitBoundsOptions,{duration:0}))));const y=typeof l.style=="string"||((n=(e=l.style)===null||e===void 0?void 0:e.projection)===null||n===void 0?void 0:n.type)!=="globe";this.resize(null,y),this._localIdeographFontFamily=l.localIdeographFontFamily,this._validateStyle=l.validateStyle,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new tc(typeof l.attributionControl=="boolean"?void 0:l.attributionControl)),l.maplibreLogo&&this.addControl(new Vi,l.logoPosition),this.on("style.load",()=>{if(y||this._resizeTransform(),this.transform.unmodified){const b=d.O(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(b)}}),this.on("data",b=>{this._update(b.dataType==="style"),this.fire(new d.l(`${b.dataType}data`,b))}),this.on("dataloading",b=>{this.fire(new d.l(`${b.dataType}dataloading`,b))}),this.on("dataabort",b=>{this.fire(new d.l("sourcedataabort",b))})}_getMapId(){return this._mapId}addControl(f,e){if(e===void 0&&(e=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new d.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const n=f.onAdd(this);this._controls.push(f);const l=this._controlPositions[e];return e.indexOf("bottom")!==-1?l.insertBefore(n,l.firstChild):l.appendChild(n),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new d.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(f);return e>-1&&this._controls.splice(e,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}calculateCameraOptionsFromTo(f,e,n,l){return l==null&&this.terrain&&(l=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(f,e,n,l)}resize(f,e=!0){const[n,l]=this._containerDimensions(),u=this._getClampedPixelRatio(n,l);if(this._resizeCanvas(n,l,u),this.painter.resize(n,l,u),this.painter.overLimit()){const y=this.painter.context.gl;this._maxCanvasSize=[y.drawingBufferWidth,y.drawingBufferHeight];const b=this._getClampedPixelRatio(n,l);this._resizeCanvas(n,l,b),this.painter.resize(n,l,b)}this._resizeTransform(e);const m=!this._moving;return m&&(this.stop(),this.fire(new d.l("movestart",f)).fire(new d.l("move",f))),this.fire(new d.l("resize",f)),m&&this.fire(new d.l("moveend",f)),this}_resizeTransform(f=!0){var e;const[n,l]=this._containerDimensions();this.transform.resize(n,l,f),(e=this._requestedCameraState)===null||e===void 0||e.resize(n,l,f)}_getClampedPixelRatio(f,e){const{0:n,1:l}=this._maxCanvasSize,u=this.getPixelRatio(),m=f*u,y=e*u;return Math.min(m>n?n/m:1,y>l?l/y:1)*u}getPixelRatio(){var f;return(f=this._overridePixelRatio)!==null&&f!==void 0?f:devicePixelRatio}setPixelRatio(f){this._overridePixelRatio=f,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(f){return this.transform.setMaxBounds(Fi.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.setMinZoom(f),this._update(),this.getZoom()<f&&this.setZoom(f),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.setMaxZoom(f),this._update(),this.getZoom()>f&&this.setZoom(f),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.setMinPitch(f),this._update(),this.getPitch()<f&&this.setPitch(f),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(f>=this.transform.minPitch)return this.transform.setMaxPitch(f),this._update(),this.getPitch()>f&&this.setPitch(f),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.setRenderWorldCopies(f),this._update()}project(f){return this.transform.locationToScreenPoint(d.Q.convert(f),this.style&&this.terrain)}unproject(f){return this.transform.screenPointToLocation(d.P.convert(f),this.terrain)}isMoving(){var f;return this._moving||((f=this.handlers)===null||f===void 0?void 0:f.isMoving())}isZooming(){var f;return this._zooming||((f=this.handlers)===null||f===void 0?void 0:f.isZooming())}isRotating(){var f;return this._rotating||((f=this.handlers)===null||f===void 0?void 0:f.isRotating())}_createDelegatedListener(f,e,n){if(f==="mouseenter"||f==="mouseover"){let l=!1;return{layers:e,listener:n,delegates:{mousemove:m=>{const y=e.filter(T=>this.getLayer(T)),b=y.length!==0?this.queryRenderedFeatures(m.point,{layers:y}):[];b.length?l||(l=!0,n.call(this,new Ui(f,this,m.originalEvent,{features:b}))):l=!1},mouseout:()=>{l=!1}}}}if(f==="mouseleave"||f==="mouseout"){let l=!1;return{layers:e,listener:n,delegates:{mousemove:y=>{const b=e.filter(T=>this.getLayer(T));(b.length!==0?this.queryRenderedFeatures(y.point,{layers:b}):[]).length?l=!0:l&&(l=!1,n.call(this,new Ui(f,this,y.originalEvent)))},mouseout:y=>{l&&(l=!1,n.call(this,new Ui(f,this,y.originalEvent)))}}}}{const l=u=>{const m=e.filter(b=>this.getLayer(b)),y=m.length!==0?this.queryRenderedFeatures(u.point,{layers:m}):[];y.length&&(u.features=y,n.call(this,u),delete u.features)};return{layers:e,listener:n,delegates:{[f]:l}}}}_saveDelegatedListener(f,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(e)}_removeDelegatedListener(f,e,n){if(!this._delegatedListeners||!this._delegatedListeners[f])return;const l=this._delegatedListeners[f];for(let u=0;u<l.length;u++){const m=l[u];if(m.listener===n&&m.layers.length===e.length&&m.layers.every(y=>e.includes(y))){for(const y in m.delegates)this.off(y,m.delegates[y]);return void l.splice(u,1)}}}on(f,e,n){if(n===void 0)return super.on(f,e);const l=typeof e=="string"?[e]:e,u=this._createDelegatedListener(f,l,n);this._saveDelegatedListener(f,u);for(const m in u.delegates)this.on(m,u.delegates[m]);return{unsubscribe:()=>{this._removeDelegatedListener(f,l,n)}}}once(f,e,n){if(n===void 0)return super.once(f,e);const l=typeof e=="string"?[e]:e,u=this._createDelegatedListener(f,l,n);for(const m in u.delegates){const y=u.delegates[m];u.delegates[m]=(...b)=>{this._removeDelegatedListener(f,l,n),y(...b)}}this._saveDelegatedListener(f,u);for(const m in u.delegates)this.once(m,u.delegates[m]);return this}off(f,e,n){return n===void 0?super.off(f,e):(this._removeDelegatedListener(f,typeof e=="string"?[e]:e,n),this)}queryRenderedFeatures(f,e){if(!this.style)return[];let n;const l=f instanceof d.P||Array.isArray(f),u=l?f:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(l?{}:f)||{},u instanceof d.P||typeof u[0]=="number")n=[d.P.convert(u)];else{const m=d.P.convert(u[0]),y=d.P.convert(u[1]);n=[m,new d.P(y.x,m.y),y,new d.P(m.x,y.y),m]}return this.style.queryRenderedFeatures(n,e,this.transform)}querySourceFeatures(f,e){return this.style.querySourceFeatures(f,e)}setStyle(f,e){return(e=d.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&f?(this._diffStyle(f,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(f,e))}setTransformRequest(f){return this._requestManager.setTransformRequest(f),this}_getUIString(f){const e=this._locale[f];if(e==null)throw new Error(`Missing UI string '${f}'`);return e}_updateStyle(f,e){var n,l;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(f,e));const u=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!f)),f?(this.style=new Bl(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof f=="string"?this.style.loadURL(f,e,u):this.style.loadJSON(f,e,u),this):((l=(n=this.style)===null||n===void 0?void 0:n.projection)===null||l===void 0||l.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Bl(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,e){if(typeof f=="string"){const n=this._requestManager.transformRequest(f,"Style");d.j(n,new AbortController).then(l=>{this._updateDiff(l.data,e)}).catch(l=>{l&&this.fire(new d.k(l))})}else typeof f=="object"&&this._updateDiff(f,e)}_updateDiff(f,e){try{this.style.setState(f,e)&&this._update(!0)}catch(n){d.w(`Unable to perform style diff: ${n.message||n.error||n}.  Rebuilding the style from scratch.`),this._updateStyle(f,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():d.w("There is no style added to the map.")}addSource(f,e){return this._lazyInitEmptyStyle(),this.style.addSource(f,e),this._update(!0)}isSourceLoaded(f){const e=this.style&&this.style.sourceCaches[f];if(e!==void 0)return e.loaded();this.fire(new d.k(new Error(`There is no source with ID '${f}'`)))}setTerrain(f){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),f){const e=this.style.sourceCaches[f.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${f.source}`);this.terrain===null&&e.reload();for(const n in this.style._layers){const l=this.style._layers[n];l.type==="hillshade"&&l.source===f.source&&d.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new za(this.painter,e,f),this.painter.renderToTexture=new Ii(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=n=>{n.dataType==="style"?this.terrain.sourceCache.freeRtt():n.dataType==="source"&&n.tile&&(n.sourceId!==f.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),this.terrain.sourceCache.freeRtt(n.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new d.l("terrain",{terrain:f})),this}getTerrain(){var f,e;return(e=(f=this.terrain)===null||f===void 0?void 0:f.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const f=this.style&&this.style.sourceCaches;for(const e in f){const n=f[e]._tiles;for(const l in n){const u=n[l];if(u.state!=="loaded"&&u.state!=="errored")return!1}}return!0}removeSource(f){return this.style.removeSource(f),this._update(!0)}getSource(f){return this.style.getSource(f)}addImage(f,e,n={}){const{pixelRatio:l=1,sdf:u=!1,stretchX:m,stretchY:y,content:b,textFitWidth:T,textFitHeight:E}=n;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||d.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new d.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:z,height:D,data:I}=e,F=e;return this.style.addImage(f,{data:new d.R({width:z,height:D},new Uint8Array(I)),pixelRatio:l,stretchX:m,stretchY:y,content:b,textFitWidth:T,textFitHeight:E,sdf:u,version:0,userImage:F}),F.onAdd&&F.onAdd(this,f),this}}{const{width:z,height:D,data:I}=at.getImageData(e);this.style.addImage(f,{data:new d.R({width:z,height:D},I),pixelRatio:l,stretchX:m,stretchY:y,content:b,textFitWidth:T,textFitHeight:E,sdf:u,version:0})}}updateImage(f,e){const n=this.style.getImage(f);if(!n)return this.fire(new d.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=e instanceof HTMLImageElement||d.b(e)?at.getImageData(e):e,{width:u,height:m,data:y}=l;if(u===void 0||m===void 0)return this.fire(new d.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(u!==n.data.width||m!==n.data.height)return this.fire(new d.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const b=!(e instanceof HTMLImageElement||d.b(e));return n.data.replace(y,b),this.style.updateImage(f,n),this}getImage(f){return this.style.getImage(f)}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new d.k(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f){return tn.getImage(this._requestManager.transformRequest(f,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(f,e){return this._lazyInitEmptyStyle(),this.style.addLayer(f,e),this._update(!0)}moveLayer(f,e){return this.style.moveLayer(f,e),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(f,e,n){return this.style.setLayerZoomRange(f,e,n),this._update(!0)}setFilter(f,e,n={}){return this.style.setFilter(f,e,n),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,e,n,l={}){return this.style.setPaintProperty(f,e,n,l),this._update(!0)}getPaintProperty(f,e){return this.style.getPaintProperty(f,e)}setLayoutProperty(f,e,n,l={}){return this.style.setLayoutProperty(f,e,n,l),this._update(!0)}getLayoutProperty(f,e){return this.style.getLayoutProperty(f,e)}setGlyphs(f,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(f,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(f,e,n={}){return this._lazyInitEmptyStyle(),this.style.addSprite(f,e,n,l=>{l||this._update(!0)}),this}removeSprite(f){return this._lazyInitEmptyStyle(),this.style.removeSprite(f),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(f,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(f,e,n=>{n||this._update(!0)}),this}setLight(f,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(f,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(f,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(f,e){return this.style.setFeatureState(f,e),this._update()}removeFeatureState(f,e){return this.style.removeFeatureState(f,e),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let f=0,e=0;return this._container&&(f=this._container.clientWidth||400,e=this._container.clientHeight||300),[f,e]}_setupContainer(){const f=this._container;f.classList.add("maplibregl-map");const e=this._canvasContainer=_e.create("div","maplibregl-canvas-container",f);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=_e.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const n=this._containerDimensions(),l=this._getClampedPixelRatio(n[0],n[1]);this._resizeCanvas(n[0],n[1],l);const u=this._controlContainer=_e.create("div","maplibregl-control-container",f),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(y=>{m[y]=_e.create("div",`maplibregl-ctrl-${y} `,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,e,n){this._canvas.width=Math.floor(n*f),this._canvas.height=Math.floor(n*e),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const f=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",l=>{e={requestedAttributes:f},l&&(e.statusMessage=l.statusMessage,e.type=l.type)},{once:!0});let n=null;if(n=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,f):this._canvas.getContext("webgl2",f)||this._canvas.getContext("webgl",f),!n){const l="Failed to initialize WebGL";throw e?(e.message=l,new Error(JSON.stringify(e))):new Error(l)}this.painter=new Qc(n,this.transform),st.testSupport(n)}migrateProjection(f,e){super.migrateProjection(f,e),this.painter.transform=f,this.fire(new d.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_render(f){var e,n,l,u,m;const y=this._idleTriggered?this._fadeDuration:0,b=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(f),this._removed)return;let T=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const D=this.transform.zoom,I=at.now();this.style.zoomHistory.update(D,I);const F=new d.C(D,{now:I,fadeDuration:y,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),N=F.crossFadingFactor();N===1&&N===this._crossFadingFactor||(T=!0,this._crossFadingFactor=N),this.style.update(F)}const E=((n=this.style.projection)===null||n===void 0?void 0:n.transitionState)>0!==b;(l=this.style.projection)===null||l===void 0||l.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((u=this.style.projection)===null||u===void 0?void 0:u.transitionState,(m=this.style.projection)===null||m===void 0?void 0:m.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||E)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,y,this._crossSourceCollisions,E),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:y,showPadding:this.showPadding}),this.fire(new d.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,d.cf.mark(d.cg.load),this.fire(new d.l("load"))),this.style&&(this.style.hasTransitions()||T)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const z=this._sourcesDirty||this._styleDirty||this._placementDirty;return z||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new d.l("idle")),!this._loaded||this._fullyLoaded||z||(this._fullyLoaded=!0,d.cf.mark(d.cg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var f;this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),tn.removeThrottleControl(this._imageQueueHandle),(f=this._resizeObserver)===null||f===void 0||f.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),_e.remove(this._canvasContainer),_e.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),d.cf.clearMetrics(),this._removed=!0,this.fire(new d.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,at.frame(this._frameRequest,f=>{d.cf.frame(f),this._frameRequest=null;try{this._render(f)}catch(e){if(!d.ch(e)&&!function(n){return n.message===$c}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get version(){return br}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(f){return this._lazyInitEmptyStyle(),this.style.setProjection(f),this._update(!0)}},O.MapMouseEvent=Ui,O.MapTouchEvent=wn,O.MapWheelEvent=Jc,O.Marker=xo,O.NavigationControl=class{constructor(f){this._updateZoomButtons=()=>{const e=this._map.getZoom(),n=e===this._map.getMaxZoom(),l=e===this._map.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,n)=>{const l=this._map._getUIString(`NavigationControl.${n}`);e.title=l,e.setAttribute("aria-label",l)},this.options=d.e({},_o,f),this._container=_e.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),_e.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),_e.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=_e.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new yo(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){_e.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(f,e){const n=_e.create("button",f,this._container);return n.type="button",n.addEventListener("click",e),n}},O.Popup=class extends d.E{constructor(f){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&_e.remove(this._content),this._container&&(_e.remove(this._container),delete this._container),this._closeButton&&this._closeButton.removeEventListener("click",this._onClose),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new d.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var n;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=_e.create("div","maplibregl-popup",this._map.getContainer()),this._tip=_e.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const b of this.options.className.split(" "))this._container.classList.add(b);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?sl(this._lngLat,this._flatPos,this._map.transform):(n=this._lngLat)===null||n===void 0?void 0:n.wrap(),this._trackPointer&&!e)return;const l=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let u=this.options.anchor;const m=oc(this.options.offset);if(!u){const b=this._container.offsetWidth,T=this._container.offsetHeight;let E;E=l.y+m.bottom.y<T?["top"]:l.y>this._map.transform.height-T?["bottom"]:[],l.x<b/2?E.push("left"):l.x>this._map.transform.width-b/2&&E.push("right"),u=E.length===0?"bottom":E.join("-")}let y=l.add(m[u]);this.options.subpixelPositioning||(y=y.round()),_e.setTransform(this._container,`${wr[u]} translate(${y.x}px,${y.y}px)`),vo(this._container,u,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=d.e(Object.create(ac),f)}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new d.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(f){return this._lngLat=d.Q.convert(f),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(document.createTextNode(f))}setHTML(f){const e=document.createDocumentFragment(),n=document.createElement("body");let l;for(n.innerHTML=f;l=n.firstChild,l;)e.appendChild(l);return this.setDOMContent(e)}getMaxWidth(){var f;return(f=this._container)===null||f===void 0?void 0:f.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=_e.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(f),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(f){return this._container&&this._container.classList.add(f),this}removeClassName(f){return this._container&&this._container.classList.remove(f),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){if(this._container)return this._container.classList.toggle(f)}setSubpixelPositioning(f){this.options.subpixelPositioning=f}_createCloseButton(){this.options.closeButton&&(this._closeButton=_e.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(sc);f&&f.focus()}},O.RasterDEMTileSource=va,O.RasterTileSource=Br,O.ScaleControl=class{constructor(f){this._onMove=()=>{rc(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,rc(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},su),f)}getDefaultPosition(){return"bottom-left"}onAdd(f){return this._map=f,this._container=_e.create("div","maplibregl-ctrl maplibregl-ctrl-scale",f.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){_e.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},O.ScrollZoomHandler=Ns,O.Style=Bl,O.TerrainControl=class{constructor(f){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=f}onAdd(f){return this._map=f,this._container=_e.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=_e.create("button","maplibregl-ctrl-terrain",this._container),_e.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){_e.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},O.TwoFingersTouchPitchHandler=Fs,O.TwoFingersTouchRotateHandler=iu,O.TwoFingersTouchZoomHandler=rl,O.TwoFingersTouchZoomRotateHandler=di,O.VectorTileSource=ea,O.VideoSource=Or,O.addSourceType=(f,e)=>d._(void 0,void 0,void 0,function*(){if(or(f))throw new Error(`A source type called "${f}" already exists.`);((n,l)=>{to[n]=l})(f,e)}),O.clearPrewarmedResources=function(){const f=ot;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(Je),ot=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},O.createTileMesh=Ta,O.getMaxParallelImageRequests=function(){return d.a.MAX_PARALLEL_IMAGE_REQUESTS},O.getRTLTextPluginStatus=function(){return ia().getRTLTextPluginStatus()},O.getVersion=function(){return ou},O.getWorkerCount=function(){return St.workerCount},O.getWorkerUrl=function(){return d.a.WORKER_URL},O.importScriptInWorkers=function(f){return ei().broadcast("IS",f)},O.prewarm=function(){Ut().acquire(Je)},O.setMaxParallelImageRequests=function(f){d.a.MAX_PARALLEL_IMAGE_REQUESTS=f},O.setRTLTextPlugin=function(f,e){return ia().setRTLTextPlugin(f,e)},O.setWorkerCount=function(f){St.workerCount=f},O.setWorkerUrl=function(f){d.a.WORKER_URL=f}});var rt=Ee;return rt})}(lp)),lp.exports}var qm=Gm();const Hm=nm(qm);function $m({uavState:Z,displayPreferences:se}){let Ee;return bd.useEffect(()=>(Ee=new Hm.Map({container:"map-display",style:"https://demotiles.maplibre.org/style.json",center:[-115.6719,36.5892],zoom:3}),()=>{Ee.remove()}),[]),Fe.jsx("div",{style:{filter:"brightness(0.9)"},id:"map-display",className:"border-gray-400 border w-full print:hidden bg-neutral-900 flex items-center justify-center flex-1",children:Fe.jsx("h1",{children:"Map"})})}const Sp=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function Mp(Z,se,Ee,ee){Z.addEventListener?Z.addEventListener(se,Ee,ee):Z.attachEvent&&Z.attachEvent("on".concat(se),Ee)}function wf(Z,se,Ee,ee){Z.removeEventListener?Z.removeEventListener(se,Ee,ee):Z.detachEvent&&Z.detachEvent("on".concat(se),Ee)}function Wp(Z,se){const Ee=se.slice(0,se.length-1);for(let ee=0;ee<Ee.length;ee++)Ee[ee]=Z[Ee[ee].toLowerCase()];return Ee}function Jp(Z){typeof Z!="string"&&(Z=""),Z=Z.replace(/\s/g,"");const se=Z.split(",");let Ee=se.lastIndexOf("");for(;Ee>=0;)se[Ee-1]+=",",se.splice(Ee,1),Ee=se.lastIndexOf("");return se}function Xm(Z,se){const Ee=Z.length>=se.length?Z:se,ee=Z.length>=se.length?se:Z;let Oe=!0;for(let rt=0;rt<Ee.length;rt++)ee.indexOf(Ee[rt])===-1&&(Oe=!1);return Oe}const zf={backspace:8,"âŒ«":8,tab:9,clear:12,enter:13,"â†©":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"â‡ª":20,",":188,".":190,"/":191,"`":192,"-":Sp?173:189,"=":Sp?61:187,";":Sp?59:186,"'":222,"[":219,"]":221,"\\":220},Dl={"â‡§":16,shift:16,"âŒ¥":18,alt:18,option:18,"âŒƒ":17,ctrl:17,control:17,"âŒ˜":91,cmd:91,command:91},cp={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},Jr={16:!1,18:!1,17:!1,91:!1},jn={};for(let Z=1;Z<20;Z++)zf["f".concat(Z)]=111+Z;let zn=[],Af=null,em="all";const Sc=new Map,Df=Z=>zf[Z.toLowerCase()]||Dl[Z.toLowerCase()]||Z.toUpperCase().charCodeAt(0),Ym=Z=>Object.keys(zf).find(se=>zf[se]===Z),Km=Z=>Object.keys(Dl).find(se=>Dl[se]===Z);function tm(Z){em=Z||"all"}function Pf(){return em||"all"}function Qm(){return zn.slice(0)}function Wm(){return zn.map(Z=>Ym(Z)||Km(Z)||String.fromCharCode(Z))}function Jm(){const Z=[];return Object.keys(jn).forEach(se=>{jn[se].forEach(Ee=>{let{key:ee,scope:Oe,mods:rt,shortcut:O}=Ee;Z.push({scope:Oe,shortcut:O,mods:rt,keys:ee.split("+").map(d=>Df(d))})})}),Z}function eg(Z){const se=Z.target||Z.srcElement,{tagName:Ee}=se;let ee=!0;const Oe=Ee==="INPUT"&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(se.type);return(se.isContentEditable||(Oe||Ee==="TEXTAREA"||Ee==="SELECT")&&!se.readOnly)&&(ee=!1),ee}function tg(Z){return typeof Z=="string"&&(Z=Df(Z)),zn.indexOf(Z)!==-1}function ig(Z,se){let Ee,ee;Z||(Z=Pf());for(const Oe in jn)if(Object.prototype.hasOwnProperty.call(jn,Oe))for(Ee=jn[Oe],ee=0;ee<Ee.length;)Ee[ee].scope===Z?Ee.splice(ee,1).forEach(O=>{let{element:d}=O;return Rp(d)}):ee++;Pf()===Z&&tm(se||"all")}function ng(Z){let se=Z.keyCode||Z.which||Z.charCode;const Ee=zn.indexOf(se);if(Ee>=0&&zn.splice(Ee,1),Z.key&&Z.key.toLowerCase()==="meta"&&zn.splice(0,zn.length),(se===93||se===224)&&(se=91),se in Jr){Jr[se]=!1;for(const ee in Dl)Dl[ee]===se&&(ln[ee]=!1)}}function im(Z){if(typeof Z>"u")Object.keys(jn).forEach(Oe=>{Array.isArray(jn[Oe])&&jn[Oe].forEach(rt=>op(rt)),delete jn[Oe]}),Rp(null);else if(Array.isArray(Z))Z.forEach(Oe=>{Oe.key&&op(Oe)});else if(typeof Z=="object")Z.key&&op(Z);else if(typeof Z=="string"){for(var se=arguments.length,Ee=new Array(se>1?se-1:0),ee=1;ee<se;ee++)Ee[ee-1]=arguments[ee];let[Oe,rt]=Ee;typeof Oe=="function"&&(rt=Oe,Oe=""),op({key:Z,scope:Oe,method:rt,splitKey:"+"})}}const op=Z=>{let{key:se,scope:Ee,method:ee,splitKey:Oe="+"}=Z;Jp(se).forEach(O=>{const d=O.split(Oe),it=d.length,Ne=d[it-1],Mt=Ne==="*"?"*":Df(Ne);if(!jn[Mt])return;Ee||(Ee=Pf());const Bt=it>1?Wp(Dl,d):[],at=[];jn[Mt]=jn[Mt].filter(_e=>{const yi=(ee?_e.method===ee:!0)&&_e.scope===Ee&&Xm(_e.mods,Bt);return yi&&at.push(_e.element),!yi}),at.forEach(_e=>Rp(_e))})};function Up(Z,se,Ee,ee){if(se.element!==ee)return;let Oe;if(se.scope===Ee||se.scope==="all"){Oe=se.mods.length>0;for(const rt in Jr)Object.prototype.hasOwnProperty.call(Jr,rt)&&(!Jr[rt]&&se.mods.indexOf(+rt)>-1||Jr[rt]&&se.mods.indexOf(+rt)===-1)&&(Oe=!1);(se.mods.length===0&&!Jr[16]&&!Jr[18]&&!Jr[17]&&!Jr[91]||Oe||se.shortcut==="*")&&(se.keys=[],se.keys=se.keys.concat(zn),se.method(Z,se)===!1&&(Z.preventDefault?Z.preventDefault():Z.returnValue=!1,Z.stopPropagation&&Z.stopPropagation(),Z.cancelBubble&&(Z.cancelBubble=!0)))}}function Vp(Z,se){const Ee=jn["*"];let ee=Z.keyCode||Z.which||Z.charCode;if(!ln.filter.call(this,Z))return;if((ee===93||ee===224)&&(ee=91),zn.indexOf(ee)===-1&&ee!==229&&zn.push(ee),["metaKey","ctrlKey","altKey","shiftKey"].forEach(d=>{const it=cp[d];Z[d]&&zn.indexOf(it)===-1?zn.push(it):!Z[d]&&zn.indexOf(it)>-1?zn.splice(zn.indexOf(it),1):d==="metaKey"&&Z[d]&&(zn=zn.filter(Ne=>Ne in cp||Ne===ee))}),ee in Jr){Jr[ee]=!0;for(const d in Dl)Dl[d]===ee&&(ln[d]=!0);if(!Ee)return}for(const d in Jr)Object.prototype.hasOwnProperty.call(Jr,d)&&(Jr[d]=Z[cp[d]]);Z.getModifierState&&!(Z.altKey&&!Z.ctrlKey)&&Z.getModifierState("AltGraph")&&(zn.indexOf(17)===-1&&zn.push(17),zn.indexOf(18)===-1&&zn.push(18),Jr[17]=!0,Jr[18]=!0);const Oe=Pf();if(Ee)for(let d=0;d<Ee.length;d++)Ee[d].scope===Oe&&(Z.type==="keydown"&&Ee[d].keydown||Z.type==="keyup"&&Ee[d].keyup)&&Up(Z,Ee[d],Oe,se);if(!(ee in jn))return;const rt=jn[ee],O=rt.length;for(let d=0;d<O;d++)if((Z.type==="keydown"&&rt[d].keydown||Z.type==="keyup"&&rt[d].keyup)&&rt[d].key){const it=rt[d],{splitKey:Ne}=it,Mt=it.key.split(Ne),Bt=[];for(let at=0;at<Mt.length;at++)Bt.push(Df(Mt[at]));Bt.sort().join("")===zn.sort().join("")&&Up(Z,it,Oe,se)}}function ln(Z,se,Ee){zn=[];const ee=Jp(Z);let Oe=[],rt="all",O=document,d=0,it=!1,Ne=!0,Mt="+",Bt=!1,at=!1;for(Ee===void 0&&typeof se=="function"&&(Ee=se),Object.prototype.toString.call(se)==="[object Object]"&&(se.scope&&(rt=se.scope),se.element&&(O=se.element),se.keyup&&(it=se.keyup),se.keydown!==void 0&&(Ne=se.keydown),se.capture!==void 0&&(Bt=se.capture),typeof se.splitKey=="string"&&(Mt=se.splitKey),se.single===!0&&(at=!0)),typeof se=="string"&&(rt=se),at&&im(Z,rt);d<ee.length;d++)Z=ee[d].split(Mt),Oe=[],Z.length>1&&(Oe=Wp(Dl,Z)),Z=Z[Z.length-1],Z=Z==="*"?"*":Df(Z),Z in jn||(jn[Z]=[]),jn[Z].push({keyup:it,keydown:Ne,scope:rt,mods:Oe,shortcut:ee[d],method:Ee,key:ee[d],splitKey:Mt,element:O});if(typeof O<"u"&&window){if(!Sc.has(O)){const _e=function(){let yi=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return Vp(yi,O)},st=function(){let yi=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;Vp(yi,O),ng(yi)};Sc.set(O,{keydownListener:_e,keyupListenr:st,capture:Bt}),Mp(O,"keydown",_e,Bt),Mp(O,"keyup",st,Bt)}if(!Af){const _e=()=>{zn=[]};Af={listener:_e,capture:Bt},Mp(window,"focus",_e,Bt)}}}function rg(Z){let se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(jn).forEach(Ee=>{jn[Ee].filter(Oe=>Oe.scope===se&&Oe.shortcut===Z).forEach(Oe=>{Oe&&Oe.method&&Oe.method()})})}function Rp(Z){const se=Object.values(jn).flat();if(se.findIndex(ee=>{let{element:Oe}=ee;return Oe===Z})<0){const{keydownListener:ee,keyupListenr:Oe,capture:rt}=Sc.get(Z)||{};ee&&Oe&&(wf(Z,"keyup",Oe,rt),wf(Z,"keydown",ee,rt),Sc.delete(Z))}if((se.length<=0||Sc.size<=0)&&(Object.keys(Sc).forEach(Oe=>{const{keydownListener:rt,keyupListenr:O,capture:d}=Sc.get(Oe)||{};rt&&O&&(wf(Oe,"keyup",O,d),wf(Oe,"keydown",rt,d),Sc.delete(Oe))}),Sc.clear(),Object.keys(jn).forEach(Oe=>delete jn[Oe]),Af)){const{listener:Oe,capture:rt}=Af;wf(window,"focus",Oe,rt),Af=null}}const Ep={getPressedKeyString:Wm,setScope:tm,getScope:Pf,deleteScope:ig,getPressedKeyCodes:Qm,getAllKeyCodes:Jm,isPressed:tg,filter:eg,trigger:rg,unbind:im,keyMap:zf,modifier:Dl,modifierMap:cp};for(const Z in Ep)Object.prototype.hasOwnProperty.call(Ep,Z)&&(ln[Z]=Ep[Z]);if(typeof window<"u"){const Z=window.hotkeys;ln.noConflict=se=>(se&&window.hotkeys===ln&&(window.hotkeys=Z),ln),window.hotkeys=ln}function ag(Z){bd.useEffect(()=>(ln.filter=se=>!(se.target instanceof HTMLInputElement),ln("up",se=>{se.preventDefault(),Z(Ee=>({...Ee,pitch:Math.round((Ee.pitch+.1)*10)/10}))}),ln("down",se=>{se.preventDefault(),Z(Ee=>({...Ee,pitch:Math.round((Ee.pitch-.1)*10)/10}))}),ln("left",se=>{se.preventDefault(),Z(Ee=>({...Ee,bank:Math.max(Ee.bank-1,-45)}))}),ln("right",se=>{se.preventDefault(),Z(Ee=>({...Ee,bank:Math.min(Ee.bank+1,45)}))}),ln("g",()=>{Z(se=>({...se,gearPosition:se.gearPosition==="up"?"down":"up"}))}),ln("t",()=>{Z(se=>({...se,powerMode:se.powerMode==="speed"?"pla":"speed"}))}),ln("ctrl+up",()=>{Z(se=>({...se,pla:Math.min(se.pla+1,100)}))}),ln("ctrl+down",()=>{Z(se=>({...se,pla:Math.max(se.pla-1,0)}))}),ln("h+left",()=>{Z(se=>({...se,heading:xd(se.heading-1)}))}),ln("h+right",()=>{Z(se=>({...se,heading:xd(se.heading+1)}))}),ln("a+up",()=>{Z(se=>({...se,airspeed:Math.min(se.airspeed+1,500)}))}),ln("a+down",()=>{Z(se=>({...se,airspeed:Math.max(se.airspeed-1,0)}))}),ln("z+up",()=>{Z(se=>({...se,altitude:Math.min(se.altitude+100,1e5)}))}),ln("z+down",()=>{Z(se=>({...se,altitude:Math.max(se.altitude-100,0)}))}),ln("ctrl+h",se=>{se.preventDefault(),Z(Ee=>({...Ee,heading:xd(360),bank:0,pitch:0}))}),ln("b",()=>{Z(se=>({...se,boardsPosition:(()=>{switch(se.boardsPosition){case fr.IN:return fr.HALF;case fr.HALF:return fr.FULL;case fr.FULL:return fr.LOCKED;case fr.LOCKED:return fr.IN;default:return fr.IN}})()}))}),()=>{ln.unbind("up,down,left,right,g,t,ctrl+up,ctrl+down,h+left,h+right,a+up,a+down,z+up,z+down,b")}),[Z])}var fr=(Z=>(Z.LOCKED="locked",Z.IN="in",Z.HALF="half",Z.FULL="full",Z))(fr||{});function sg(){const[Z,se]=bd.useState({airspeed:150,altitude:16e3,pitch:0,bank:0,heading:360,gearPosition:"up",powerMode:"speed",pla:30,boardsPosition:"in"}),[Ee,ee]=bd.useState({showHUD:!0,showMap:!0,theme:"dark",northUp:!1});return ag(se),Fe.jsx("div",{className:"h-screen w-screen overflow-hidden",children:Fe.jsxs("div",{className:"flex h-full p-2 space-x-2",children:[Fe.jsx("div",{className:"w-2/6 print:hidden",children:Fe.jsx(fm,{uavState:Z,displayPreferences:Ee,onStateChange:se})}),Fe.jsxs("div",{className:"w-4/6 print:w-full flex flex-col items-center justify-center space-y-2",children:[Fe.jsx(Om,{uavState:Z,displayPreferences:Ee}),Fe.jsxs("div",{className:"flex w-full space-x-2 flex-1 max-h-1/2 print:hidden",children:[Fe.jsx(Nm,{uavState:Z,displayPreferences:Ee}),Fe.jsxs("div",{className:"flex flex-col space-y-2 w-full",children:[Fe.jsx(Vm,{uavState:Z,displayPreferences:Ee}),Fe.jsx($m,{uavState:Z,displayPreferences:Ee})]})]})]})]})})}var Cp={exports:{}},Tf={},Ap={exports:{}},zp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zp;function og(){return Zp||(Zp=1,function(Z){function se(Ke,Ot){var zt=Ke.length;Ke.push(Ot);e:for(;0<zt;){var ci=zt-1>>>1,fe=Ke[ci];if(0<Oe(fe,Ot))Ke[ci]=Ot,Ke[zt]=fe,zt=ci;else break e}}function Ee(Ke){return Ke.length===0?null:Ke[0]}function ee(Ke){if(Ke.length===0)return null;var Ot=Ke[0],zt=Ke.pop();if(zt!==Ot){Ke[0]=zt;e:for(var ci=0,fe=Ke.length,Je=fe>>>1;ci<Je;){var St=2*(ci+1)-1,xt=Ke[St],ot=St+1,Rt=Ke[ot];if(0>Oe(xt,zt))ot<fe&&0>Oe(Rt,xt)?(Ke[ci]=Rt,Ke[ot]=zt,ci=ot):(Ke[ci]=xt,Ke[St]=zt,ci=St);else if(ot<fe&&0>Oe(Rt,zt))Ke[ci]=Rt,Ke[ot]=zt,ci=ot;else break e}}return Ot}function Oe(Ke,Ot){var zt=Ke.sortIndex-Ot.sortIndex;return zt!==0?zt:Ke.id-Ot.id}if(Z.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var rt=performance;Z.unstable_now=function(){return rt.now()}}else{var O=Date,d=O.now();Z.unstable_now=function(){return O.now()-d}}var it=[],Ne=[],Mt=1,Bt=null,at=3,_e=!1,st=!1,yi=!1,Ai=typeof setTimeout=="function"?setTimeout:null,Pn=typeof clearTimeout=="function"?clearTimeout:null,cn=typeof setImmediate<"u"?setImmediate:null;function pr(Ke){for(var Ot=Ee(Ne);Ot!==null;){if(Ot.callback===null)ee(Ne);else if(Ot.startTime<=Ke)ee(Ne),Ot.sortIndex=Ot.expirationTime,se(it,Ot);else break;Ot=Ee(Ne)}}function tn(Ke){if(yi=!1,pr(Ke),!st)if(Ee(it)!==null)st=!0,ji();else{var Ot=Ee(Ne);Ot!==null&&Fn(tn,Ot.startTime-Ke)}}var $t=!1,Jt=-1,li=5,gi=-1;function Dt(){return!(Z.unstable_now()-gi<li)}function ai(){if($t){var Ke=Z.unstable_now();gi=Ke;var Ot=!0;try{e:{st=!1,yi&&(yi=!1,Pn(Jt),Jt=-1),_e=!0;var zt=at;try{t:{for(pr(Ke),Bt=Ee(it);Bt!==null&&!(Bt.expirationTime>Ke&&Dt());){var ci=Bt.callback;if(typeof ci=="function"){Bt.callback=null,at=Bt.priorityLevel;var fe=ci(Bt.expirationTime<=Ke);if(Ke=Z.unstable_now(),typeof fe=="function"){Bt.callback=fe,pr(Ke),Ot=!0;break t}Bt===Ee(it)&&ee(it),pr(Ke)}else ee(it);Bt=Ee(it)}if(Bt!==null)Ot=!0;else{var Je=Ee(Ne);Je!==null&&Fn(tn,Je.startTime-Ke),Ot=!1}}break e}finally{Bt=null,at=zt,_e=!1}Ot=void 0}}finally{Ot?Dn():$t=!1}}}var Dn;if(typeof cn=="function")Dn=function(){cn(ai)};else if(typeof MessageChannel<"u"){var Kn=new MessageChannel,un=Kn.port2;Kn.port1.onmessage=ai,Dn=function(){un.postMessage(null)}}else Dn=function(){Ai(ai,0)};function ji(){$t||($t=!0,Dn())}function Fn(Ke,Ot){Jt=Ai(function(){Ke(Z.unstable_now())},Ot)}Z.unstable_IdlePriority=5,Z.unstable_ImmediatePriority=1,Z.unstable_LowPriority=4,Z.unstable_NormalPriority=3,Z.unstable_Profiling=null,Z.unstable_UserBlockingPriority=2,Z.unstable_cancelCallback=function(Ke){Ke.callback=null},Z.unstable_continueExecution=function(){st||_e||(st=!0,ji())},Z.unstable_forceFrameRate=function(Ke){0>Ke||125<Ke?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):li=0<Ke?Math.floor(1e3/Ke):5},Z.unstable_getCurrentPriorityLevel=function(){return at},Z.unstable_getFirstCallbackNode=function(){return Ee(it)},Z.unstable_next=function(Ke){switch(at){case 1:case 2:case 3:var Ot=3;break;default:Ot=at}var zt=at;at=Ot;try{return Ke()}finally{at=zt}},Z.unstable_pauseExecution=function(){},Z.unstable_requestPaint=function(){},Z.unstable_runWithPriority=function(Ke,Ot){switch(Ke){case 1:case 2:case 3:case 4:case 5:break;default:Ke=3}var zt=at;at=Ke;try{return Ot()}finally{at=zt}},Z.unstable_scheduleCallback=function(Ke,Ot,zt){var ci=Z.unstable_now();switch(typeof zt=="object"&&zt!==null?(zt=zt.delay,zt=typeof zt=="number"&&0<zt?ci+zt:ci):zt=ci,Ke){case 1:var fe=-1;break;case 2:fe=250;break;case 5:fe=1073741823;break;case 4:fe=1e4;break;default:fe=5e3}return fe=zt+fe,Ke={id:Mt++,callback:Ot,priorityLevel:Ke,startTime:zt,expirationTime:fe,sortIndex:-1},zt>ci?(Ke.sortIndex=zt,se(Ne,Ke),Ee(it)===null&&Ke===Ee(Ne)&&(yi?(Pn(Jt),Jt=-1):yi=!0,Fn(tn,zt-ci))):(Ke.sortIndex=fe,se(it,Ke),st||_e||(st=!0,ji())),Ke},Z.unstable_shouldYield=Dt,Z.unstable_wrapCallback=function(Ke){var Ot=at;return function(){var zt=at;at=Ot;try{return Ke.apply(this,arguments)}finally{at=zt}}}}(zp)),zp}var Gp;function lg(){return Gp||(Gp=1,Ap.exports=og()),Ap.exports}var Pp={exports:{}},ya={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qp;function cg(){if(qp)return ya;qp=1;var Z=Ip();function se(it){var Ne="https://react.dev/errors/"+it;if(1<arguments.length){Ne+="?args[]="+encodeURIComponent(arguments[1]);for(var Mt=2;Mt<arguments.length;Mt++)Ne+="&args[]="+encodeURIComponent(arguments[Mt])}return"Minified React error #"+it+"; visit "+Ne+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Ee(){}var ee={d:{f:Ee,r:function(){throw Error(se(522))},D:Ee,C:Ee,L:Ee,m:Ee,X:Ee,S:Ee,M:Ee},p:0,findDOMNode:null},Oe=Symbol.for("react.portal");function rt(it,Ne,Mt){var Bt=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Oe,key:Bt==null?null:""+Bt,children:it,containerInfo:Ne,implementation:Mt}}var O=Z.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(it,Ne){if(it==="font")return"";if(typeof Ne=="string")return Ne==="use-credentials"?Ne:""}return ya.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ee,ya.createPortal=function(it,Ne){var Mt=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ne||Ne.nodeType!==1&&Ne.nodeType!==9&&Ne.nodeType!==11)throw Error(se(299));return rt(it,Ne,null,Mt)},ya.flushSync=function(it){var Ne=O.T,Mt=ee.p;try{if(O.T=null,ee.p=2,it)return it()}finally{O.T=Ne,ee.p=Mt,ee.d.f()}},ya.preconnect=function(it,Ne){typeof it=="string"&&(Ne?(Ne=Ne.crossOrigin,Ne=typeof Ne=="string"?Ne==="use-credentials"?Ne:"":void 0):Ne=null,ee.d.C(it,Ne))},ya.prefetchDNS=function(it){typeof it=="string"&&ee.d.D(it)},ya.preinit=function(it,Ne){if(typeof it=="string"&&Ne&&typeof Ne.as=="string"){var Mt=Ne.as,Bt=d(Mt,Ne.crossOrigin),at=typeof Ne.integrity=="string"?Ne.integrity:void 0,_e=typeof Ne.fetchPriority=="string"?Ne.fetchPriority:void 0;Mt==="style"?ee.d.S(it,typeof Ne.precedence=="string"?Ne.precedence:void 0,{crossOrigin:Bt,integrity:at,fetchPriority:_e}):Mt==="script"&&ee.d.X(it,{crossOrigin:Bt,integrity:at,fetchPriority:_e,nonce:typeof Ne.nonce=="string"?Ne.nonce:void 0})}},ya.preinitModule=function(it,Ne){if(typeof it=="string")if(typeof Ne=="object"&&Ne!==null){if(Ne.as==null||Ne.as==="script"){var Mt=d(Ne.as,Ne.crossOrigin);ee.d.M(it,{crossOrigin:Mt,integrity:typeof Ne.integrity=="string"?Ne.integrity:void 0,nonce:typeof Ne.nonce=="string"?Ne.nonce:void 0})}}else Ne==null&&ee.d.M(it)},ya.preload=function(it,Ne){if(typeof it=="string"&&typeof Ne=="object"&&Ne!==null&&typeof Ne.as=="string"){var Mt=Ne.as,Bt=d(Mt,Ne.crossOrigin);ee.d.L(it,Mt,{crossOrigin:Bt,integrity:typeof Ne.integrity=="string"?Ne.integrity:void 0,nonce:typeof Ne.nonce=="string"?Ne.nonce:void 0,type:typeof Ne.type=="string"?Ne.type:void 0,fetchPriority:typeof Ne.fetchPriority=="string"?Ne.fetchPriority:void 0,referrerPolicy:typeof Ne.referrerPolicy=="string"?Ne.referrerPolicy:void 0,imageSrcSet:typeof Ne.imageSrcSet=="string"?Ne.imageSrcSet:void 0,imageSizes:typeof Ne.imageSizes=="string"?Ne.imageSizes:void 0,media:typeof Ne.media=="string"?Ne.media:void 0})}},ya.preloadModule=function(it,Ne){if(typeof it=="string")if(Ne){var Mt=d(Ne.as,Ne.crossOrigin);ee.d.m(it,{as:typeof Ne.as=="string"&&Ne.as!=="script"?Ne.as:void 0,crossOrigin:Mt,integrity:typeof Ne.integrity=="string"?Ne.integrity:void 0})}else ee.d.m(it)},ya.requestFormReset=function(it){ee.d.r(it)},ya.unstable_batchedUpdates=function(it,Ne){return it(Ne)},ya.useFormState=function(it,Ne,Mt){return O.H.useFormState(it,Ne,Mt)},ya.useFormStatus=function(){return O.H.useHostTransitionStatus()},ya.version="19.0.0",ya}var Hp;function ug(){if(Hp)return Pp.exports;Hp=1;function Z(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Z)}catch(se){console.error(se)}}return Z(),Pp.exports=cg(),Pp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $p;function hg(){if($p)return Tf;$p=1;var Z=lg(),se=Ip(),Ee=ug();function ee(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Oe(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}var rt=Symbol.for("react.element"),O=Symbol.for("react.transitional.element"),d=Symbol.for("react.portal"),it=Symbol.for("react.fragment"),Ne=Symbol.for("react.strict_mode"),Mt=Symbol.for("react.profiler"),Bt=Symbol.for("react.provider"),at=Symbol.for("react.consumer"),_e=Symbol.for("react.context"),st=Symbol.for("react.forward_ref"),yi=Symbol.for("react.suspense"),Ai=Symbol.for("react.suspense_list"),Pn=Symbol.for("react.memo"),cn=Symbol.for("react.lazy"),pr=Symbol.for("react.offscreen"),tn=Symbol.for("react.memo_cache_sentinel"),$t=Symbol.iterator;function Jt(i){return i===null||typeof i!="object"?null:(i=$t&&i[$t]||i["@@iterator"],typeof i=="function"?i:null)}var li=Symbol.for("react.client.reference");function gi(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===li?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case it:return"Fragment";case d:return"Portal";case Mt:return"Profiler";case Ne:return"StrictMode";case yi:return"Suspense";case Ai:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case _e:return(i.displayName||"Context")+".Provider";case at:return(i._context.displayName||"Context")+".Consumer";case st:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Pn:return s=i.displayName||null,s!==null?s:gi(i.type)||"Memo";case cn:s=i._payload,i=i._init;try{return gi(i(s))}catch{}}return null}var Dt=se.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ai=Object.assign,Dn,Kn;function un(i){if(Dn===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);Dn=s&&s[1]||"",Kn=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Dn+i+Kn}var ji=!1;function Fn(i,s){if(!i||ji)return"";ji=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(s){var Qe=function(){throw Error()};if(Object.defineProperty(Qe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Qe,[])}catch(Ue){var Pe=Ue}Reflect.construct(i,[],Qe)}else{try{Qe.call()}catch(Ue){Pe=Ue}i.call(Qe.prototype)}}else{try{throw Error()}catch(Ue){Pe=Ue}(Qe=i())&&typeof Qe.catch=="function"&&Qe.catch(function(){})}}catch(Ue){if(Ue&&Pe&&typeof Ue.stack=="string")return[Ue.stack,Pe.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var S=p.DetermineComponentFrameRoot(),B=S[0],q=S[1];if(B&&q){var ne=B.split(`
`),me=q.split(`
`);for(x=p=0;p<ne.length&&!ne[p].includes("DetermineComponentFrameRoot");)p++;for(;x<me.length&&!me[x].includes("DetermineComponentFrameRoot");)x++;if(p===ne.length||x===me.length)for(p=ne.length-1,x=me.length-1;1<=p&&0<=x&&ne[p]!==me[x];)x--;for(;1<=p&&0<=x;p--,x--)if(ne[p]!==me[x]){if(p!==1||x!==1)do if(p--,x--,0>x||ne[p]!==me[x]){var Ze=`
`+ne[p].replace(" at new "," at ");return i.displayName&&Ze.includes("<anonymous>")&&(Ze=Ze.replace("<anonymous>",i.displayName)),Ze}while(1<=p&&0<=x);break}}}finally{ji=!1,Error.prepareStackTrace=c}return(c=i?i.displayName||i.name:"")?un(c):""}function Ke(i){switch(i.tag){case 26:case 27:case 5:return un(i.type);case 16:return un("Lazy");case 13:return un("Suspense");case 19:return un("SuspenseList");case 0:case 15:return i=Fn(i.type,!1),i;case 11:return i=Fn(i.type.render,!1),i;case 1:return i=Fn(i.type,!0),i;default:return""}}function Ot(i){try{var s="";do s+=Ke(i),i=i.return;while(i);return s}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function zt(i){var s=i,c=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(c=s.return),i=s.return;while(i)}return s.tag===3?c:null}function ci(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function fe(i){if(zt(i)!==i)throw Error(ee(188))}function Je(i){var s=i.alternate;if(!s){if(s=zt(i),s===null)throw Error(ee(188));return s!==i?null:i}for(var c=i,p=s;;){var x=c.return;if(x===null)break;var S=x.alternate;if(S===null){if(p=x.return,p!==null){c=p;continue}break}if(x.child===S.child){for(S=x.child;S;){if(S===c)return fe(x),i;if(S===p)return fe(x),s;S=S.sibling}throw Error(ee(188))}if(c.return!==p.return)c=x,p=S;else{for(var B=!1,q=x.child;q;){if(q===c){B=!0,c=x,p=S;break}if(q===p){B=!0,p=x,c=S;break}q=q.sibling}if(!B){for(q=S.child;q;){if(q===c){B=!0,c=S,p=x;break}if(q===p){B=!0,p=S,c=x;break}q=q.sibling}if(!B)throw Error(ee(189))}}if(c.alternate!==p)throw Error(ee(190))}if(c.tag!==3)throw Error(ee(188));return c.stateNode.current===c?i:s}function St(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=St(i),s!==null)return s;i=i.sibling}return null}var xt=Array.isArray,ot=Ee.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Rt={pending:!1,data:null,method:null,action:null},Ut=[],hn=-1;function ei(i){return{current:i}}function ui(i){0>hn||(i.current=Ut[hn],Ut[hn]=null,hn--)}function vi(i,s){hn++,Ut[hn]=i.current,i.current=s}var Di=ei(null),Hi=ei(null),sr=ei(null),Fi=ei(null);function Oa(i,s){switch(vi(sr,s),vi(Hi,i),vi(Di,null),i=s.nodeType,i){case 9:case 11:s=(s=s.documentElement)&&(s=s.namespaceURI)?Cu(s):0;break;default:if(i=i===8?s.parentNode:s,s=i.tagName,i=i.namespaceURI)i=Cu(i),s=df(i,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ui(Di),vi(Di,s)}function ea(){ui(Di),ui(Hi),ui(sr)}function Br(i){i.memoizedState!==null&&vi(Fi,i);var s=Di.current,c=df(s,i.type);s!==c&&(vi(Hi,i),vi(Di,c))}function va(i){Hi.current===i&&(ui(Di),ui(Hi)),Fi.current===i&&(ui(Fi),G._currentValue=Rt)}var ja=Object.prototype.hasOwnProperty,ta=Z.unstable_scheduleCallback,Or=Z.unstable_cancelCallback,Bo=Z.unstable_shouldYield,to=Z.unstable_requestPaint,or=Z.unstable_now,Oo=Z.unstable_getCurrentPriorityLevel,ws=Z.unstable_ImmediatePriority,Fa=Z.unstable_UserBlockingPriority,ia=Z.unstable_NormalPriority,Ts=Z.unstable_LowPriority,is=Z.unstable_IdlePriority,Il=Z.log,jo=Z.unstable_setDisableYieldValue,ns=null,dn=null;function ye(i){if(dn&&typeof dn.onCommitFiberRoot=="function")try{dn.onCommitFiberRoot(ns,i,void 0,(i.current.flags&128)===128)}catch{}}function P(i){if(typeof Il=="function"&&jo(i),dn&&typeof dn.setStrictMode=="function")try{dn.setStrictMode(ns,i)}catch{}}var V=Math.clz32?Math.clz32:le,$=Math.log,W=Math.LN2;function le(i){return i>>>=0,i===0?32:31-($(i)/W|0)|0}var pe=128,Se=4194304;function de(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Re(i,s){var c=i.pendingLanes;if(c===0)return 0;var p=0,x=i.suspendedLanes,S=i.pingedLanes,B=i.warmLanes;i=i.finishedLanes!==0;var q=c&134217727;return q!==0?(c=q&~x,c!==0?p=de(c):(S&=q,S!==0?p=de(S):i||(B=q&~B,B!==0&&(p=de(B))))):(q=c&~x,q!==0?p=de(q):S!==0?p=de(S):i||(B=c&~B,B!==0&&(p=de(B)))),p===0?0:s!==0&&s!==p&&(s&x)===0&&(x=p&-p,B=s&-s,x>=B||x===32&&(B&4194176)!==0)?s:p}function ze(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function ve(i,s){switch(i){case 1:case 2:case 4:case 8:return s+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ve(){var i=pe;return pe<<=1,(pe&4194176)===0&&(pe=128),i}function xe(){var i=Se;return Se<<=1,(Se&62914560)===0&&(Se=4194304),i}function tt(i){for(var s=[],c=0;31>c;c++)s.push(i);return s}function pt(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function kt(i,s,c,p,x,S){var B=i.pendingLanes;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=c,i.entangledLanes&=c,i.errorRecoveryDisabledLanes&=c,i.shellSuspendCounter=0;var q=i.entanglements,ne=i.expirationTimes,me=i.hiddenUpdates;for(c=B&~c;0<c;){var Ze=31-V(c),Qe=1<<Ze;q[Ze]=0,ne[Ze]=-1;var Pe=me[Ze];if(Pe!==null)for(me[Ze]=null,Ze=0;Ze<Pe.length;Ze++){var Ue=Pe[Ze];Ue!==null&&(Ue.lane&=-536870913)}c&=~Qe}p!==0&&At(i,p,0),S!==0&&x===0&&i.tag!==0&&(i.suspendedLanes|=S&~(B&~s))}function At(i,s,c){i.pendingLanes|=s,i.suspendedLanes&=~s;var p=31-V(s);i.entangledLanes|=s,i.entanglements[p]=i.entanglements[p]|1073741824|c&4194218}function je(i,s){var c=i.entangledLanes|=s;for(i=i.entanglements;c;){var p=31-V(c),x=1<<p;x&s|i[p]&s&&(i[p]|=s),c&=~x}}function ht(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function lt(){var i=ot.p;return i!==0?i:(i=window.event,i===void 0?32:qi(i.type))}function Zt(i,s){var c=ot.p;try{return ot.p=i,s()}finally{ot.p=c}}var bt=Math.random().toString(36).slice(2),Et="__reactFiber$"+bt,ct="__reactProps$"+bt,na="__reactContainer$"+bt,nn="__reactEvents$"+bt,In="__reactListeners$"+bt,zi="__reactHandles$"+bt,Rl="__reactResources$"+bt,Nn="__reactMarker$"+bt;function hi(i){delete i[Et],delete i[ct],delete i[nn],delete i[In],delete i[zi]}function Ss(i){var s=i[Et];if(s)return s;for(var c=i.parentNode;c;){if(s=c[na]||c[Et]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(i=pf(i);i!==null;){if(c=i[Et])return c;i=pf(i)}return s}i=c,c=i.parentNode}return null}function Na(i){if(i=i[Et]||i[na]){var s=i.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return i}return null}function io(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(ee(33))}function jr(i){var s=i[Rl];return s||(s=i[Rl]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function $i(i){i[Nn]=!0}var Mc=new Set,Pu={};function Ms(i,s){xa(i,s),xa(i+"Capture",s)}function xa(i,s){for(Pu[i]=s,i=0;i<s.length;i++)Mc.add(s[i])}var Ua=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wd=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Eh={},Ch={};function Du(i){return ja.call(Ch,i)?!0:ja.call(Eh,i)?!1:wd.test(i)?Ch[i]=!0:(Eh[i]=!0,!1)}function rs(i,s,c){if(Du(s))if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var p=s.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+c)}}function Fo(i,s,c){if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+c)}}function ba(i,s,c,p){if(p===null)i.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttributeNS(s,c,""+p)}}function Qn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Ec(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Iu(i){var s=Ec(i)?"checked":"value",c=Object.getOwnPropertyDescriptor(i.constructor.prototype,s),p=""+i[s];if(!i.hasOwnProperty(s)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var x=c.get,S=c.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return x.call(this)},set:function(B){p=""+B,S.call(this,B)}}),Object.defineProperty(i,s,{enumerable:c.enumerable}),{getValue:function(){return p},setValue:function(B){p=""+B},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function no(i){i._valueTracker||(i._valueTracker=Iu(i))}function Cc(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var c=s.getValue(),p="";return i&&(p=Ec(i)?i.checked?"true":"false":i.value),i=p,i!==c?(s.setValue(i),!0):!1}function Va(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var wa=/[\n"\\]/g;function Ft(i){return i.replace(wa,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function mr(i,s,c,p,x,S,B,q){i.name="",B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"?i.type=B:i.removeAttribute("type"),s!=null?B==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+Qn(s)):i.value!==""+Qn(s)&&(i.value=""+Qn(s)):B!=="submit"&&B!=="reset"||i.removeAttribute("value"),s!=null?Xt(i,B,Qn(s)):c!=null?Xt(i,B,Qn(c)):p!=null&&i.removeAttribute("value"),x==null&&S!=null&&(i.defaultChecked=!!S),x!=null&&(i.checked=x&&typeof x!="function"&&typeof x!="symbol"),q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?i.name=""+Qn(q):i.removeAttribute("name")}function Fr(i,s,c,p,x,S,B,q){if(S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(i.type=S),s!=null||c!=null){if(!(S!=="submit"&&S!=="reset"||s!=null))return;c=c!=null?""+Qn(c):"",s=s!=null?""+Qn(s):c,q||s===i.value||(i.value=s),i.defaultValue=s}p=p??x,p=typeof p!="function"&&typeof p!="symbol"&&!!p,i.checked=q?i.checked:!!p,i.defaultChecked=!!p,B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"&&(i.name=B)}function Xt(i,s,c){s==="number"&&Va(i.ownerDocument)===i||i.defaultValue===""+c||(i.defaultValue=""+c)}function as(i,s,c,p){if(i=i.options,s){s={};for(var x=0;x<c.length;x++)s["$"+c[x]]=!0;for(c=0;c<i.length;c++)x=s.hasOwnProperty("$"+i[c].value),i[c].selected!==x&&(i[c].selected=x),x&&p&&(i[c].defaultSelected=!0)}else{for(c=""+Qn(c),s=null,x=0;x<i.length;x++){if(i[x].value===c){i[x].selected=!0,p&&(i[x].defaultSelected=!0);return}s!==null||i[x].disabled||(s=i[x])}s!==null&&(s.selected=!0)}}function Ac(i,s,c){if(s!=null&&(s=""+Qn(s),s!==i.value&&(i.value=s),c==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=c!=null?""+Qn(c):""}function Nr(i,s,c,p){if(s==null){if(p!=null){if(c!=null)throw Error(ee(92));if(xt(p)){if(1<p.length)throw Error(ee(93));p=p[0]}c=p}c==null&&(c=""),s=c}c=Qn(s),i.defaultValue=c,p=i.textContent,p===c&&p!==""&&p!==null&&(i.value=p)}function rn(i,s){if(s){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=s;return}}i.textContent=s}var Un=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ni(i,s,c){var p=s.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?p?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":p?i.setProperty(s,c):typeof c!="number"||c===0||Un.has(s)?s==="float"?i.cssFloat=c:i[s]=(""+c).trim():i[s]=c+"px"}function zc(i,s,c){if(s!=null&&typeof s!="object")throw Error(ee(62));if(i=i.style,c!=null){for(var p in c)!c.hasOwnProperty(p)||s!=null&&s.hasOwnProperty(p)||(p.indexOf("--")===0?i.setProperty(p,""):p==="float"?i.cssFloat="":i[p]="");for(var x in s)p=s[x],s.hasOwnProperty(x)&&c[x]!==p&&Ni(i,x,p)}else for(var S in s)s.hasOwnProperty(S)&&Ni(i,S,s[S])}function bn(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gr=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Mr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ro(i){return Mr.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var Ur=null;function an(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Vr=null,Wn=null;function No(i){var s=Na(i);if(s&&(i=s.stateNode)){var c=i[ct]||null;e:switch(i=s.stateNode,s.type){case"input":if(mr(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),s=c.name,c.type==="radio"&&s!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Ft(""+s)+'"][type="radio"]'),s=0;s<c.length;s++){var p=c[s];if(p!==i&&p.form===i.form){var x=p[ct]||null;if(!x)throw Error(ee(90));mr(p,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(s=0;s<c.length;s++)p=c[s],p.form===i.form&&Cc(p)}break e;case"textarea":Ac(i,c.value,c.defaultValue);break e;case"select":s=c.value,s!=null&&as(i,!!c.multiple,s,!1)}}}var Er=!1;function Pc(i,s,c){if(Er)return i(s,c);Er=!0;try{var p=i(s);return p}finally{if(Er=!1,(Vr!==null||Wn!==null)&&(ph(),Vr&&(s=Vr,i=Wn,Wn=Vr=null,No(s),i)))for(s=0;s<i.length;s++)No(i[s])}}function _r(i,s){var c=i.stateNode;if(c===null)return null;var p=c[ct]||null;if(p===null)return null;c=p[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(ee(231,s,typeof c));return c}var Ti=!1;if(Ua)try{var Es={};Object.defineProperty(Es,"passive",{get:function(){Ti=!0}}),window.addEventListener("test",Es,Es),window.removeEventListener("test",Es,Es)}catch{Ti=!1}var Vt=null,jt=null,ss=null;function Yt(){if(ss)return ss;var i,s=jt,c=s.length,p,x="value"in Vt?Vt.value:Vt.textContent,S=x.length;for(i=0;i<c&&s[i]===x[i];i++);var B=c-i;for(p=1;p<=B&&s[c-p]===x[S-p];p++);return ss=x.slice(i,1<p?1-p:void 0)}function Cs(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function yr(){return!0}function Uo(){return!1}function Jn(i){function s(c,p,x,S,B){this._reactName=c,this._targetInst=x,this.type=p,this.nativeEvent=S,this.target=B,this.currentTarget=null;for(var q in i)i.hasOwnProperty(q)&&(c=i[q],this[q]=c?c(S):S[q]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?yr:Uo,this.isPropagationStopped=Uo,this}return ai(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=yr)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=yr)},persist:function(){},isPersistent:yr}),s}var Ta={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},os=Jn(Ta),Za=ai({},Ta,{view:0,detail:0}),Td=Jn(Za),Vo,kl,ls,Rn=ai({},Za,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:cs,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==ls&&(ls&&i.type==="mousemove"?(Vo=i.screenX-ls.screenX,kl=i.screenY-ls.screenY):kl=Vo=0,ls=i),Vo)},movementY:function(i){return"movementY"in i?i.movementY:kl}}),er=Jn(Rn),Dc=ai({},Rn,{dataTransfer:0}),Zr=Jn(Dc),fn=ai({},Za,{relatedTarget:0}),Ll=Jn(fn),Ic=ai({},Ta,{animationName:0,elapsedTime:0,pseudoElement:0}),ao=Jn(Ic),Sd=ai({},Ta,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Rc=Jn(Sd),Ru=ai({},Ta,{data:0}),Ah=Jn(Ru),kc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Lc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Bc(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=Cr[i])?!!s[i]:!1}function cs(){return Bc}var ku=ai({},Za,{key:function(i){if(i.key){var s=kc[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=Cs(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Lc[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:cs,charCode:function(i){return i.type==="keypress"?Cs(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Cs(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Bl=Jn(ku),Ga=ai({},Rn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zh=Jn(Ga),Lu=ai({},Za,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:cs}),Ol=Jn(Lu),As=ai({},Ta,{propertyName:0,elapsedTime:0,pseudoElement:0}),Md=Jn(As),jl=ai({},Rn,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Ph=Jn(jl),Zo=ai({},Ta,{newState:0,oldState:0}),Dh=Jn(Zo),Ih=[9,13,27,32],Bu=Ua&&"CompositionEvent"in window,Go=null;Ua&&"documentMode"in document&&(Go=document.documentMode);var Ou=Ua&&"TextEvent"in window&&!Go,ju=Ua&&(!Bu||Go&&8<Go&&11>=Go),Oc=" ",jc=!1;function Fc(i,s){switch(i){case"keyup":return Ih.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zs(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var so=!1;function Rh(i,s){switch(i){case"compositionend":return zs(s);case"keypress":return s.which!==32?null:(jc=!0,Oc);case"textInput":return i=s.data,i===Oc&&jc?null:i;default:return null}}function oo(i,s){if(so)return i==="compositionend"||!Bu&&Fc(i,s)?(i=Yt(),ss=jt=Vt=null,so=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return ju&&s.locale!=="ko"?null:s.data;default:return null}}var Ed={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Fl(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!Ed[i.type]:s==="textarea"}function kh(i,s,c,p){Vr?Wn?Wn.push(p):Wn=[p]:Vr=p,s=yh(s,"onChange"),0<s.length&&(c=new os("onChange","change",null,c,p),i.push({event:c,listeners:s}))}var qo=null,lo=null;function Lh(i){of(i,0)}function Nl(i){var s=io(i);if(Cc(s))return i}function Ul(i,s){if(i==="change")return s}var Nc=!1;if(Ua){var Ho;if(Ua){var Sa="oninput"in document;if(!Sa){var Uc=document.createElement("div");Uc.setAttribute("oninput","return;"),Sa=typeof Uc.oninput=="function"}Ho=Sa}else Ho=!1;Nc=Ho&&(!document.documentMode||9<document.documentMode)}function Vl(){qo&&(qo.detachEvent("onpropertychange",Vc),lo=qo=null)}function Vc(i){if(i.propertyName==="value"&&Nl(lo)){var s=[];kh(s,lo,i,an(i)),Pc(Lh,s)}}function Bh(i,s,c){i==="focusin"?(Vl(),qo=s,lo=c,qo.attachEvent("onpropertychange",Vc)):i==="focusout"&&Vl()}function Fu(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Nl(lo)}function co(i,s){if(i==="click")return Nl(s)}function si(i,s){if(i==="input"||i==="change")return Nl(s)}function Cd(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var Gr=typeof Object.is=="function"?Object.is:Cd;function Zl(i,s){if(Gr(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var c=Object.keys(i),p=Object.keys(s);if(c.length!==p.length)return!1;for(p=0;p<c.length;p++){var x=c[p];if(!ja.call(s,x)||!Gr(i[x],s[x]))return!1}return!0}function Oh(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Nu(i,s){var c=Oh(i);i=0;for(var p;c;){if(c.nodeType===3){if(p=i+c.textContent.length,i<=s&&p>=s)return{node:c,offset:s-i};i=p}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Oh(c)}}function jh(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?jh(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function Uu(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=Va(i.document);s instanceof i.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)i=s.contentWindow;else break;s=Va(i.document)}return s}function $o(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}function Zc(i,s){var c=Uu(s);s=i.focusedElem;var p=i.selectionRange;if(c!==s&&s&&s.ownerDocument&&jh(s.ownerDocument.documentElement,s)){if(p!==null&&$o(s)){if(i=p.start,c=p.end,c===void 0&&(c=i),"selectionStart"in s)s.selectionStart=i,s.selectionEnd=Math.min(c,s.value.length);else if(c=(i=s.ownerDocument||document)&&i.defaultView||window,c.getSelection){c=c.getSelection();var x=s.textContent.length,S=Math.min(p.start,x);p=p.end===void 0?S:Math.min(p.end,x),!c.extend&&S>p&&(x=p,p=S,S=x),x=Nu(s,S);var B=Nu(s,p);x&&B&&(c.rangeCount!==1||c.anchorNode!==x.node||c.anchorOffset!==x.offset||c.focusNode!==B.node||c.focusOffset!==B.offset)&&(i=i.createRange(),i.setStart(x.node,x.offset),c.removeAllRanges(),S>p?(c.addRange(i),c.extend(B.node,B.offset)):(i.setEnd(B.node,B.offset),c.addRange(i)))}}for(i=[],c=s;c=c.parentNode;)c.nodeType===1&&i.push({element:c,left:c.scrollLeft,top:c.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<i.length;s++)c=i[s],c.element.scrollLeft=c.left,c.element.scrollTop=c.top}}var Gc=Ua&&"documentMode"in document&&11>=document.documentMode,Ps=null,us=null,qa=null,Ar=!1;function Vu(i,s,c){var p=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Ar||Ps==null||Ps!==Va(p)||(p=Ps,"selectionStart"in p&&$o(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),qa&&Zl(qa,p)||(qa=p,p=yh(us,"onSelect"),0<p.length&&(s=new os("onSelect","select",null,s,c),i.push({event:s,listeners:p}),s.target=Ps)))}function Ds(i,s){var c={};return c[i.toLowerCase()]=s.toLowerCase(),c["Webkit"+i]="webkit"+s,c["Moz"+i]="moz"+s,c}var Is={animationend:Ds("Animation","AnimationEnd"),animationiteration:Ds("Animation","AnimationIteration"),animationstart:Ds("Animation","AnimationStart"),transitionrun:Ds("Transition","TransitionRun"),transitionstart:Ds("Transition","TransitionStart"),transitioncancel:Ds("Transition","TransitionCancel"),transitionend:Ds("Transition","TransitionEnd")},hs={},Gl={};Ua&&(Gl=document.createElement("div").style,"AnimationEvent"in window||(delete Is.animationend.animation,delete Is.animationiteration.animation,delete Is.animationstart.animation),"TransitionEvent"in window||delete Is.transitionend.transition);function Ha(i){if(hs[i])return hs[i];if(!Is[i])return i;var s=Is[i],c;for(c in s)if(s.hasOwnProperty(c)&&c in Gl)return hs[i]=s[c];return i}var Xo=Ha("animationend"),ql=Ha("animationiteration"),Zu=Ha("animationstart"),Yo=Ha("transitionrun"),Ko=Ha("transitionstart"),Fh=Ha("transitioncancel"),qc=Ha("transitionend"),ti=new Map,Hl="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function Ma(i,s){ti.set(i,s),Ms(s,[i])}var qr=[],ra=0,Gu=0;function Hc(){for(var i=ra,s=Gu=ra=0;s<i;){var c=qr[s];qr[s++]=null;var p=qr[s];qr[s++]=null;var x=qr[s];qr[s++]=null;var S=qr[s];if(qr[s++]=null,p!==null&&x!==null){var B=p.pending;B===null?x.next=x:(x.next=B.next,B.next=x),p.pending=x}S!==0&&Xl(c,x,S)}}function $l(i,s,c,p){qr[ra++]=i,qr[ra++]=s,qr[ra++]=c,qr[ra++]=p,Gu|=p,i.lanes|=p,i=i.alternate,i!==null&&(i.lanes|=p)}function $c(i,s,c,p){return $l(i,s,c,p),Xa(i)}function $a(i,s){return $l(i,null,null,s),Xa(i)}function Xl(i,s,c){i.lanes|=c;var p=i.alternate;p!==null&&(p.lanes|=c);for(var x=!1,S=i.return;S!==null;)S.childLanes|=c,p=S.alternate,p!==null&&(p.childLanes|=c),S.tag===22&&(i=S.stateNode,i===null||i._visibility&1||(x=!0)),i=S,S=S.return;x&&s!==null&&i.tag===3&&(S=i.stateNode,x=31-V(c),S=S.hiddenUpdates,i=S[x],i===null?S[x]=[s]:i.push(s),s.lane=c|536870912)}function Xa(i){if(50<yc)throw yc=0,ed=null,Error(ee(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var ds={},Xc=new WeakMap;function Hr(i,s){if(typeof i=="object"&&i!==null){var c=Xc.get(i);return c!==void 0?c:(s={value:i,source:s,stack:Ot(s)},Xc.set(i,s),s)}return{value:i,source:s,stack:Ot(s)}}var fs=[],ps=0,Qo=null,Yl=0,vr=[],aa=0,Rs=null,$r=1,sa="";function ms(i,s){fs[ps++]=Yl,fs[ps++]=Qo,Qo=i,Yl=s}function Yc(i,s,c){vr[aa++]=$r,vr[aa++]=sa,vr[aa++]=Rs,Rs=i;var p=$r;i=sa;var x=32-V(p)-1;p&=~(1<<x),c+=1;var S=32-V(s)+x;if(30<S){var B=x-x%5;S=(p&(1<<B)-1).toString(32),p>>=B,x-=B,$r=1<<32-V(s)+x|c<<x|p,sa=S+i}else $r=1<<S|c<<x|p,sa=i}function ks(i){i.return!==null&&(ms(i,1),Yc(i,1,0))}function uo(i){for(;i===Qo;)Qo=fs[--ps],fs[ps]=null,Yl=fs[--ps],fs[ps]=null;for(;i===Rs;)Rs=vr[--aa],vr[aa]=null,sa=vr[--aa],vr[aa]=null,$r=vr[--aa],vr[aa]=null}var tr=null,pn=null,It=!1,ir=null,mn=!1,Kl=Error(ee(519));function gs(i){var s=Error(ee(418,""));throw Wo(Hr(s,i)),Kl}function qu(i){var s=i.stateNode,c=i.type,p=i.memoizedProps;switch(s[Et]=i,s[ct]=p,c){case"dialog":Kt("cancel",s),Kt("close",s);break;case"iframe":case"object":case"embed":Kt("load",s);break;case"video":case"audio":for(c=0;c<Su.length;c++)Kt(Su[c],s);break;case"source":Kt("error",s);break;case"img":case"image":case"link":Kt("error",s),Kt("load",s);break;case"details":Kt("toggle",s);break;case"input":Kt("invalid",s),Fr(s,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0),no(s);break;case"select":Kt("invalid",s);break;case"textarea":Kt("invalid",s),Nr(s,p.value,p.defaultValue,p.children),no(s)}c=p.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||s.textContent===""+c||p.suppressHydrationWarning===!0||cf(s.textContent,c)?(p.popover!=null&&(Kt("beforetoggle",s),Kt("toggle",s)),p.onScroll!=null&&Kt("scroll",s),p.onScrollEnd!=null&&Kt("scrollend",s),p.onClick!=null&&(s.onclick=bs),s=!0):s=!1,s||gs(i)}function Ls(i){for(tr=i.return;tr;)switch(tr.tag){case 3:case 27:mn=!0;return;case 5:case 13:mn=!1;return;default:tr=tr.return}}function Ya(i){if(i!==tr)return!1;if(!It)return Ls(i),It=!0,!1;var s=!1,c;if((c=i.tag!==3&&i.tag!==27)&&((c=i.tag===5)&&(c=i.type,c=!(c!=="form"&&c!=="button")||Au(i.type,i.memoizedProps)),c=!c),c&&(s=!0),s&&pn&&gs(i),Ls(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ee(317));e:{for(i=i.nextSibling,s=0;i;){if(i.nodeType===8)if(c=i.data,c==="/$"){if(s===0){pn=es(i.nextSibling);break e}s--}else c!=="$"&&c!=="$!"&&c!=="$?"||s++;i=i.nextSibling}pn=null}}else pn=tr?es(i.stateNode.nextSibling):null;return!0}function Ka(){pn=tr=null,It=!1}function Wo(i){ir===null?ir=[i]:ir.push(i)}var ho=Error(ee(460)),Kc=Error(ee(474)),Qc={then:function(){}};function Wc(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Ea(){}function fo(i,s,c){switch(c=i[c],c===void 0?i.push(s):c!==s&&(s.then(Ea,Ea),s=c),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,i===ho?Error(ee(483)):i;default:if(typeof s.status=="string")s.then(Ea,Ea);else{if(i=Li,i!==null&&100<i.shellSuspendCounter)throw Error(ee(482));i=s,i.status="pending",i.then(function(p){if(s.status==="pending"){var x=s;x.status="fulfilled",x.value=p}},function(p){if(s.status==="pending"){var x=s;x.status="rejected",x.reason=p}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,i===ho?Error(ee(483)):i}throw Jo=s,ho}}var Jo=null;function Hu(){if(Jo===null)throw Error(ee(459));var i=Jo;return Jo=null,i}var po=null,el=0;function Ql(i){var s=el;return el+=1,po===null&&(po=[]),fo(po,i,s)}function tl(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function Ca(i,s){throw s.$$typeof===rt?Error(ee(525)):(i=Object.prototype.toString.call(s),Error(ee(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function mo(i){var s=i._init;return s(i._payload)}function Ui(i){function s(be,ge){if(i){var Ce=be.deletions;Ce===null?(be.deletions=[ge],be.flags|=16):Ce.push(ge)}}function c(be,ge){if(!i)return null;for(;ge!==null;)s(be,ge),ge=ge.sibling;return null}function p(be){for(var ge=new Map;be!==null;)be.key!==null?ge.set(be.key,be):ge.set(be.index,be),be=be.sibling;return ge}function x(be,ge){return be=vl(be,ge),be.index=0,be.sibling=null,be}function S(be,ge,Ce){return be.index=Ce,i?(Ce=be.alternate,Ce!==null?(Ce=Ce.index,Ce<ge?(be.flags|=33554434,ge):Ce):(be.flags|=33554434,ge)):(be.flags|=1048576,ge)}function B(be){return i&&be.alternate===null&&(be.flags|=33554434),be}function q(be,ge,Ce,He){return ge===null||ge.tag!==6?(ge=qd(Ce,be.mode,He),ge.return=be,ge):(ge=x(ge,Ce),ge.return=be,ge)}function ne(be,ge,Ce,He){var gt=Ce.type;return gt===it?Ze(be,ge,Ce.props.children,He,Ce.key):ge!==null&&(ge.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===cn&&mo(gt)===ge.type)?(ge=x(ge,Ce.props),tl(ge,Ce),ge.return=be,ge):(ge=ch(Ce.type,Ce.key,Ce.props,null,be.mode,He),tl(ge,Ce),ge.return=be,ge)}function me(be,ge,Ce,He){return ge===null||ge.tag!==4||ge.stateNode.containerInfo!==Ce.containerInfo||ge.stateNode.implementation!==Ce.implementation?(ge=mc(Ce,be.mode,He),ge.return=be,ge):(ge=x(ge,Ce.children||[]),ge.return=be,ge)}function Ze(be,ge,Ce,He,gt){return ge===null||ge.tag!==7?(ge=xl(Ce,be.mode,He,gt),ge.return=be,ge):(ge=x(ge,Ce),ge.return=be,ge)}function Qe(be,ge,Ce){if(typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint")return ge=qd(""+ge,be.mode,Ce),ge.return=be,ge;if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case O:return Ce=ch(ge.type,ge.key,ge.props,null,be.mode,Ce),tl(Ce,ge),Ce.return=be,Ce;case d:return ge=mc(ge,be.mode,Ce),ge.return=be,ge;case cn:var He=ge._init;return ge=He(ge._payload),Qe(be,ge,Ce)}if(xt(ge)||Jt(ge))return ge=xl(ge,be.mode,Ce,null),ge.return=be,ge;if(typeof ge.then=="function")return Qe(be,Ql(ge),Ce);if(ge.$$typeof===_e)return Qe(be,qh(be,ge),Ce);Ca(be,ge)}return null}function Pe(be,ge,Ce,He){var gt=ge!==null?ge.key:null;if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return gt!==null?null:q(be,ge,""+Ce,He);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case O:return Ce.key===gt?ne(be,ge,Ce,He):null;case d:return Ce.key===gt?me(be,ge,Ce,He):null;case cn:return gt=Ce._init,Ce=gt(Ce._payload),Pe(be,ge,Ce,He)}if(xt(Ce)||Jt(Ce))return gt!==null?null:Ze(be,ge,Ce,He,null);if(typeof Ce.then=="function")return Pe(be,ge,Ql(Ce),He);if(Ce.$$typeof===_e)return Pe(be,ge,qh(be,Ce),He);Ca(be,Ce)}return null}function Ue(be,ge,Ce,He,gt){if(typeof He=="string"&&He!==""||typeof He=="number"||typeof He=="bigint")return be=be.get(Ce)||null,q(ge,be,""+He,gt);if(typeof He=="object"&&He!==null){switch(He.$$typeof){case O:return be=be.get(He.key===null?Ce:He.key)||null,ne(ge,be,He,gt);case d:return be=be.get(He.key===null?Ce:He.key)||null,me(ge,be,He,gt);case cn:var Qt=He._init;return He=Qt(He._payload),Ue(be,ge,Ce,He,gt)}if(xt(He)||Jt(He))return be=be.get(Ce)||null,Ze(ge,be,He,gt,null);if(typeof He.then=="function")return Ue(be,ge,Ce,Ql(He),gt);if(He.$$typeof===_e)return Ue(be,ge,Ce,qh(ge,He),gt);Ca(ge,He)}return null}function Ct(be,ge,Ce,He){for(var gt=null,Qt=null,Pt=ge,Lt=ge=0,dr=null;Pt!==null&&Lt<Ce.length;Lt++){Pt.index>Lt?(dr=Pt,Pt=null):dr=Pt.sibling;var Nt=Pe(be,Pt,Ce[Lt],He);if(Nt===null){Pt===null&&(Pt=dr);break}i&&Pt&&Nt.alternate===null&&s(be,Pt),ge=S(Nt,ge,Lt),Qt===null?gt=Nt:Qt.sibling=Nt,Qt=Nt,Pt=dr}if(Lt===Ce.length)return c(be,Pt),It&&ms(be,Lt),gt;if(Pt===null){for(;Lt<Ce.length;Lt++)Pt=Qe(be,Ce[Lt],He),Pt!==null&&(ge=S(Pt,ge,Lt),Qt===null?gt=Pt:Qt.sibling=Pt,Qt=Pt);return It&&ms(be,Lt),gt}for(Pt=p(Pt);Lt<Ce.length;Lt++)dr=Ue(Pt,be,Lt,Ce[Lt],He),dr!==null&&(i&&dr.alternate!==null&&Pt.delete(dr.key===null?Lt:dr.key),ge=S(dr,ge,Lt),Qt===null?gt=dr:Qt.sibling=dr,Qt=dr);return i&&Pt.forEach(function(Yn){return s(be,Yn)}),It&&ms(be,Lt),gt}function qt(be,ge,Ce,He){if(Ce==null)throw Error(ee(151));for(var gt=null,Qt=null,Pt=ge,Lt=ge=0,dr=null,Nt=Ce.next();Pt!==null&&!Nt.done;Lt++,Nt=Ce.next()){Pt.index>Lt?(dr=Pt,Pt=null):dr=Pt.sibling;var Yn=Pe(be,Pt,Nt.value,He);if(Yn===null){Pt===null&&(Pt=dr);break}i&&Pt&&Yn.alternate===null&&s(be,Pt),ge=S(Yn,ge,Lt),Qt===null?gt=Yn:Qt.sibling=Yn,Qt=Yn,Pt=dr}if(Nt.done)return c(be,Pt),It&&ms(be,Lt),gt;if(Pt===null){for(;!Nt.done;Lt++,Nt=Ce.next())Nt=Qe(be,Nt.value,He),Nt!==null&&(ge=S(Nt,ge,Lt),Qt===null?gt=Nt:Qt.sibling=Nt,Qt=Nt);return It&&ms(be,Lt),gt}for(Pt=p(Pt);!Nt.done;Lt++,Nt=Ce.next())Nt=Ue(Pt,be,Lt,Nt.value,He),Nt!==null&&(i&&Nt.alternate!==null&&Pt.delete(Nt.key===null?Lt:Nt.key),ge=S(Nt,ge,Lt),Qt===null?gt=Nt:Qt.sibling=Nt,Qt=Nt);return i&&Pt.forEach(function(Tc){return s(be,Tc)}),It&&ms(be,Lt),gt}function An(be,ge,Ce,He){if(typeof Ce=="object"&&Ce!==null&&Ce.type===it&&Ce.key===null&&(Ce=Ce.props.children),typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case O:e:{for(var gt=Ce.key;ge!==null;){if(ge.key===gt){if(gt=Ce.type,gt===it){if(ge.tag===7){c(be,ge.sibling),He=x(ge,Ce.props.children),He.return=be,be=He;break e}}else if(ge.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===cn&&mo(gt)===ge.type){c(be,ge.sibling),He=x(ge,Ce.props),tl(He,Ce),He.return=be,be=He;break e}c(be,ge);break}else s(be,ge);ge=ge.sibling}Ce.type===it?(He=xl(Ce.props.children,be.mode,He,Ce.key),He.return=be,be=He):(He=ch(Ce.type,Ce.key,Ce.props,null,be.mode,He),tl(He,Ce),He.return=be,be=He)}return B(be);case d:e:{for(gt=Ce.key;ge!==null;){if(ge.key===gt)if(ge.tag===4&&ge.stateNode.containerInfo===Ce.containerInfo&&ge.stateNode.implementation===Ce.implementation){c(be,ge.sibling),He=x(ge,Ce.children||[]),He.return=be,be=He;break e}else{c(be,ge);break}else s(be,ge);ge=ge.sibling}He=mc(Ce,be.mode,He),He.return=be,be=He}return B(be);case cn:return gt=Ce._init,Ce=gt(Ce._payload),An(be,ge,Ce,He)}if(xt(Ce))return Ct(be,ge,Ce,He);if(Jt(Ce)){if(gt=Jt(Ce),typeof gt!="function")throw Error(ee(150));return Ce=gt.call(Ce),qt(be,ge,Ce,He)}if(typeof Ce.then=="function")return An(be,ge,Ql(Ce),He);if(Ce.$$typeof===_e)return An(be,ge,qh(be,Ce),He);Ca(be,Ce)}return typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint"?(Ce=""+Ce,ge!==null&&ge.tag===6?(c(be,ge.sibling),He=x(ge,Ce),He.return=be,be=He):(c(be,ge),He=qd(Ce,be.mode,He),He.return=be,be=He),B(be)):c(be,ge)}return function(be,ge,Ce,He){try{el=0;var gt=An(be,ge,Ce,He);return po=null,gt}catch(Pt){if(Pt===ho)throw Pt;var Qt=Lr(29,Pt,null,be.mode);return Qt.lanes=He,Qt.return=be,Qt}finally{}}}var wn=Ui(!0),Jc=Ui(!1),xr=ei(null),_s=ei(0);function il(i,s){i=Qs,vi(_s,i),vi(xr,s),Qs=i|s.baseLanes}function eu(){vi(_s,Qs),vi(xr,xr.current)}function Wl(){Qs=_s.current,ui(xr),ui(_s)}var oa=ei(null),Xr=null;function la(i){var s=i.alternate;vi(gn,gn.current&1),vi(oa,i),Xr===null&&(s===null||xr.current!==null||s.memoizedState!==null)&&(Xr=i)}function zr(i){if(i.tag===22){if(vi(gn,gn.current),vi(oa,i),Xr===null){var s=i.alternate;s!==null&&s.memoizedState!==null&&(Xr=i)}}else nt()}function nt(){vi(gn,gn.current),vi(oa,oa.current)}function Pr(i){ui(oa),Xr===i&&(Xr=null),ui(gn)}var gn=ei(0);function Jl(i){for(var s=i;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Bs=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(c,p){i.push(p)}};this.abort=function(){s.aborted=!0,i.forEach(function(c){return c()})}},ec=Z.unstable_scheduleCallback,tu=Z.unstable_NormalPriority,Tt={$$typeof:_e,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function nl(){return{controller:new Bs,data:new Map,refCount:0}}function rl(i){i.refCount--,i.refCount===0&&ec(tu,function(){i.controller.abort()})}var Os=null,iu=0,js=0,Fs=null;function $u(i,s){if(Os===null){var c=Os=[];iu=0,js=af(),Fs={status:"pending",value:void 0,then:function(p){c.push(p)}}}return iu++,s.then(nu,nu),s}function nu(){if(--iu===0&&Os!==null){Fs!==null&&(Fs.status="fulfilled");var i=Os;Os=null,js=0,Fs=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function Ad(i,s){var c=[],p={status:"pending",value:null,reason:null,then:function(x){c.push(x)}};return i.then(function(){p.status="fulfilled",p.value=s;for(var x=0;x<c.length;x++)(0,c[x])(s)},function(x){for(p.status="rejected",p.reason=x,x=0;x<c.length;x++)(0,c[x])(void 0)}),p}var ru=Dt.S;Dt.S=function(i,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&$u(i,s),ru!==null&&ru(i,s)};var Ns=ei(null);function au(){var i=Ns.current;return i!==null?i:Li.pooledCache}function Aa(i,s){s===null?vi(Ns,Ns.current):vi(Ns,s.pool)}function Pi(){var i=au();return i===null?null:{parent:Tt._currentValue,pool:i}}var ca=0,Gt=null,di=null,sn=null,Us=!1,al=!1,Vn=!1,go=0,mt=0,yt=null,tc=0;function Vi(){throw Error(ee(321))}function ic(i,s){if(s===null)return!1;for(var c=0;c<s.length&&c<i.length;c++)if(!Gr(i[c],s[c]))return!1;return!0}function lr(i,s,c,p,x,S){return ca=S,Gt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Dt.H=i===null||i.memoizedState===null?ki:Zi,Vn=!1,S=c(p,x),Vn=!1,al&&(S=za(s,c,p,x)),Xu(i),S}function Xu(i){Dt.H=Mi;var s=di!==null&&di.next!==null;if(ca=0,sn=di=Gt=null,Us=!1,mt=0,yt=null,s)throw Error(ee(300));i===null||Ln||(i=i.dependencies,i!==null&&Rr(i)&&(Ln=!0))}function za(i,s,c,p){Gt=i;var x=0;do{if(al&&(yt=null),mt=0,al=!1,25<=x)throw Error(ee(301));if(x+=1,sn=di=null,i.updateQueue!=null){var S=i.updateQueue;S.lastEffect=null,S.events=null,S.stores=null,S.memoCache!=null&&(S.memoCache.index=0)}Dt.H=Dr,S=s(c,p)}while(al);return S}function zd(){var i=Dt.H,s=i.useState()[0];return s=typeof s.then=="function"?yo(s):s,i=i.useState()[0],(di!==null?di.memoizedState:null)!==i&&(Gt.flags|=1024),s}function ua(){var i=go!==0;return go=0,i}function Ii(i,s,c){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~c}function Xi(i){if(Us){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}Us=!1}ca=0,sn=di=Gt=null,al=!1,mt=go=0,yt=null}function br(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return sn===null?Gt.memoizedState=sn=i:sn=sn.next=i,sn}function Ri(){if(di===null){var i=Gt.alternate;i=i!==null?i.memoizedState:null}else i=di.next;var s=sn===null?Gt.memoizedState:sn.next;if(s!==null)sn=s,di=i;else{if(i===null)throw Gt.alternate===null?Error(ee(467)):Error(ee(310));di=i,i={memoizedState:di.memoizedState,baseState:di.baseState,baseQueue:di.baseQueue,queue:di.queue,next:null},sn===null?Gt.memoizedState=sn=i:sn=sn.next=i}return sn}var _o;_o=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function yo(i){var s=mt;return mt+=1,yt===null&&(yt=[]),i=fo(yt,i,s),s=Gt,(sn===null?s.memoizedState:sn.next)===null&&(s=s.alternate,Dt.H=s===null||s.memoizedState===null?ki:Zi),i}function ha(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return yo(i);if(i.$$typeof===_e)return cr(i)}throw Error(ee(438,String(i)))}function sl(i){var s=null,c=Gt.updateQueue;if(c!==null&&(s=c.memoCache),s==null){var p=Gt.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(s={data:p.data.map(function(x){return x.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),c===null&&(c=_o(),Gt.updateQueue=c),c.memoCache=s,c=s.data[s.index],c===void 0)for(c=s.data[s.index]=Array(i),p=0;p<i;p++)c[p]=tn;return s.index++,c}function wr(i,s){return typeof s=="function"?s(i):s}function vo(i){var s=Ri();return xo(s,di,i)}function xo(i,s,c){var p=i.queue;if(p===null)throw Error(ee(311));p.lastRenderedReducer=c;var x=i.baseQueue,S=p.pending;if(S!==null){if(x!==null){var B=x.next;x.next=S.next,S.next=B}s.baseQueue=x=S,p.pending=null}if(S=i.baseState,x===null)i.memoizedState=S;else{s=x.next;var q=B=null,ne=null,me=s,Ze=!1;do{var Qe=me.lane&-536870913;if(Qe!==me.lane?(ri&Qe)===Qe:(ca&Qe)===Qe){var Pe=me.revertLane;if(Pe===0)ne!==null&&(ne=ne.next={lane:0,revertLane:0,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null}),Qe===js&&(Ze=!0);else if((ca&Pe)===Pe){me=me.next,Pe===js&&(Ze=!0);continue}else Qe={lane:0,revertLane:me.revertLane,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null},ne===null?(q=ne=Qe,B=S):ne=ne.next=Qe,Gt.lanes|=Pe,bl|=Pe;Qe=me.action,Vn&&c(S,Qe),S=me.hasEagerState?me.eagerState:c(S,Qe)}else Pe={lane:Qe,revertLane:me.revertLane,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null},ne===null?(q=ne=Pe,B=S):ne=ne.next=Pe,Gt.lanes|=Qe,bl|=Qe;me=me.next}while(me!==null&&me!==s);if(ne===null?B=S:ne.next=q,!Gr(S,i.memoizedState)&&(Ln=!0,Ze&&(c=Fs,c!==null)))throw c;i.memoizedState=S,i.baseState=B,i.baseQueue=ne,p.lastRenderedState=S}return x===null&&(p.lanes=0),[i.memoizedState,p.dispatch]}function nc(i){var s=Ri(),c=s.queue;if(c===null)throw Error(ee(311));c.lastRenderedReducer=i;var p=c.dispatch,x=c.pending,S=s.memoizedState;if(x!==null){c.pending=null;var B=x=x.next;do S=i(S,B.action),B=B.next;while(B!==x);Gr(S,s.memoizedState)||(Ln=!0),s.memoizedState=S,s.baseQueue===null&&(s.baseState=S),c.lastRenderedState=S}return[S,p]}function bo(i,s,c){var p=Gt,x=Ri(),S=It;if(S){if(c===void 0)throw Error(ee(407));c=c()}else c=s();var B=!Gr((di||x).memoizedState,c);if(B&&(x.memoizedState=c,Ln=!0),x=x.queue,X(rc.bind(null,p,x,i),[i]),x.getSnapshot!==s||B||sn!==null&&sn.memoizedState.tag&1){if(p.flags|=2048,D(9,su.bind(null,p,x,c,s),{destroy:void 0},null),Li===null)throw Error(ee(349));S||(ca&60)!==0||Vs(p,s,c)}return c}function Vs(i,s,c){i.flags|=16384,i={getSnapshot:s,value:c},s=Gt.updateQueue,s===null?(s=_o(),Gt.updateQueue=s,s.stores=[i]):(c=s.stores,c===null?s.stores=[i]:c.push(i))}function su(i,s,c,p){s.value=c,s.getSnapshot=p,Zs(s)&&ac(i)}function rc(i,s,c){return c(function(){Zs(s)&&ac(i)})}function Zs(i){var s=i.getSnapshot;i=i.value;try{var c=s();return!Gr(i,c)}catch{return!0}}function ac(i){var s=$a(i,2);s!==null&&rr(s,i,2)}function sc(i){var s=br();if(typeof i=="function"){var c=i;if(i=c(),Vn){P(!0);try{c()}finally{P(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:wr,lastRenderedState:i},s}function oc(i,s,c,p){return i.baseState=c,xo(i,di,typeof p=="function"?p:wr)}function ou(i,s,c,p,x){if(ii(i))throw Error(ee(485));if(i=s.action,i!==null){var S={payload:x,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(B){S.listeners.push(B)}};Dt.T!==null?c(!0):S.isTransition=!1,p(S),c=s.pending,c===null?(S.next=s.pending=S,f(s,S)):(S.next=c.next,s.pending=c.next=S)}}function f(i,s){var c=s.action,p=s.payload,x=i.state;if(s.isTransition){var S=Dt.T,B={};Dt.T=B;try{var q=c(x,p),ne=Dt.S;ne!==null&&ne(B,q),e(i,s,q)}catch(me){l(i,s,me)}finally{Dt.T=S}}else try{S=c(x,p),e(i,s,S)}catch(me){l(i,s,me)}}function e(i,s,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(p){n(i,s,p)},function(p){return l(i,s,p)}):n(i,s,c)}function n(i,s,c){s.status="fulfilled",s.value=c,u(s),i.state=c,s=i.pending,s!==null&&(c=s.next,c===s?i.pending=null:(c=c.next,s.next=c,f(i,c)))}function l(i,s,c){var p=i.pending;if(i.pending=null,p!==null){p=p.next;do s.status="rejected",s.reason=c,u(s),s=s.next;while(s!==p)}i.action=null}function u(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function m(i,s){return s}function y(i,s){if(It){var c=Li.formState;if(c!==null){e:{var p=Gt;if(It){if(pn){t:{for(var x=pn,S=mn;x.nodeType!==8;){if(!S){x=null;break t}if(x=es(x.nextSibling),x===null){x=null;break t}}S=x.data,x=S==="F!"||S==="F"?x:null}if(x){pn=es(x.nextSibling),p=x.data==="F!";break e}}gs(p)}p=!1}p&&(s=c[0])}}return c=br(),c.memoizedState=c.baseState=s,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:m,lastRenderedState:s},c.queue=p,c=fi.bind(null,Gt,p),p.dispatch=c,p=sc(!1),S=xi.bind(null,Gt,!1,p.queue),p=br(),x={state:s,dispatch:null,action:i,pending:null},p.queue=x,c=ou.bind(null,Gt,x,S,c),x.dispatch=c,p.memoizedState=i,[s,c,!1]}function b(i){var s=Ri();return T(s,di,i)}function T(i,s,c){s=xo(i,s,m)[0],i=vo(wr)[0],s=typeof s=="object"&&s!==null&&typeof s.then=="function"?yo(s):s;var p=Ri(),x=p.queue,S=x.dispatch;return c!==p.memoizedState&&(Gt.flags|=2048,D(9,E.bind(null,x,c),{destroy:void 0},null)),[s,S,i]}function E(i,s){i.action=s}function z(i){var s=Ri(),c=di;if(c!==null)return T(s,c,i);Ri(),s=s.memoizedState,c=Ri();var p=c.queue.dispatch;return c.memoizedState=i,[s,p,!1]}function D(i,s,c,p){return i={tag:i,create:s,inst:c,deps:p,next:null},s=Gt.updateQueue,s===null&&(s=_o(),Gt.updateQueue=s),c=s.lastEffect,c===null?s.lastEffect=i.next=i:(p=c.next,c.next=i,i.next=p,s.lastEffect=i),i}function I(){return Ri().memoizedState}function F(i,s,c,p){var x=br();Gt.flags|=i,x.memoizedState=D(1|s,c,{destroy:void 0},p===void 0?null:p)}function N(i,s,c,p){var x=Ri();p=p===void 0?null:p;var S=x.memoizedState.inst;di!==null&&p!==null&&ic(p,di.memoizedState.deps)?x.memoizedState=D(s,c,S,p):(Gt.flags|=i,x.memoizedState=D(1|s,c,S,p))}function Y(i,s){F(8390656,8,i,s)}function X(i,s){N(2048,8,i,s)}function K(i,s){return N(4,2,i,s)}function J(i,s){return N(4,4,i,s)}function re(i,s){if(typeof s=="function"){i=i();var c=s(i);return function(){typeof c=="function"?c():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function ae(i,s,c){c=c!=null?c.concat([i]):null,N(4,4,re.bind(null,s,i),c)}function oe(){}function he(i,s){var c=Ri();s=s===void 0?null:s;var p=c.memoizedState;return s!==null&&ic(s,p[1])?p[0]:(c.memoizedState=[i,s],i)}function ce(i,s){var c=Ri();s=s===void 0?null:s;var p=c.memoizedState;if(s!==null&&ic(s,p[1]))return p[0];if(p=i(),Vn){P(!0);try{i()}finally{P(!1)}}return c.memoizedState=[p,s],p}function we(i,s,c){return c===void 0||(ca&1073741824)!==0?i.memoizedState=s:(i.memoizedState=c,i=dh(),Gt.lanes|=i,bl|=i,c)}function Me(i,s,c,p){return Gr(c,s)?c:xr.current!==null?(i=we(i,c,p),Gr(i,s)||(Ln=!0),i):(ca&42)===0?(Ln=!0,i.memoizedState=c):(i=dh(),Gt.lanes|=i,bl|=i,s)}function ke(i,s,c,p,x){var S=ot.p;ot.p=S!==0&&8>S?S:8;var B=Dt.T,q={};Dt.T=q,xi(i,!1,s,c);try{var ne=x(),me=Dt.S;if(me!==null&&me(q,ne),ne!==null&&typeof ne=="object"&&typeof ne.then=="function"){var Ze=Ad(ne,p);_i(i,s,Ze,Zn(i))}else _i(i,s,p,Zn(i))}catch(Qe){_i(i,s,{then:function(){},status:"rejected",reason:Qe},Zn())}finally{ot.p=S,Dt.T=B}}function Le(){}function Ie(i,s,c,p){if(i.tag!==5)throw Error(ee(476));var x=et(i).queue;ke(i,x,s,Rt,c===null?Le:function(){return We(i),c(p)})}function et(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:Rt,baseState:Rt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wr,lastRenderedState:Rt},next:null};var c={};return s.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wr,lastRenderedState:c},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function We(i){var s=et(i).next.queue;_i(i,s,{},Zn())}function Ge(){return cr(G)}function ft(){return Ri().memoizedState}function _t(){return Ri().memoizedState}function oi(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var c=Zn();i=fl(c);var p=Ys(s,i,c);p!==null&&(rr(p,s,c),cc(p,s,c)),s={cache:nl()},i.payload=s;return}s=s.return}}function Si(i,s,c){var p=Zn();c={lane:p,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},ii(i)?pi(s,c):(c=$c(i,s,c,p),c!==null&&(rr(c,i,p),kn(c,s,p)))}function fi(i,s,c){var p=Zn();_i(i,s,c,p)}function _i(i,s,c,p){var x={lane:p,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(ii(i))pi(s,x);else{var S=i.alternate;if(i.lanes===0&&(S===null||S.lanes===0)&&(S=s.lastRenderedReducer,S!==null))try{var B=s.lastRenderedState,q=S(B,c);if(x.hasEagerState=!0,x.eagerState=q,Gr(q,B))return $l(i,s,x,0),Li===null&&Hc(),!1}catch{}finally{}if(c=$c(i,s,x,p),c!==null)return rr(c,i,p),kn(c,s,p),!0}return!1}function xi(i,s,c,p){if(p={lane:2,revertLane:af(),action:p,hasEagerState:!1,eagerState:null,next:null},ii(i)){if(s)throw Error(ee(479))}else s=$c(i,c,p,2),s!==null&&rr(s,i,2)}function ii(i){var s=i.alternate;return i===Gt||s!==null&&s===Gt}function pi(i,s){al=Us=!0;var c=i.pending;c===null?s.next=s:(s.next=c.next,c.next=s),i.pending=s}function kn(i,s,c){if((c&4194176)!==0){var p=s.lanes;p&=i.pendingLanes,c|=p,s.lanes=c,je(i,c)}}var Mi={readContext:cr,use:ha,useCallback:Vi,useContext:Vi,useEffect:Vi,useImperativeHandle:Vi,useLayoutEffect:Vi,useInsertionEffect:Vi,useMemo:Vi,useReducer:Vi,useRef:Vi,useState:Vi,useDebugValue:Vi,useDeferredValue:Vi,useTransition:Vi,useSyncExternalStore:Vi,useId:Vi};Mi.useCacheRefresh=Vi,Mi.useMemoCache=Vi,Mi.useHostTransitionStatus=Vi,Mi.useFormState=Vi,Mi.useActionState=Vi,Mi.useOptimistic=Vi;var ki={readContext:cr,use:ha,useCallback:function(i,s){return br().memoizedState=[i,s===void 0?null:s],i},useContext:cr,useEffect:Y,useImperativeHandle:function(i,s,c){c=c!=null?c.concat([i]):null,F(4194308,4,re.bind(null,s,i),c)},useLayoutEffect:function(i,s){return F(4194308,4,i,s)},useInsertionEffect:function(i,s){F(4,2,i,s)},useMemo:function(i,s){var c=br();s=s===void 0?null:s;var p=i();if(Vn){P(!0);try{i()}finally{P(!1)}}return c.memoizedState=[p,s],p},useReducer:function(i,s,c){var p=br();if(c!==void 0){var x=c(s);if(Vn){P(!0);try{c(s)}finally{P(!1)}}}else x=s;return p.memoizedState=p.baseState=x,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:x},p.queue=i,i=i.dispatch=Si.bind(null,Gt,i),[p.memoizedState,i]},useRef:function(i){var s=br();return i={current:i},s.memoizedState=i},useState:function(i){i=sc(i);var s=i.queue,c=fi.bind(null,Gt,s);return s.dispatch=c,[i.memoizedState,c]},useDebugValue:oe,useDeferredValue:function(i,s){var c=br();return we(c,i,s)},useTransition:function(){var i=sc(!1);return i=ke.bind(null,Gt,i.queue,!0,!1),br().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,c){var p=Gt,x=br();if(It){if(c===void 0)throw Error(ee(407));c=c()}else{if(c=s(),Li===null)throw Error(ee(349));(ri&60)!==0||Vs(p,s,c)}x.memoizedState=c;var S={value:c,getSnapshot:s};return x.queue=S,Y(rc.bind(null,p,S,i),[i]),p.flags|=2048,D(9,su.bind(null,p,S,c,s),{destroy:void 0},null),c},useId:function(){var i=br(),s=Li.identifierPrefix;if(It){var c=sa,p=$r;c=(p&~(1<<32-V(p)-1)).toString(32)+c,s=":"+s+"R"+c,c=go++,0<c&&(s+="H"+c.toString(32)),s+=":"}else c=tc++,s=":"+s+"r"+c.toString(32)+":";return i.memoizedState=s},useCacheRefresh:function(){return br().memoizedState=oi.bind(null,Gt)}};ki.useMemoCache=sl,ki.useHostTransitionStatus=Ge,ki.useFormState=y,ki.useActionState=y,ki.useOptimistic=function(i){var s=br();s.memoizedState=s.baseState=i;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=c,s=xi.bind(null,Gt,!0,c),c.dispatch=s,[i,s]};var Zi={readContext:cr,use:ha,useCallback:he,useContext:cr,useEffect:X,useImperativeHandle:ae,useInsertionEffect:K,useLayoutEffect:J,useMemo:ce,useReducer:vo,useRef:I,useState:function(){return vo(wr)},useDebugValue:oe,useDeferredValue:function(i,s){var c=Ri();return Me(c,di.memoizedState,i,s)},useTransition:function(){var i=vo(wr)[0],s=Ri().memoizedState;return[typeof i=="boolean"?i:yo(i),s]},useSyncExternalStore:bo,useId:ft};Zi.useCacheRefresh=_t,Zi.useMemoCache=sl,Zi.useHostTransitionStatus=Ge,Zi.useFormState=b,Zi.useActionState=b,Zi.useOptimistic=function(i,s){var c=Ri();return oc(c,di,i,s)};var Dr={readContext:cr,use:ha,useCallback:he,useContext:cr,useEffect:X,useImperativeHandle:ae,useInsertionEffect:K,useLayoutEffect:J,useMemo:ce,useReducer:nc,useRef:I,useState:function(){return nc(wr)},useDebugValue:oe,useDeferredValue:function(i,s){var c=Ri();return di===null?we(c,i,s):Me(c,di.memoizedState,i,s)},useTransition:function(){var i=nc(wr)[0],s=Ri().memoizedState;return[typeof i=="boolean"?i:yo(i),s]},useSyncExternalStore:bo,useId:ft};Dr.useCacheRefresh=_t,Dr.useMemoCache=sl,Dr.useHostTransitionStatus=Ge,Dr.useFormState=z,Dr.useActionState=z,Dr.useOptimistic=function(i,s){var c=Ri();return di!==null?oc(c,di,i,s):(c.baseState=i,[i,c.queue.dispatch])};function Pa(i,s,c,p){s=i.memoizedState,c=c(p,s),c=c==null?s:ai({},s,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var da={isMounted:function(i){return(i=i._reactInternals)?zt(i)===i:!1},enqueueSetState:function(i,s,c){i=i._reactInternals;var p=Zn(),x=fl(p);x.payload=s,c!=null&&(x.callback=c),s=Ys(i,x,p),s!==null&&(rr(s,i,p),cc(s,i,p))},enqueueReplaceState:function(i,s,c){i=i._reactInternals;var p=Zn(),x=fl(p);x.tag=1,x.payload=s,c!=null&&(x.callback=c),s=Ys(i,x,p),s!==null&&(rr(s,i,p),cc(s,i,p))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var c=Zn(),p=fl(c);p.tag=2,s!=null&&(p.callback=s),s=Ys(i,p,c),s!==null&&(rr(s,i,c),cc(s,i,c))}};function Yr(i,s,c,p,x,S,B){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,S,B):s.prototype&&s.prototype.isPureReactComponent?!Zl(c,p)||!Zl(x,S):!0}function Gs(i,s,c,p){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,p),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,p),s.state!==i&&da.enqueueReplaceState(s,s.state,null)}function Da(i,s){var c=s;if("ref"in s){c={};for(var p in s)p!=="ref"&&(c[p]=s[p])}if(i=i.defaultProps){c===s&&(c=ai({},c));for(var x in i)c[x]===void 0&&(c[x]=i[x])}return c}var Qa=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function Kr(i){Qa(i)}function Ia(i){console.error(i)}function fa(i){Qa(i)}function Qr(i,s){try{var c=i.onUncaughtError;c(s.value,{componentStack:s.stack})}catch(p){setTimeout(function(){throw p})}}function bi(i,s,c){try{var p=i.onCaughtError;p(c.value,{componentStack:c.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function mi(i,s,c){return c=fl(c),c.tag=3,c.payload={element:null},c.callback=function(){Qr(i,s)},c}function Tn(i){return i=fl(i),i.tag=3,i}function Sn(i,s,c,p){var x=c.type.getDerivedStateFromError;if(typeof x=="function"){var S=p.value;i.payload=function(){return x(S)},i.callback=function(){bi(s,c,p)}}var B=c.stateNode;B!==null&&typeof B.componentDidCatch=="function"&&(i.callback=function(){bi(s,c,p),typeof x!="function"&&(wl===null?wl=new Set([this]):wl.add(this));var q=p.stack;this.componentDidCatch(p.value,{componentStack:q!==null?q:""})})}function wo(i,s,c,p,x){if(c.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(s=c.alternate,s!==null&&To(s,c,x,!0),c=oa.current,c!==null){switch(c.tag){case 13:return Xr===null?mh():c.alternate===null&&Mn===0&&(Mn=3),c.flags&=-257,c.flags|=65536,c.lanes=x,p===Qc?c.flags|=16384:(s=c.updateQueue,s===null?c.updateQueue=new Set([p]):s.add(p),ef(i,p,x)),!1;case 22:return c.flags|=65536,p===Qc?c.flags|=16384:(s=c.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([p])},c.updateQueue=s):(c=s.retryQueue,c===null?s.retryQueue=new Set([p]):c.add(p)),ef(i,p,x)),!1}throw Error(ee(435,c.tag))}return ef(i,p,x),mh(),!1}if(It)return s=oa.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=x,p!==Kl&&(i=Error(ee(422),{cause:p}),Wo(Hr(i,c)))):(p!==Kl&&(s=Error(ee(423),{cause:p}),Wo(Hr(s,c))),i=i.current.alternate,i.flags|=65536,x&=-x,i.lanes|=x,p=Hr(p,c),x=mi(i.stateNode,p,x),Hh(i,x),Mn!==4&&(Mn=2)),!1;var S=Error(ee(520),{cause:p});if(S=Hr(S,c),Wi===null?Wi=[S]:Wi.push(S),Mn!==4&&(Mn=2),s===null)return!0;p=Hr(p,c),c=s;do{switch(c.tag){case 3:return c.flags|=65536,i=x&-x,c.lanes|=i,i=mi(c.stateNode,p,i),Hh(c,i),!1;case 1:if(s=c.type,S=c.stateNode,(c.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(wl===null||!wl.has(S))))return c.flags|=65536,x&=-x,c.lanes|=x,x=Tn(x),Sn(x,i,c,p),Hh(c,x),!1}c=c.return}while(c!==null);return!1}var Nh=Error(ee(461)),Ln=!1;function Bn(i,s,c,p){s.child=i===null?Jc(s,null,c,p):wn(s,i.child,c,p)}function Yu(i,s,c,p,x){c=c.render;var S=s.ref;if("ref"in p){var B={};for(var q in p)q!=="ref"&&(B[q]=p[q])}else B=p;return hl(s),p=lr(i,s,c,B,S,x),q=ua(),i!==null&&!Ln?(Ii(i,s,x),$s(i,s,x)):(It&&q&&ks(s),s.flags|=1,Bn(i,s,p,x),s.child)}function qs(i,s,c,p,x){if(i===null){var S=c.type;return typeof S=="function"&&!lh(S)&&S.defaultProps===void 0&&c.compare===null?(s.tag=15,s.type=S,Ir(i,s,S,p,x)):(i=ch(c.type,null,p,s,s.mode,x),i.ref=s.ref,i.return=s,s.child=i)}if(S=i.child,!Vh(i,x)){var B=S.memoizedProps;if(c=c.compare,c=c!==null?c:Zl,c(B,p)&&i.ref===s.ref)return $s(i,s,x)}return s.flags|=1,i=vl(S,p),i.ref=s.ref,i.return=s,s.child=i}function Ir(i,s,c,p,x){if(i!==null){var S=i.memoizedProps;if(Zl(S,p)&&i.ref===s.ref)if(Ln=!1,s.pendingProps=p=S,Vh(i,x))(i.flags&131072)!==0&&(Ln=!0);else return s.lanes=i.lanes,$s(i,s,x)}return ol(i,s,c,p,x)}function lu(i,s,c){var p=s.pendingProps,x=p.children,S=(s.stateNode._pendingVisibility&2)!==0,B=i!==null?i.memoizedState:null;if(Hs(i,s),p.mode==="hidden"||S){if((s.flags&128)!==0){if(p=B!==null?B.baseLanes|c:c,i!==null){for(x=s.child=i.child,S=0;x!==null;)S=S|x.lanes|x.childLanes,x=x.sibling;s.childLanes=S&~p}else s.childLanes=0,s.child=null;return Ku(i,s,p,c)}if((c&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&Aa(s,B!==null?B.cachePool:null),B!==null?il(s,B):eu(),zr(s);else return s.lanes=s.childLanes=536870912,Ku(i,s,B!==null?B.baseLanes|c:c,c)}else B!==null?(Aa(s,B.cachePool),il(s,B),nt(),s.memoizedState=null):(i!==null&&Aa(s,null),eu(),nt());return Bn(i,s,x,c),s.child}function Ku(i,s,c,p){var x=au();return x=x===null?null:{parent:Tt._currentValue,pool:x},s.memoizedState={baseLanes:c,cachePool:x},i!==null&&Aa(s,null),eu(),zr(s),i!==null&&To(i,s,p,!0),null}function Hs(i,s){var c=s.ref;if(c===null)i!==null&&i.ref!==null&&(s.flags|=2097664);else{if(typeof c!="function"&&typeof c!="object")throw Error(ee(284));(i===null||i.ref!==c)&&(s.flags|=2097664)}}function ol(i,s,c,p,x){return hl(s),c=lr(i,s,c,p,void 0,x),p=ua(),i!==null&&!Ln?(Ii(i,s,x),$s(i,s,x)):(It&&p&&ks(s),s.flags|=1,Bn(i,s,c,x),s.child)}function Qu(i,s,c,p,x,S){return hl(s),s.updateQueue=null,c=za(s,p,c,x),Xu(i),p=ua(),i!==null&&!Ln?(Ii(i,s,S),$s(i,s,S)):(It&&p&&ks(s),s.flags|=1,Bn(i,s,c,S),s.child)}function lc(i,s,c,p,x){if(hl(s),s.stateNode===null){var S=ds,B=c.contextType;typeof B=="object"&&B!==null&&(S=cr(B)),S=new c(p,S),s.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=da,s.stateNode=S,S._reactInternals=s,S=s.stateNode,S.props=p,S.state=s.memoizedState,S.refs={},kd(s),B=c.contextType,S.context=typeof B=="object"&&B!==null?cr(B):ds,S.state=s.memoizedState,B=c.getDerivedStateFromProps,typeof B=="function"&&(Pa(s,c,B,p),S.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(B=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),B!==S.state&&da.enqueueReplaceState(S,S.state,null),ih(s,p,S,x),Mo(),S.state=s.memoizedState),typeof S.componentDidMount=="function"&&(s.flags|=4194308),p=!0}else if(i===null){S=s.stateNode;var q=s.memoizedProps,ne=Da(c,q);S.props=ne;var me=S.context,Ze=c.contextType;B=ds,typeof Ze=="object"&&Ze!==null&&(B=cr(Ze));var Qe=c.getDerivedStateFromProps;Ze=typeof Qe=="function"||typeof S.getSnapshotBeforeUpdate=="function",q=s.pendingProps!==q,Ze||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(q||me!==B)&&Gs(s,S,p,B),dl=!1;var Pe=s.memoizedState;S.state=Pe,ih(s,p,S,x),Mo(),me=s.memoizedState,q||Pe!==me||dl?(typeof Qe=="function"&&(Pa(s,c,Qe,p),me=s.memoizedState),(ne=dl||Yr(s,c,ne,p,Pe,me,B))?(Ze||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(s.flags|=4194308)):(typeof S.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=p,s.memoizedState=me),S.props=p,S.state=me,S.context=B,p=ne):(typeof S.componentDidMount=="function"&&(s.flags|=4194308),p=!1)}else{S=s.stateNode,Ld(i,s),B=s.memoizedProps,Ze=Da(c,B),S.props=Ze,Qe=s.pendingProps,Pe=S.context,me=c.contextType,ne=ds,typeof me=="object"&&me!==null&&(ne=cr(me)),q=c.getDerivedStateFromProps,(me=typeof q=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(B!==Qe||Pe!==ne)&&Gs(s,S,p,ne),dl=!1,Pe=s.memoizedState,S.state=Pe,ih(s,p,S,x),Mo();var Ue=s.memoizedState;B!==Qe||Pe!==Ue||dl||i!==null&&i.dependencies!==null&&Rr(i.dependencies)?(typeof q=="function"&&(Pa(s,c,q,p),Ue=s.memoizedState),(Ze=dl||Yr(s,c,Ze,p,Pe,Ue,ne)||i!==null&&i.dependencies!==null&&Rr(i.dependencies))?(me||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(p,Ue,ne),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(p,Ue,ne)),typeof S.componentDidUpdate=="function"&&(s.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof S.componentDidUpdate!="function"||B===i.memoizedProps&&Pe===i.memoizedState||(s.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||B===i.memoizedProps&&Pe===i.memoizedState||(s.flags|=1024),s.memoizedProps=p,s.memoizedState=Ue),S.props=p,S.state=Ue,S.context=ne,p=Ze):(typeof S.componentDidUpdate!="function"||B===i.memoizedProps&&Pe===i.memoizedState||(s.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||B===i.memoizedProps&&Pe===i.memoizedState||(s.flags|=1024),p=!1)}return S=p,Hs(i,s),p=(s.flags&128)!==0,S||p?(S=s.stateNode,c=p&&typeof c.getDerivedStateFromError!="function"?null:S.render(),s.flags|=1,i!==null&&p?(s.child=wn(s,i.child,null,x),s.child=wn(s,null,c,x)):Bn(i,s,c,x),s.memoizedState=S.state,i=s.child):i=$s(i,s,x),i}function If(i,s,c,p){return Ka(),s.flags|=256,Bn(i,s,c,p),s.child}var Wu={dehydrated:null,treeContext:null,retryLane:0};function Pd(i){return{baseLanes:i,cachePool:Pi()}}function Ju(i,s,c){return i=i!==null?i.childLanes&~c:0,s&&(i|=ma),i}function Dd(i,s,c){var p=s.pendingProps,x=!1,S=(s.flags&128)!==0,B;if((B=S)||(B=i!==null&&i.memoizedState===null?!1:(gn.current&2)!==0),B&&(x=!0,s.flags&=-129),B=(s.flags&32)!==0,s.flags&=-33,i===null){if(It){if(x?la(s):nt(),It){var q=pn,ne;if(ne=q){e:{for(ne=q,q=mn;ne.nodeType!==8;){if(!q){q=null;break e}if(ne=es(ne.nextSibling),ne===null){q=null;break e}}q=ne}q!==null?(s.memoizedState={dehydrated:q,treeContext:Rs!==null?{id:$r,overflow:sa}:null,retryLane:536870912},ne=Lr(18,null,null,0),ne.stateNode=q,ne.return=s,s.child=ne,tr=s,pn=null,ne=!0):ne=!1}ne||gs(s)}if(q=s.memoizedState,q!==null&&(q=q.dehydrated,q!==null))return q.data==="$!"?s.lanes=16:s.lanes=536870912,null;Pr(s)}return q=p.children,p=p.fallback,x?(nt(),x=s.mode,q=ll({mode:"hidden",children:q},x),p=xl(p,x,c,null),q.return=s,p.return=s,q.sibling=p,s.child=q,x=s.child,x.memoizedState=Pd(c),x.childLanes=Ju(i,B,c),s.memoizedState=Wu,p):(la(s),Uh(s,q))}if(ne=i.memoizedState,ne!==null&&(q=ne.dehydrated,q!==null)){if(S)s.flags&256?(la(s),s.flags&=-257,s=Id(i,s,c)):s.memoizedState!==null?(nt(),s.child=i.child,s.flags|=128,s=null):(nt(),x=p.fallback,q=s.mode,p=ll({mode:"visible",children:p.children},q),x=xl(x,q,c,null),x.flags|=2,p.return=s,x.return=s,p.sibling=x,s.child=p,wn(s,i.child,null,c),p=s.child,p.memoizedState=Pd(c),p.childLanes=Ju(i,B,c),s.memoizedState=Wu,s=x);else if(la(s),q.data==="$!"){if(B=q.nextSibling&&q.nextSibling.dataset,B)var me=B.dgst;B=me,p=Error(ee(419)),p.stack="",p.digest=B,Wo({value:p,source:null,stack:null}),s=Id(i,s,c)}else if(Ln||To(i,s,c,!1),B=(c&i.childLanes)!==0,Ln||B){if(B=Li,B!==null){if(p=c&-c,(p&42)!==0)p=1;else switch(p){case 2:p=1;break;case 8:p=4;break;case 32:p=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:p=64;break;case 268435456:p=134217728;break;default:p=0}if(p=(p&(B.suspendedLanes|c))!==0?0:p,p!==0&&p!==ne.retryLane)throw ne.retryLane=p,$a(i,p),rr(B,i,p),Nh}q.data==="$?"||mh(),s=Id(i,s,c)}else q.data==="$?"?(s.flags|=128,s.child=i.child,s=_p.bind(null,i),q._reactRetry=s,s=null):(i=ne.treeContext,pn=es(q.nextSibling),tr=s,It=!0,ir=null,mn=!1,i!==null&&(vr[aa++]=$r,vr[aa++]=sa,vr[aa++]=Rs,$r=i.id,sa=i.overflow,Rs=s),s=Uh(s,p.children),s.flags|=4096);return s}return x?(nt(),x=p.fallback,q=s.mode,ne=i.child,me=ne.sibling,p=vl(ne,{mode:"hidden",children:p.children}),p.subtreeFlags=ne.subtreeFlags&31457280,me!==null?x=vl(me,x):(x=xl(x,q,c,null),x.flags|=2),x.return=s,p.return=s,p.sibling=x,s.child=p,p=x,x=s.child,q=i.child.memoizedState,q===null?q=Pd(c):(ne=q.cachePool,ne!==null?(me=Tt._currentValue,ne=ne.parent!==me?{parent:me,pool:me}:ne):ne=Pi(),q={baseLanes:q.baseLanes|c,cachePool:ne}),x.memoizedState=q,x.childLanes=Ju(i,B,c),s.memoizedState=Wu,p):(la(s),c=i.child,i=c.sibling,c=vl(c,{mode:"visible",children:p.children}),c.return=s,c.sibling=null,i!==null&&(B=s.deletions,B===null?(s.deletions=[i],s.flags|=16):B.push(i)),s.child=c,s.memoizedState=null,c)}function Uh(i,s){return s=ll({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function ll(i,s){return Vf(i,s,0,null)}function Id(i,s,c){return wn(s,i.child,null,c),i=Uh(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function cu(i,s,c){i.lanes|=s;var p=i.alternate;p!==null&&(p.lanes|=s),Gh(i.return,s,c)}function uu(i,s,c,p,x){var S=i.memoizedState;S===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:p,tail:c,tailMode:x}:(S.isBackwards=s,S.rendering=null,S.renderingStartTime=0,S.last=p,S.tail=c,S.tailMode=x)}function eh(i,s,c){var p=s.pendingProps,x=p.revealOrder,S=p.tail;if(Bn(i,s,p.children,c),p=gn.current,(p&2)!==0)p=p&1|2,s.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&cu(i,c,s);else if(i.tag===19)cu(i,c,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}p&=1}switch(vi(gn,p),x){case"forwards":for(c=s.child,x=null;c!==null;)i=c.alternate,i!==null&&Jl(i)===null&&(x=c),c=c.sibling;c=x,c===null?(x=s.child,s.child=null):(x=c.sibling,c.sibling=null),uu(s,!1,x,c,S);break;case"backwards":for(c=null,x=s.child,s.child=null;x!==null;){if(i=x.alternate,i!==null&&Jl(i)===null){s.child=x;break}i=x.sibling,x.sibling=c,c=x,x=i}uu(s,!0,c,null,S);break;case"together":uu(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function $s(i,s,c){if(i!==null&&(s.dependencies=i.dependencies),bl|=s.lanes,(c&s.childLanes)===0)if(i!==null){if(To(i,s,c,!1),(c&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(ee(153));if(s.child!==null){for(i=s.child,c=vl(i,i.pendingProps),s.child=c,c.return=s;i.sibling!==null;)i=i.sibling,c=c.sibling=vl(i,i.pendingProps),c.return=s;c.sibling=null}return s.child}function Vh(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&Rr(i)))}function up(i,s,c){switch(s.tag){case 3:Oa(s,s.stateNode.containerInfo),ul(s,Tt,i.memoizedState.cache),Ka();break;case 27:case 5:Br(s);break;case 4:Oa(s,s.stateNode.containerInfo);break;case 10:ul(s,s.type,s.memoizedProps.value);break;case 13:var p=s.memoizedState;if(p!==null)return p.dehydrated!==null?(la(s),s.flags|=128,null):(c&s.child.childLanes)!==0?Dd(i,s,c):(la(s),i=$s(i,s,c),i!==null?i.sibling:null);la(s);break;case 19:var x=(i.flags&128)!==0;if(p=(c&s.childLanes)!==0,p||(To(i,s,c,!1),p=(c&s.childLanes)!==0),x){if(p)return eh(i,s,c);s.flags|=128}if(x=s.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),vi(gn,gn.current),p)break;return null;case 22:case 23:return s.lanes=0,lu(i,s,c);case 24:ul(s,Tt,i.memoizedState.cache)}return $s(i,s,c)}function Rf(i,s,c){if(i!==null)if(i.memoizedProps!==s.pendingProps)Ln=!0;else{if(!Vh(i,c)&&(s.flags&128)===0)return Ln=!1,up(i,s,c);Ln=(i.flags&131072)!==0}else Ln=!1,It&&(s.flags&1048576)!==0&&Yc(s,Yl,s.index);switch(s.lanes=0,s.tag){case 16:e:{i=s.pendingProps;var p=s.elementType,x=p._init;if(p=x(p._payload),s.type=p,typeof p=="function")lh(p)?(i=Da(p,i),s.tag=1,s=lc(null,s,p,i,c)):(s.tag=0,s=ol(null,s,p,i,c));else{if(p!=null){if(x=p.$$typeof,x===st){s.tag=11,s=Yu(null,s,p,i,c);break e}else if(x===Pn){s.tag=14,s=qs(null,s,p,i,c);break e}}throw s=gi(p)||p,Error(ee(306,s,""))}}return s;case 0:return ol(i,s,s.type,s.pendingProps,c);case 1:return p=s.type,x=Da(p,s.pendingProps),lc(i,s,p,x,c);case 3:e:{if(Oa(s,s.stateNode.containerInfo),i===null)throw Error(ee(387));var S=s.pendingProps;x=s.memoizedState,p=x.element,Ld(i,s),ih(s,S,null,c);var B=s.memoizedState;if(S=B.cache,ul(s,Tt,S),S!==x.cache&&th(s,[Tt],c,!0),Mo(),S=B.element,x.isDehydrated)if(x={element:S,isDehydrated:!1,cache:B.cache},s.updateQueue.baseState=x,s.memoizedState=x,s.flags&256){s=If(i,s,S,c);break e}else if(S!==p){p=Hr(Error(ee(424)),s),Wo(p),s=If(i,s,S,c);break e}else for(pn=es(s.stateNode.containerInfo.firstChild),tr=s,It=!0,ir=null,mn=!0,c=Jc(s,null,S,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(Ka(),S===p){s=$s(i,s,c);break e}Bn(i,s,S,c)}s=s.child}return s;case 26:return Hs(i,s),i===null?(c=vd(s.type,null,s.pendingProps,null))?s.memoizedState=c:It||(c=s.type,i=s.pendingProps,p=vh(sr.current).createElement(c),p[Et]=s,p[ct]=i,ur(p,c,i),$i(p),s.stateNode=p):s.memoizedState=vd(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return Br(s),i===null&&It&&(p=s.stateNode=_d(s.type,s.pendingProps,sr.current),tr=s,mn=!0,pn=es(p.firstChild)),p=s.pendingProps.children,i!==null||It?Bn(i,s,p,c):s.child=wn(s,null,p,c),Hs(i,s),s.child;case 5:return i===null&&It&&((x=p=pn)&&(p=El(p,s.type,s.pendingProps,mn),p!==null?(s.stateNode=p,tr=s,pn=es(p.firstChild),mn=!1,x=!0):x=!1),x||gs(s)),Br(s),x=s.type,S=s.pendingProps,B=i!==null?i.memoizedProps:null,p=S.children,Au(x,S)?p=null:B!==null&&Au(x,B)&&(s.flags|=32),s.memoizedState!==null&&(x=lr(i,s,zd,null,null,c),G._currentValue=x),Hs(i,s),Bn(i,s,p,c),s.child;case 6:return i===null&&It&&((i=c=pn)&&(c=ff(c,s.pendingProps,mn),c!==null?(s.stateNode=c,tr=s,pn=null,i=!0):i=!1),i||gs(s)),null;case 13:return Dd(i,s,c);case 4:return Oa(s,s.stateNode.containerInfo),p=s.pendingProps,i===null?s.child=wn(s,null,p,c):Bn(i,s,p,c),s.child;case 11:return Yu(i,s,s.type,s.pendingProps,c);case 7:return Bn(i,s,s.pendingProps,c),s.child;case 8:return Bn(i,s,s.pendingProps.children,c),s.child;case 12:return Bn(i,s,s.pendingProps.children,c),s.child;case 10:return p=s.pendingProps,ul(s,s.type,p.value),Bn(i,s,p.children,c),s.child;case 9:return x=s.type._context,p=s.pendingProps.children,hl(s),x=cr(x),p=p(x),s.flags|=1,Bn(i,s,p,c),s.child;case 14:return qs(i,s,s.type,s.pendingProps,c);case 15:return Ir(i,s,s.type,s.pendingProps,c);case 19:return eh(i,s,c);case 22:return lu(i,s,c);case 24:return hl(s),p=cr(Tt),i===null?(x=au(),x===null&&(x=Li,S=nl(),x.pooledCache=S,S.refCount++,S!==null&&(x.pooledCacheLanes|=c),x=S),s.memoizedState={parent:p,cache:x},kd(s),ul(s,Tt,x)):((i.lanes&c)!==0&&(Ld(i,s),ih(s,null,null,c),Mo()),x=i.memoizedState,S=s.memoizedState,x.parent!==p?(x={parent:p,cache:p},s.memoizedState=x,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=x),ul(s,Tt,p)):(p=S.cache,ul(s,Tt,p),p!==x.cache&&th(s,[Tt],c,!0))),Bn(i,s,s.pendingProps.children,c),s.child;case 29:throw s.pendingProps}throw Error(ee(156,s.tag))}var Zh=ei(null),cl=null,Xs=null;function ul(i,s,c){vi(Zh,s._currentValue),s._currentValue=c}function ys(i){i._currentValue=Zh.current,ui(Zh)}function Gh(i,s,c){for(;i!==null;){var p=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,p!==null&&(p.childLanes|=s)):p!==null&&(p.childLanes&s)!==s&&(p.childLanes|=s),i===c)break;i=i.return}}function th(i,s,c,p){var x=i.child;for(x!==null&&(x.return=i);x!==null;){var S=x.dependencies;if(S!==null){var B=x.child;S=S.firstContext;e:for(;S!==null;){var q=S;S=x;for(var ne=0;ne<s.length;ne++)if(q.context===s[ne]){S.lanes|=c,q=S.alternate,q!==null&&(q.lanes|=c),Gh(S.return,c,i),p||(B=null);break e}S=q.next}}else if(x.tag===18){if(B=x.return,B===null)throw Error(ee(341));B.lanes|=c,S=B.alternate,S!==null&&(S.lanes|=c),Gh(B,c,i),B=null}else B=x.child;if(B!==null)B.return=x;else for(B=x;B!==null;){if(B===i){B=null;break}if(x=B.sibling,x!==null){x.return=B.return,B=x;break}B=B.return}x=B}}function To(i,s,c,p){i=null;for(var x=s,S=!1;x!==null;){if(!S){if((x.flags&524288)!==0)S=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var B=x.alternate;if(B===null)throw Error(ee(387));if(B=B.memoizedProps,B!==null){var q=x.type;Gr(x.pendingProps.value,B.value)||(i!==null?i.push(q):i=[q])}}else if(x===Fi.current){if(B=x.alternate,B===null)throw Error(ee(387));B.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(i!==null?i.push(G):i=[G])}x=x.return}i!==null&&th(s,i,c,p),s.flags|=262144}function Rr(i){for(i=i.firstContext;i!==null;){if(!Gr(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function hl(i){cl=i,Xs=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function cr(i){return Rd(cl,i)}function qh(i,s){return cl===null&&hl(i),Rd(i,s)}function Rd(i,s){var c=s._currentValue;if(s={context:s,memoizedValue:c,next:null},Xs===null){if(i===null)throw Error(ee(308));Xs=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else Xs=Xs.next=s;return c}var dl=!1;function kd(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ld(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function fl(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Ys(i,s,c){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(on&2)!==0){var x=p.pending;return x===null?s.next=s:(s.next=x.next,x.next=s),p.pending=s,s=Xa(i),Xl(i,null,c),s}return $l(i,p,s,c),Xa(i)}function cc(i,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194176)!==0)){var p=s.lanes;p&=i.pendingLanes,c|=p,s.lanes=c,je(i,c)}}function Hh(i,s){var c=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,c===p)){var x=null,S=null;if(c=c.firstBaseUpdate,c!==null){do{var B={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};S===null?x=S=B:S=S.next=B,c=c.next}while(c!==null);S===null?x=S=s:S=S.next=s}else x=S=s;c={baseState:p.baseState,firstBaseUpdate:x,lastBaseUpdate:S,shared:p.shared,callbacks:p.callbacks},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=s:i.next=s,c.lastBaseUpdate=s}var So=!1;function Mo(){if(So){var i=Fs;if(i!==null)throw i}}function ih(i,s,c,p){So=!1;var x=i.updateQueue;dl=!1;var S=x.firstBaseUpdate,B=x.lastBaseUpdate,q=x.shared.pending;if(q!==null){x.shared.pending=null;var ne=q,me=ne.next;ne.next=null,B===null?S=me:B.next=me,B=ne;var Ze=i.alternate;Ze!==null&&(Ze=Ze.updateQueue,q=Ze.lastBaseUpdate,q!==B&&(q===null?Ze.firstBaseUpdate=me:q.next=me,Ze.lastBaseUpdate=ne))}if(S!==null){var Qe=x.baseState;B=0,Ze=me=ne=null,q=S;do{var Pe=q.lane&-536870913,Ue=Pe!==q.lane;if(Ue?(ri&Pe)===Pe:(p&Pe)===Pe){Pe!==0&&Pe===js&&(So=!0),Ze!==null&&(Ze=Ze.next={lane:0,tag:q.tag,payload:q.payload,callback:null,next:null});e:{var Ct=i,qt=q;Pe=s;var An=c;switch(qt.tag){case 1:if(Ct=qt.payload,typeof Ct=="function"){Qe=Ct.call(An,Qe,Pe);break e}Qe=Ct;break e;case 3:Ct.flags=Ct.flags&-65537|128;case 0:if(Ct=qt.payload,Pe=typeof Ct=="function"?Ct.call(An,Qe,Pe):Ct,Pe==null)break e;Qe=ai({},Qe,Pe);break e;case 2:dl=!0}}Pe=q.callback,Pe!==null&&(i.flags|=64,Ue&&(i.flags|=8192),Ue=x.callbacks,Ue===null?x.callbacks=[Pe]:Ue.push(Pe))}else Ue={lane:Pe,tag:q.tag,payload:q.payload,callback:q.callback,next:null},Ze===null?(me=Ze=Ue,ne=Qe):Ze=Ze.next=Ue,B|=Pe;if(q=q.next,q===null){if(q=x.shared.pending,q===null)break;Ue=q,q=Ue.next,Ue.next=null,x.lastBaseUpdate=Ue,x.shared.pending=null}}while(!0);Ze===null&&(ne=Qe),x.baseState=ne,x.firstBaseUpdate=me,x.lastBaseUpdate=Ze,S===null&&(x.shared.lanes=0),bl|=B,i.lanes=B,i.memoizedState=Qe}}function kf(i,s){if(typeof i!="function")throw Error(ee(191,i));i.call(s)}function Lf(i,s){var c=i.callbacks;if(c!==null)for(i.callbacks=null,i=0;i<c.length;i++)kf(c[i],s)}function nh(i,s){try{var c=s.updateQueue,p=c!==null?c.lastEffect:null;if(p!==null){var x=p.next;c=x;do{if((c.tag&i)===i){p=void 0;var S=c.create,B=c.inst;p=S(),B.destroy=p}c=c.next}while(c!==x)}}catch(q){Bi(s,s.return,q)}}function pl(i,s,c){try{var p=s.updateQueue,x=p!==null?p.lastEffect:null;if(x!==null){var S=x.next;p=S;do{if((p.tag&i)===i){var B=p.inst,q=B.destroy;if(q!==void 0){B.destroy=void 0,x=s;var ne=c;try{q()}catch(me){Bi(x,ne,me)}}}p=p.next}while(p!==S)}}catch(me){Bi(s,s.return,me)}}function Bf(i){var s=i.updateQueue;if(s!==null){var c=i.stateNode;try{Lf(s,c)}catch(p){Bi(i,i.return,p)}}}function Of(i,s,c){c.props=Da(i.type,i.memoizedProps),c.state=i.memoizedState;try{c.componentWillUnmount()}catch(p){Bi(i,s,p)}}function Eo(i,s){try{var c=i.ref;if(c!==null){var p=i.stateNode;switch(i.tag){case 26:case 27:case 5:var x=p;break;default:x=p}typeof c=="function"?i.refCleanup=c(x):c.current=x}}catch(S){Bi(i,s,S)}}function Ra(i,s){var c=i.ref,p=i.refCleanup;if(c!==null)if(typeof p=="function")try{p()}catch(x){Bi(i,s,x)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(x){Bi(i,s,x)}else c.current=null}function Bd(i){var s=i.type,c=i.memoizedProps,p=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":c.autoFocus&&p.focus();break e;case"img":c.src?p.src=c.src:c.srcSet&&(p.srcset=c.srcSet)}}catch(x){Bi(i,i.return,x)}}function hu(i,s,c){try{var p=i.stateNode;ip(p,i.type,c,s),p[ct]=s}catch(x){Bi(i,i.return,x)}}function jf(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27||i.tag===4}function Yi(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||jf(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==27&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function ml(i,s,c){var p=i.tag;if(p===5||p===6)i=i.stateNode,s?c.nodeType===8?c.parentNode.insertBefore(i,s):c.insertBefore(i,s):(c.nodeType===8?(s=c.parentNode,s.insertBefore(i,c)):(s=c,s.appendChild(i)),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=bs));else if(p!==4&&p!==27&&(i=i.child,i!==null))for(ml(i,s,c),i=i.sibling;i!==null;)ml(i,s,c),i=i.sibling}function rh(i,s,c){var p=i.tag;if(p===5||p===6)i=i.stateNode,s?c.insertBefore(i,s):c.appendChild(i);else if(p!==4&&p!==27&&(i=i.child,i!==null))for(rh(i,s,c),i=i.sibling;i!==null;)rh(i,s,c),i=i.sibling}var Wa=!1,Ki=!1,uc=!1,Od=typeof WeakSet=="function"?WeakSet:Set,nr=null,du=!1;function jd(i,s){if(i=i.containerInfo,uf=Ye,i=Uu(i),$o(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var p=c.getSelection&&c.getSelection();if(p&&p.rangeCount!==0){c=p.anchorNode;var x=p.anchorOffset,S=p.focusNode;p=p.focusOffset;try{c.nodeType,S.nodeType}catch{c=null;break e}var B=0,q=-1,ne=-1,me=0,Ze=0,Qe=i,Pe=null;t:for(;;){for(var Ue;Qe!==c||x!==0&&Qe.nodeType!==3||(q=B+x),Qe!==S||p!==0&&Qe.nodeType!==3||(ne=B+p),Qe.nodeType===3&&(B+=Qe.nodeValue.length),(Ue=Qe.firstChild)!==null;)Pe=Qe,Qe=Ue;for(;;){if(Qe===i)break t;if(Pe===c&&++me===x&&(q=B),Pe===S&&++Ze===p&&(ne=B),(Ue=Qe.nextSibling)!==null)break;Qe=Pe,Pe=Qe.parentNode}Qe=Ue}c=q===-1||ne===-1?null:{start:q,end:ne}}else c=null}c=c||{start:0,end:0}}else c=null;for(hf={focusedElem:i,selectionRange:c},Ye=!1,nr=s;nr!==null;)if(s=nr,i=s.child,(s.subtreeFlags&1028)!==0&&i!==null)i.return=s,nr=i;else for(;nr!==null;){switch(s=nr,S=s.alternate,i=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&S!==null){i=void 0,c=s,x=S.memoizedProps,S=S.memoizedState,p=c.stateNode;try{var Ct=Da(c.type,x,c.elementType===c.type);i=p.getSnapshotBeforeUpdate(Ct,S),p.__reactInternalSnapshotBeforeUpdate=i}catch(qt){Bi(c,c.return,qt)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,c=i.nodeType,c===9)Gn(i);else if(c===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Gn(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(ee(163))}if(i=s.sibling,i!==null){i.return=s.return,nr=i;break}nr=s.return}return Ct=du,du=!1,Ct}function hc(i,s,c){var p=c.flags;switch(c.tag){case 0:case 11:case 15:Ao(i,c),p&4&&nh(5,c);break;case 1:if(Ao(i,c),p&4)if(i=c.stateNode,s===null)try{i.componentDidMount()}catch(q){Bi(c,c.return,q)}else{var x=Da(c.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(x,s,i.__reactInternalSnapshotBeforeUpdate)}catch(q){Bi(c,c.return,q)}}p&64&&Bf(c),p&512&&Eo(c,c.return);break;case 3:if(Ao(i,c),p&64&&(p=c.updateQueue,p!==null)){if(i=null,c.child!==null)switch(c.child.tag){case 27:case 5:i=c.child.stateNode;break;case 1:i=c.child.stateNode}try{Lf(p,i)}catch(q){Bi(c,c.return,q)}}break;case 26:Ao(i,c),p&512&&Eo(c,c.return);break;case 27:case 5:Ao(i,c),s===null&&p&4&&Bd(c),p&512&&Eo(c,c.return);break;case 12:Ao(i,c);break;case 13:Ao(i,c),p&4&&gl(i,c);break;case 22:if(x=c.memoizedState!==null||Wa,!x){s=s!==null&&s.memoizedState!==null||Ki;var S=Wa,B=Ki;Wa=x,(Ki=s)&&!B?_l(i,c,(c.subtreeFlags&8772)!==0):Ao(i,c),Wa=S,Ki=B}p&512&&(c.memoizedProps.mode==="manual"?Eo(c,c.return):Ra(c,c.return));break;default:Ao(i,c)}}function ah(i){var s=i.alternate;s!==null&&(i.alternate=null,ah(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&hi(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Qi=null,Tr=!1;function Co(i,s,c){for(c=c.child;c!==null;)Fd(i,s,c),c=c.sibling}function Fd(i,s,c){if(dn&&typeof dn.onCommitFiberUnmount=="function")try{dn.onCommitFiberUnmount(ns,c)}catch{}switch(c.tag){case 26:Ki||Ra(c,s),Co(i,s,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Ki||Ra(c,s);var p=Qi,x=Tr;for(Qi=c.stateNode,Co(i,s,c),c=c.stateNode,s=c.attributes;s.length;)c.removeAttributeNode(s[0]);hi(c),Qi=p,Tr=x;break;case 5:Ki||Ra(c,s);case 6:x=Qi;var S=Tr;if(Qi=null,Co(i,s,c),Qi=x,Tr=S,Qi!==null)if(Tr)try{i=Qi,p=c.stateNode,i.nodeType===8?i.parentNode.removeChild(p):i.removeChild(p)}catch(B){Bi(c,s,B)}else try{Qi.removeChild(c.stateNode)}catch(B){Bi(c,s,B)}break;case 18:Qi!==null&&(Tr?(s=Qi,c=c.stateNode,s.nodeType===8?Ml(s.parentNode,c):s.nodeType===1&&Ml(s,c),Wr(s)):Ml(Qi,c.stateNode));break;case 4:p=Qi,x=Tr,Qi=c.stateNode.containerInfo,Tr=!0,Co(i,s,c),Qi=p,Tr=x;break;case 0:case 11:case 14:case 15:Ki||pl(2,c,s),Ki||pl(4,c,s),Co(i,s,c);break;case 1:Ki||(Ra(c,s),p=c.stateNode,typeof p.componentWillUnmount=="function"&&Of(c,s,p)),Co(i,s,c);break;case 21:Co(i,s,c);break;case 22:Ki||Ra(c,s),Ki=(p=Ki)||c.memoizedState!==null,Co(i,s,c),Ki=p;break;default:Co(i,s,c)}}function gl(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Wr(i)}catch(c){Bi(s,s.return,c)}}function hp(i){switch(i.tag){case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new Od),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new Od),s;default:throw Error(ee(435,i.tag))}}function $h(i,s){var c=hp(i);s.forEach(function(p){var x=tf.bind(null,i,p);c.has(p)||(c.add(p),p.then(x,x))})}function kr(i,s){var c=s.deletions;if(c!==null)for(var p=0;p<c.length;p++){var x=c[p],S=i,B=s,q=B;e:for(;q!==null;){switch(q.tag){case 27:case 5:Qi=q.stateNode,Tr=!1;break e;case 3:Qi=q.stateNode.containerInfo,Tr=!0;break e;case 4:Qi=q.stateNode.containerInfo,Tr=!0;break e}q=q.return}if(Qi===null)throw Error(ee(160));Fd(S,B,x),Qi=null,Tr=!1,S=x.alternate,S!==null&&(S.return=null),x.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)Nd(s,i),s=s.sibling}var ka=null;function Nd(i,s){var c=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:kr(s,i),La(i),p&4&&(pl(3,i,i.return),nh(3,i),pl(5,i,i.return));break;case 1:kr(s,i),La(i),p&512&&(Ki||c===null||Ra(c,c.return)),p&64&&Wa&&(i=i.updateQueue,i!==null&&(p=i.callbacks,p!==null&&(c=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=c===null?p:c.concat(p))));break;case 26:var x=ka;if(kr(s,i),La(i),p&512&&(Ki||c===null||Ra(c,c.return)),p&4){var S=c!==null?c.memoizedState:null;if(p=i.memoizedState,c===null)if(p===null)if(i.stateNode===null){e:{p=i.type,c=i.memoizedProps,x=x.ownerDocument||x;t:switch(p){case"title":S=x.getElementsByTagName("title")[0],(!S||S[Nn]||S[Et]||S.namespaceURI==="http://www.w3.org/2000/svg"||S.hasAttribute("itemprop"))&&(S=x.createElement(p),x.head.insertBefore(S,x.querySelector("head > title"))),ur(S,p,c),S[Et]=i,$i(S),p=S;break e;case"link":var B=M("link","href",x).get(p+(c.href||""));if(B){for(var q=0;q<B.length;q++)if(S=B[q],S.getAttribute("href")===(c.href==null?null:c.href)&&S.getAttribute("rel")===(c.rel==null?null:c.rel)&&S.getAttribute("title")===(c.title==null?null:c.title)&&S.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){B.splice(q,1);break t}}S=x.createElement(p),ur(S,p,c),x.head.appendChild(S);break;case"meta":if(B=M("meta","content",x).get(p+(c.content||""))){for(q=0;q<B.length;q++)if(S=B[q],S.getAttribute("content")===(c.content==null?null:""+c.content)&&S.getAttribute("name")===(c.name==null?null:c.name)&&S.getAttribute("property")===(c.property==null?null:c.property)&&S.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&S.getAttribute("charset")===(c.charSet==null?null:c.charSet)){B.splice(q,1);break t}}S=x.createElement(p),ur(S,p,c),x.head.appendChild(S);break;default:throw Error(ee(468,p))}S[Et]=i,$i(S),p=S}i.stateNode=p}else C(x,i.type,i.stateNode);else i.stateNode=h(x,p,i.memoizedProps);else S!==p?(S===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):S.count--,p===null?C(x,i.type,i.stateNode):h(x,p,i.memoizedProps)):p===null&&i.stateNode!==null&&hu(i,i.memoizedProps,c.memoizedProps)}break;case 27:if(p&4&&i.alternate===null){x=i.stateNode,S=i.memoizedProps;try{for(var ne=x.firstChild;ne;){var me=ne.nextSibling,Ze=ne.nodeName;ne[Nn]||Ze==="HEAD"||Ze==="BODY"||Ze==="SCRIPT"||Ze==="STYLE"||Ze==="LINK"&&ne.rel.toLowerCase()==="stylesheet"||x.removeChild(ne),ne=me}for(var Qe=i.type,Pe=x.attributes;Pe.length;)x.removeAttributeNode(Pe[0]);ur(x,Qe,S),x[Et]=i,x[ct]=S}catch(Ct){Bi(i,i.return,Ct)}}case 5:if(kr(s,i),La(i),p&512&&(Ki||c===null||Ra(c,c.return)),i.flags&32){x=i.stateNode;try{rn(x,"")}catch(Ct){Bi(i,i.return,Ct)}}p&4&&i.stateNode!=null&&(x=i.memoizedProps,hu(i,x,c!==null?c.memoizedProps:x)),p&1024&&(uc=!0);break;case 6:if(kr(s,i),La(i),p&4){if(i.stateNode===null)throw Error(ee(162));p=i.memoizedProps,c=i.stateNode;try{c.nodeValue=p}catch(Ct){Bi(i,i.return,Ct)}}break;case 3:if(w=null,x=ka,ka=bh(s.containerInfo),kr(s,i),ka=x,La(i),p&4&&c!==null&&c.memoizedState.isDehydrated)try{Wr(s.containerInfo)}catch(Ct){Bi(i,i.return,Ct)}uc&&(uc=!1,Ff(i));break;case 4:p=ka,ka=bh(i.stateNode.containerInfo),kr(s,i),La(i),ka=p;break;case 12:kr(s,i),La(i);break;case 13:kr(s,i),La(i),i.child.flags&8192&&i.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Qh=or()),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,$h(i,p)));break;case 22:if(p&512&&(Ki||c===null||Ra(c,c.return)),ne=i.memoizedState!==null,me=c!==null&&c.memoizedState!==null,Ze=Wa,Qe=Ki,Wa=Ze||ne,Ki=Qe||me,kr(s,i),Ki=Qe,Wa=Ze,La(i),s=i.stateNode,s._current=i,s._visibility&=-3,s._visibility|=s._pendingVisibility&2,p&8192&&(s._visibility=ne?s._visibility&-2:s._visibility|1,ne&&(s=Wa||Ki,c===null||me||s||fu(i)),i.memoizedProps===null||i.memoizedProps.mode!=="manual"))e:for(c=null,s=i;;){if(s.tag===5||s.tag===26||s.tag===27){if(c===null){me=c=s;try{if(x=me.stateNode,ne)S=x.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{B=me.stateNode,q=me.memoizedProps.style;var Ue=q!=null&&q.hasOwnProperty("display")?q.display:null;B.style.display=Ue==null||typeof Ue=="boolean"?"":(""+Ue).trim()}}catch(Ct){Bi(me,me.return,Ct)}}}else if(s.tag===6){if(c===null){me=s;try{me.stateNode.nodeValue=ne?"":me.memoizedProps}catch(Ct){Bi(me,me.return,Ct)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}p&4&&(p=i.updateQueue,p!==null&&(c=p.retryQueue,c!==null&&(p.retryQueue=null,$h(i,c))));break;case 19:kr(s,i),La(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,$h(i,p)));break;case 21:break;default:kr(s,i),La(i)}}function La(i){var s=i.flags;if(s&2){try{if(i.tag!==27){e:{for(var c=i.return;c!==null;){if(jf(c)){var p=c;break e}c=c.return}throw Error(ee(160))}switch(p.tag){case 27:var x=p.stateNode,S=Yi(i);rh(i,S,x);break;case 5:var B=p.stateNode;p.flags&32&&(rn(B,""),p.flags&=-33);var q=Yi(i);rh(i,q,B);break;case 3:case 4:var ne=p.stateNode.containerInfo,me=Yi(i);ml(i,me,ne);break;default:throw Error(ee(161))}}}catch(Ze){Bi(i,i.return,Ze)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function Ff(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;Ff(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function Ao(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)hc(i,s.alternate,s),s=s.sibling}function fu(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:pl(4,s,s.return),fu(s);break;case 1:Ra(s,s.return);var c=s.stateNode;typeof c.componentWillUnmount=="function"&&Of(s,s.return,c),fu(s);break;case 26:case 27:case 5:Ra(s,s.return),fu(s);break;case 22:Ra(s,s.return),s.memoizedState===null&&fu(s);break;default:fu(s)}i=i.sibling}}function _l(i,s,c){for(c=c&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var p=s.alternate,x=i,S=s,B=S.flags;switch(S.tag){case 0:case 11:case 15:_l(x,S,c),nh(4,S);break;case 1:if(_l(x,S,c),p=S,x=p.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(me){Bi(p,p.return,me)}if(p=S,x=p.updateQueue,x!==null){var q=p.stateNode;try{var ne=x.shared.hiddenCallbacks;if(ne!==null)for(x.shared.hiddenCallbacks=null,x=0;x<ne.length;x++)kf(ne[x],q)}catch(me){Bi(p,p.return,me)}}c&&B&64&&Bf(S),Eo(S,S.return);break;case 26:case 27:case 5:_l(x,S,c),c&&p===null&&B&4&&Bd(S),Eo(S,S.return);break;case 12:_l(x,S,c);break;case 13:_l(x,S,c),c&&B&4&&gl(x,S);break;case 22:S.memoizedState===null&&_l(x,S,c),Eo(S,S.return);break;default:_l(x,S,c)}s=s.sibling}}function Ud(i,s){var c=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==c&&(i!=null&&i.refCount++,c!=null&&rl(c))}function sh(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&rl(i))}function zo(i,s,c,p){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Xh(i,s,c,p),s=s.sibling}function Xh(i,s,c,p){var x=s.flags;switch(s.tag){case 0:case 11:case 15:zo(i,s,c,p),x&2048&&nh(9,s);break;case 3:zo(i,s,c,p),x&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&rl(i)));break;case 12:if(x&2048){zo(i,s,c,p),i=s.stateNode;try{var S=s.memoizedProps,B=S.id,q=S.onPostCommit;typeof q=="function"&&q(B,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(ne){Bi(s,s.return,ne)}}else zo(i,s,c,p);break;case 23:break;case 22:S=s.stateNode,s.memoizedState!==null?S._visibility&4?zo(i,s,c,p):fc(i,s):S._visibility&4?zo(i,s,c,p):(S._visibility|=4,dc(i,s,c,p,(s.subtreeFlags&10256)!==0)),x&2048&&Ud(s.alternate,s);break;case 24:zo(i,s,c,p),x&2048&&sh(s.alternate,s);break;default:zo(i,s,c,p)}}function dc(i,s,c,p,x){for(x=x&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var S=i,B=s,q=c,ne=p,me=B.flags;switch(B.tag){case 0:case 11:case 15:dc(S,B,q,ne,x),nh(8,B);break;case 23:break;case 22:var Ze=B.stateNode;B.memoizedState!==null?Ze._visibility&4?dc(S,B,q,ne,x):fc(S,B):(Ze._visibility|=4,dc(S,B,q,ne,x)),x&&me&2048&&Ud(B.alternate,B);break;case 24:dc(S,B,q,ne,x),x&&me&2048&&sh(B.alternate,B);break;default:dc(S,B,q,ne,x)}s=s.sibling}}function fc(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var c=i,p=s,x=p.flags;switch(p.tag){case 22:fc(c,p),x&2048&&Ud(p.alternate,p);break;case 24:fc(c,p),x&2048&&sh(p.alternate,p);break;default:fc(c,p)}s=s.sibling}}var pu=8192;function pc(i){if(i.subtreeFlags&pu)for(i=i.child;i!==null;)oh(i),i=i.sibling}function oh(i){switch(i.tag){case 26:pc(i),i.flags&pu&&i.memoizedState!==null&&U(ka,i.memoizedState,i.memoizedProps);break;case 5:pc(i);break;case 3:case 4:var s=ka;ka=bh(i.stateNode.containerInfo),pc(i),ka=s;break;case 22:i.memoizedState===null&&(s=i.alternate,s!==null&&s.memoizedState!==null?(s=pu,pu=16777216,pc(i),pu=s):pc(i));break;default:pc(i)}}function Vd(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function mu(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var p=s[c];nr=p,Nf(p,i)}Vd(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Zd(i),i=i.sibling}function Zd(i){switch(i.tag){case 0:case 11:case 15:mu(i),i.flags&2048&&pl(9,i,i.return);break;case 3:mu(i);break;case 12:mu(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&4&&(i.return===null||i.return.tag!==13)?(s._visibility&=-5,yl(i)):mu(i);break;default:mu(i)}}function yl(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var p=s[c];nr=p,Nf(p,i)}Vd(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:pl(8,s,s.return),yl(s);break;case 22:c=s.stateNode,c._visibility&4&&(c._visibility&=-5,yl(s));break;default:yl(s)}i=i.sibling}}function Nf(i,s){for(;nr!==null;){var c=nr;switch(c.tag){case 0:case 11:case 15:pl(8,c,s);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var p=c.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:rl(c.memoizedState.cache)}if(p=c.child,p!==null)p.return=c,nr=p;else e:for(c=i;nr!==null;){p=nr;var x=p.sibling,S=p.return;if(ah(p),p===c){nr=null;break e}if(x!==null){x.return=S,nr=x;break e}nr=S}}}function Gd(i,s,c,p){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Lr(i,s,c,p){return new Gd(i,s,c,p)}function lh(i){return i=i.prototype,!(!i||!i.isReactComponent)}function vl(i,s){var c=i.alternate;return c===null?(c=Lr(i.tag,s,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=s,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&31457280,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,s=i.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c.refCleanup=i.refCleanup,c}function Uf(i,s){i.flags&=31457282;var c=i.alternate;return c===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,s=c.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function ch(i,s,c,p,x,S){var B=0;if(p=i,typeof i=="function")lh(i)&&(B=1);else if(typeof i=="string")B=A(i,c,Di.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case it:return xl(c.children,x,S,s);case Ne:B=8,x|=24;break;case Mt:return i=Lr(12,c,s,x|2),i.elementType=Mt,i.lanes=S,i;case yi:return i=Lr(13,c,s,x),i.elementType=yi,i.lanes=S,i;case Ai:return i=Lr(19,c,s,x),i.elementType=Ai,i.lanes=S,i;case pr:return Vf(c,x,S,s);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case Bt:case _e:B=10;break e;case at:B=9;break e;case st:B=11;break e;case Pn:B=14;break e;case cn:B=16,p=null;break e}B=29,c=Error(ee(130,i===null?"null":typeof i,"")),p=null}return s=Lr(B,c,s,x),s.elementType=i,s.type=p,s.lanes=S,s}function xl(i,s,c,p){return i=Lr(7,i,p,s),i.lanes=c,i}function Vf(i,s,c,p){i=Lr(22,i,p,s),i.elementType=pr,i.lanes=c;var x={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var S=x._current;if(S===null)throw Error(ee(456));if((x._pendingVisibility&2)===0){var B=$a(S,2);B!==null&&(x._pendingVisibility|=2,rr(B,S,2))}},attach:function(){var S=x._current;if(S===null)throw Error(ee(456));if((x._pendingVisibility&2)!==0){var B=$a(S,2);B!==null&&(x._pendingVisibility&=-3,rr(B,S,2))}}};return i.stateNode=x,i}function qd(i,s,c){return i=Lr(6,i,null,s),i.lanes=c,i}function mc(i,s,c){return s=Lr(4,i.children!==null?i.children:[],i.key,s),s.lanes=c,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}function Ks(i){i.flags|=4}function Zf(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!R(s)){if(s=oa.current,s!==null&&((ri&4194176)===ri?Xr!==null:(ri&62914560)!==ri&&(ri&536870912)===0||s!==Xr))throw Jo=Qc,Kc;i.flags|=8192}}function Yh(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?xe():536870912,i.lanes|=s,gc|=s)}function uh(i,s){if(!It)switch(i.tailMode){case"hidden":s=i.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var p=null;c!==null;)c.alternate!==null&&(p=c),c=c.sibling;p===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function _n(i){var s=i.alternate!==null&&i.alternate.child===i.child,c=0,p=0;if(s)for(var x=i.child;x!==null;)c|=x.lanes|x.childLanes,p|=x.subtreeFlags&31457280,p|=x.flags&31457280,x.return=i,x=x.sibling;else for(x=i.child;x!==null;)c|=x.lanes|x.childLanes,p|=x.subtreeFlags,p|=x.flags,x.return=i,x=x.sibling;return i.subtreeFlags|=p,i.childLanes=c,s}function dp(i,s,c){var p=s.pendingProps;switch(uo(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _n(s),null;case 1:return _n(s),null;case 3:return c=s.stateNode,p=null,i!==null&&(p=i.memoizedState.cache),s.memoizedState.cache!==p&&(s.flags|=2048),ys(Tt),ea(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(i===null||i.child===null)&&(Ya(s)?Ks(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,ir!==null&&(vu(ir),ir=null))),_n(s),null;case 26:return c=s.memoizedState,i===null?(Ks(s),c!==null?(_n(s),Zf(s,c)):(_n(s),s.flags&=-16777217)):c?c!==i.memoizedState?(Ks(s),_n(s),Zf(s,c)):(_n(s),s.flags&=-16777217):(i.memoizedProps!==p&&Ks(s),_n(s),s.flags&=-16777217),null;case 27:va(s),c=sr.current;var x=s.type;if(i!==null&&s.stateNode!=null)i.memoizedProps!==p&&Ks(s);else{if(!p){if(s.stateNode===null)throw Error(ee(166));return _n(s),null}i=Di.current,Ya(s)?qu(s):(i=_d(x,p,c),s.stateNode=i,Ks(s))}return _n(s),null;case 5:if(va(s),c=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==p&&Ks(s);else{if(!p){if(s.stateNode===null)throw Error(ee(166));return _n(s),null}if(i=Di.current,Ya(s))qu(s);else{switch(x=vh(sr.current),i){case 1:i=x.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:i=x.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":i=x.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":i=x.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":i=x.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof p.is=="string"?x.createElement("select",{is:p.is}):x.createElement("select"),p.multiple?i.multiple=!0:p.size&&(i.size=p.size);break;default:i=typeof p.is=="string"?x.createElement(c,{is:p.is}):x.createElement(c)}}i[Et]=s,i[ct]=p;e:for(x=s.child;x!==null;){if(x.tag===5||x.tag===6)i.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===s)break e;for(;x.sibling===null;){if(x.return===null||x.return===s)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}s.stateNode=i;e:switch(ur(i,c,p),c){case"button":case"input":case"select":case"textarea":i=!!p.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Ks(s)}}return _n(s),s.flags&=-16777217,null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==p&&Ks(s);else{if(typeof p!="string"&&s.stateNode===null)throw Error(ee(166));if(i=sr.current,Ya(s)){if(i=s.stateNode,c=s.memoizedProps,p=null,x=tr,x!==null)switch(x.tag){case 27:case 5:p=x.memoizedProps}i[Et]=s,i=!!(i.nodeValue===c||p!==null&&p.suppressHydrationWarning===!0||cf(i.nodeValue,c)),i||gs(s)}else i=vh(i).createTextNode(p),i[Et]=s,s.stateNode=i}return _n(s),null;case 13:if(p=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(x=Ya(s),p!==null&&p.dehydrated!==null){if(i===null){if(!x)throw Error(ee(318));if(x=s.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(ee(317));x[Et]=s}else Ka(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;_n(s),x=!1}else ir!==null&&(vu(ir),ir=null),x=!0;if(!x)return s.flags&256?(Pr(s),s):(Pr(s),null)}if(Pr(s),(s.flags&128)!==0)return s.lanes=c,s;if(c=p!==null,i=i!==null&&i.memoizedState!==null,c){p=s.child,x=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(x=p.alternate.memoizedState.cachePool.pool);var S=null;p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(S=p.memoizedState.cachePool.pool),S!==x&&(p.flags|=2048)}return c!==i&&c&&(s.child.flags|=8192),Yh(s,s.updateQueue),_n(s),null;case 4:return ea(),i===null&&dd(s.stateNode.containerInfo),_n(s),null;case 10:return ys(s.type),_n(s),null;case 19:if(ui(gn),x=s.memoizedState,x===null)return _n(s),null;if(p=(s.flags&128)!==0,S=x.rendering,S===null)if(p)uh(x,!1);else{if(Mn!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(S=Jl(i),S!==null){for(s.flags|=128,uh(x,!1),i=S.updateQueue,s.updateQueue=i,Yh(s,i),s.subtreeFlags=0,i=c,c=s.child;c!==null;)Uf(c,i),c=c.sibling;return vi(gn,gn.current&1|2),s.child}i=i.sibling}x.tail!==null&&or()>_u&&(s.flags|=128,p=!0,uh(x,!1),s.lanes=4194304)}else{if(!p)if(i=Jl(S),i!==null){if(s.flags|=128,p=!0,i=i.updateQueue,s.updateQueue=i,Yh(s,i),uh(x,!0),x.tail===null&&x.tailMode==="hidden"&&!S.alternate&&!It)return _n(s),null}else 2*or()-x.renderingStartTime>_u&&c!==536870912&&(s.flags|=128,p=!0,uh(x,!1),s.lanes=4194304);x.isBackwards?(S.sibling=s.child,s.child=S):(i=x.last,i!==null?i.sibling=S:s.child=S,x.last=S)}return x.tail!==null?(s=x.tail,x.rendering=s,x.tail=s.sibling,x.renderingStartTime=or(),s.sibling=null,i=gn.current,vi(gn,p?i&1|2:i&1),s):(_n(s),null);case 22:case 23:return Pr(s),Wl(),p=s.memoizedState!==null,i!==null?i.memoizedState!==null!==p&&(s.flags|=8192):p&&(s.flags|=8192),p?(c&536870912)!==0&&(s.flags&128)===0&&(_n(s),s.subtreeFlags&6&&(s.flags|=8192)):_n(s),c=s.updateQueue,c!==null&&Yh(s,c.retryQueue),c=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),p=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),p!==c&&(s.flags|=2048),i!==null&&ui(Ns),null;case 24:return c=null,i!==null&&(c=i.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),ys(Tt),_n(s),null;case 25:return null}throw Error(ee(156,s.tag))}function fp(i,s){switch(uo(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return ys(Tt),ea(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return va(s),null;case 13:if(Pr(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(ee(340));Ka()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return ui(gn),null;case 4:return ea(),null;case 10:return ys(s.type),null;case 22:case 23:return Pr(s),Wl(),i!==null&&ui(Ns),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return ys(Tt),null;case 25:return null;default:return null}}function Hd(i,s){switch(uo(s),s.tag){case 3:ys(Tt),ea();break;case 26:case 27:case 5:va(s);break;case 4:ea();break;case 13:Pr(s);break;case 19:ui(gn);break;case 10:ys(s.type);break;case 22:case 23:Pr(s),Wl(),i!==null&&ui(Ns);break;case 24:ys(Tt)}}var $d={getCacheForType:function(i){var s=cr(Tt),c=s.data.get(i);return c===void 0&&(c=i(),s.data.set(i,c)),c}},Gf=typeof WeakMap=="function"?WeakMap:Map,on=0,Li=null,ni=null,ri=0,Gi=0,pa=null,Po=!1,gu=!1,Xd=!1,Qs=0,Mn=0,bl=0,vs=0,Kh=0,ma=0,gc=0,Wi=null,Ja=null,Yd=!1,Qh=0,_u=1/0,yu=null,wl=null,Wh=!1,_c=null,hh=0,Jh=0,Sr=null,yc=0,ed=null;function Zn(){if((on&2)!==0&&ri!==0)return ri&-ri;if(Dt.T!==null){var i=js;return i!==0?i:af()}return lt()}function dh(){ma===0&&(ma=(ri&536870912)===0||It?Ve():536870912);var i=oa.current;return i!==null&&(i.flags|=32),ma}function rr(i,s,c){(i===Li&&Gi===2||i.cancelPendingCommit!==null)&&(xu(i,0),Do(i,ri,ma,!1)),pt(i,c),((on&2)===0||i!==Li)&&(i===Li&&((on&2)===0&&(vs|=c),Mn===4&&Do(i,ri,ma,!1)),xs(i))}function vc(i,s,c){if((on&6)!==0)throw Error(ee(327));var p=!c&&(s&60)===0&&(s&i.expiredLanes)===0||ze(i,s),x=p?mp(i,s):Wd(i,s,!0),S=p;do{if(x===0){gu&&!p&&Do(i,s,0,!1);break}else if(x===6)Do(i,s,0,!Po);else{if(c=i.current.alternate,S&&!pp(c)){x=Wd(i,s,!1),S=!1;continue}if(x===2){if(S=s,i.errorRecoveryDisabledLanes&S)var B=0;else B=i.pendingLanes&-536870913,B=B!==0?B:B&536870912?536870912:0;if(B!==0){s=B;e:{var q=i;x=Wi;var ne=q.current.memoizedState.isDehydrated;if(ne&&(xu(q,B).flags|=256),B=Wd(q,B,!1),B!==2){if(Xd&&!ne){q.errorRecoveryDisabledLanes|=S,vs|=S,x=4;break e}S=Ja,Ja=x,S!==null&&vu(S)}x=B}if(S=!1,x!==2)continue}}if(x===1){xu(i,0),Do(i,s,0,!0);break}e:{switch(p=i,x){case 0:case 1:throw Error(ee(345));case 4:if((s&4194176)===s){Do(p,s,ma,!Po);break e}break;case 2:Ja=null;break;case 3:case 5:break;default:throw Error(ee(329))}if(p.finishedWork=c,p.finishedLanes=s,(s&62914560)===s&&(S=Qh+300-or(),10<S)){if(Do(p,s,ma,!Po),Re(p,0)!==0)break e;p.timeoutHandle=xh(fh.bind(null,p,c,Ja,yu,Yd,s,ma,vs,gc,Po,2,-0,0),S);break e}fh(p,c,Ja,yu,Yd,s,ma,vs,gc,Po,0,-0,0)}}break}while(!0);xs(i)}function vu(i){Ja===null?Ja=i:Ja.push.apply(Ja,i)}function fh(i,s,c,p,x,S,B,q,ne,me,Ze,Qe,Pe){var Ue=s.subtreeFlags;if((Ue&8192||(Ue&16785408)===16785408)&&(k={stylesheets:null,count:0,unsuspend:j},oh(s),s=H(),s!==null)){i.cancelPendingCommit=s(wu.bind(null,i,c,p,x,B,q,ne,1,Qe,Pe)),Do(i,S,B,!me);return}wu(i,c,p,x,B,q,ne,Ze,Qe,Pe)}function pp(i){for(var s=i;;){var c=s.tag;if((c===0||c===11||c===15)&&s.flags&16384&&(c=s.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var p=0;p<c.length;p++){var x=c[p],S=x.getSnapshot;x=x.value;try{if(!Gr(S(),x))return!1}catch{return!1}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Do(i,s,c,p){s&=~Kh,s&=~vs,i.suspendedLanes|=s,i.pingedLanes&=~s,p&&(i.warmLanes|=s),p=i.expirationTimes;for(var x=s;0<x;){var S=31-V(x),B=1<<S;p[S]=-1,x&=~B}c!==0&&At(i,c,s)}function ph(){return(on&6)===0?(_h(0),!1):!0}function td(){if(ni!==null){if(Gi===0)var i=ni.return;else i=ni,Xs=cl=null,Xi(i),po=null,el=0,i=ni;for(;i!==null;)Hd(i.alternate,i),i=i.return;ni=null}}function xu(i,s){i.finishedWork=null,i.finishedLanes=0;var c=i.timeoutHandle;c!==-1&&(i.timeoutHandle=-1,gd(c)),c=i.cancelPendingCommit,c!==null&&(i.cancelPendingCommit=null,c()),td(),Li=i,ni=c=vl(i.current,null),ri=s,Gi=0,pa=null,Po=!1,gu=ze(i,s),Xd=!1,gc=ma=Kh=vs=bl=Mn=0,Ja=Wi=null,Yd=!1,(s&8)!==0&&(s|=s&32);var p=i.entangledLanes;if(p!==0)for(i=i.entanglements,p&=s;0<p;){var x=31-V(p),S=1<<x;s|=i[x],p&=~S}return Qs=s,Hc(),c}function Kd(i,s){Gt=null,Dt.H=Mi,s===ho?(s=Hu(),Gi=3):s===Kc?(s=Hu(),Gi=4):Gi=s===Nh?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,pa=s,ni===null&&(Mn=1,Qr(i,Hr(s,i.current)))}function Qd(){var i=Dt.H;return Dt.H=Mi,i===null?Mi:i}function id(){var i=Dt.A;return Dt.A=$d,i}function mh(){Mn=4,Po||(ri&4194176)!==ri&&oa.current!==null||(gu=!0),(bl&134217727)===0&&(vs&134217727)===0||Li===null||Do(Li,ri,ma,!1)}function Wd(i,s,c){var p=on;on|=2;var x=Qd(),S=id();(Li!==i||ri!==s)&&(yu=null,xu(i,s)),s=!1;var B=Mn;e:do try{if(Gi!==0&&ni!==null){var q=ni,ne=pa;switch(Gi){case 8:td(),B=6;break e;case 3:case 2:case 6:oa.current===null&&(s=!0);var me=Gi;if(Gi=0,pa=null,bu(i,q,ne,me),c&&gu){B=0;break e}break;default:me=Gi,Gi=0,pa=null,bu(i,q,ne,me)}}qf(),B=Mn;break}catch(Ze){Kd(i,Ze)}while(!0);return s&&i.shellSuspendCounter++,Xs=cl=null,on=p,Dt.H=x,Dt.A=S,ni===null&&(Li=null,ri=0,Hc()),B}function qf(){for(;ni!==null;)Hf(ni)}function mp(i,s){var c=on;on|=2;var p=Qd(),x=id();Li!==i||ri!==s?(yu=null,_u=or()+500,xu(i,s)):gu=ze(i,s);e:do try{if(Gi!==0&&ni!==null){s=ni;var S=pa;t:switch(Gi){case 1:Gi=0,pa=null,bu(i,s,S,1);break;case 2:if(Wc(S)){Gi=0,pa=null,$f(s);break}s=function(){Gi===2&&Li===i&&(Gi=7),xs(i)},S.then(s,s);break e;case 3:Gi=7;break e;case 4:Gi=5;break e;case 7:Wc(S)?(Gi=0,pa=null,$f(s)):(Gi=0,pa=null,bu(i,s,S,7));break;case 5:var B=null;switch(ni.tag){case 26:B=ni.memoizedState;case 5:case 27:var q=ni;if(!B||R(B)){Gi=0,pa=null;var ne=q.sibling;if(ne!==null)ni=ne;else{var me=q.return;me!==null?(ni=me,gh(me)):ni=null}break t}}Gi=0,pa=null,bu(i,s,S,5);break;case 6:Gi=0,pa=null,bu(i,s,S,6);break;case 8:td(),Mn=6;break e;default:throw Error(ee(462))}}gp();break}catch(Ze){Kd(i,Ze)}while(!0);return Xs=cl=null,Dt.H=p,Dt.A=x,on=c,ni!==null?0:(Li=null,ri=0,Hc(),Mn)}function gp(){for(;ni!==null&&!Bo();)Hf(ni)}function Hf(i){var s=Rf(i.alternate,i,Qs);i.memoizedProps=i.pendingProps,s===null?gh(i):ni=s}function $f(i){var s=i,c=s.alternate;switch(s.tag){case 15:case 0:s=Qu(c,s,s.pendingProps,s.type,void 0,ri);break;case 11:s=Qu(c,s,s.pendingProps,s.type.render,s.ref,ri);break;case 5:Xi(s);default:Hd(c,s),s=ni=Uf(s,Qs),s=Rf(c,s,Qs)}i.memoizedProps=i.pendingProps,s===null?gh(i):ni=s}function bu(i,s,c,p){Xs=cl=null,Xi(s),po=null,el=0;var x=s.return;try{if(wo(i,x,s,c,ri)){Mn=1,Qr(i,Hr(c,i.current)),ni=null;return}}catch(S){if(x!==null)throw ni=x,S;Mn=1,Qr(i,Hr(c,i.current)),ni=null;return}s.flags&32768?(It||p===1?i=!0:gu||(ri&536870912)!==0?i=!1:(Po=i=!0,(p===2||p===3||p===6)&&(p=oa.current,p!==null&&p.tag===13&&(p.flags|=16384))),Jd(s,i)):gh(s)}function gh(i){var s=i;do{if((s.flags&32768)!==0){Jd(s,Po);return}i=s.return;var c=dp(s.alternate,s,Qs);if(c!==null){ni=c;return}if(s=s.sibling,s!==null){ni=s;return}ni=s=i}while(s!==null);Mn===0&&(Mn=5)}function Jd(i,s){do{var c=fp(i.alternate,i);if(c!==null){c.flags&=32767,ni=c;return}if(c=i.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!s&&(i=i.sibling,i!==null)){ni=i;return}ni=i=c}while(i!==null);Mn=6,ni=null}function wu(i,s,c,p,x,S,B,q,ne,me){var Ze=Dt.T,Qe=ot.p;try{ot.p=2,Dt.T=null,Ws(i,s,c,p,Qe,x,S,B,q,ne,me)}finally{Dt.T=Ze,ot.p=Qe}}function Ws(i,s,c,p,x,S,B,q){do xc();while(_c!==null);if((on&6)!==0)throw Error(ee(327));var ne=i.finishedWork;if(p=i.finishedLanes,ne===null)return null;if(i.finishedWork=null,i.finishedLanes=0,ne===i.current)throw Error(ee(177));i.callbackNode=null,i.callbackPriority=0,i.cancelPendingCommit=null;var me=ne.lanes|ne.childLanes;if(me|=Gu,kt(i,p,me,S,B,q),i===Li&&(ni=Li=null,ri=0),(ne.subtreeFlags&10256)===0&&(ne.flags&10256)===0||Wh||(Wh=!0,Jh=me,Sr=c,nf(ia,function(){return xc(),null})),c=(ne.flags&15990)!==0,(ne.subtreeFlags&15990)!==0||c?(c=Dt.T,Dt.T=null,S=ot.p,ot.p=2,B=on,on|=4,jd(i,ne),Nd(ne,i),Zc(hf,i.containerInfo),Ye=!!uf,hf=uf=null,i.current=ne,hc(i,ne.alternate,ne),to(),on=B,ot.p=S,Dt.T=c):i.current=ne,Wh?(Wh=!1,_c=i,hh=p):Io(i,me),me=i.pendingLanes,me===0&&(wl=null),ye(ne.stateNode),xs(i),s!==null)for(x=i.onRecoverableError,ne=0;ne<s.length;ne++)me=s[ne],x(me.value,{componentStack:me.stack});return(hh&3)!==0&&xc(),me=i.pendingLanes,(p&4194218)!==0&&(me&42)!==0?i===ed?yc++:(yc=0,ed=i):yc=0,_h(0),null}function Io(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,rl(s)))}function xc(){if(_c!==null){var i=_c,s=Jh;Jh=0;var c=ht(hh),p=Dt.T,x=ot.p;try{if(ot.p=32>c?32:c,Dt.T=null,_c===null)var S=!1;else{c=Sr,Sr=null;var B=_c,q=hh;if(_c=null,hh=0,(on&6)!==0)throw Error(ee(331));var ne=on;if(on|=4,Zd(B.current),Xh(B,B.current,q,c),on=ne,_h(0,!1),dn&&typeof dn.onPostCommitFiberRoot=="function")try{dn.onPostCommitFiberRoot(ns,B)}catch{}S=!0}return S}finally{ot.p=x,Dt.T=p,Io(i,s)}}return!1}function nd(i,s,c){s=Hr(c,s),s=mi(i.stateNode,s,2),i=Ys(i,s,2),i!==null&&(pt(i,2),xs(i))}function Bi(i,s,c){if(i.tag===3)nd(i,i,c);else for(;s!==null;){if(s.tag===3){nd(s,i,c);break}else if(s.tag===1){var p=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(wl===null||!wl.has(p))){i=Hr(c,i),c=Tn(2),p=Ys(s,c,2),p!==null&&(Sn(c,p,s,i),pt(p,2),xs(p));break}}s=s.return}}function ef(i,s,c){var p=i.pingCache;if(p===null){p=i.pingCache=new Gf;var x=new Set;p.set(s,x)}else x=p.get(s),x===void 0&&(x=new Set,p.set(s,x));x.has(c)||(Xd=!0,x.add(c),i=rd.bind(null,i,s,c),s.then(i,i))}function rd(i,s,c){var p=i.pingCache;p!==null&&p.delete(s),i.pingedLanes|=i.suspendedLanes&c,i.warmLanes&=~c,Li===i&&(ri&c)===c&&(Mn===4||Mn===3&&(ri&62914560)===ri&&300>or()-Qh?(on&2)===0&&xu(i,0):Kh|=c,gc===ri&&(gc=0)),xs(i)}function ad(i,s){s===0&&(s=xe()),i=$a(i,s),i!==null&&(pt(i,s),xs(i))}function _p(i){var s=i.memoizedState,c=0;s!==null&&(c=s.retryLane),ad(i,c)}function tf(i,s){var c=0;switch(i.tag){case 13:var p=i.stateNode,x=i.memoizedState;x!==null&&(c=x.retryLane);break;case 19:p=i.stateNode;break;case 22:p=i.stateNode._retryCache;break;default:throw Error(ee(314))}p!==null&&p.delete(s),ad(i,c)}function nf(i,s){return ta(i,s)}var Ro=null,bc=null,sd=!1,Tu=!1,od=!1,Js=0;function xs(i){i!==bc&&i.next===null&&(bc===null?Ro=bc=i:bc=bc.next=i),Tu=!0,sd||(sd=!0,vp(yp))}function _h(i,s){if(!od&&Tu){od=!0;do for(var c=!1,p=Ro;p!==null;){if(i!==0){var x=p.pendingLanes;if(x===0)var S=0;else{var B=p.suspendedLanes,q=p.pingedLanes;S=(1<<31-V(42|i)+1)-1,S&=x&~(B&~q),S=S&201326677?S&201326677|1:S?S|2:0}S!==0&&(c=!0,Yf(p,S))}else S=ri,S=Re(p,p===Li?S:0),(S&3)===0||ze(p,S)||(c=!0,Yf(p,S));p=p.next}while(c);od=!1}}function yp(){Tu=sd=!1;var i=0;Js!==0&&(md()&&(i=Js),Js=0);for(var s=or(),c=null,p=Ro;p!==null;){var x=p.next,S=rf(p,s);S===0?(p.next=null,c===null?Ro=x:c.next=x,x===null&&(bc=c)):(c=p,(i!==0||(S&3)!==0)&&(Tu=!0)),p=x}_h(i)}function rf(i,s){for(var c=i.suspendedLanes,p=i.pingedLanes,x=i.expirationTimes,S=i.pendingLanes&-62914561;0<S;){var B=31-V(S),q=1<<B,ne=x[B];ne===-1?((q&c)===0||(q&p)!==0)&&(x[B]=ve(q,s)):ne<=s&&(i.expiredLanes|=q),S&=~q}if(s=Li,c=ri,c=Re(i,i===s?c:0),p=i.callbackNode,c===0||i===s&&Gi===2||i.cancelPendingCommit!==null)return p!==null&&p!==null&&Or(p),i.callbackNode=null,i.callbackPriority=0;if((c&3)===0||ze(i,c)){if(s=c&-c,s===i.callbackPriority)return s;switch(p!==null&&Or(p),ht(c)){case 2:case 8:c=Fa;break;case 32:c=ia;break;case 268435456:c=is;break;default:c=ia}return p=Xf.bind(null,i),c=ta(c,p),i.callbackPriority=s,i.callbackNode=c,s}return p!==null&&p!==null&&Or(p),i.callbackPriority=2,i.callbackNode=null,2}function Xf(i,s){var c=i.callbackNode;if(xc()&&i.callbackNode!==c)return null;var p=ri;return p=Re(i,i===Li?p:0),p===0?null:(vc(i,p,s),rf(i,or()),i.callbackNode!=null&&i.callbackNode===c?Xf.bind(null,i):null)}function Yf(i,s){if(xc())return null;vc(i,s,!0)}function vp(i){xp(function(){(on&6)!==0?ta(ws,i):i()})}function af(){return Js===0&&(Js=Ve()),Js}function Kf(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:ro(""+i)}function ld(i,s){var c=s.ownerDocument.createElement("input");return c.name=s.name,c.value=s.value,i.id&&c.setAttribute("form",i.id),s.parentNode.insertBefore(c,s),i=new FormData(i),c.parentNode.removeChild(c),i}function Tl(i,s,c,p,x){if(s==="submit"&&c&&c.stateNode===x){var S=Kf((x[ct]||null).action),B=p.submitter;B&&(s=(s=B[ct]||null)?Kf(s.formAction):B.getAttribute("formAction"),s!==null&&(S=s,B=null));var q=new os("action","action",null,p,x);i.push({event:q,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(Js!==0){var ne=B?ld(x,B):new FormData(x);Ie(c,{pending:!0,data:ne,method:x.method,action:S},null,ne)}}else typeof S=="function"&&(q.preventDefault(),ne=B?ld(x,B):new FormData(x),Ie(c,{pending:!0,data:ne,method:x.method,action:S},S,ne))},currentTarget:x}]})}}for(var cd=0;cd<Hl.length;cd++){var ud=Hl[cd],Qf=ud.toLowerCase(),Wf=ud[0].toUpperCase()+ud.slice(1);Ma(Qf,"on"+Wf)}Ma(Xo,"onAnimationEnd"),Ma(ql,"onAnimationIteration"),Ma(Zu,"onAnimationStart"),Ma("dblclick","onDoubleClick"),Ma("focusin","onFocus"),Ma("focusout","onBlur"),Ma(Yo,"onTransitionRun"),Ma(Ko,"onTransitionStart"),Ma(Fh,"onTransitionCancel"),Ma(qc,"onTransitionEnd"),xa("onMouseEnter",["mouseout","mouseover"]),xa("onMouseLeave",["mouseout","mouseover"]),xa("onPointerEnter",["pointerout","pointerover"]),xa("onPointerLeave",["pointerout","pointerover"]),Ms("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ms("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ms("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ms("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ms("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ms("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Su="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),sf=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Su));function of(i,s){s=(s&4)!==0;for(var c=0;c<i.length;c++){var p=i[c],x=p.event;p=p.listeners;e:{var S=void 0;if(s)for(var B=p.length-1;0<=B;B--){var q=p[B],ne=q.instance,me=q.currentTarget;if(q=q.listener,ne!==S&&x.isPropagationStopped())break e;S=q,x.currentTarget=me;try{S(x)}catch(Ze){Qa(Ze)}x.currentTarget=null,S=ne}else for(B=0;B<p.length;B++){if(q=p[B],ne=q.instance,me=q.currentTarget,q=q.listener,ne!==S&&x.isPropagationStopped())break e;S=q,x.currentTarget=me;try{S(x)}catch(Ze){Qa(Ze)}x.currentTarget=null,S=ne}}}}function Kt(i,s){var c=s[nn];c===void 0&&(c=s[nn]=new Set);var p=i+"__bubble";c.has(p)||(ga(s,i,2,!1),c.add(p))}function hd(i,s,c){var p=0;s&&(p|=4),ga(c,i,p,s)}var Mu="_reactListening"+Math.random().toString(36).slice(2);function dd(i){if(!i[Mu]){i[Mu]=!0,Mc.forEach(function(c){c!=="selectionchange"&&(sf.has(c)||hd(c,!1,i),hd(c,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[Mu]||(s[Mu]=!0,hd("selectionchange",!1,s))}}function ga(i,s,c,p){switch(qi(s)){case 2:var x=Be;break;case 8:x=ut;break;default:x=wt}c=x.bind(null,s,c,i),x=void 0,!Ti||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(x=!0),p?x!==void 0?i.addEventListener(s,c,{capture:!0,passive:x}):i.addEventListener(s,c,!0):x!==void 0?i.addEventListener(s,c,{passive:x}):i.addEventListener(s,c,!1)}function Sl(i,s,c,p,x){var S=p;if((s&1)===0&&(s&2)===0&&p!==null)e:for(;;){if(p===null)return;var B=p.tag;if(B===3||B===4){var q=p.stateNode.containerInfo;if(q===x||q.nodeType===8&&q.parentNode===x)break;if(B===4)for(B=p.return;B!==null;){var ne=B.tag;if((ne===3||ne===4)&&(ne=B.stateNode.containerInfo,ne===x||ne.nodeType===8&&ne.parentNode===x))return;B=B.return}for(;q!==null;){if(B=Ss(q),B===null)return;if(ne=B.tag,ne===5||ne===6||ne===26||ne===27){p=S=B;continue e}q=q.parentNode}}p=p.return}Pc(function(){var me=S,Ze=an(c),Qe=[];e:{var Pe=ti.get(i);if(Pe!==void 0){var Ue=os,Ct=i;switch(i){case"keypress":if(Cs(c)===0)break e;case"keydown":case"keyup":Ue=Bl;break;case"focusin":Ct="focus",Ue=Ll;break;case"focusout":Ct="blur",Ue=Ll;break;case"beforeblur":case"afterblur":Ue=Ll;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ue=er;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ue=Zr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ue=Ol;break;case Xo:case ql:case Zu:Ue=ao;break;case qc:Ue=Md;break;case"scroll":case"scrollend":Ue=Td;break;case"wheel":Ue=Ph;break;case"copy":case"cut":case"paste":Ue=Rc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ue=zh;break;case"toggle":case"beforetoggle":Ue=Dh}var qt=(s&4)!==0,An=!qt&&(i==="scroll"||i==="scrollend"),be=qt?Pe!==null?Pe+"Capture":null:Pe;qt=[];for(var ge=me,Ce;ge!==null;){var He=ge;if(Ce=He.stateNode,He=He.tag,He!==5&&He!==26&&He!==27||Ce===null||be===null||(He=_r(ge,be),He!=null&&qt.push(Eu(ge,He,Ce))),An)break;ge=ge.return}0<qt.length&&(Pe=new Ue(Pe,Ct,null,c,Ze),Qe.push({event:Pe,listeners:qt}))}}if((s&7)===0){e:{if(Pe=i==="mouseover"||i==="pointerover",Ue=i==="mouseout"||i==="pointerout",Pe&&c!==Ur&&(Ct=c.relatedTarget||c.fromElement)&&(Ss(Ct)||Ct[na]))break e;if((Ue||Pe)&&(Pe=Ze.window===Ze?Ze:(Pe=Ze.ownerDocument)?Pe.defaultView||Pe.parentWindow:window,Ue?(Ct=c.relatedTarget||c.toElement,Ue=me,Ct=Ct?Ss(Ct):null,Ct!==null&&(An=zt(Ct),qt=Ct.tag,Ct!==An||qt!==5&&qt!==27&&qt!==6)&&(Ct=null)):(Ue=null,Ct=me),Ue!==Ct)){if(qt=er,He="onMouseLeave",be="onMouseEnter",ge="mouse",(i==="pointerout"||i==="pointerover")&&(qt=zh,He="onPointerLeave",be="onPointerEnter",ge="pointer"),An=Ue==null?Pe:io(Ue),Ce=Ct==null?Pe:io(Ct),Pe=new qt(He,ge+"leave",Ue,c,Ze),Pe.target=An,Pe.relatedTarget=Ce,He=null,Ss(Ze)===me&&(qt=new qt(be,ge+"enter",Ct,c,Ze),qt.target=Ce,qt.relatedTarget=An,He=qt),An=He,Ue&&Ct)t:{for(qt=Ue,be=Ct,ge=0,Ce=qt;Ce;Ce=wc(Ce))ge++;for(Ce=0,He=be;He;He=wc(He))Ce++;for(;0<ge-Ce;)qt=wc(qt),ge--;for(;0<Ce-ge;)be=wc(be),Ce--;for(;ge--;){if(qt===be||be!==null&&qt===be.alternate)break t;qt=wc(qt),be=wc(be)}qt=null}else qt=null;Ue!==null&&lf(Qe,Pe,Ue,qt,!1),Ct!==null&&An!==null&&lf(Qe,An,Ct,qt,!0)}}e:{if(Pe=me?io(me):window,Ue=Pe.nodeName&&Pe.nodeName.toLowerCase(),Ue==="select"||Ue==="input"&&Pe.type==="file")var gt=Ul;else if(Fl(Pe))if(Nc)gt=si;else{gt=Fu;var Qt=Bh}else Ue=Pe.nodeName,!Ue||Ue.toLowerCase()!=="input"||Pe.type!=="checkbox"&&Pe.type!=="radio"?me&&bn(me.elementType)&&(gt=Ul):gt=co;if(gt&&(gt=gt(i,me))){kh(Qe,gt,c,Ze);break e}Qt&&Qt(i,Pe,me),i==="focusout"&&me&&Pe.type==="number"&&me.memoizedProps.value!=null&&Xt(Pe,"number",Pe.value)}switch(Qt=me?io(me):window,i){case"focusin":(Fl(Qt)||Qt.contentEditable==="true")&&(Ps=Qt,us=me,qa=null);break;case"focusout":qa=us=Ps=null;break;case"mousedown":Ar=!0;break;case"contextmenu":case"mouseup":case"dragend":Ar=!1,Vu(Qe,c,Ze);break;case"selectionchange":if(Gc)break;case"keydown":case"keyup":Vu(Qe,c,Ze)}var Pt;if(Bu)e:{switch(i){case"compositionstart":var Lt="onCompositionStart";break e;case"compositionend":Lt="onCompositionEnd";break e;case"compositionupdate":Lt="onCompositionUpdate";break e}Lt=void 0}else so?Fc(i,c)&&(Lt="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(Lt="onCompositionStart");Lt&&(ju&&c.locale!=="ko"&&(so||Lt!=="onCompositionStart"?Lt==="onCompositionEnd"&&so&&(Pt=Yt()):(Vt=Ze,jt="value"in Vt?Vt.value:Vt.textContent,so=!0)),Qt=yh(me,Lt),0<Qt.length&&(Lt=new Ah(Lt,i,null,c,Ze),Qe.push({event:Lt,listeners:Qt}),Pt?Lt.data=Pt:(Pt=zs(c),Pt!==null&&(Lt.data=Pt)))),(Pt=Ou?Rh(i,c):oo(i,c))&&(Lt=yh(me,"onBeforeInput"),0<Lt.length&&(Qt=new Ah("onBeforeInput","beforeinput",null,c,Ze),Qe.push({event:Qt,listeners:Lt}),Qt.data=Pt)),Tl(Qe,i,me,c,Ze)}of(Qe,s)})}function Eu(i,s,c){return{instance:i,listener:s,currentTarget:c}}function yh(i,s){for(var c=s+"Capture",p=[];i!==null;){var x=i,S=x.stateNode;x=x.tag,x!==5&&x!==26&&x!==27||S===null||(x=_r(i,c),x!=null&&p.unshift(Eu(i,x,S)),x=_r(i,s),x!=null&&p.push(Eu(i,x,S))),i=i.return}return p}function wc(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function lf(i,s,c,p,x){for(var S=s._reactName,B=[];c!==null&&c!==p;){var q=c,ne=q.alternate,me=q.stateNode;if(q=q.tag,ne!==null&&ne===p)break;q!==5&&q!==26&&q!==27||me===null||(ne=me,x?(me=_r(c,S),me!=null&&B.unshift(Eu(c,me,ne))):x||(me=_r(c,S),me!=null&&B.push(Eu(c,me,ne)))),c=c.return}B.length!==0&&i.push({event:s,listeners:B})}var Jf=/\r\n?/g,ep=/\u0000|\uFFFD/g;function tp(i){return(typeof i=="string"?i:""+i).replace(Jf,`
`).replace(ep,"")}function cf(i,s){return s=tp(s),tp(i)===s}function bs(){}function Ei(i,s,c,p,x,S){switch(c){case"children":typeof p=="string"?s==="body"||s==="textarea"&&p===""||rn(i,p):(typeof p=="number"||typeof p=="bigint")&&s!=="body"&&rn(i,""+p);break;case"className":Fo(i,"class",p);break;case"tabIndex":Fo(i,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Fo(i,c,p);break;case"style":zc(i,p,S);break;case"data":if(s!=="object"){Fo(i,"data",p);break}case"src":case"href":if(p===""&&(s!=="a"||c!=="href")){i.removeAttribute(c);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(c);break}p=ro(""+p),i.setAttribute(c,p);break;case"action":case"formAction":if(typeof p=="function"){i.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof S=="function"&&(c==="formAction"?(s!=="input"&&Ei(i,s,"name",x.name,x,null),Ei(i,s,"formEncType",x.formEncType,x,null),Ei(i,s,"formMethod",x.formMethod,x,null),Ei(i,s,"formTarget",x.formTarget,x,null)):(Ei(i,s,"encType",x.encType,x,null),Ei(i,s,"method",x.method,x,null),Ei(i,s,"target",x.target,x,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(c);break}p=ro(""+p),i.setAttribute(c,p);break;case"onClick":p!=null&&(i.onclick=bs);break;case"onScroll":p!=null&&Kt("scroll",i);break;case"onScrollEnd":p!=null&&Kt("scrollend",i);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(ee(61));if(c=p.__html,c!=null){if(x.children!=null)throw Error(ee(60));i.innerHTML=c}}break;case"multiple":i.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":i.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){i.removeAttribute("xlink:href");break}c=ro(""+p),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(c,""+p):i.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(c,""):i.removeAttribute(c);break;case"capture":case"download":p===!0?i.setAttribute(c,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(c,p):i.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?i.setAttribute(c,p):i.removeAttribute(c);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?i.removeAttribute(c):i.setAttribute(c,p);break;case"popover":Kt("beforetoggle",i),Kt("toggle",i),rs(i,"popover",p);break;case"xlinkActuate":ba(i,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":ba(i,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":ba(i,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":ba(i,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":ba(i,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":ba(i,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":ba(i,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":ba(i,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":ba(i,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":rs(i,"is",p);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=gr.get(c)||c,rs(i,c,p))}}function fd(i,s,c,p,x,S){switch(c){case"style":zc(i,p,S);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(ee(61));if(c=p.__html,c!=null){if(x.children!=null)throw Error(ee(60));i.innerHTML=c}}break;case"children":typeof p=="string"?rn(i,p):(typeof p=="number"||typeof p=="bigint")&&rn(i,""+p);break;case"onScroll":p!=null&&Kt("scroll",i);break;case"onScrollEnd":p!=null&&Kt("scrollend",i);break;case"onClick":p!=null&&(i.onclick=bs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Pu.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(x=c.endsWith("Capture"),s=c.slice(2,x?c.length-7:void 0),S=i[ct]||null,S=S!=null?S[c]:null,typeof S=="function"&&i.removeEventListener(s,S,x),typeof p=="function")){typeof S!="function"&&S!==null&&(c in i?i[c]=null:i.hasAttribute(c)&&i.removeAttribute(c)),i.addEventListener(s,p,x);break e}c in i?i[c]=p:p===!0?i.setAttribute(c,""):rs(i,c,p)}}}function ur(i,s,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Kt("error",i),Kt("load",i);var p=!1,x=!1,S;for(S in c)if(c.hasOwnProperty(S)){var B=c[S];if(B!=null)switch(S){case"src":p=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(ee(137,s));default:Ei(i,s,S,B,c,null)}}x&&Ei(i,s,"srcSet",c.srcSet,c,null),p&&Ei(i,s,"src",c.src,c,null);return;case"input":Kt("invalid",i);var q=S=B=x=null,ne=null,me=null;for(p in c)if(c.hasOwnProperty(p)){var Ze=c[p];if(Ze!=null)switch(p){case"name":x=Ze;break;case"type":B=Ze;break;case"checked":ne=Ze;break;case"defaultChecked":me=Ze;break;case"value":S=Ze;break;case"defaultValue":q=Ze;break;case"children":case"dangerouslySetInnerHTML":if(Ze!=null)throw Error(ee(137,s));break;default:Ei(i,s,p,Ze,c,null)}}Fr(i,S,q,ne,me,B,x,!1),no(i);return;case"select":Kt("invalid",i),p=B=S=null;for(x in c)if(c.hasOwnProperty(x)&&(q=c[x],q!=null))switch(x){case"value":S=q;break;case"defaultValue":B=q;break;case"multiple":p=q;default:Ei(i,s,x,q,c,null)}s=S,c=B,i.multiple=!!p,s!=null?as(i,!!p,s,!1):c!=null&&as(i,!!p,c,!0);return;case"textarea":Kt("invalid",i),S=x=p=null;for(B in c)if(c.hasOwnProperty(B)&&(q=c[B],q!=null))switch(B){case"value":p=q;break;case"defaultValue":x=q;break;case"children":S=q;break;case"dangerouslySetInnerHTML":if(q!=null)throw Error(ee(91));break;default:Ei(i,s,B,q,c,null)}Nr(i,p,x,S),no(i);return;case"option":for(ne in c)if(c.hasOwnProperty(ne)&&(p=c[ne],p!=null))switch(ne){case"selected":i.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:Ei(i,s,ne,p,c,null)}return;case"dialog":Kt("cancel",i),Kt("close",i);break;case"iframe":case"object":Kt("load",i);break;case"video":case"audio":for(p=0;p<Su.length;p++)Kt(Su[p],i);break;case"image":Kt("error",i),Kt("load",i);break;case"details":Kt("toggle",i);break;case"embed":case"source":case"link":Kt("error",i),Kt("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(me in c)if(c.hasOwnProperty(me)&&(p=c[me],p!=null))switch(me){case"children":case"dangerouslySetInnerHTML":throw Error(ee(137,s));default:Ei(i,s,me,p,c,null)}return;default:if(bn(s)){for(Ze in c)c.hasOwnProperty(Ze)&&(p=c[Ze],p!==void 0&&fd(i,s,Ze,p,c,void 0));return}}for(q in c)c.hasOwnProperty(q)&&(p=c[q],p!=null&&Ei(i,s,q,p,c,null))}function ip(i,s,c,p){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,S=null,B=null,q=null,ne=null,me=null,Ze=null;for(Ue in c){var Qe=c[Ue];if(c.hasOwnProperty(Ue)&&Qe!=null)switch(Ue){case"checked":break;case"value":break;case"defaultValue":ne=Qe;default:p.hasOwnProperty(Ue)||Ei(i,s,Ue,null,p,Qe)}}for(var Pe in p){var Ue=p[Pe];if(Qe=c[Pe],p.hasOwnProperty(Pe)&&(Ue!=null||Qe!=null))switch(Pe){case"type":S=Ue;break;case"name":x=Ue;break;case"checked":me=Ue;break;case"defaultChecked":Ze=Ue;break;case"value":B=Ue;break;case"defaultValue":q=Ue;break;case"children":case"dangerouslySetInnerHTML":if(Ue!=null)throw Error(ee(137,s));break;default:Ue!==Qe&&Ei(i,s,Pe,Ue,p,Qe)}}mr(i,B,q,ne,me,Ze,S,x);return;case"select":Ue=B=q=Pe=null;for(S in c)if(ne=c[S],c.hasOwnProperty(S)&&ne!=null)switch(S){case"value":break;case"multiple":Ue=ne;default:p.hasOwnProperty(S)||Ei(i,s,S,null,p,ne)}for(x in p)if(S=p[x],ne=c[x],p.hasOwnProperty(x)&&(S!=null||ne!=null))switch(x){case"value":Pe=S;break;case"defaultValue":q=S;break;case"multiple":B=S;default:S!==ne&&Ei(i,s,x,S,p,ne)}s=q,c=B,p=Ue,Pe!=null?as(i,!!c,Pe,!1):!!p!=!!c&&(s!=null?as(i,!!c,s,!0):as(i,!!c,c?[]:"",!1));return;case"textarea":Ue=Pe=null;for(q in c)if(x=c[q],c.hasOwnProperty(q)&&x!=null&&!p.hasOwnProperty(q))switch(q){case"value":break;case"children":break;default:Ei(i,s,q,null,p,x)}for(B in p)if(x=p[B],S=c[B],p.hasOwnProperty(B)&&(x!=null||S!=null))switch(B){case"value":Pe=x;break;case"defaultValue":Ue=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(ee(91));break;default:x!==S&&Ei(i,s,B,x,p,S)}Ac(i,Pe,Ue);return;case"option":for(var Ct in c)if(Pe=c[Ct],c.hasOwnProperty(Ct)&&Pe!=null&&!p.hasOwnProperty(Ct))switch(Ct){case"selected":i.selected=!1;break;default:Ei(i,s,Ct,null,p,Pe)}for(ne in p)if(Pe=p[ne],Ue=c[ne],p.hasOwnProperty(ne)&&Pe!==Ue&&(Pe!=null||Ue!=null))switch(ne){case"selected":i.selected=Pe&&typeof Pe!="function"&&typeof Pe!="symbol";break;default:Ei(i,s,ne,Pe,p,Ue)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var qt in c)Pe=c[qt],c.hasOwnProperty(qt)&&Pe!=null&&!p.hasOwnProperty(qt)&&Ei(i,s,qt,null,p,Pe);for(me in p)if(Pe=p[me],Ue=c[me],p.hasOwnProperty(me)&&Pe!==Ue&&(Pe!=null||Ue!=null))switch(me){case"children":case"dangerouslySetInnerHTML":if(Pe!=null)throw Error(ee(137,s));break;default:Ei(i,s,me,Pe,p,Ue)}return;default:if(bn(s)){for(var An in c)Pe=c[An],c.hasOwnProperty(An)&&Pe!==void 0&&!p.hasOwnProperty(An)&&fd(i,s,An,void 0,p,Pe);for(Ze in p)Pe=p[Ze],Ue=c[Ze],!p.hasOwnProperty(Ze)||Pe===Ue||Pe===void 0&&Ue===void 0||fd(i,s,Ze,Pe,p,Ue);return}}for(var be in c)Pe=c[be],c.hasOwnProperty(be)&&Pe!=null&&!p.hasOwnProperty(be)&&Ei(i,s,be,null,p,Pe);for(Qe in p)Pe=p[Qe],Ue=c[Qe],!p.hasOwnProperty(Qe)||Pe===Ue||Pe==null&&Ue==null||Ei(i,s,Qe,Pe,p,Ue)}var uf=null,hf=null;function vh(i){return i.nodeType===9?i:i.ownerDocument}function Cu(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function df(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function Au(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var pd=null;function md(){var i=window.event;return i&&i.type==="popstate"?i===pd?!1:(pd=i,!0):(pd=null,!1)}var xh=typeof setTimeout=="function"?setTimeout:void 0,gd=typeof clearTimeout=="function"?clearTimeout:void 0,np=typeof Promise=="function"?Promise:void 0,xp=typeof queueMicrotask=="function"?queueMicrotask:typeof np<"u"?function(i){return np.resolve(null).then(i).catch(bp)}:xh;function bp(i){setTimeout(function(){throw i})}function Ml(i,s){var c=s,p=0;do{var x=c.nextSibling;if(i.removeChild(c),x&&x.nodeType===8)if(c=x.data,c==="/$"){if(p===0){i.removeChild(x),Wr(s);return}p--}else c!=="$"&&c!=="$?"&&c!=="$!"||p++;c=x}while(c);Wr(s)}function Gn(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var c=s;switch(s=s.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Gn(c),hi(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}i.removeChild(c)}}function El(i,s,c,p){for(;i.nodeType===1;){var x=c;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!p&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(p){if(!i[Nn])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(S=i.getAttribute("rel"),S==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(S!==x.rel||i.getAttribute("href")!==(x.href==null?null:x.href)||i.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||i.getAttribute("title")!==(x.title==null?null:x.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(S=i.getAttribute("src"),(S!==(x.src==null?null:x.src)||i.getAttribute("type")!==(x.type==null?null:x.type)||i.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&S&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var S=x.name==null?null:""+x.name;if(x.type==="hidden"&&i.getAttribute("name")===S)return i}else return i;if(i=es(i.nextSibling),i===null)break}return null}function ff(i,s,c){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=es(i.nextSibling),i===null))return null;return i}function es(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return i}function pf(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"){if(s===0)return i;s--}else c==="/$"&&s++}i=i.previousSibling}return null}function _d(i,s,c){switch(s=vh(c),i){case"html":if(i=s.documentElement,!i)throw Error(ee(452));return i;case"head":if(i=s.head,!i)throw Error(ee(453));return i;case"body":if(i=s.body,!i)throw Error(ee(454));return i;default:throw Error(ee(451))}}var ts=new Map,mf=new Set;function bh(i){return typeof i.getRootNode=="function"?i.getRootNode():i.ownerDocument}var ko=ot.d;ot.d={f:rp,r:gf,D:wh,C:yf,L:ap,m:vf,X:Th,S:yd,M:xf};function rp(){var i=ko.f(),s=ph();return i||s}function gf(i){var s=Na(i);s!==null&&s.tag===5&&s.type==="form"?We(s):ko.r(i)}var Cl=typeof document>"u"?null:document;function _f(i,s,c){var p=Cl;if(p&&typeof s=="string"&&s){var x=Ft(s);x='link[rel="'+i+'"][href="'+x+'"]',typeof c=="string"&&(x+='[crossorigin="'+c+'"]'),mf.has(x)||(mf.add(x),i={rel:i,crossOrigin:c,href:s},p.querySelector(x)===null&&(s=p.createElement("link"),ur(s,"link",i),$i(s),p.head.appendChild(s)))}}function wh(i){ko.D(i),_f("dns-prefetch",i,null)}function yf(i,s){ko.C(i,s),_f("preconnect",i,s)}function ap(i,s,c){ko.L(i,s,c);var p=Cl;if(p&&i&&s){var x='link[rel="preload"][as="'+Ft(s)+'"]';s==="image"&&c&&c.imageSrcSet?(x+='[imagesrcset="'+Ft(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(x+='[imagesizes="'+Ft(c.imageSizes)+'"]')):x+='[href="'+Ft(i)+'"]';var S=x;switch(s){case"style":S=Al(i);break;case"script":S=r(i)}ts.has(S)||(i=ai({rel:"preload",href:s==="image"&&c&&c.imageSrcSet?void 0:i,as:s},c),ts.set(S,i),p.querySelector(x)!==null||s==="style"&&p.querySelector(Sh(S))||s==="script"&&p.querySelector(o(S))||(s=p.createElement("link"),ur(s,"link",i),$i(s),p.head.appendChild(s)))}}function vf(i,s){ko.m(i,s);var c=Cl;if(c&&i){var p=s&&typeof s.as=="string"?s.as:"script",x='link[rel="modulepreload"][as="'+Ft(p)+'"][href="'+Ft(i)+'"]',S=x;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":S=r(i)}if(!ts.has(S)&&(i=ai({rel:"modulepreload",href:i},s),ts.set(S,i),c.querySelector(x)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(o(S)))return}p=c.createElement("link"),ur(p,"link",i),$i(p),c.head.appendChild(p)}}}function yd(i,s,c){ko.S(i,s,c);var p=Cl;if(p&&i){var x=jr(p).hoistableStyles,S=Al(i);s=s||"default";var B=x.get(S);if(!B){var q={loading:0,preload:null};if(B=p.querySelector(Sh(S)))q.loading=5;else{i=ai({rel:"stylesheet",href:i,"data-precedence":s},c),(c=ts.get(S))&&_(i,c);var ne=B=p.createElement("link");$i(ne),ur(ne,"link",i),ne._p=new Promise(function(me,Ze){ne.onload=me,ne.onerror=Ze}),ne.addEventListener("load",function(){q.loading|=1}),ne.addEventListener("error",function(){q.loading|=2}),q.loading|=4,g(B,s,p)}B={type:"stylesheet",instance:B,count:1,state:q},x.set(S,B)}}}function Th(i,s){ko.X(i,s);var c=Cl;if(c&&i){var p=jr(c).hoistableScripts,x=r(i),S=p.get(x);S||(S=c.querySelector(o(x)),S||(i=ai({src:i,async:!0},s),(s=ts.get(x))&&v(i,s),S=c.createElement("script"),$i(S),ur(S,"link",i),c.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},p.set(x,S))}}function xf(i,s){ko.M(i,s);var c=Cl;if(c&&i){var p=jr(c).hoistableScripts,x=r(i),S=p.get(x);S||(S=c.querySelector(o(x)),S||(i=ai({src:i,async:!0,type:"module"},s),(s=ts.get(x))&&v(i,s),S=c.createElement("script"),$i(S),ur(S,"link",i),c.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},p.set(x,S))}}function vd(i,s,c,p){var x=(x=sr.current)?bh(x):null;if(!x)throw Error(ee(446));switch(i){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(s=Al(c.href),c=jr(x).hoistableStyles,p=c.get(s),p||(p={type:"style",instance:null,count:0,state:null},c.set(s,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){i=Al(c.href);var S=jr(x).hoistableStyles,B=S.get(i);if(B||(x=x.ownerDocument||x,B={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},S.set(i,B),(S=x.querySelector(Sh(i)))&&!S._p&&(B.instance=S,B.state.loading=5),ts.has(i)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},ts.set(i,c),S||t(x,i,c,B.state))),s&&p===null)throw Error(ee(528,""));return B}if(s&&p!==null)throw Error(ee(529,""));return null;case"script":return s=c.async,c=c.src,typeof c=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=r(c),c=jr(x).hoistableScripts,p=c.get(s),p||(p={type:"script",instance:null,count:0,state:null},c.set(s,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(ee(444,i))}}function Al(i){return'href="'+Ft(i)+'"'}function Sh(i){return'link[rel="stylesheet"]['+i+"]"}function a(i){return ai({},i,{"data-precedence":i.precedence,precedence:null})}function t(i,s,c,p){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?p.loading=1:(s=i.createElement("link"),p.preload=s,s.addEventListener("load",function(){return p.loading|=1}),s.addEventListener("error",function(){return p.loading|=2}),ur(s,"link",c),$i(s),i.head.appendChild(s))}function r(i){return'[src="'+Ft(i)+'"]'}function o(i){return"script[async]"+i}function h(i,s,c){if(s.count++,s.instance===null)switch(s.type){case"style":var p=i.querySelector('style[data-href~="'+Ft(c.href)+'"]');if(p)return s.instance=p,$i(p),p;var x=ai({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return p=(i.ownerDocument||i).createElement("style"),$i(p),ur(p,"style",x),g(p,c.precedence,i),s.instance=p;case"stylesheet":x=Al(c.href);var S=i.querySelector(Sh(x));if(S)return s.state.loading|=4,s.instance=S,$i(S),S;p=a(c),(x=ts.get(x))&&_(p,x),S=(i.ownerDocument||i).createElement("link"),$i(S);var B=S;return B._p=new Promise(function(q,ne){B.onload=q,B.onerror=ne}),ur(S,"link",p),s.state.loading|=4,g(S,c.precedence,i),s.instance=S;case"script":return S=r(c.src),(x=i.querySelector(o(S)))?(s.instance=x,$i(x),x):(p=c,(x=ts.get(S))&&(p=ai({},c),v(p,x)),i=i.ownerDocument||i,x=i.createElement("script"),$i(x),ur(x,"link",p),i.head.appendChild(x),s.instance=x);case"void":return null;default:throw Error(ee(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(p=s.instance,s.state.loading|=4,g(p,c.precedence,i));return s.instance}function g(i,s,c){for(var p=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=p.length?p[p.length-1]:null,S=x,B=0;B<p.length;B++){var q=p[B];if(q.dataset.precedence===s)S=q;else if(S!==x)break}S?S.parentNode.insertBefore(i,S.nextSibling):(s=c.nodeType===9?c.head:c,s.insertBefore(i,s.firstChild))}function _(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function v(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var w=null;function M(i,s,c){if(w===null){var p=new Map,x=w=new Map;x.set(c,p)}else x=w,p=x.get(c),p||(p=new Map,x.set(c,p));if(p.has(i))return p;for(p.set(i,null),c=c.getElementsByTagName(i),x=0;x<c.length;x++){var S=c[x];if(!(S[Nn]||S[Et]||i==="link"&&S.getAttribute("rel")==="stylesheet")&&S.namespaceURI!=="http://www.w3.org/2000/svg"){var B=S.getAttribute(s)||"";B=i+B;var q=p.get(B);q?q.push(S):p.set(B,[S])}}return p}function C(i,s,c){i=i.ownerDocument||i,i.head.insertBefore(c,s==="title"?i.querySelector("head > title"):null)}function A(i,s,c){if(c===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return i=s.disabled,typeof s.precedence=="string"&&i==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function R(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var k=null;function j(){}function U(i,s,c){if(k===null)throw Error(ee(475));var p=k;if(s.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var x=Al(c.href),S=i.querySelector(Sh(x));if(S){i=S._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(p.count++,p=Q.bind(p),i.then(p,p)),s.state.loading|=4,s.instance=S,$i(S);return}S=i.ownerDocument||i,c=a(c),(x=ts.get(x))&&_(c,x),S=S.createElement("link"),$i(S);var B=S;B._p=new Promise(function(q,ne){B.onload=q,B.onerror=ne}),ur(S,"link",c),s.instance=S}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(s,i),(i=s.state.preload)&&(s.state.loading&3)===0&&(p.count++,s=Q.bind(p),i.addEventListener("load",s),i.addEventListener("error",s))}}function H(){if(k===null)throw Error(ee(475));var i=k;return i.stylesheets&&i.count===0&&te(i,i.stylesheets),0<i.count?function(s){var c=setTimeout(function(){if(i.stylesheets&&te(i,i.stylesheets),i.unsuspend){var p=i.unsuspend;i.unsuspend=null,p()}},6e4);return i.unsuspend=s,function(){i.unsuspend=null,clearTimeout(c)}}:null}function Q(){if(this.count--,this.count===0){if(this.stylesheets)te(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var ue=null;function te(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,ue=new Map,s.forEach(L,i),ue=null,Q.call(i))}function L(i,s){if(!(s.state.loading&4)){var c=ue.get(i);if(c)var p=c.get(null);else{c=new Map,ue.set(i,c);for(var x=i.querySelectorAll("link[data-precedence],style[data-precedence]"),S=0;S<x.length;S++){var B=x[S];(B.nodeName==="LINK"||B.getAttribute("media")!=="not all")&&(c.set(B.dataset.precedence,B),p=B)}p&&c.set(null,p)}x=s.instance,B=x.getAttribute("data-precedence"),S=c.get(B)||p,S===p&&c.set(null,x),c.set(B,x),this.count++,p=Q.bind(this),x.addEventListener("load",p),x.addEventListener("error",p),S?S.parentNode.insertBefore(x,S.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(x,i.firstChild)),s.state.loading|=4}}var G={$$typeof:_e,Provider:null,Consumer:null,_currentValue:Rt,_currentValue2:Rt,_threadCount:0};function ie(i,s,c,p,x,S,B,q){this.tag=1,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=tt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tt(0),this.hiddenUpdates=tt(null),this.identifierPrefix=p,this.onUncaughtError=x,this.onCaughtError=S,this.onRecoverableError=B,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=q,this.incompleteTransitions=new Map}function Te(i,s,c,p,x,S,B,q,ne,me,Ze,Qe){return i=new ie(i,s,c,B,q,ne,me,Qe),s=1,S===!0&&(s|=24),S=Lr(3,null,null,s),i.current=S,S.stateNode=i,s=nl(),s.refCount++,i.pooledCache=s,s.refCount++,S.memoizedState={element:p,isDehydrated:c,cache:s},kd(S),i}function qe(i){return i?(i=ds,i):ds}function Ae(i,s,c,p,x,S){x=qe(x),p.context===null?p.context=x:p.pendingContext=x,p=fl(s),p.payload={element:c},S=S===void 0?null:S,S!==null&&(p.callback=S),c=Ys(i,p,s),c!==null&&(rr(c,i,s),cc(c,i,s))}function De(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<s?c:s}}function Xe(i,s){De(i,s),(i=i.alternate)&&De(i,s)}function $e(i){if(i.tag===13){var s=$a(i,67108864);s!==null&&rr(s,i,67108864),Xe(i,67108864)}}var Ye=!0;function Be(i,s,c,p){var x=Dt.T;Dt.T=null;var S=ot.p;try{ot.p=2,wt(i,s,c,p)}finally{ot.p=S,Dt.T=x}}function ut(i,s,c,p){var x=Dt.T;Dt.T=null;var S=ot.p;try{ot.p=8,wt(i,s,c,p)}finally{ot.p=S,Dt.T=x}}function wt(i,s,c,p){if(Ye){var x=vt(p);if(x===null)Sl(i,s,p,dt,c),Hn(i,p);else if(Ba(x,i,s,c,p))p.stopPropagation();else if(Hn(i,p),s&4&&-1<ar.indexOf(i)){for(;x!==null;){var S=Na(x);if(S!==null)switch(S.tag){case 3:if(S=S.stateNode,S.current.memoizedState.isDehydrated){var B=de(S.pendingLanes);if(B!==0){var q=S;for(q.pendingLanes|=2,q.entangledLanes|=2;B;){var ne=1<<31-V(B);q.entanglements[1]|=ne,B&=~ne}xs(S),(on&6)===0&&(_u=or()+500,_h(0))}}break;case 13:q=$a(S,2),q!==null&&rr(q,S,2),ph(),Xe(S,2)}if(S=vt(p),S===null&&Sl(i,s,p,dt,c),S===x)break;x=S}x!==null&&p.stopPropagation()}else Sl(i,s,p,null,c)}}function vt(i){return i=an(i),Ht(i)}var dt=null;function Ht(i){if(dt=null,i=Ss(i),i!==null){var s=zt(i);if(s===null)i=null;else{var c=s.tag;if(c===13){if(i=ci(s),i!==null)return i;i=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return dt=i,null}function qi(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Oo()){case ws:return 2;case Fa:return 8;case ia:case Ts:return 32;case is:return 268435456;default:return 32}default:return 32}}var yn=!1,Ji=null,qn=null,En=null,vn=new Map,wi=new Map,Oi=[],ar="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Hn(i,s){switch(i){case"focusin":case"focusout":Ji=null;break;case"dragenter":case"dragleave":qn=null;break;case"mouseover":case"mouseout":En=null;break;case"pointerover":case"pointerout":vn.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":wi.delete(s.pointerId)}}function $n(i,s,c,p,x,S){return i===null||i.nativeEvent!==S?(i={blockedOn:s,domEventName:c,eventSystemFlags:p,nativeEvent:S,targetContainers:[x]},s!==null&&(s=Na(s),s!==null&&$e(s)),i):(i.eventSystemFlags|=p,s=i.targetContainers,x!==null&&s.indexOf(x)===-1&&s.push(x),i)}function Ba(i,s,c,p,x){switch(s){case"focusin":return Ji=$n(Ji,i,s,c,p,x),!0;case"dragenter":return qn=$n(qn,i,s,c,p,x),!0;case"mouseover":return En=$n(En,i,s,c,p,x),!0;case"pointerover":var S=x.pointerId;return vn.set(S,$n(vn.get(S)||null,i,s,c,p,x)),!0;case"gotpointercapture":return S=x.pointerId,wi.set(S,$n(wi.get(S)||null,i,s,c,p,x)),!0}return!1}function On(i){var s=Ss(i.target);if(s!==null){var c=zt(s);if(c!==null){if(s=c.tag,s===13){if(s=ci(c),s!==null){i.blockedOn=s,Zt(i.priority,function(){if(c.tag===13){var p=Zn(),x=$a(c,p);x!==null&&rr(x,c,p),Xe(c,p)}});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function hr(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var c=vt(i.nativeEvent);if(c===null){c=i.nativeEvent;var p=new c.constructor(c.type,c);Ur=p,c.target.dispatchEvent(p),Ur=null}else return s=Na(c),s!==null&&$e(s),i.blockedOn=c,!1;s.shift()}return!0}function Cn(i,s,c){hr(i)&&c.delete(s)}function Xn(){yn=!1,Ji!==null&&hr(Ji)&&(Ji=null),qn!==null&&hr(qn)&&(qn=null),En!==null&&hr(En)&&(En=null),vn.forEach(Cn),wi.forEach(Cn)}function xn(i,s){i.blockedOn===s&&(i.blockedOn=null,yn||(yn=!0,Z.unstable_scheduleCallback(Z.unstable_NormalPriority,Xn)))}var en=null;function Ci(i){en!==i&&(en=i,Z.unstable_scheduleCallback(Z.unstable_NormalPriority,function(){en===i&&(en=null);for(var s=0;s<i.length;s+=3){var c=i[s],p=i[s+1],x=i[s+2];if(typeof p!="function"){if(Ht(p||c)===null)continue;break}var S=Na(c);S!==null&&(i.splice(s,3),s-=3,Ie(S,{pending:!0,data:x,method:c.method,action:p},p,x))}}))}function Wr(i){function s(ne){return xn(ne,i)}Ji!==null&&xn(Ji,i),qn!==null&&xn(qn,i),En!==null&&xn(En,i),vn.forEach(s),wi.forEach(s);for(var c=0;c<Oi.length;c++){var p=Oi[c];p.blockedOn===i&&(p.blockedOn=null)}for(;0<Oi.length&&(c=Oi[0],c.blockedOn===null);)On(c),c.blockedOn===null&&Oi.shift();if(c=(i.ownerDocument||i).$$reactFormReplay,c!=null)for(p=0;p<c.length;p+=3){var x=c[p],S=c[p+1],B=x[ct]||null;if(typeof S=="function")B||Ci(c);else if(B){var q=null;if(S&&S.hasAttribute("formAction")){if(x=S,B=S[ct]||null)q=B.formAction;else if(Ht(x)!==null)continue}else q=B.action;typeof q=="function"?c[p+1]=q:(c.splice(p,3),p-=3),Ci(c)}}}function zl(i){this._internalRoot=i}_a.prototype.render=zl.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(ee(409));var c=s.current,p=Zn();Ae(c,p,i,s,null,null)},_a.prototype.unmount=zl.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;i.tag===0&&xc(),Ae(i.current,2,null,i,null,null),ph(),s[na]=null}};function _a(i){this._internalRoot=i}_a.prototype.unstable_scheduleHydration=function(i){if(i){var s=lt();i={blockedOn:null,target:i,priority:s};for(var c=0;c<Oi.length&&s!==0&&s<Oi[c].priority;c++);Oi.splice(c,0,i),c===0&&On(i)}};var sp=se.version;if(sp!=="19.0.0")throw Error(ee(527,sp,"19.0.0"));ot.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(ee(188)):(i=Object.keys(i).join(","),Error(ee(268,i)));return i=Je(s),i=i!==null?St(i):null,i=i===null?null:i.stateNode,i};var zu={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:Dt,findFiberByHostInstance:Ss,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var eo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!eo.isDisabled&&eo.supportsFiber)try{ns=eo.inject(zu),dn=eo}catch{}}return Tf.createRoot=function(i,s){if(!Oe(i))throw Error(ee(299));var c=!1,p="",x=Kr,S=Ia,B=fa,q=null;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(p=s.identifierPrefix),s.onUncaughtError!==void 0&&(x=s.onUncaughtError),s.onCaughtError!==void 0&&(S=s.onCaughtError),s.onRecoverableError!==void 0&&(B=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(q=s.unstable_transitionCallbacks)),s=Te(i,1,!1,null,null,c,p,x,S,B,q,null),i[na]=s.current,dd(i.nodeType===8?i.parentNode:i),new zl(s)},Tf.hydrateRoot=function(i,s,c){if(!Oe(i))throw Error(ee(299));var p=!1,x="",S=Kr,B=Ia,q=fa,ne=null,me=null;return c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(S=c.onUncaughtError),c.onCaughtError!==void 0&&(B=c.onCaughtError),c.onRecoverableError!==void 0&&(q=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(ne=c.unstable_transitionCallbacks),c.formState!==void 0&&(me=c.formState)),s=Te(i,1,!0,s,c??null,p,x,S,B,q,ne,me),s.context=qe(null),c=s.current,p=Zn(),x=fl(p),x.callback=null,Ys(c,x,p),s.current.lanes=p,pt(s,p),xs(s),i[na]=s.current,dd(i),new _a(s)},Tf.version="19.0.0",Tf}var Xp;function dg(){if(Xp)return Cp.exports;Xp=1;function Z(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Z)}catch(se){console.error(se)}}return Z(),Cp.exports=hg(),Cp.exports}var fg=dg();const pg=fg.createRoot(document.getElementById("root"));pg.render(Fe.jsx(bd.StrictMode,{children:Fe.jsx(sg,{})}));</script>
    <style rel="stylesheet" crossorigin>/*! tailwindcss v4.0.14 | MIT License | https://tailwindcss.com */@layer theme{:root,:host{--font-sans:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--font-mono:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--color-green-300:oklch(.871 .15 154.449);--color-green-500:oklch(.723 .219 149.579);--color-green-900:oklch(.393 .095 152.535);--color-gray-400:oklch(.707 .022 261.325);--color-gray-500:oklch(.551 .027 264.364);--color-gray-700:oklch(.373 .034 259.733);--color-gray-800:oklch(.278 .033 256.848);--color-neutral-900:oklch(.205 0 0);--color-black:#000;--color-white:#fff;--spacing:.25rem;--container-3xl:48rem;--text-xs:.75rem;--text-xs--line-height:calc(1/.75);--text-sm:.875rem;--text-sm--line-height:calc(1.25/.875);--text-lg:1.125rem;--text-lg--line-height:calc(1.75/1.125);--text-xl:1.25rem;--text-xl--line-height:calc(1.75/1.25);--font-weight-semibold:600;--font-weight-black:900;--tracking-tight:-.025em;--ease-out:cubic-bezier(0,0,.2,1);--default-transition-duration:.15s;--default-transition-timing-function:cubic-bezier(.4,0,.2,1);--default-font-family:var(--font-sans);--default-font-feature-settings:var(--font-sans--font-feature-settings);--default-font-variation-settings:var(--font-sans--font-variation-settings);--default-mono-font-family:var(--font-mono);--default-mono-font-feature-settings:var(--font-mono--font-feature-settings);--default-mono-font-variation-settings:var(--font-mono--font-variation-settings)}}@layer base{*,:after,:before,::backdrop{box-sizing:border-box;border:0 solid;margin:0;padding:0}::file-selector-button{box-sizing:border-box;border:0 solid;margin:0;padding:0}html,:host{-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;line-height:1.5;font-family:var(--default-font-family,ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji");font-feature-settings:var(--default-font-feature-settings,normal);font-variation-settings:var(--default-font-variation-settings,normal);-webkit-tap-highlight-color:transparent}body{line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;-webkit-text-decoration:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:var(--default-mono-font-family,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace);font-feature-settings:var(--default-mono-font-feature-settings,normal);font-variation-settings:var(--default-mono-font-variation-settings,normal);font-size:1em}small{font-size:80%}sub,sup{vertical-align:baseline;font-size:75%;line-height:0;position:relative}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}:-moz-focusring{outline:auto}progress{vertical-align:baseline}summary{display:list-item}ol,ul,menu{list-style:none}img,svg,video,canvas,audio,iframe,embed,object{vertical-align:middle;display:block}img,video{max-width:100%;height:auto}button,input,select,optgroup,textarea{font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;color:inherit;opacity:1;background-color:#0000;border-radius:0}::file-selector-button{font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;color:inherit;opacity:1;background-color:#0000;border-radius:0}:where(select:is([multiple],[size])) optgroup{font-weight:bolder}:where(select:is([multiple],[size])) optgroup option{padding-inline-start:20px}::file-selector-button{margin-inline-end:4px}::placeholder{opacity:1;color:color-mix(in oklab,currentColor 50%,transparent)}textarea{resize:vertical}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-date-and-time-value{min-height:1lh;text-align:inherit}::-webkit-datetime-edit{display:inline-flex}::-webkit-datetime-edit-fields-wrapper{padding:0}::-webkit-datetime-edit{padding-block:0}::-webkit-datetime-edit-year-field{padding-block:0}::-webkit-datetime-edit-month-field{padding-block:0}::-webkit-datetime-edit-day-field{padding-block:0}::-webkit-datetime-edit-hour-field{padding-block:0}::-webkit-datetime-edit-minute-field{padding-block:0}::-webkit-datetime-edit-second-field{padding-block:0}::-webkit-datetime-edit-millisecond-field{padding-block:0}::-webkit-datetime-edit-meridiem-field{padding-block:0}:-moz-ui-invalid{box-shadow:none}button,input:where([type=button],[type=reset],[type=submit]){-webkit-appearance:button;-moz-appearance:button;appearance:button}::file-selector-button{-webkit-appearance:button;-moz-appearance:button;appearance:button}::-webkit-inner-spin-button{height:auto}::-webkit-outer-spin-button{height:auto}[hidden]:where(:not([hidden=until-found])){display:none!important}}@layer components;@layer utilities{.collapse{visibility:collapse}.visible{visibility:visible}.absolute{position:absolute}.fixed{position:fixed}.relative{position:relative}.static{position:static}.sticky{position:sticky}.inset-0{inset:calc(var(--spacing)*0)}.top-0{top:calc(var(--spacing)*0)}.top-1{top:calc(var(--spacing)*1)}.top-1\/2{top:50%}.top-\[3\%\]{top:3%}.right-0{right:calc(var(--spacing)*0)}.bottom-0{bottom:calc(var(--spacing)*0)}.bottom-1{bottom:calc(var(--spacing)*1)}.bottom-\[4\%\]{bottom:4%}.left-0{left:calc(var(--spacing)*0)}.left-1{left:calc(var(--spacing)*1)}.left-1\/2{left:50%}.z-10{z-index:10}.container{width:100%}@media (width>=40rem){.container{max-width:40rem}}@media (width>=48rem){.container{max-width:48rem}}@media (width>=64rem){.container{max-width:64rem}}@media (width>=80rem){.container{max-width:80rem}}@media (width>=96rem){.container{max-width:96rem}}.m-1{margin:calc(var(--spacing)*1)}.mx-auto{margin-inline:auto}.mr-2{margin-right:calc(var(--spacing)*2)}.ml-2{margin-left:calc(var(--spacing)*2)}.block{display:block}.contents{display:contents}.flex{display:flex}.flow-root{display:flow-root}.grid{display:grid}.hidden{display:none}.inline{display:inline}.inline-block{display:inline-block}.inline-flex{display:inline-flex}.inline-grid{display:inline-grid}.inline-table{display:inline-table}.list-item{display:list-item}.table{display:table}.table-caption{display:table-caption}.table-cell{display:table-cell}.table-column{display:table-column}.table-column-group{display:table-column-group}.table-footer-group{display:table-footer-group}.table-header-group{display:table-header-group}.table-row{display:table-row}.table-row-group{display:table-row-group}.aspect-5\/3{aspect-ratio:5/3}.aspect-square{aspect-ratio:1}.size-4{width:calc(var(--spacing)*4);height:calc(var(--spacing)*4)}.size-10{width:calc(var(--spacing)*10);height:calc(var(--spacing)*10)}.h-0{height:calc(var(--spacing)*0)}.h-1{height:calc(var(--spacing)*1)}.h-1\/2{height:50%}.h-5{height:calc(var(--spacing)*5)}.h-10{height:calc(var(--spacing)*10)}.h-auto{height:auto}.h-full{height:100%}.h-px{height:1px}.h-screen{height:100vh}.max-h-1{max-height:calc(var(--spacing)*1)}.max-h-1\/2{max-height:50%}.max-h-full{max-height:100%}.w-0{width:calc(var(--spacing)*0)}.w-1{width:calc(var(--spacing)*1)}.w-1\/4{width:25%}.w-2{width:calc(var(--spacing)*2)}.w-2\/6{width:33.3333%}.w-4{width:calc(var(--spacing)*4)}.w-4\/6{width:66.6667%}.w-20{width:calc(var(--spacing)*20)}.w-25{width:calc(var(--spacing)*25)}.w-full{width:100%}.w-screen{width:100vw}.max-w-3xl{max-width:var(--container-3xl)}.flex-1{flex:1}.-translate-x-1{--tw-translate-x:calc(var(--spacing)*-1);translate:var(--tw-translate-x)var(--tw-translate-y)}.-translate-x-1\/2{--tw-translate-x: -50% ;translate:var(--tw-translate-x)var(--tw-translate-y)}.-translate-y-1{--tw-translate-y:calc(var(--spacing)*-1);translate:var(--tw-translate-x)var(--tw-translate-y)}.-translate-y-1\/2{--tw-translate-y: -50% ;translate:var(--tw-translate-x)var(--tw-translate-y)}.scale-5{--tw-scale-x:5%;--tw-scale-y:5%;--tw-scale-z:5%;scale:var(--tw-scale-x)var(--tw-scale-y)}.scale-10{--tw-scale-x:10%;--tw-scale-y:10%;--tw-scale-z:10%;scale:var(--tw-scale-x)var(--tw-scale-y)}.scale-75{--tw-scale-x:75%;--tw-scale-y:75%;--tw-scale-z:75%;scale:var(--tw-scale-x)var(--tw-scale-y)}.scale-100{--tw-scale-x:100%;--tw-scale-y:100%;--tw-scale-z:100%;scale:var(--tw-scale-x)var(--tw-scale-y)}.scale-x-\[-1\]{--tw-scale-x:-1;scale:var(--tw-scale-x)var(--tw-scale-y)}.rotate-180{rotate:180deg}.transform{transform:var(--tw-rotate-x)var(--tw-rotate-y)var(--tw-rotate-z)var(--tw-skew-x)var(--tw-skew-y)}.cursor-pointer{cursor:pointer}.resize{resize:both}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.grid-rows-3{grid-template-rows:repeat(3,minmax(0,1fr))}.flex-col{flex-direction:column}.items-center{align-items:center}.justify-between{justify-content:space-between}.justify-center{justify-content:center}:where(.space-y-2>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*2)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*2)*calc(1 - var(--tw-space-y-reverse)))}:where(.space-x-2>:not(:last-child)){--tw-space-x-reverse:0;margin-inline-start:calc(calc(var(--spacing)*2)*var(--tw-space-x-reverse));margin-inline-end:calc(calc(var(--spacing)*2)*calc(1 - var(--tw-space-x-reverse)))}:where(.divide-x>:not(:last-child)){--tw-divide-x-reverse:0;border-inline-style:var(--tw-border-style);border-inline-start-width:calc(1px*var(--tw-divide-x-reverse));border-inline-end-width:calc(1px*calc(1 - var(--tw-divide-x-reverse)))}:where(.divide-y>:not(:last-child)){--tw-divide-y-reverse:0;border-bottom-style:var(--tw-border-style);border-top-style:var(--tw-border-style);border-top-width:calc(1px*var(--tw-divide-y-reverse));border-bottom-width:calc(1px*calc(1 - var(--tw-divide-y-reverse)))}:where(.divide-gray-400>:not(:last-child)){border-color:var(--color-gray-400)}.overflow-hidden{overflow:hidden}.overflow-y-auto{overflow-y:auto}.border{border-style:var(--tw-border-style);border-width:1px}.border-x{border-inline-style:var(--tw-border-style);border-inline-width:1px}.border-t{border-top-style:var(--tw-border-style);border-top-width:1px}.border-t-\[8px\]{border-top-style:var(--tw-border-style);border-top-width:8px}.border-r-\[12px\]{border-right-style:var(--tw-border-style);border-right-width:12px}.border-b{border-bottom-style:var(--tw-border-style);border-bottom-width:1px}.border-b-\[8px\]{border-bottom-style:var(--tw-border-style);border-bottom-width:8px}.border-l{border-left-style:var(--tw-border-style);border-left-width:1px}.border-l-\[12px\]{border-left-style:var(--tw-border-style);border-left-width:12px}.border-gray-400{border-color:var(--color-gray-400)}.border-green-500{border-color:var(--color-green-500)}.border-t-transparent{border-top-color:#0000}.border-r-green-500{border-right-color:var(--color-green-500)}.border-b-transparent{border-bottom-color:#0000}.border-l-green-500{border-left-color:var(--color-green-500)}.bg-black{background-color:var(--color-black)}.bg-gray-800{background-color:var(--color-gray-800)}.bg-green-500{background-color:var(--color-green-500)}.bg-neutral-900{background-color:var(--color-neutral-900)}.fill-black{fill:var(--color-black)}.stroke-gray-500{stroke:var(--color-gray-500)}.p-2{padding:calc(var(--spacing)*2)}.p-6{padding:calc(var(--spacing)*6)}.px-4{padding-inline:calc(var(--spacing)*4)}.py-2{padding-block:calc(var(--spacing)*2)}.pl-4{padding-left:calc(var(--spacing)*4)}.text-center{text-align:center}.text-justify{text-align:justify}.font-mono{font-family:var(--font-mono)}.text-lg{font-size:var(--text-lg);line-height:var(--tw-leading,var(--text-lg--line-height))}.text-sm{font-size:var(--text-sm);line-height:var(--tw-leading,var(--text-sm--line-height))}.text-xl{font-size:var(--text-xl);line-height:var(--tw-leading,var(--text-xl--line-height))}.text-xs{font-size:var(--text-xs);line-height:var(--tw-leading,var(--text-xs--line-height))}.font-black{--tw-font-weight:var(--font-weight-black);font-weight:var(--font-weight-black)}.font-semibold{--tw-font-weight:var(--font-weight-semibold);font-weight:var(--font-weight-semibold)}.tracking-tight{--tw-tracking:var(--tracking-tight);letter-spacing:var(--tracking-tight)}.break-all{word-break:break-all}.whitespace-pre{white-space:pre}.text-gray-400{color:var(--color-gray-400)}.text-gray-700{color:var(--color-gray-700)}.text-green-500{color:var(--color-green-500)}.text-white{color:var(--color-white)}.capitalize{text-transform:capitalize}.lowercase{text-transform:lowercase}.uppercase{text-transform:uppercase}.italic{font-style:italic}.line-through{text-decoration-line:line-through}.overline{text-decoration-line:overline}.underline{text-decoration-line:underline}.ring{--tw-ring-shadow:var(--tw-ring-inset,)0 0 0 calc(1px + var(--tw-ring-offset-width))var(--tw-ring-color,currentColor);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.-outline-offset-1{outline-offset:-1px}.blur{--tw-blur:blur(8px);filter:var(--tw-blur,)var(--tw-brightness,)var(--tw-contrast,)var(--tw-grayscale,)var(--tw-hue-rotate,)var(--tw-invert,)var(--tw-saturate,)var(--tw-sepia,)var(--tw-drop-shadow,)}.invert{--tw-invert:invert(100%);filter:var(--tw-blur,)var(--tw-brightness,)var(--tw-contrast,)var(--tw-grayscale,)var(--tw-hue-rotate,)var(--tw-invert,)var(--tw-saturate,)var(--tw-sepia,)var(--tw-drop-shadow,)}.filter{filter:var(--tw-blur,)var(--tw-brightness,)var(--tw-contrast,)var(--tw-grayscale,)var(--tw-hue-rotate,)var(--tw-invert,)var(--tw-saturate,)var(--tw-sepia,)var(--tw-drop-shadow,)}.transition{transition-property:color,background-color,border-color,outline-color,text-decoration-color,fill,stroke,--tw-gradient-from,--tw-gradient-via,--tw-gradient-to,opacity,box-shadow,transform,translate,scale,rotate,filter,-webkit-backdrop-filter,backdrop-filter;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function));transition-duration:var(--tw-duration,var(--default-transition-duration))}.transition-colors{transition-property:color,background-color,border-color,outline-color,text-decoration-color,fill,stroke,--tw-gradient-from,--tw-gradient-via,--tw-gradient-to;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function));transition-duration:var(--tw-duration,var(--default-transition-duration))}.ease-out{--tw-ease:var(--ease-out);transition-timing-function:var(--ease-out)}.select-none{-webkit-user-select:none;user-select:none}.selection\:bg-green-300 ::selection{background-color:var(--color-green-300)}.selection\:bg-green-300::selection{background-color:var(--color-green-300)}.selection\:text-black ::selection{color:var(--color-black)}.selection\:text-black::selection{color:var(--color-black)}.last\:border-b:last-child{border-bottom-style:var(--tw-border-style);border-bottom-width:1px}.last\:border-gray-400:last-child{border-color:var(--color-gray-400)}@media (hover:hover){.hover\:bg-green-900:hover{background-color:var(--color-green-900)}}.focus\:bg-green-900:focus{background-color:var(--color-green-900)}.focus\:ring:focus{--tw-ring-shadow:var(--tw-ring-inset,)0 0 0 calc(1px + var(--tw-ring-offset-width))var(--tw-ring-color,currentColor);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.focus\:ring-green-500:focus{--tw-ring-color:var(--color-green-500)}.focus\:ring-offset-2:focus{--tw-ring-offset-width:2px;--tw-ring-offset-shadow:var(--tw-ring-inset,)0 0 0 var(--tw-ring-offset-width)var(--tw-ring-offset-color)}.focus\:ring-offset-gray-800:focus{--tw-ring-offset-color:var(--color-gray-800)}.focus\:outline-none:focus{--tw-outline-style:none;outline-style:none}@media (width>=48rem){.md\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}}@media (width>=64rem){.lg\:last\:border-r:last-child{border-right-style:var(--tw-border-style);border-right-width:1px}}@media (width>=80rem){.xl\:grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}}@media print{.print\:bottom-\[6\%\]{bottom:6%}.print\:hidden{display:none}.print\:w-full{width:100%}.print\:border-black{border-color:var(--color-black)}.print\:border-r-black{border-right-color:var(--color-black)}.print\:border-l-black{border-left-color:var(--color-black)}.print\:bg-white{background-color:var(--color-white)}.print\:fill-white{fill:var(--color-white)}.print\:text-black{color:var(--color-black)}}}input[type=number]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}@media print{.print-text-black{color:#000!important}.print-bg-black{background-color:#000!important}.print-bg-black-dotted{background-image:linear-gradient(90deg,#000 50%,#0000 50%)!important;background-repeat:repeat-x!important;background-size:10px 1px!important}}@property --tw-translate-x{syntax:"*";inherits:false;initial-value:0}@property --tw-translate-y{syntax:"*";inherits:false;initial-value:0}@property --tw-translate-z{syntax:"*";inherits:false;initial-value:0}@property --tw-scale-x{syntax:"*";inherits:false;initial-value:1}@property --tw-scale-y{syntax:"*";inherits:false;initial-value:1}@property --tw-scale-z{syntax:"*";inherits:false;initial-value:1}@property --tw-rotate-x{syntax:"*";inherits:false;initial-value:rotateX(0)}@property --tw-rotate-y{syntax:"*";inherits:false;initial-value:rotateY(0)}@property --tw-rotate-z{syntax:"*";inherits:false;initial-value:rotateZ(0)}@property --tw-skew-x{syntax:"*";inherits:false;initial-value:skewX(0)}@property --tw-skew-y{syntax:"*";inherits:false;initial-value:skewY(0)}@property --tw-space-y-reverse{syntax:"*";inherits:false;initial-value:0}@property --tw-space-x-reverse{syntax:"*";inherits:false;initial-value:0}@property --tw-divide-x-reverse{syntax:"*";inherits:false;initial-value:0}@property --tw-border-style{syntax:"*";inherits:false;initial-value:solid}@property --tw-divide-y-reverse{syntax:"*";inherits:false;initial-value:0}@property --tw-font-weight{syntax:"*";inherits:false}@property --tw-tracking{syntax:"*";inherits:false}@property --tw-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-shadow-color{syntax:"*";inherits:false}@property --tw-inset-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-inset-shadow-color{syntax:"*";inherits:false}@property --tw-ring-color{syntax:"*";inherits:false}@property --tw-ring-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-inset-ring-color{syntax:"*";inherits:false}@property --tw-inset-ring-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-ring-inset{syntax:"*";inherits:false}@property --tw-ring-offset-width{syntax:"<length>";inherits:false;initial-value:0}@property --tw-ring-offset-color{syntax:"*";inherits:false;initial-value:#fff}@property --tw-ring-offset-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-blur{syntax:"*";inherits:false}@property --tw-brightness{syntax:"*";inherits:false}@property --tw-contrast{syntax:"*";inherits:false}@property --tw-grayscale{syntax:"*";inherits:false}@property --tw-hue-rotate{syntax:"*";inherits:false}@property --tw-invert{syntax:"*";inherits:false}@property --tw-opacity{syntax:"*";inherits:false}@property --tw-saturate{syntax:"*";inherits:false}@property --tw-sepia{syntax:"*";inherits:false}@property --tw-drop-shadow{syntax:"*";inherits:false}@property --tw-ease{syntax:"*";inherits:false}.maplibregl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgb(0 0 0/0)}.maplibregl-canvas{left:0;position:absolute;top:0}.maplibregl-map:fullscreen{height:100%;width:100%}.maplibregl-ctrl-group button.maplibregl-ctrl-compass{touch-action:none}.maplibregl-canvas-container.maplibregl-interactive,.maplibregl-ctrl-group button.maplibregl-ctrl-compass{cursor:grab;-webkit-user-select:none;-moz-user-select:none;user-select:none}.maplibregl-canvas-container.maplibregl-interactive.maplibregl-track-pointer{cursor:pointer}.maplibregl-canvas-container.maplibregl-interactive:active,.maplibregl-ctrl-group button.maplibregl-ctrl-compass:active{cursor:grabbing}.maplibregl-canvas-container.maplibregl-touch-zoom-rotate,.maplibregl-canvas-container.maplibregl-touch-zoom-rotate .maplibregl-canvas{touch-action:pan-x pan-y}.maplibregl-canvas-container.maplibregl-touch-drag-pan,.maplibregl-canvas-container.maplibregl-touch-drag-pan .maplibregl-canvas{touch-action:pinch-zoom}.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan,.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan .maplibregl-canvas{touch-action:none}.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures,.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures .maplibregl-canvas{touch-action:pan-x pan-y}.maplibregl-ctrl-bottom-left,.maplibregl-ctrl-bottom-right,.maplibregl-ctrl-top-left,.maplibregl-ctrl-top-right{pointer-events:none;position:absolute;z-index:2}.maplibregl-ctrl-top-left{left:0;top:0}.maplibregl-ctrl-top-right{right:0;top:0}.maplibregl-ctrl-bottom-left{bottom:0;left:0}.maplibregl-ctrl-bottom-right{bottom:0;right:0}.maplibregl-ctrl{clear:both;pointer-events:auto;transform:translate(0)}.maplibregl-ctrl-top-left .maplibregl-ctrl{float:left;margin:10px 0 0 10px}.maplibregl-ctrl-top-right .maplibregl-ctrl{float:right;margin:10px 10px 0 0}.maplibregl-ctrl-bottom-left .maplibregl-ctrl{float:left;margin:0 0 10px 10px}.maplibregl-ctrl-bottom-right .maplibregl-ctrl{float:right;margin:0 10px 10px 0}.maplibregl-ctrl-group{background:#fff;border-radius:4px}.maplibregl-ctrl-group:not(:empty){box-shadow:0 0 0 2px #0000001a}@media (forced-colors:active){.maplibregl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.maplibregl-ctrl-group button{background-color:transparent;border:0;box-sizing:border-box;cursor:pointer;display:block;height:29px;outline:none;padding:0;width:29px}.maplibregl-ctrl-group button+button{border-top:1px solid #ddd}.maplibregl-ctrl button .maplibregl-ctrl-icon{background-position:50%;background-repeat:no-repeat;display:block;height:100%;width:100%}@media (forced-colors:active){.maplibregl-ctrl-icon{background-color:transparent}.maplibregl-ctrl-group button+button{border-top:1px solid ButtonText}}.maplibregl-ctrl button::-moz-focus-inner{border:0;padding:0}.maplibregl-ctrl-attrib-button:focus,.maplibregl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.maplibregl-ctrl button:disabled{cursor:not-allowed}.maplibregl-ctrl button:disabled .maplibregl-ctrl-icon{opacity:.25}@media (hover:hover){.maplibregl-ctrl button:not(:disabled):hover{background-color:#0000000d}}.maplibregl-ctrl button:not(:disabled):active{background-color:#0000000d}.maplibregl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.maplibregl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.maplibregl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.maplibregl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.maplibregl-ctrl-group button:focus:only-child{border-radius:inherit}.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5'/%3E%3C/svg%3E")}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5'/%3E%3C/svg%3E")}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5'/%3E%3C/svg%3E")}}.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1z'/%3E%3C/svg%3E")}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1z'/%3E%3C/svg%3E")}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1z'/%3E%3C/svg%3E")}}.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='m10.5 14 4-8 4 8z'/%3E%3Cpath fill='%23ccc' d='m10.5 16 4 8 4-8z'/%3E%3C/svg%3E")}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='m10.5 14 4-8 4 8z'/%3E%3Cpath fill='%23ccc' d='m10.5 16 4 8 4-8z'/%3E%3C/svg%3E")}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='m10.5 14 4-8 4 8z'/%3E%3Cpath fill='%23ccc' d='m10.5 16 4 8 4-8z'/%3E%3C/svg%3E")}}.maplibregl-ctrl button.maplibregl-ctrl-globe .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' fill='none' stroke='%23333' viewBox='0 0 22 22'%3E%3Ccircle cx='11' cy='11' r='8.5'/%3E%3Cpath d='M17.5 11c0 4.819-3.02 8.5-6.5 8.5S4.5 15.819 4.5 11 7.52 2.5 11 2.5s6.5 3.681 6.5 8.5Z'/%3E%3Cpath d='M13.5 11c0 2.447-.331 4.64-.853 6.206-.262.785-.562 1.384-.872 1.777-.314.399-.58.517-.775.517s-.461-.118-.775-.517c-.31-.393-.61-.992-.872-1.777C8.831 15.64 8.5 13.446 8.5 11s.331-4.64.853-6.206c.262-.785.562-1.384.872-1.777.314-.399.58-.517.775-.517s.461.118.775.517c.31.393.61.992.872 1.777.522 1.565.853 3.76.853 6.206Z'/%3E%3Cpath d='M11 7.5c-1.909 0-3.622-.166-4.845-.428-.616-.132-1.08-.283-1.379-.434a1.3 1.3 0 0 1-.224-.138q.07-.058.224-.138c.299-.151.763-.302 1.379-.434C7.378 5.666 9.091 5.5 11 5.5s3.622.166 4.845.428c.616.132 1.08.283 1.379.434.105.053.177.1.224.138q-.07.058-.224.138c-.299.151-.763.302-1.379.434-1.223.262-2.936.428-4.845.428ZM4.486 6.436ZM11 16.5c-1.909 0-3.622-.166-4.845-.428-.616-.132-1.08-.283-1.379-.434a1.3 1.3 0 0 1-.224-.138 1.3 1.3 0 0 1 .224-.138c.299-.151.763-.302 1.379-.434C7.378 14.666 9.091 14.5 11 14.5s3.622.166 4.845.428c.616.132 1.08.283 1.379.434.105.053.177.1.224.138a1.3 1.3 0 0 1-.224.138c-.299.151-.763.302-1.379.434-1.223.262-2.936.428-4.845.428Zm-6.514-1.064ZM11 12.5c-2.46 0-4.672-.222-6.255-.574-.796-.177-1.406-.38-1.805-.59a1.5 1.5 0 0 1-.39-.272.3.3 0 0 1-.047-.064.3.3 0 0 1 .048-.064c.066-.073.189-.167.389-.272.399-.21 1.009-.413 1.805-.59C6.328 9.722 8.54 9.5 11 9.5s4.672.222 6.256.574c.795.177 1.405.38 1.804.59.2.105.323.2.39.272a.3.3 0 0 1 .047.064.3.3 0 0 1-.048.064 1.4 1.4 0 0 1-.389.272c-.399.21-1.009.413-1.804.59-1.584.352-3.796.574-6.256.574Zm-8.501-1.51v.002zm0 .018v.002zm17.002.002v-.002zm0-.018v-.002z'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-globe-enabled .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' fill='none' stroke='%2333b5e5' viewBox='0 0 22 22'%3E%3Ccircle cx='11' cy='11' r='8.5'/%3E%3Cpath d='M17.5 11c0 4.819-3.02 8.5-6.5 8.5S4.5 15.819 4.5 11 7.52 2.5 11 2.5s6.5 3.681 6.5 8.5Z'/%3E%3Cpath d='M13.5 11c0 2.447-.331 4.64-.853 6.206-.262.785-.562 1.384-.872 1.777-.314.399-.58.517-.775.517s-.461-.118-.775-.517c-.31-.393-.61-.992-.872-1.777C8.831 15.64 8.5 13.446 8.5 11s.331-4.64.853-6.206c.262-.785.562-1.384.872-1.777.314-.399.58-.517.775-.517s.461.118.775.517c.31.393.61.992.872 1.777.522 1.565.853 3.76.853 6.206Z'/%3E%3Cpath d='M11 7.5c-1.909 0-3.622-.166-4.845-.428-.616-.132-1.08-.283-1.379-.434a1.3 1.3 0 0 1-.224-.138q.07-.058.224-.138c.299-.151.763-.302 1.379-.434C7.378 5.666 9.091 5.5 11 5.5s3.622.166 4.845.428c.616.132 1.08.283 1.379.434.105.053.177.1.224.138q-.07.058-.224.138c-.299.151-.763.302-1.379.434-1.223.262-2.936.428-4.845.428ZM4.486 6.436ZM11 16.5c-1.909 0-3.622-.166-4.845-.428-.616-.132-1.08-.283-1.379-.434a1.3 1.3 0 0 1-.224-.138 1.3 1.3 0 0 1 .224-.138c.299-.151.763-.302 1.379-.434C7.378 14.666 9.091 14.5 11 14.5s3.622.166 4.845.428c.616.132 1.08.283 1.379.434.105.053.177.1.224.138a1.3 1.3 0 0 1-.224.138c-.299.151-.763.302-1.379.434-1.223.262-2.936.428-4.845.428Zm-6.514-1.064ZM11 12.5c-2.46 0-4.672-.222-6.255-.574-.796-.177-1.406-.38-1.805-.59a1.5 1.5 0 0 1-.39-.272.3.3 0 0 1-.047-.064.3.3 0 0 1 .048-.064c.066-.073.189-.167.389-.272.399-.21 1.009-.413 1.805-.59C6.328 9.722 8.54 9.5 11 9.5s4.672.222 6.256.574c.795.177 1.405.38 1.804.59.2.105.323.2.39.272a.3.3 0 0 1 .047.064.3.3 0 0 1-.048.064 1.4 1.4 0 0 1-.389.272c-.399.21-1.009.413-1.804.59-1.584.352-3.796.574-6.256.574Zm-8.501-1.51v.002zm0 .018v.002zm17.002.002v-.002zm0-.018v-.002z'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-terrain .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' fill='%23333' viewBox='0 0 22 22'%3E%3Cpath d='m1.754 13.406 4.453-4.851 3.09 3.09 3.281 3.277.969-.969-3.309-3.312 3.844-4.121 6.148 6.886h1.082v-.855l-7.207-8.07-4.84 5.187L6.169 6.57l-5.48 5.965v.871ZM.688 16.844h20.625v1.375H.688Zm0 0'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-terrain-enabled .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' fill='%2333b5e5' viewBox='0 0 22 22'%3E%3Cpath d='m1.754 13.406 4.453-4.851 3.09 3.09 3.281 3.277.969-.969-3.309-3.312 3.844-4.121 6.148 6.886h1.082v-.855l-7.207-8.07-4.84 5.187L6.169 6.57l-5.48 5.965v.871ZM.688 16.844h20.625v1.375H.688Zm0 0'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23aaa' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1z'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e58978' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e54e33' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-waiting .maplibregl-ctrl-icon{animation:maplibregl-spin 2s linear infinite}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23999' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1z'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e58978' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e54e33' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3C/svg%3E")}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23666' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1z'/%3E%3C/svg%3E")}}@keyframes maplibregl-spin{0%{transform:rotate(0)}to{transform:rotate(1turn)}}a.maplibregl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.25 1.25 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.25 1.25 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5 5 0 0 1 .314-.787l.009-.016a4.6 4.6 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.6 4.6 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4q.47.48.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.42 2.42 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.45 2.45 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675q.318.302.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.8 4.8 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.4 3.4 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.25 1.25 0 0 1 .689 1.004 4.7 4.7 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528q-.001.515-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.8 5.8 0 0 1-.548-2.512q0-.429.053-.843a1.3 1.3 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.8 4.8 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.5 4.5 0 0 1-1.935-.424 1.25 1.25 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.4 2.4 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.7 4.7 0 0 1-1.782 1.884 4.77 4.77 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.5 4.5 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a5 5 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.25 1.25 0 0 1-1.115.676h-.098a1.25 1.25 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15q.493-.356.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267q-.133-.329-.526-.658l-.032-.028a3.2 3.2 0 0 0-.668-.428l-.27-.12a3.3 3.3 0 0 0-1.235-.23q-1.136-.001-1.974.493a3.36 3.36 0 0 0-1.3 1.382q-.445.89-.444 2.074 0 1.2.51 2.107a3.8 3.8 0 0 0 1.382 1.381 3.9 3.9 0 0 0 1.893.477q.795 0 1.455-.33zm-2.789-5.38q-.576.675-.575 1.762 0 1.102.559 1.794.576.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.2 2.2 0 0 0 .468-.29l.178-.161a2.2 2.2 0 0 0 .397-.561q.244-.5.244-1.15v-.115q0-.708-.296-1.267l-.043-.077a2.2 2.2 0 0 0-.633-.709l-.13-.086-.047-.028a2.1 2.1 0 0 0-1.073-.285q-1.052 0-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.96.96 0 0 0-.353-.389.85.85 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.6 2.6 0 0 0 .331.423q.319.33.755.548l.173.074q.65.255 1.49.255 1.02 0 1.844-.493a3.45 3.45 0 0 0 1.316-1.4q.493-.904.493-2.089 0-1.909-.988-2.913-.988-1.02-2.584-1.02-.898 0-1.575.347a3 3 0 0 0-.415.262l-.199.166a3.4 3.4 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138q.206.29.48.5l.155.11.053.034q.51.296 1.119.297 1.07 0 1.645-.675.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.435 0-.835.16a2 2 0 0 0-.284.136 2 2 0 0 0-.363.254 2.2 2.2 0 0 0-.46.569l-.082.162a2.6 2.6 0 0 0-.213 1.072v.115q0 .707.296 1.267l.135.211zm.964-.818a1.1 1.1 0 0 0 .367.385.94.94 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a1 1 0 0 0-.503.135l-.012.007a.86.86 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.4 1.4 0 0 0 .14.66zm15.7-6.222q.347-.346.346-.856a1.05 1.05 0 0 0-.345-.79 1.18 1.18 0 0 0-.84-.329q-.51 0-.855.33a1.05 1.05 0 0 0-.346.79q0 .51.346.855.345.346.856.346.51 0 .839-.346zm4.337 9.314.033-1.332q.191.403.59.747l.098.081a4 4 0 0 0 .316.224l.223.122a3.2 3.2 0 0 0 1.44.322 3.8 3.8 0 0 0 1.875-.477 3.5 3.5 0 0 0 1.382-1.366q.527-.89.526-2.09 0-1.184-.444-2.073a3.24 3.24 0 0 0-1.283-1.399q-.823-.51-1.942-.51a3.5 3.5 0 0 0-1.527.344l-.086.043-.165.09a3 3 0 0 0-.33.214q-.432.315-.656.707a2 2 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.5 2.5 0 0 0 .566.7q.117.098.245.18l.144.08a2.1 2.1 0 0 0 .975.232q1.07 0 1.645-.675.576-.69.576-1.778 0-1.102-.576-1.777-.56-.691-1.645-.692a2.2 2.2 0 0 0-1.015.235q-.22.113-.415.282l-.15.142a2.1 2.1 0 0 0-.42.594q-.223.479-.223 1.1v.115q0 .705.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.87.87 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.1 1.1 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013q.345-.13.724-.14l.069-.002q.493 0 .642.099l.247-1.794q-.196-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2 2 0 0 0-.411.148 2.2 2.2 0 0 0-.4.249 2.5 2.5 0 0 0-.485.499 2.7 2.7 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884q0-.546.159-.943a1.5 1.5 0 0 1 .466-.636 2.5 2.5 0 0 1 .399-.253 2 2 0 0 1 .224-.099zm9.784 2.656.05-.922q0-1.743-.856-2.698-.838-.97-2.584-.97-1.119-.001-2.007.493a3.46 3.46 0 0 0-1.4 1.382q-.493.906-.493 2.106 0 1.07.428 1.975.428.89 1.332 1.432.906.526 2.255.526.973 0 1.668-.185l.044-.012.135-.04q.613-.184.984-.421l-.542-1.267q-.3.162-.642.274l-.297.087q-.51.131-1.3.131-.954 0-1.497-.444a1.6 1.6 0 0 1-.192-.193q-.366-.44-.512-1.234l-.004-.021zm-5.427-1.256-.003.022h3.752v-.138q-.011-.727-.288-1.118a1 1 0 0 0-.156-.176q-.46-.428-1.316-.428-.986 0-1.494.604-.379.45-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81q-1.02 0-1.893-.478a3.8 3.8 0 0 1-1.381-1.382q-.51-.906-.51-2.106 0-1.185.444-2.074a3.36 3.36 0 0 1 1.3-1.382q.839-.494 1.974-.494a3.3 3.3 0 0 1 1.234.231 3.3 3.3 0 0 1 .97.575q.396.33.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332q-.279.593-1.02 1.053a3.17 3.17 0 0 1-1.662.444zm.296-1.482q.938 0 1.58-.642.642-.66.642-1.711v-.115q0-.708-.296-1.267a2.2 2.2 0 0 0-.807-.872 2.1 2.1 0 0 0-1.119-.313q-1.053 0-1.629.692-.575.675-.575 1.76 0 1.103.559 1.795.577.675 1.645.675zm6.521-6.237h1.711v1.4q.906-1.597 2.83-1.597 1.596 0 2.584 1.02.988 1.005.988 2.914 0 1.185-.493 2.09a3.46 3.46 0 0 1-1.316 1.399 3.5 3.5 0 0 1-1.844.493q-.954 0-1.662-.329a2.67 2.67 0 0 1-1.086-.97l.017 5.134h-1.728zm4.048 6.22q1.07 0 1.645-.674.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.592 0-1.12.296-.51.28-.822.823-.296.527-.296 1.234v.115q0 .708.296 1.267.313.543.823.855.51.296 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.16 1.16 0 0 1-.856-.346 1.17 1.17 0 0 1-.346-.856 1.05 1.05 0 0 1 .346-.79q.346-.329.856-.329.494 0 .839.33a1.05 1.05 0 0 1 .345.79 1.16 1.16 0 0 1-.345.855q-.33.346-.84.346zm7.875 9.133a3.17 3.17 0 0 1-1.662-.444q-.723-.46-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283q.279-.658 1.086-1.119a3.5 3.5 0 0 1 1.778-.477q1.119 0 1.942.51a3.24 3.24 0 0 1 1.283 1.4q.445.888.444 2.072 0 1.201-.526 2.09a3.5 3.5 0 0 1-1.382 1.366 3.8 3.8 0 0 1-1.876.477zm-.296-1.481q1.069 0 1.645-.675.577-.69.577-1.778 0-1.102-.577-1.776-.56-.691-1.645-.692a2.12 2.12 0 0 0-1.58.659q-.642.641-.642 1.694v.115q0 .71.296 1.267a2.4 2.4 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481q.263-.757.856-1.217a2.14 2.14 0 0 1 1.349-.46q.527 0 .724.098l-.247 1.794q-.149-.099-.642-.099-.774 0-1.416.494-.626.493-.626 1.58v3.883h-1.777V9.242zm9.534 7.718q-1.35 0-2.255-.526-.904-.543-1.332-1.432a4.6 4.6 0 0 1-.428-1.975q0-1.2.493-2.106a3.46 3.46 0 0 1 1.4-1.382q.889-.495 2.007-.494 1.744 0 2.584.97.855.956.856 2.7 0 .444-.05.92h-5.43q.18 1.005.708 1.45.542.443 1.497.443.79 0 1.3-.131a4 4 0 0 0 .938-.362l.542 1.267q-.411.263-1.119.46-.708.198-1.711.197zm1.596-4.558q.016-1.02-.444-1.432-.46-.428-1.316-.428-1.728 0-1.991 1.86z'/%3E%3Cpath d='M5.074 15.948a.484.657 0 0 0-.486.659v1.84a.484.657 0 0 0 .486.659h4.101a.484.657 0 0 0 .486-.659v-1.84a.484.657 0 0 0-.486-.659zm3.56 1.16H5.617v.838h3.017z' style='fill:%23fff;fill-rule:evenodd;stroke-width:1.03600001'/%3E%3Cg style='stroke-width:1.12603545'%3E%3Cpath d='M-9.408-1.416c-3.833-.025-7.056 2.912-7.08 6.615-.02 3.08 1.653 4.832 3.107 6.268.903.892 1.721 1.74 2.32 2.902l-.525-.004c-.543-.003-.992.304-1.24.639a1.87 1.87 0 0 0-.362 1.121l-.011 1.877c-.003.402.104.787.347 1.125.244.338.688.653 1.23.656l4.142.028c.542.003.99-.306 1.238-.641a1.87 1.87 0 0 0 .363-1.121l.012-1.875a1.87 1.87 0 0 0-.348-1.127c-.243-.338-.688-.653-1.23-.656l-.518-.004c.597-1.145 1.425-1.983 2.348-2.87 1.473-1.414 3.18-3.149 3.2-6.226-.016-3.59-2.923-6.684-6.993-6.707m-.006 1.1v.002c3.274.02 5.92 2.532 5.9 5.6-.017 2.706-1.39 4.026-2.863 5.44-1.034.994-2.118 2.033-2.814 3.633-.018.041-.052.055-.075.065q-.013.004-.02.01a.34.34 0 0 1-.226.084.34.34 0 0 1-.224-.086l-.092-.077c-.699-1.615-1.768-2.669-2.781-3.67-1.454-1.435-2.797-2.762-2.78-5.478.02-3.067 2.7-5.545 5.975-5.523m-.02 2.826c-1.62-.01-2.944 1.315-2.955 2.96-.01 1.646 1.295 2.988 2.916 2.999h.002c1.621.01 2.943-1.316 2.953-2.961.011-1.646-1.294-2.988-2.916-2.998m-.005 1.1c1.017.006 1.829.83 1.822 1.89s-.83 1.874-1.848 1.867c-1.018-.006-1.829-.83-1.822-1.89s.83-1.874 1.848-1.868m-2.155 11.857 4.14.025c.271.002.49.305.487.676l-.013 1.875c-.003.37-.224.67-.495.668l-4.14-.025c-.27-.002-.487-.306-.485-.676l.012-1.875c.003-.37.224-.67.494-.668' style='color:%23000;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:%23000;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:evenodd;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:%23000;solid-opacity:1;vector-effect:none;fill:%23000;fill-opacity:.4;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-9.415-.316C-12.69-.338-15.37 2.14-15.39 5.207c-.017 2.716 1.326 4.041 2.78 5.477 1.013 1 2.081 2.055 2.78 3.67l.092.076a.34.34 0 0 0 .225.086.34.34 0 0 0 .227-.083l.019-.01c.022-.009.057-.024.074-.064.697-1.6 1.78-2.64 2.814-3.634 1.473-1.414 2.847-2.733 2.864-5.44.02-3.067-2.627-5.58-5.901-5.601m-.057 8.784c1.621.011 2.944-1.315 2.955-2.96.01-1.646-1.295-2.988-2.916-2.999-1.622-.01-2.945 1.315-2.955 2.96s1.295 2.989 2.916 3' style='clip-rule:evenodd;fill:%23e1e3e9;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-11.594 15.465c-.27-.002-.492.297-.494.668l-.012 1.876c-.003.371.214.673.485.675l4.14.027c.271.002.492-.298.495-.668l.012-1.877c.003-.37-.215-.672-.485-.674z' style='clip-rule:evenodd;fill:%23fff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3C/g%3E%3C/svg%3E");background-repeat:no-repeat;cursor:pointer;display:block;height:23px;margin:0 0 -4px -4px;overflow:hidden;width:88px}a.maplibregl-ctrl-logo.maplibregl-compact{width:14px}@media (forced-colors:active){a.maplibregl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.25 1.25 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.25 1.25 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5 5 0 0 1 .314-.787l.009-.016a4.6 4.6 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.6 4.6 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4q.47.48.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.42 2.42 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.45 2.45 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675q.318.302.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.8 4.8 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.4 3.4 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.25 1.25 0 0 1 .689 1.004 4.7 4.7 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528q-.001.515-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.8 5.8 0 0 1-.548-2.512q0-.429.053-.843a1.3 1.3 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.8 4.8 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.5 4.5 0 0 1-1.935-.424 1.25 1.25 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.4 2.4 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.7 4.7 0 0 1-1.782 1.884 4.77 4.77 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.5 4.5 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a5 5 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.25 1.25 0 0 1-1.115.676h-.098a1.25 1.25 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15q.493-.356.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267q-.133-.329-.526-.658l-.032-.028a3.2 3.2 0 0 0-.668-.428l-.27-.12a3.3 3.3 0 0 0-1.235-.23q-1.136-.001-1.974.493a3.36 3.36 0 0 0-1.3 1.382q-.445.89-.444 2.074 0 1.2.51 2.107a3.8 3.8 0 0 0 1.382 1.381 3.9 3.9 0 0 0 1.893.477q.795 0 1.455-.33zm-2.789-5.38q-.576.675-.575 1.762 0 1.102.559 1.794.576.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.2 2.2 0 0 0 .468-.29l.178-.161a2.2 2.2 0 0 0 .397-.561q.244-.5.244-1.15v-.115q0-.708-.296-1.267l-.043-.077a2.2 2.2 0 0 0-.633-.709l-.13-.086-.047-.028a2.1 2.1 0 0 0-1.073-.285q-1.052 0-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.96.96 0 0 0-.353-.389.85.85 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.6 2.6 0 0 0 .331.423q.319.33.755.548l.173.074q.65.255 1.49.255 1.02 0 1.844-.493a3.45 3.45 0 0 0 1.316-1.4q.493-.904.493-2.089 0-1.909-.988-2.913-.988-1.02-2.584-1.02-.898 0-1.575.347a3 3 0 0 0-.415.262l-.199.166a3.4 3.4 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138q.206.29.48.5l.155.11.053.034q.51.296 1.119.297 1.07 0 1.645-.675.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.435 0-.835.16a2 2 0 0 0-.284.136 2 2 0 0 0-.363.254 2.2 2.2 0 0 0-.46.569l-.082.162a2.6 2.6 0 0 0-.213 1.072v.115q0 .707.296 1.267l.135.211zm.964-.818a1.1 1.1 0 0 0 .367.385.94.94 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a1 1 0 0 0-.503.135l-.012.007a.86.86 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.4 1.4 0 0 0 .14.66zm15.7-6.222q.347-.346.346-.856a1.05 1.05 0 0 0-.345-.79 1.18 1.18 0 0 0-.84-.329q-.51 0-.855.33a1.05 1.05 0 0 0-.346.79q0 .51.346.855.345.346.856.346.51 0 .839-.346zm4.337 9.314.033-1.332q.191.403.59.747l.098.081a4 4 0 0 0 .316.224l.223.122a3.2 3.2 0 0 0 1.44.322 3.8 3.8 0 0 0 1.875-.477 3.5 3.5 0 0 0 1.382-1.366q.527-.89.526-2.09 0-1.184-.444-2.073a3.24 3.24 0 0 0-1.283-1.399q-.823-.51-1.942-.51a3.5 3.5 0 0 0-1.527.344l-.086.043-.165.09a3 3 0 0 0-.33.214q-.432.315-.656.707a2 2 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.5 2.5 0 0 0 .566.7q.117.098.245.18l.144.08a2.1 2.1 0 0 0 .975.232q1.07 0 1.645-.675.576-.69.576-1.778 0-1.102-.576-1.777-.56-.691-1.645-.692a2.2 2.2 0 0 0-1.015.235q-.22.113-.415.282l-.15.142a2.1 2.1 0 0 0-.42.594q-.223.479-.223 1.1v.115q0 .705.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.87.87 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.1 1.1 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013q.345-.13.724-.14l.069-.002q.493 0 .642.099l.247-1.794q-.196-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2 2 0 0 0-.411.148 2.2 2.2 0 0 0-.4.249 2.5 2.5 0 0 0-.485.499 2.7 2.7 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884q0-.546.159-.943a1.5 1.5 0 0 1 .466-.636 2.5 2.5 0 0 1 .399-.253 2 2 0 0 1 .224-.099zm9.784 2.656.05-.922q0-1.743-.856-2.698-.838-.97-2.584-.97-1.119-.001-2.007.493a3.46 3.46 0 0 0-1.4 1.382q-.493.906-.493 2.106 0 1.07.428 1.975.428.89 1.332 1.432.906.526 2.255.526.973 0 1.668-.185l.044-.012.135-.04q.613-.184.984-.421l-.542-1.267q-.3.162-.642.274l-.297.087q-.51.131-1.3.131-.954 0-1.497-.444a1.6 1.6 0 0 1-.192-.193q-.366-.44-.512-1.234l-.004-.021zm-5.427-1.256-.003.022h3.752v-.138q-.011-.727-.288-1.118a1 1 0 0 0-.156-.176q-.46-.428-1.316-.428-.986 0-1.494.604-.379.45-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81q-1.02 0-1.893-.478a3.8 3.8 0 0 1-1.381-1.382q-.51-.906-.51-2.106 0-1.185.444-2.074a3.36 3.36 0 0 1 1.3-1.382q.839-.494 1.974-.494a3.3 3.3 0 0 1 1.234.231 3.3 3.3 0 0 1 .97.575q.396.33.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332q-.279.593-1.02 1.053a3.17 3.17 0 0 1-1.662.444zm.296-1.482q.938 0 1.58-.642.642-.66.642-1.711v-.115q0-.708-.296-1.267a2.2 2.2 0 0 0-.807-.872 2.1 2.1 0 0 0-1.119-.313q-1.053 0-1.629.692-.575.675-.575 1.76 0 1.103.559 1.795.577.675 1.645.675zm6.521-6.237h1.711v1.4q.906-1.597 2.83-1.597 1.596 0 2.584 1.02.988 1.005.988 2.914 0 1.185-.493 2.09a3.46 3.46 0 0 1-1.316 1.399 3.5 3.5 0 0 1-1.844.493q-.954 0-1.662-.329a2.67 2.67 0 0 1-1.086-.97l.017 5.134h-1.728zm4.048 6.22q1.07 0 1.645-.674.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.592 0-1.12.296-.51.28-.822.823-.296.527-.296 1.234v.115q0 .708.296 1.267.313.543.823.855.51.296 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.16 1.16 0 0 1-.856-.346 1.17 1.17 0 0 1-.346-.856 1.05 1.05 0 0 1 .346-.79q.346-.329.856-.329.494 0 .839.33a1.05 1.05 0 0 1 .345.79 1.16 1.16 0 0 1-.345.855q-.33.346-.84.346zm7.875 9.133a3.17 3.17 0 0 1-1.662-.444q-.723-.46-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283q.279-.658 1.086-1.119a3.5 3.5 0 0 1 1.778-.477q1.119 0 1.942.51a3.24 3.24 0 0 1 1.283 1.4q.445.888.444 2.072 0 1.201-.526 2.09a3.5 3.5 0 0 1-1.382 1.366 3.8 3.8 0 0 1-1.876.477zm-.296-1.481q1.069 0 1.645-.675.577-.69.577-1.778 0-1.102-.577-1.776-.56-.691-1.645-.692a2.12 2.12 0 0 0-1.58.659q-.642.641-.642 1.694v.115q0 .71.296 1.267a2.4 2.4 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481q.263-.757.856-1.217a2.14 2.14 0 0 1 1.349-.46q.527 0 .724.098l-.247 1.794q-.149-.099-.642-.099-.774 0-1.416.494-.626.493-.626 1.58v3.883h-1.777V9.242zm9.534 7.718q-1.35 0-2.255-.526-.904-.543-1.332-1.432a4.6 4.6 0 0 1-.428-1.975q0-1.2.493-2.106a3.46 3.46 0 0 1 1.4-1.382q.889-.495 2.007-.494 1.744 0 2.584.97.855.956.856 2.7 0 .444-.05.92h-5.43q.18 1.005.708 1.45.542.443 1.497.443.79 0 1.3-.131a4 4 0 0 0 .938-.362l.542 1.267q-.411.263-1.119.46-.708.198-1.711.197zm1.596-4.558q.016-1.02-.444-1.432-.46-.428-1.316-.428-1.728 0-1.991 1.86z'/%3E%3Cpath d='M5.074 15.948a.484.657 0 0 0-.486.659v1.84a.484.657 0 0 0 .486.659h4.101a.484.657 0 0 0 .486-.659v-1.84a.484.657 0 0 0-.486-.659zm3.56 1.16H5.617v.838h3.017z' style='fill:%23fff;fill-rule:evenodd;stroke-width:1.03600001'/%3E%3Cg style='stroke-width:1.12603545'%3E%3Cpath d='M-9.408-1.416c-3.833-.025-7.056 2.912-7.08 6.615-.02 3.08 1.653 4.832 3.107 6.268.903.892 1.721 1.74 2.32 2.902l-.525-.004c-.543-.003-.992.304-1.24.639a1.87 1.87 0 0 0-.362 1.121l-.011 1.877c-.003.402.104.787.347 1.125.244.338.688.653 1.23.656l4.142.028c.542.003.99-.306 1.238-.641a1.87 1.87 0 0 0 .363-1.121l.012-1.875a1.87 1.87 0 0 0-.348-1.127c-.243-.338-.688-.653-1.23-.656l-.518-.004c.597-1.145 1.425-1.983 2.348-2.87 1.473-1.414 3.18-3.149 3.2-6.226-.016-3.59-2.923-6.684-6.993-6.707m-.006 1.1v.002c3.274.02 5.92 2.532 5.9 5.6-.017 2.706-1.39 4.026-2.863 5.44-1.034.994-2.118 2.033-2.814 3.633-.018.041-.052.055-.075.065q-.013.004-.02.01a.34.34 0 0 1-.226.084.34.34 0 0 1-.224-.086l-.092-.077c-.699-1.615-1.768-2.669-2.781-3.67-1.454-1.435-2.797-2.762-2.78-5.478.02-3.067 2.7-5.545 5.975-5.523m-.02 2.826c-1.62-.01-2.944 1.315-2.955 2.96-.01 1.646 1.295 2.988 2.916 2.999h.002c1.621.01 2.943-1.316 2.953-2.961.011-1.646-1.294-2.988-2.916-2.998m-.005 1.1c1.017.006 1.829.83 1.822 1.89s-.83 1.874-1.848 1.867c-1.018-.006-1.829-.83-1.822-1.89s.83-1.874 1.848-1.868m-2.155 11.857 4.14.025c.271.002.49.305.487.676l-.013 1.875c-.003.37-.224.67-.495.668l-4.14-.025c-.27-.002-.487-.306-.485-.676l.012-1.875c.003-.37.224-.67.494-.668' style='color:%23000;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:%23000;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:evenodd;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:%23000;solid-opacity:1;vector-effect:none;fill:%23000;fill-opacity:.4;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-9.415-.316C-12.69-.338-15.37 2.14-15.39 5.207c-.017 2.716 1.326 4.041 2.78 5.477 1.013 1 2.081 2.055 2.78 3.67l.092.076a.34.34 0 0 0 .225.086.34.34 0 0 0 .227-.083l.019-.01c.022-.009.057-.024.074-.064.697-1.6 1.78-2.64 2.814-3.634 1.473-1.414 2.847-2.733 2.864-5.44.02-3.067-2.627-5.58-5.901-5.601m-.057 8.784c1.621.011 2.944-1.315 2.955-2.96.01-1.646-1.295-2.988-2.916-2.999-1.622-.01-2.945 1.315-2.955 2.96s1.295 2.989 2.916 3' style='clip-rule:evenodd;fill:%23e1e3e9;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-11.594 15.465c-.27-.002-.492.297-.494.668l-.012 1.876c-.003.371.214.673.485.675l4.14.027c.271.002.492-.298.495-.668l.012-1.877c.003-.37-.215-.672-.485-.674z' style='clip-rule:evenodd;fill:%23fff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3C/g%3E%3C/svg%3E")}}@media (forced-colors:active) and (prefers-color-scheme:light){a.maplibregl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.25 1.25 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.25 1.25 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5 5 0 0 1 .314-.787l.009-.016a4.6 4.6 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.6 4.6 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4q.47.48.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.42 2.42 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.45 2.45 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675q.318.302.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.8 4.8 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.4 3.4 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.25 1.25 0 0 1 .689 1.004 4.7 4.7 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528q-.001.515-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.8 5.8 0 0 1-.548-2.512q0-.429.053-.843a1.3 1.3 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.8 4.8 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.5 4.5 0 0 1-1.935-.424 1.25 1.25 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.4 2.4 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.7 4.7 0 0 1-1.782 1.884 4.77 4.77 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.5 4.5 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a5 5 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.25 1.25 0 0 1-1.115.676h-.098a1.25 1.25 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15q.493-.356.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267q-.133-.329-.526-.658l-.032-.028a3.2 3.2 0 0 0-.668-.428l-.27-.12a3.3 3.3 0 0 0-1.235-.23q-1.136-.001-1.974.493a3.36 3.36 0 0 0-1.3 1.382q-.445.89-.444 2.074 0 1.2.51 2.107a3.8 3.8 0 0 0 1.382 1.381 3.9 3.9 0 0 0 1.893.477q.795 0 1.455-.33zm-2.789-5.38q-.576.675-.575 1.762 0 1.102.559 1.794.576.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.2 2.2 0 0 0 .468-.29l.178-.161a2.2 2.2 0 0 0 .397-.561q.244-.5.244-1.15v-.115q0-.708-.296-1.267l-.043-.077a2.2 2.2 0 0 0-.633-.709l-.13-.086-.047-.028a2.1 2.1 0 0 0-1.073-.285q-1.052 0-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.96.96 0 0 0-.353-.389.85.85 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.6 2.6 0 0 0 .331.423q.319.33.755.548l.173.074q.65.255 1.49.255 1.02 0 1.844-.493a3.45 3.45 0 0 0 1.316-1.4q.493-.904.493-2.089 0-1.909-.988-2.913-.988-1.02-2.584-1.02-.898 0-1.575.347a3 3 0 0 0-.415.262l-.199.166a3.4 3.4 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138q.206.29.48.5l.155.11.053.034q.51.296 1.119.297 1.07 0 1.645-.675.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.435 0-.835.16a2 2 0 0 0-.284.136 2 2 0 0 0-.363.254 2.2 2.2 0 0 0-.46.569l-.082.162a2.6 2.6 0 0 0-.213 1.072v.115q0 .707.296 1.267l.135.211zm.964-.818a1.1 1.1 0 0 0 .367.385.94.94 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a1 1 0 0 0-.503.135l-.012.007a.86.86 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.4 1.4 0 0 0 .14.66zm15.7-6.222q.347-.346.346-.856a1.05 1.05 0 0 0-.345-.79 1.18 1.18 0 0 0-.84-.329q-.51 0-.855.33a1.05 1.05 0 0 0-.346.79q0 .51.346.855.345.346.856.346.51 0 .839-.346zm4.337 9.314.033-1.332q.191.403.59.747l.098.081a4 4 0 0 0 .316.224l.223.122a3.2 3.2 0 0 0 1.44.322 3.8 3.8 0 0 0 1.875-.477 3.5 3.5 0 0 0 1.382-1.366q.527-.89.526-2.09 0-1.184-.444-2.073a3.24 3.24 0 0 0-1.283-1.399q-.823-.51-1.942-.51a3.5 3.5 0 0 0-1.527.344l-.086.043-.165.09a3 3 0 0 0-.33.214q-.432.315-.656.707a2 2 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.5 2.5 0 0 0 .566.7q.117.098.245.18l.144.08a2.1 2.1 0 0 0 .975.232q1.07 0 1.645-.675.576-.69.576-1.778 0-1.102-.576-1.777-.56-.691-1.645-.692a2.2 2.2 0 0 0-1.015.235q-.22.113-.415.282l-.15.142a2.1 2.1 0 0 0-.42.594q-.223.479-.223 1.1v.115q0 .705.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.87.87 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.1 1.1 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013q.345-.13.724-.14l.069-.002q.493 0 .642.099l.247-1.794q-.196-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2 2 0 0 0-.411.148 2.2 2.2 0 0 0-.4.249 2.5 2.5 0 0 0-.485.499 2.7 2.7 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884q0-.546.159-.943a1.5 1.5 0 0 1 .466-.636 2.5 2.5 0 0 1 .399-.253 2 2 0 0 1 .224-.099zm9.784 2.656.05-.922q0-1.743-.856-2.698-.838-.97-2.584-.97-1.119-.001-2.007.493a3.46 3.46 0 0 0-1.4 1.382q-.493.906-.493 2.106 0 1.07.428 1.975.428.89 1.332 1.432.906.526 2.255.526.973 0 1.668-.185l.044-.012.135-.04q.613-.184.984-.421l-.542-1.267q-.3.162-.642.274l-.297.087q-.51.131-1.3.131-.954 0-1.497-.444a1.6 1.6 0 0 1-.192-.193q-.366-.44-.512-1.234l-.004-.021zm-5.427-1.256-.003.022h3.752v-.138q-.011-.727-.288-1.118a1 1 0 0 0-.156-.176q-.46-.428-1.316-.428-.986 0-1.494.604-.379.45-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81q-1.02 0-1.893-.478a3.8 3.8 0 0 1-1.381-1.382q-.51-.906-.51-2.106 0-1.185.444-2.074a3.36 3.36 0 0 1 1.3-1.382q.839-.494 1.974-.494a3.3 3.3 0 0 1 1.234.231 3.3 3.3 0 0 1 .97.575q.396.33.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332q-.279.593-1.02 1.053a3.17 3.17 0 0 1-1.662.444zm.296-1.482q.938 0 1.58-.642.642-.66.642-1.711v-.115q0-.708-.296-1.267a2.2 2.2 0 0 0-.807-.872 2.1 2.1 0 0 0-1.119-.313q-1.053 0-1.629.692-.575.675-.575 1.76 0 1.103.559 1.795.577.675 1.645.675zm6.521-6.237h1.711v1.4q.906-1.597 2.83-1.597 1.596 0 2.584 1.02.988 1.005.988 2.914 0 1.185-.493 2.09a3.46 3.46 0 0 1-1.316 1.399 3.5 3.5 0 0 1-1.844.493q-.954 0-1.662-.329a2.67 2.67 0 0 1-1.086-.97l.017 5.134h-1.728zm4.048 6.22q1.07 0 1.645-.674.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.592 0-1.12.296-.51.28-.822.823-.296.527-.296 1.234v.115q0 .708.296 1.267.313.543.823.855.51.296 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.16 1.16 0 0 1-.856-.346 1.17 1.17 0 0 1-.346-.856 1.05 1.05 0 0 1 .346-.79q.346-.329.856-.329.494 0 .839.33a1.05 1.05 0 0 1 .345.79 1.16 1.16 0 0 1-.345.855q-.33.346-.84.346zm7.875 9.133a3.17 3.17 0 0 1-1.662-.444q-.723-.46-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283q.279-.658 1.086-1.119a3.5 3.5 0 0 1 1.778-.477q1.119 0 1.942.51a3.24 3.24 0 0 1 1.283 1.4q.445.888.444 2.072 0 1.201-.526 2.09a3.5 3.5 0 0 1-1.382 1.366 3.8 3.8 0 0 1-1.876.477zm-.296-1.481q1.069 0 1.645-.675.577-.69.577-1.778 0-1.102-.577-1.776-.56-.691-1.645-.692a2.12 2.12 0 0 0-1.58.659q-.642.641-.642 1.694v.115q0 .71.296 1.267a2.4 2.4 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481q.263-.757.856-1.217a2.14 2.14 0 0 1 1.349-.46q.527 0 .724.098l-.247 1.794q-.149-.099-.642-.099-.774 0-1.416.494-.626.493-.626 1.58v3.883h-1.777V9.242zm9.534 7.718q-1.35 0-2.255-.526-.904-.543-1.332-1.432a4.6 4.6 0 0 1-.428-1.975q0-1.2.493-2.106a3.46 3.46 0 0 1 1.4-1.382q.889-.495 2.007-.494 1.744 0 2.584.97.855.956.856 2.7 0 .444-.05.92h-5.43q.18 1.005.708 1.45.542.443 1.497.443.79 0 1.3-.131a4 4 0 0 0 .938-.362l.542 1.267q-.411.263-1.119.46-.708.198-1.711.197zm1.596-4.558q.016-1.02-.444-1.432-.46-.428-1.316-.428-1.728 0-1.991 1.86z'/%3E%3Cpath d='M5.074 15.948a.484.657 0 0 0-.486.659v1.84a.484.657 0 0 0 .486.659h4.101a.484.657 0 0 0 .486-.659v-1.84a.484.657 0 0 0-.486-.659zm3.56 1.16H5.617v.838h3.017z' style='fill:%23fff;fill-rule:evenodd;stroke-width:1.03600001'/%3E%3Cg style='stroke-width:1.12603545'%3E%3Cpath d='M-9.408-1.416c-3.833-.025-7.056 2.912-7.08 6.615-.02 3.08 1.653 4.832 3.107 6.268.903.892 1.721 1.74 2.32 2.902l-.525-.004c-.543-.003-.992.304-1.24.639a1.87 1.87 0 0 0-.362 1.121l-.011 1.877c-.003.402.104.787.347 1.125.244.338.688.653 1.23.656l4.142.028c.542.003.99-.306 1.238-.641a1.87 1.87 0 0 0 .363-1.121l.012-1.875a1.87 1.87 0 0 0-.348-1.127c-.243-.338-.688-.653-1.23-.656l-.518-.004c.597-1.145 1.425-1.983 2.348-2.87 1.473-1.414 3.18-3.149 3.2-6.226-.016-3.59-2.923-6.684-6.993-6.707m-.006 1.1v.002c3.274.02 5.92 2.532 5.9 5.6-.017 2.706-1.39 4.026-2.863 5.44-1.034.994-2.118 2.033-2.814 3.633-.018.041-.052.055-.075.065q-.013.004-.02.01a.34.34 0 0 1-.226.084.34.34 0 0 1-.224-.086l-.092-.077c-.699-1.615-1.768-2.669-2.781-3.67-1.454-1.435-2.797-2.762-2.78-5.478.02-3.067 2.7-5.545 5.975-5.523m-.02 2.826c-1.62-.01-2.944 1.315-2.955 2.96-.01 1.646 1.295 2.988 2.916 2.999h.002c1.621.01 2.943-1.316 2.953-2.961.011-1.646-1.294-2.988-2.916-2.998m-.005 1.1c1.017.006 1.829.83 1.822 1.89s-.83 1.874-1.848 1.867c-1.018-.006-1.829-.83-1.822-1.89s.83-1.874 1.848-1.868m-2.155 11.857 4.14.025c.271.002.49.305.487.676l-.013 1.875c-.003.37-.224.67-.495.668l-4.14-.025c-.27-.002-.487-.306-.485-.676l.012-1.875c.003-.37.224-.67.494-.668' style='color:%23000;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:%23000;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:evenodd;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:%23000;solid-opacity:1;vector-effect:none;fill:%23000;fill-opacity:.4;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-9.415-.316C-12.69-.338-15.37 2.14-15.39 5.207c-.017 2.716 1.326 4.041 2.78 5.477 1.013 1 2.081 2.055 2.78 3.67l.092.076a.34.34 0 0 0 .225.086.34.34 0 0 0 .227-.083l.019-.01c.022-.009.057-.024.074-.064.697-1.6 1.78-2.64 2.814-3.634 1.473-1.414 2.847-2.733 2.864-5.44.02-3.067-2.627-5.58-5.901-5.601m-.057 8.784c1.621.011 2.944-1.315 2.955-2.96.01-1.646-1.295-2.988-2.916-2.999-1.622-.01-2.945 1.315-2.955 2.96s1.295 2.989 2.916 3' style='clip-rule:evenodd;fill:%23e1e3e9;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-11.594 15.465c-.27-.002-.492.297-.494.668l-.012 1.876c-.003.371.214.673.485.675l4.14.027c.271.002.492-.298.495-.668l.012-1.877c.003-.37-.215-.672-.485-.674z' style='clip-rule:evenodd;fill:%23fff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3C/g%3E%3C/svg%3E")}}.maplibregl-ctrl.maplibregl-ctrl-attrib{background-color:#ffffff80;margin:0;padding:0 5px}@media screen{.maplibregl-ctrl-attrib.maplibregl-compact{background-color:#fff;border-radius:12px;box-sizing:content-box;color:#000;margin:10px;min-height:20px;padding:2px 24px 2px 0;position:relative}.maplibregl-ctrl-attrib.maplibregl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.maplibregl-ctrl-bottom-left>.maplibregl-ctrl-attrib.maplibregl-compact-show,.maplibregl-ctrl-top-left>.maplibregl-ctrl-attrib.maplibregl-compact-show{border-radius:12px;padding:2px 8px 2px 28px}.maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-inner{display:none}.maplibregl-ctrl-attrib-button{background-color:#ffffff80;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E");border:0;border-radius:12px;box-sizing:border-box;cursor:pointer;display:none;height:24px;outline:none;position:absolute;right:0;top:0;width:24px}.maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;list-style:none}.maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button::-webkit-details-marker{display:none}.maplibregl-ctrl-bottom-left .maplibregl-ctrl-attrib-button,.maplibregl-ctrl-top-left .maplibregl-ctrl-attrib-button{left:0}.maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-button,.maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-inner{display:block}.maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-button{background-color:#0000000d}.maplibregl-ctrl-bottom-right>.maplibregl-ctrl-attrib.maplibregl-compact:after{bottom:0;right:0}.maplibregl-ctrl-top-right>.maplibregl-ctrl-attrib.maplibregl-compact:after{right:0;top:0}.maplibregl-ctrl-top-left>.maplibregl-ctrl-attrib.maplibregl-compact:after{left:0;top:0}.maplibregl-ctrl-bottom-left>.maplibregl-ctrl-attrib.maplibregl-compact:after{bottom:0;left:0}}@media screen and (forced-colors:active){.maplibregl-ctrl-attrib.maplibregl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='%23fff' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E")}}@media screen and (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl-attrib.maplibregl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E")}}.maplibregl-ctrl-attrib a{color:#000000bf;text-decoration:none}.maplibregl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.maplibregl-attrib-empty{display:none}.maplibregl-ctrl-scale{background-color:#ffffffbf;border:2px solid #333;border-top:#333;box-sizing:border-box;color:#333;font-size:10px;padding:0 5px}.maplibregl-popup{display:flex;left:0;pointer-events:none;position:absolute;top:0;will-change:transform}.maplibregl-popup-anchor-top,.maplibregl-popup-anchor-top-left,.maplibregl-popup-anchor-top-right{flex-direction:column}.maplibregl-popup-anchor-bottom,.maplibregl-popup-anchor-bottom-left,.maplibregl-popup-anchor-bottom-right{flex-direction:column-reverse}.maplibregl-popup-anchor-left{flex-direction:row}.maplibregl-popup-anchor-right{flex-direction:row-reverse}.maplibregl-popup-tip{border:10px solid transparent;height:0;width:0;z-index:1}.maplibregl-popup-anchor-top .maplibregl-popup-tip{align-self:center;border-bottom-color:#fff;border-top:none}.maplibregl-popup-anchor-top-left .maplibregl-popup-tip{align-self:flex-start;border-bottom-color:#fff;border-left:none;border-top:none}.maplibregl-popup-anchor-top-right .maplibregl-popup-tip{align-self:flex-end;border-bottom-color:#fff;border-right:none;border-top:none}.maplibregl-popup-anchor-bottom .maplibregl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.maplibregl-popup-anchor-bottom-left .maplibregl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.maplibregl-popup-anchor-bottom-right .maplibregl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.maplibregl-popup-anchor-left .maplibregl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.maplibregl-popup-anchor-right .maplibregl-popup-tip{align-self:center;border-left-color:#fff;border-right:none}.maplibregl-popup-close-button{background-color:transparent;border:0;border-radius:0 3px 0 0;cursor:pointer;position:absolute;right:0;top:0}.maplibregl-popup-close-button:hover{background-color:#0000000d}.maplibregl-popup-content{background:#fff;border-radius:3px;box-shadow:0 1px 2px #0000001a;padding:15px 10px;pointer-events:auto;position:relative}.maplibregl-popup-anchor-top-left .maplibregl-popup-content{border-top-left-radius:0}.maplibregl-popup-anchor-top-right .maplibregl-popup-content{border-top-right-radius:0}.maplibregl-popup-anchor-bottom-left .maplibregl-popup-content{border-bottom-left-radius:0}.maplibregl-popup-anchor-bottom-right .maplibregl-popup-content{border-bottom-right-radius:0}.maplibregl-popup-track-pointer{display:none}.maplibregl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.maplibregl-map:hover .maplibregl-popup-track-pointer{display:flex}.maplibregl-map:active .maplibregl-popup-track-pointer{display:none}.maplibregl-marker{left:0;position:absolute;top:0;transition:opacity .2s;will-change:transform}.maplibregl-user-location-dot,.maplibregl-user-location-dot:before{background-color:#1da1f2;border-radius:50%;height:15px;width:15px}.maplibregl-user-location-dot:before{animation:maplibregl-user-location-dot-pulse 2s infinite;content:"";position:absolute}.maplibregl-user-location-dot:after{border:2px solid #fff;border-radius:50%;box-shadow:0 0 3px #00000059;box-sizing:border-box;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px}@keyframes maplibregl-user-location-dot-pulse{0%{opacity:1;transform:scale(1)}70%{opacity:0;transform:scale(3)}to{opacity:0;transform:scale(1)}}.maplibregl-user-location-dot-stale{background-color:#aaa}.maplibregl-user-location-dot-stale:after{display:none}.maplibregl-user-location-accuracy-circle{background-color:#1da1f233;border-radius:100%;height:1px;width:1px}.maplibregl-crosshair,.maplibregl-crosshair .maplibregl-interactive,.maplibregl-crosshair .maplibregl-interactive:active{cursor:crosshair}.maplibregl-boxzoom{background:#fff;border:2px dotted #202020;height:0;left:0;opacity:.5;position:absolute;top:0;width:0}.maplibregl-cooperative-gesture-screen{align-items:center;background:#0006;color:#fff;display:flex;font-size:1.4em;top:0;right:0;bottom:0;left:0;justify-content:center;line-height:1.2;opacity:0;padding:1rem;pointer-events:none;position:absolute;transition:opacity 1s ease 1s;z-index:99999}.maplibregl-cooperative-gesture-screen.maplibregl-show{opacity:1;transition:opacity .05s}.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message{display:none}@media (hover:none),(pointer:coarse){.maplibregl-cooperative-gesture-screen .maplibregl-desktop-message{display:none}.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message{display:block}}.maplibregl-pseudo-fullscreen{height:100%!important;left:0!important;position:fixed!important;top:0!important;width:100%!important;z-index:99999}</style>
  </head>
  <body
    class="bg-neutral-900 overflow-hidden text-white select-none print:text-black print:bg-white"
  >
    <div id="root"></div>
  </body>
</html>
